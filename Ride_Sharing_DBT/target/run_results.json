{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2025-03-14T13:14:10.810566Z", "invocation_id": "2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:13:59.694393Z", "completed_at": "2025-03-14T13:13:59.708419Z"}, {"name": "execute", "started_at": "2025-03-14T13:13:59.709423Z", "completed_at": "2025-03-14T13:14:00.181824Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5684676170349121, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00b9-0001-429b-0008-435e0002420a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.stg_country", "compiled": true, "compiled_code": "\n\nSELECT \n    CUSTOMER_ID,\n    COUNTRY,\n    REGION\nFROM RIDE_SHARING_DB.RAW.COUNTRY_REGION", "relation_name": "RIDE_SHARING_DB.STAGING.stg_country"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:00.265061Z", "completed_at": "2025-03-14T13:14:00.269029Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:00.270062Z", "completed_at": "2025-03-14T13:14:00.665391Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.47751617431640625, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429e-0008-435e00023596"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.stg_customers", "compiled": true, "compiled_code": "\n\nSELECT \n    CUSTOMER_ID,\n    CUSTOMERNAME,\n    COMPANY\nFROM RIDE_SHARING_DB.RAW.CUSTOMERS", "relation_name": "RIDE_SHARING_DB.STAGING.stg_customers"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:00.746428Z", "completed_at": "2025-03-14T13:14:00.751433Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:00.752436Z", "completed_at": "2025-03-14T13:14:01.557753Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9131600856781006, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429e-0008-435e0002359a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.stg_product", "compiled": true, "compiled_code": "\n\nSELECT \n    PRODUCT_ID,\n    PRODUCT_FAMILY,\n    PRODUCT_SUB_FAMILY\nFROM RIDE_SHARING_DB.RAW.PRODUCTS\n\n\n", "relation_name": "RIDE_SHARING_DB.MART.stg_product"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:01.669590Z", "completed_at": "2025-03-14T13:14:01.674589Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:01.675559Z", "completed_at": "2025-03-14T13:14:02.171684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5892314910888672, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429e-0008-435e0002359e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.stg_transaction", "compiled": true, "compiled_code": "\n\nSELECT \n    CUSTOMER_ID,\n    PRODUCT_ID,\n    TO_DATE(PAYMENT_MONTH, 'DD-MM-YYYY') AS PAYMENT_MONTH,\n    REVENUE_TYPE,\n    REVENUE,\n    QUANTITY,\n    COMPANIES\nFROM RIDE_SHARING_DB.RAW.TRANSACTION", "relation_name": "RIDE_SHARING_DB.STAGING.stg_transaction"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:02.263789Z", "completed_at": "2025-03-14T13:14:02.267806Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:02.268820Z", "completed_at": "2025-03-14T13:14:03.117257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9439818859100342, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429b-0008-435e0002420e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_churnstatus", "compiled": true, "compiled_code": "\n\n\n\nWITH transactions AS (\n    SELECT\n        customer_id,\n        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month\n    FROM RIDE_SHARING_DB.STAGING.stg_transaction\n),\n \nmax_month AS (\n    SELECT MAX(tran_month) AS latest_month FROM transactions\n),\n \nchurn_status AS (\n    SELECT\n        t.customer_id,\n        MAX(t.tran_month) AS last_transaction_month,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'\n            ELSE 'Active'\n        END AS L3m_churn_status,\n        CASE\n            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 'New_Customer' \n            ELSE 'Existing_Customer'\n        END AS L3MCustomer_Status,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'\n            ELSE 'Active'\n        END AS LM_churn_status,\n        CASE\n            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 'New_Customer' \n            ELSE 'Existing_Customer'\n        END AS LM_Customer_Status,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 'Churned'\n            ELSE 'Active'\n        END AS Ltm_churn_status,\n        CASE\n            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 'New_Customer' \n            ELSE 'Existing_Customer'\n        END AS Ltm_Customer_Status\n    FROM transactions t\n    CROSS JOIN max_month m\n    GROUP BY t.customer_id,m.latest_month\n)\nSELECT * FROM churn_status", "relation_name": "RIDE_SHARING_DB.MARTS.mart_churnstatus"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:03.210733Z", "completed_at": "2025-03-14T13:14:03.214731Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:03.215715Z", "completed_at": "2025-03-14T13:14:04.009538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.883246898651123, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429e-0008-435e000235a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_cust_churn_count", "compiled": true, "compiled_code": "\n\n\n\nWITH transactions AS (\n    SELECT\n        customer_id,\n        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month\n    FROM RIDE_SHARING_DB.STAGING.stg_transaction\n),\n \nmax_month AS (\n    SELECT MAX(tran_month) AS latest_month FROM transactions\n),\n \nchurn_status AS (\n    SELECT\n        t.customer_id,\n        MAX(t.tran_month) AS last_transaction_month,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 1\n            ELSE 0\n        END AS L3m_churn_status,\n        CASE\n            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 1\n            ELSE 0\n        END AS L3MCustomer_Status,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 1\n            ELSE 0\n        END AS LM_churn_status,\n        CASE\n            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 1 \n            ELSE 0\n        END AS LM_Customer_Status,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 1\n            ELSE 0\n        END AS Ltm_churn_status,\n        CASE\n            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 1\n            ELSE 0\n        END AS Ltm_Customer_Status\n    FROM transactions t\n    CROSS JOIN max_month m\n    GROUP BY t.customer_id,m.latest_month\n)\nSELECT sum(LM_churn_status) as churned_last_month,\nsum(L3m_churn_status) as churned_last_3_months,\nsum(Ltm_churn_status) as churned_last_12_months,\nsum(LM_Customer_Status) as new_customers_last_month,\nsum(L3MCustomer_Status) as new_customers_last_3_months,\nsum(Ltm_Customer_Status) as new_customers_last_12_months\n FROM \nchurn_status", "relation_name": "RIDE_SHARING_DB.MARTS.mart_cust_churn_count"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:04.100538Z", "completed_at": "2025-03-14T13:14:04.107538Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:04.109537Z", "completed_at": "2025-03-14T13:14:05.058048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0418250560760498, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429b-0008-435e00024212"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_customers_rank", "compiled": true, "compiled_code": "\nWITH stg_customers AS (\nSELECT \n    c.CUSTOMER_ID,\n    c.CUSTOMERNAME,\n    SUM(r.REVENUE) AS TOTAL_REVENUE,\n    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK\nFROM RIDE_SHARING_DB.STAGING.stg_customers c\nJOIN RIDE_SHARING_DB.STAGING.stg_transaction r \nON c.CUSTOMER_ID = r.CUSTOMER_ID\nGROUP BY c.CUSTOMER_ID,CUSTOMERNAME\nORDER BY TOTAL_REVENUE DESC\n)\nSELECT \n    s.CUSTOMER_ID,\n    s.CUSTOMERNAME,\n    con.COUNTRY,\n    con.REGION,\n    s.TOTAL_REVENUE,\n    s.RANK\n    \nFROM stg_customers s\nJOIN RIDE_SHARING_DB.STAGING.stg_country con\non s.CUSTOMER_ID = con.CUSTOMER_ID", "relation_name": "RIDE_SHARING_DB.MARTS.mart_customers_rank"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:05.147326Z", "completed_at": "2025-03-14T13:14:05.154322Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:05.156328Z", "completed_at": "2025-03-14T13:14:05.838957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7769949436187744, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429b-0008-435e00024216"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_fiscal_year", "compiled": true, "compiled_code": "\n\n\nWITH first_payment AS (\n    SELECT\n        customer_id,\n        YEAR(MIN(PAYMENT_MONTH)) AS fiscal_Year,\n    FROM\n        RIDE_SHARING_DB.STAGING.stg_transaction\n    GROUP BY customer_id\n)\nSELECT\n    fiscal_Year,\n    COUNT(customer_id) AS new_logos_count\nFROM\n    first_payment\nGROUP BY fiscal_Year", "relation_name": "RIDE_SHARING_DB.MARTS.mart_fiscal_year"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:05.927474Z", "completed_at": "2025-03-14T13:14:05.931477Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:05.932475Z", "completed_at": "2025-03-14T13:14:06.670257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.839287519454956, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429b-0008-435e0002421a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_high_cross", "compiled": true, "compiled_code": "\nWITH cross_sell as(\nSELECT \n    CUSTOMER_ID,\n    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,\n    SUM(REVENUE) AS TOTAL_REVENUE\nFROM RIDE_SHARING_DB.STAGING.stg_transaction\nGROUP BY CUSTOMER_ID\n)\nSELECT \n    CUSTOMER_ID,\n    UNIQUE_PRODUCTS,\n    DENSE_RANK() OVER (ORDER BY UNIQUE_PRODUCTS DESC) AS RANK,\n    TOTAL_REVENUE\nFROM cross_sell\n    wHERE UNIQUE_PRODUCTS > 1\n    ORDER BY UNIQUE_PRODUCTS DESC", "relation_name": "RIDE_SHARING_DB.MARTS.mart_high_cross"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:06.774676Z", "completed_at": "2025-03-14T13:14:06.778645Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:06.779646Z", "completed_at": "2025-03-14T13:14:07.714631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0316433906555176, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429e-0008-435e000235a6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_nrr_grr", "compiled": true, "compiled_code": "\n\nwith prev as (\n    select\n        customer_id,\n        revenue,\n        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue\n    from RIDE_SHARING_DB.STAGING.stg_transaction\n),\ntransactions AS (\n SELECT\n        customer_id,\n        SUM(revenue) AS total_revenue,  \n        sum(previous_revenue) as prev_total_revenue,\n        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  \n        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  \n    FROM prev\n    GROUP BY 1\n),\ntrans as(\nSELECT\n    customer_id,\n    total_revenue,\n    prev_total_revenue,\n    expansion_revenue,\n    contraction_revenue,\n    CASE\n        WHEN total_revenue = 0 THEN 0\n        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100\n    END AS net_revenue_retention_in_percentage,\n    CASE\n        WHEN total_revenue = 0 THEN 0\n        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100\n    END AS gross_revenue_retention_in_percentage\nFROM transactions\n)\nSELECT \n    t.CUSTOMER_ID,\n    c.COUNTRY,\n    c.REGION,\n    t.total_revenue,\n    t.prev_total_revenue,\n    t.expansion_revenue,\n    t.contraction_revenue,\n    t.net_revenue_retention_in_percentage,\n    t.gross_revenue_retention_in_percentage\n    from trans t\n    JOIN RIDE_SHARING_DB.STAGING.stg_country c\n    ON t.CUSTOMER_ID = c.CUSTOMER_ID", "relation_name": "RIDE_SHARING_DB.MARTS.mart_nrr_grr"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:07.818608Z", "completed_at": "2025-03-14T13:14:07.823603Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:07.824608Z", "completed_at": "2025-03-14T13:14:08.703811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9676377773284912, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429b-0008-435e0002421e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_prod_churn", "compiled": true, "compiled_code": "\n\n\n\nWITH transactions AS (\n    SELECT\n        PRODUCT_ID,\n        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month\n    FROM RIDE_SHARING_DB.STAGING.stg_transaction\n),\n \nmax_month AS (\n    SELECT MAX(tran_month) AS latest_month FROM transactions\n),\n \nchurn_status AS (\n    SELECT\n        t.PRODUCT_ID,\n        m.latest_month,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'\n            ELSE 'Active'\n        END AS L3m_churn_status,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'\n            ELSE 'Active'\n        END AS LM_churn_status,\n        CASE\n            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 'Churned'\n            ELSE 'Active'\n        END AS Ltm_churn_status\n    FROM transactions t\n    CROSS JOIN max_month m\n    GROUP BY t.PRODUCT_ID,m.latest_month\n)\nSELECT * FROM churn_status", "relation_name": "RIDE_SHARING_DB.MARTS.mart_prod_churn"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:08.790171Z", "completed_at": "2025-03-14T13:14:08.794173Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:08.795143Z", "completed_at": "2025-03-14T13:14:09.829390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1386563777923584, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429a-0008-435e000250fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_product_revenue", "compiled": true, "compiled_code": "\nSELECT \n    p.PRODUCT_ID,\n    p.PRODUCT_FAMILY,\n    SUM(r.REVENUE) AS TOTAL_REVENUE,\n    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS,\n    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK\nFROM RIDE_SHARING_DB.MART.stg_product p\nJOIN RIDE_SHARING_DB.STAGING.stg_transaction r \nON p.PRODUCT_ID = r.PRODUCT_ID\nGROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY\nORDER BY TOTAL_REVENUE DESC", "relation_name": "RIDE_SHARING_DB.MARTS.mart_product_revenue"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:14:09.933800Z", "completed_at": "2025-03-14T13:14:09.937798Z"}, {"name": "execute", "started_at": "2025-03-14T13:14:09.938802Z", "completed_at": "2025-03-14T13:14:10.699683Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8697414398193359, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ba-0001-429a-0008-435e00025102"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.practice.mart_revenue_loss", "compiled": true, "compiled_code": "\n\nWITH revenue_drop as(\n    SELECT\n    PRODUCT_ID,\n    PAYMENT_MONTH,\n    REVENUE,\n    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE\nFROM RIDE_SHARING_DB.STAGING.stg_transaction\n),\nreplace_null as(\n    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,\n    PRODUCT_ID,\n    PAYMENT_MONTH,\n    PREV_REVENUE,\n    REVENUE,\n     FROM revenue_drop\n)\n    SELECT \n    PRODUCT_ID,\n    PAYMENT_MONTH,\n    SUM(Previous_Revenue) as Previous_Revenue,\n    SUM(REVENUE) as Current_Revenue,\n    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,\nFROM replace_null\nGROUP BY PRODUCT_ID,PAYMENT_MONTH   \nORDER BY Revenue_Loss DESC\n\n\n-- SELECT \n--     PRODUCT_ID,\n--     SUM(Revenue_Loss) as Total_Revenue_Loss\n--     FROM loss_revenue\n-- GROUP BY PRODUCT_ID", "relation_name": "RIDE_SHARING_DB.MARTS.mart_revenue_loss"}], "elapsed_time": 15.363647699356079, "args": {"enable_legacy_logger": false, "which": "run", "log_level_file": "debug", "show_resource_report": false, "partial_parse_file_diff": true, "indirect_selection": "eager", "log_format_file": "debug", "log_format": "default", "introspect": true, "printer_width": 80, "print": true, "defer": false, "log_level": "info", "quiet": false, "cache_selected_only": false, "strict_mode": false, "use_colors": true, "vars": {}, "static_parser": true, "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt run", "favor_state": false, "profiles_dir": "C:\\Users\\KavinVishnuN\\.dbt", "write_json": true, "exclude": [], "log_path": "C:\\Users\\KavinVishnuN\\dbt\\practice\\logs", "select": [], "populate_cache": true, "partial_parse": true, "project_dir": "C:\\Users\\KavinVishnuN\\dbt\\practice", "send_anonymous_usage_stats": true, "use_colors_file": true, "version_check": true, "macro_debugging": false, "log_file_max_bytes": 10485760}}