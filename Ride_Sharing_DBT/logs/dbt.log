[0m11:21:02.494985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B2F26920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B2793E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B2791C30>]}


============================== 11:21:02.494985 | b09037e1-be42-45dd-9dc8-ac925e926d73 ==============================
[0m11:21:02.494985 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:21:02.494985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:21:02.494985 [info ] [MainThread]: dbt version: 1.7.4
[0m11:21:02.494985 [info ] [MainThread]: python version: 3.10.0
[0m11:21:02.494985 [info ] [MainThread]: python path: C:\Users\kumar\AppData\Local\Programs\Python\Python310\python.exe
[0m11:21:02.494985 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m11:21:02.950214 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m11:21:02.950214 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m11:21:02.950214 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECT\dbt\practice\dbt_project.yml
[0m11:21:02.950214 [info ] [MainThread]: adapter type: snowflake
[0m11:21:02.950214 [info ] [MainThread]: adapter version: 1.7.1
[0m11:21:03.023018 [info ] [MainThread]: Configuration:
[0m11:21:03.024025 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:21:03.025035 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:21:03.026025 [info ] [MainThread]: Required dependencies:
[0m11:21:03.027025 [debug] [MainThread]: Executing "git --help"
[0m11:21:03.041827 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:21:03.041827 [debug] [MainThread]: STDERR: "b''"
[0m11:21:03.041827 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:21:03.041827 [info ] [MainThread]: Connection:
[0m11:21:03.041827 [info ] [MainThread]:   account: LZLTXPB-FW41340
[0m11:21:03.056650 [info ] [MainThread]:   user: KAVIN11
[0m11:21:03.056650 [info ] [MainThread]:   database: snowflake_prac
[0m11:21:03.056650 [info ] [MainThread]:   warehouse: compute_wh
[0m11:21:03.056650 [info ] [MainThread]:   role: accountadmin
[0m11:21:03.056650 [info ] [MainThread]:   schema: public
[0m11:21:03.056650 [info ] [MainThread]:   authenticator: None
[0m11:21:03.056650 [info ] [MainThread]:   private_key_path: None
[0m11:21:03.056650 [info ] [MainThread]:   token: None
[0m11:21:03.056650 [info ] [MainThread]:   oauth_client_id: None
[0m11:21:03.056650 [info ] [MainThread]:   query_tag: None
[0m11:21:03.056650 [info ] [MainThread]:   client_session_keep_alive: False
[0m11:21:03.056650 [info ] [MainThread]:   host: None
[0m11:21:03.056650 [info ] [MainThread]:   port: None
[0m11:21:03.056650 [info ] [MainThread]:   proxy_host: None
[0m11:21:03.056650 [info ] [MainThread]:   proxy_port: None
[0m11:21:03.056650 [info ] [MainThread]:   protocol: None
[0m11:21:03.056650 [info ] [MainThread]:   connect_retries: 1
[0m11:21:03.056650 [info ] [MainThread]:   connect_timeout: None
[0m11:21:03.056650 [info ] [MainThread]:   retry_on_database_errors: False
[0m11:21:03.056650 [info ] [MainThread]:   retry_all: False
[0m11:21:03.056650 [info ] [MainThread]:   insecure_mode: False
[0m11:21:03.056650 [info ] [MainThread]:   reuse_connections: None
[0m11:21:03.056650 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:21:03.072276 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m11:21:03.073399 [debug] [MainThread]: Using snowflake connection "debug"
[0m11:21:03.073399 [debug] [MainThread]: On debug: select 1 as id
[0m11:21:03.073399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:21:03.608539 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:21:03.608539 [debug] [MainThread]: On debug: Close
[0m11:21:03.703690 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:21:03.703690 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:21:03.703690 [debug] [MainThread]: Command `dbt debug` succeeded at 11:21:03.703690 after 1.28 seconds
[0m11:21:03.703690 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:21:03.703690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B2F26920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C466CB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C466F640>]}
[0m11:21:03.703690 [debug] [MainThread]: Flushing usage events
[0m12:38:38.435400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CEAC6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CE332F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CE332830>]}


============================== 12:38:38.442525 | ea82135d-b7d8-4563-81ad-263f383f5c60 ==============================
[0m12:38:38.442525 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:38:38.443944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:40.674202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea82135d-b7d8-4563-81ad-263f383f5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CE2FBCA0>]}
[0m12:38:40.783634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea82135d-b7d8-4563-81ad-263f383f5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E12C6170>]}
[0m12:38:40.783634 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:38:40.809155 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:38:40.809155 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:38:40.809155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea82135d-b7d8-4563-81ad-263f383f5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E01BF490>]}
[0m12:38:43.525607 [error] [MainThread]: Encountered an error:
Compilation Error in model tpch_orders (models\staging\tpch_orders.sql)
  expected token 'end of print statement', got ':'
    line 1
      select * from {{source : {'tp_source','MY_FIRST_DBT_MODEL'}}}
[0m12:38:43.525607 [debug] [MainThread]: Command `dbt run` failed at 12:38:43.525607 after 5.19 seconds
[0m12:38:43.525607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CEAC6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E14BD510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E14BD1E0>]}
[0m12:38:43.525607 [debug] [MainThread]: Flushing usage events
[0m12:39:43.521041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213758F5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021375162F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213751617E0>]}


============================== 12:39:43.521041 | bec17e7e-427f-4a2f-8af5-aa11455cccec ==============================
[0m12:39:43.521041 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:39:43.521041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:39:44.205757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bec17e7e-427f-4a2f-8af5-aa11455cccec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137512BDC0>]}
[0m12:39:44.315997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bec17e7e-427f-4a2f-8af5-aa11455cccec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137F124FD0>]}
[0m12:39:44.331628 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:39:44.331628 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:39:44.331628 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:39:44.331628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bec17e7e-427f-4a2f-8af5-aa11455cccec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137F0BA650>]}
[0m12:39:45.318128 [error] [MainThread]: Encountered an error:
Compilation Error in model tpch_orders (models\staging\tpch_orders.sql)
  expected token 'end of print statement', got '{'
    line 3
      from {{source{'tp_source','MY_FIRST_DBT_MODEL'}}}
[0m12:39:45.318128 [debug] [MainThread]: Command `dbt run` failed at 12:39:45.318128 after 1.88 seconds
[0m12:39:45.318128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213758F5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137F3194B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137F319180>]}
[0m12:39:45.318128 [debug] [MainThread]: Flushing usage events
[0m12:40:16.053492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF31375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF29A2EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF29A39D0>]}


============================== 12:40:16.058143 | 4a12368d-48dc-434a-b41b-fc7f814a87a7 ==============================
[0m12:40:16.058143 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:40:16.058143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:40:16.903646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a12368d-48dc-434a-b41b-fc7f814a87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF296BB20>]}
[0m12:40:17.011418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a12368d-48dc-434a-b41b-fc7f814a87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFF947970>]}
[0m12:40:17.011418 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:40:17.011418 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:40:17.025925 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:40:17.027003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a12368d-48dc-434a-b41b-fc7f814a87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFE90AE00>]}
[0m12:40:18.002628 [error] [MainThread]: Encountered an error:
Compilation Error in model tpch_orders (models\staging\tpch_orders.sql)
  expected token 'end of print statement', got '{'
    line 3
      from {{source{'tp_source','MY_FIRST_DBT_MODEL'} }}
[0m12:40:18.002628 [debug] [MainThread]: Command `dbt run` failed at 12:40:18.002628 after 2.03 seconds
[0m12:40:18.002628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF31375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFFB39540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBFFB39210>]}
[0m12:40:18.002628 [debug] [MainThread]: Flushing usage events
[0m12:41:18.260351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280D4405C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280D3C76F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280D3C764D0>]}


============================== 12:41:18.262860 | b9cf0825-874e-4de1-ad1b-5062a9dffb4b ==============================
[0m12:41:18.262860 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:41:18.262860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:18.939145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9cf0825-874e-4de1-ad1b-5062a9dffb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280D3C3FE20>]}
[0m12:41:19.032895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9cf0825-874e-4de1-ad1b-5062a9dffb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6C06440>]}
[0m12:41:19.032895 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:41:19.052005 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:41:19.052005 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:41:19.057066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9cf0825-874e-4de1-ad1b-5062a9dffb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E5A85A50>]}
[0m12:41:20.160763 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\staging\t_sources.yml @ sources: {'name': 'tp_source', 'database': 'snowflake_prac', 'schema': 'public', 'tables': [{'name': 'MY_FIRST_DBT_MODEL', 'columns': [{'names': 'id', 'tests': ['not_null']}]}]} - at path ['tables'][0]['columns'][0]: 'name' is a required property
[0m12:41:20.160763 [debug] [MainThread]: Command `dbt run` failed at 12:41:20.160763 after 1.98 seconds
[0m12:41:20.160763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280D4405C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6D25C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6C05C30>]}
[0m12:41:20.160763 [debug] [MainThread]: Flushing usage events
[0m12:42:18.432615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021938AC5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021938332F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219383317E0>]}


============================== 12:42:18.432615 | c80b7990-eba3-4185-b78d-6d22135c4a0f ==============================
[0m12:42:18.432615 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:42:18.432615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:42:19.088983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219382FBDC0>]}
[0m12:42:19.215626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194B2CA860>]}
[0m12:42:19.232482 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:42:19.235769 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:42:19.235769 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:42:19.235769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194A28A650>]}
[0m12:42:20.532541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.mart
[0m12:42:20.532541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194B61C2B0>]}
[0m12:42:20.587793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194B61D180>]}
[0m12:42:20.587793 [info ] [MainThread]: Found 1 model, 1 test, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:42:20.587793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194B579420>]}
[0m12:42:20.587793 [info ] [MainThread]: 
[0m12:42:20.587793 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:20.596889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m12:42:20.617100 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m12:42:20.620118 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m12:42:20.620118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:21.490351 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:42:21.490351 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m12:42:21.584246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m12:42:21.615356 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m12:42:21.615356 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m12:42:21.615356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:22.070859 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:42:22.070859 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m12:42:22.164611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194B9ABDF0>]}
[0m12:42:22.180175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:22.180175 [info ] [MainThread]: 
[0m12:42:22.180175 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m12:42:22.195725 [info ] [Thread-1 (]: 1 of 1 START sql view model public.tpch_orders ................................. [RUN]
[0m12:42:22.197940 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m12:42:22.197940 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m12:42:22.218252 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m12:42:22.250883 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 12:42:22.200738 => 12:42:22.250883
[0m12:42:22.250883 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m12:42:22.289885 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m12:42:22.300529 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m12:42:22.300529 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from snowflake_prac.public.MY_FIRST_DBT_MODEL
  );
[0m12:42:22.300529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:22.724165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:42:22.770983 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 12:42:22.250883 => 12:42:22.770983
[0m12:42:22.770983 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m12:42:22.867891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c80b7990-eba3-4185-b78d-6d22135c4a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194BA16B60>]}
[0m12:42:22.871156 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.67s]
[0m12:42:22.871156 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m12:42:22.878673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:22.878673 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m12:42:22.878673 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m12:42:22.878673 [debug] [MainThread]: Connection 'model.practice.tpch_orders' was properly closed.
[0m12:42:22.878673 [info ] [MainThread]: 
[0m12:42:22.884869 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m12:42:22.886891 [debug] [MainThread]: Command end result
[0m12:42:22.910318 [info ] [MainThread]: 
[0m12:42:22.910731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:22.910731 [info ] [MainThread]: 
[0m12:42:22.910731 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:22.917038 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:22.917038 after 4.56 seconds
[0m12:42:22.917038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021938AC5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194B512920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194B61C7C0>]}
[0m12:42:22.917038 [debug] [MainThread]: Flushing usage events
[0m14:48:02.370860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA04747610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA03FB2F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA03FB31C0>]}


============================== 14:48:02.377491 | cef7c5a1-b319-472e-b459-871efadd778c ==============================
[0m14:48:02.377491 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:48:02.377491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:48:04.288612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cef7c5a1-b319-472e-b459-871efadd778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA03F7BE20>]}
[0m14:48:04.367166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cef7c5a1-b319-472e-b459-871efadd778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA15F75C00>]}
[0m14:48:04.367166 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:48:04.387459 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:48:05.245953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:48:05.245953 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\samp.sql
[0m14:48:05.245953 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m14:48:05.480331 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.tpch_orders' (models\staging\tpch_orders.sql) depends on a source named 'tp_source.MY_FIRST_DBT_MODEL' which was not found
[0m14:48:05.480331 [debug] [MainThread]: Command `dbt test` failed at 14:48:05.480331 after 3.19 seconds
[0m14:48:05.480331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA04747610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA172C7F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA17326410>]}
[0m14:48:05.480331 [debug] [MainThread]: Flushing usage events
[0m14:48:28.123899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E723E7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E71C52F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E71C531C0>]}


============================== 14:48:28.127234 | d7528af2-1343-4d88-8f5b-77515c4cbb1c ==============================
[0m14:48:28.127234 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:48:28.127234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:28.599235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7528af2-1343-4d88-8f5b-77515c4cbb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E71C1BE20>]}
[0m14:48:28.667362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7528af2-1343-4d88-8f5b-77515c4cbb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E7FC15C00>]}
[0m14:48:28.667362 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:48:28.682986 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:48:28.755472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:48:28.755472 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\samp.sql
[0m14:48:28.756476 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m14:48:28.910224 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\staging\t_sources.yml @ sources: {'name': 'tp_source', 'database': 'snowflake_prac', 'schema': 'public', 'tables': [{'name': 'MY_FIRST_DBT_MODEL', 'columns': [{'names': 'id', 'tests': ['not_null']}]}]} - at path ['tables'][0]['columns'][0]: 'name' is a required property
[0m14:48:28.910224 [debug] [MainThread]: Command `dbt test` failed at 14:48:28.910224 after 0.85 seconds
[0m14:48:28.910224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E723E7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E7FE2F940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E7FE895A0>]}
[0m14:48:28.910224 [debug] [MainThread]: Flushing usage events
[0m14:48:50.724863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C81306920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C80B82F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C80B82830>]}


============================== 14:48:50.724863 | a6fdfe51-ab75-4d51-82a0-369e573afb79 ==============================
[0m14:48:50.724863 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:48:50.724863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:51.181006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6fdfe51-ab75-4d51-82a0-369e573afb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C80B4BCA0>]}
[0m14:48:51.249133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6fdfe51-ab75-4d51-82a0-369e573afb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C93AF6170>]}
[0m14:48:51.249133 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:48:51.264701 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:48:51.319825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:48:51.319825 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\samp.sql
[0m14:48:51.319825 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m14:48:51.571731 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.mart
- models.data_pipeline.staging
[0m14:48:51.571731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6fdfe51-ab75-4d51-82a0-369e573afb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C94075E10>]}
[0m14:48:51.602494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6fdfe51-ab75-4d51-82a0-369e573afb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C93C01270>]}
[0m14:48:51.602494 [info ] [MainThread]: Found 2 models, 1 test, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:48:51.602494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6fdfe51-ab75-4d51-82a0-369e573afb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C93C01810>]}
[0m14:48:51.602494 [info ] [MainThread]: 
[0m14:48:51.602494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:48:51.602494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m14:48:51.622051 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m14:48:51.622051 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m14:48:51.622051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:52.238219 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:48:52.238219 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m14:48:52.331585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6fdfe51-ab75-4d51-82a0-369e573afb79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C940CABC0>]}
[0m14:48:52.331585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:52.331585 [info ] [MainThread]: 
[0m14:48:52.347083 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0
[0m14:48:52.347083 [info ] [Thread-1 (]: 1 of 1 START test source_not_null_tp_source_MY_FIRST_DBT_MODEL_id .............. [RUN]
[0m14:48:52.347083 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0'
[0m14:48:52.347083 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0
[0m14:48:52.371166 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0"
[0m14:48:52.371166 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0 (compile): 14:48:52.356085 => 14:48:52.371166
[0m14:48:52.371166 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0
[0m14:48:52.385837 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0"
[0m14:48:52.385837 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0"
[0m14:48:52.395934 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from SNOWFLAKE_SAMPLE_DATA.public.MY_FIRST_DBT_MODEL
where id is null



      
    ) dbt_internal_test
[0m14:48:52.395934 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:52.816848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae3ae-0001-422c-0000-0008435eb7e1
[0m14:48:52.816848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SNOWFLAKE_SAMPLE_DATA.PUBLIC' does not exist or not authorized.
[0m14:48:52.816848 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0 (execute): 14:48:52.371166 => 14:48:52.816848
[0m14:48:52.832469 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0: Close
[0m14:48:52.941940 [debug] [Thread-1 (]: Database Error in test source_not_null_tp_source_MY_FIRST_DBT_MODEL_id (models\staging\t_sources.yml)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE_SAMPLE_DATA.PUBLIC' does not exist or not authorized.
  compiled Code at target\run\practice\models\staging\t_sources.yml\source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.sql
[0m14:48:52.941940 [error] [Thread-1 (]: 1 of 1 ERROR source_not_null_tp_source_MY_FIRST_DBT_MODEL_id ................... [[31mERROR[0m in 0.59s]
[0m14:48:52.941940 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0
[0m14:48:52.941940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:52.941940 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m14:48:52.941940 [debug] [MainThread]: Connection 'test.practice.source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.b565eec3e0' was properly closed.
[0m14:48:52.941940 [info ] [MainThread]: 
[0m14:48:52.941940 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m14:48:52.953453 [debug] [MainThread]: Command end result
[0m14:48:52.958332 [info ] [MainThread]: 
[0m14:48:52.958332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:48:52.958332 [info ] [MainThread]: 
[0m14:48:52.958332 [error] [MainThread]:   Database Error in test source_not_null_tp_source_MY_FIRST_DBT_MODEL_id (models\staging\t_sources.yml)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE_SAMPLE_DATA.PUBLIC' does not exist or not authorized.
  compiled Code at target\run\practice\models\staging\t_sources.yml\source_not_null_tp_source_MY_FIRST_DBT_MODEL_id.sql
[0m14:48:52.958332 [info ] [MainThread]: 
[0m14:48:52.967829 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:48:52.968837 [debug] [MainThread]: Command `dbt test` failed at 14:48:52.968837 after 2.29 seconds
[0m14:48:52.969840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C81306920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C940C7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C93C02B60>]}
[0m14:48:52.970429 [debug] [MainThread]: Flushing usage events
[0m14:55:01.432040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8F07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8772F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D87731C0>]}


============================== 14:55:01.435955 | ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c ==============================
[0m14:55:01.435955 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:55:01.435955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:55:01.946182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D873BE20>]}
[0m14:55:02.015488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EA735C00>]}
[0m14:55:02.015488 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:55:02.027499 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:55:02.106046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:55:02.107072 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m14:55:02.107983 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\tpch_orders.sql
[0m14:55:02.355303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.mart
- models.data_pipeline.staging
[0m14:55:02.355303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EBC92050>]}
[0m14:55:02.373096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EB80DBD0>]}
[0m14:55:02.375035 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:55:02.376041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EB80D630>]}
[0m14:55:02.376853 [info ] [MainThread]: 
[0m14:55:02.376853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:02.376853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m14:55:02.391843 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m14:55:02.392460 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m14:55:02.393187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:02.949347 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:55:02.949347 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m14:55:03.035622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m14:55:03.035622 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m14:55:03.035622 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m14:55:03.045373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:03.627615 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:55:03.635461 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m14:55:03.725578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EBE88760>]}
[0m14:55:03.725578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:03.735329 [info ] [MainThread]: 
[0m14:55:03.739425 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m14:55:03.739425 [info ] [Thread-1 (]: 1 of 2 START sql view model public.tpch_orders ................................. [RUN]
[0m14:55:03.739425 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m14:55:03.743177 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m14:55:03.755185 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m14:55:03.755185 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 14:55:03.743177 => 14:55:03.755185
[0m14:55:03.755185 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m14:55:03.785172 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m14:55:03.785172 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m14:55:03.785172 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m14:55:03.785172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:04.295387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:55:04.311394 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 14:55:03.755185 => 14:55:04.311394
[0m14:55:04.311394 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m14:55:04.417786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EBEEF0A0>]}
[0m14:55:04.417786 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m14:55:04.417786 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m14:55:04.425408 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m14:55:04.425408 [info ] [Thread-1 (]: 2 of 2 START sql view model public.samp ........................................ [RUN]
[0m14:55:04.425408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m14:55:04.425408 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m14:55:04.425408 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m14:55:04.425408 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 14:55:04.425408 => 14:55:04.425408
[0m14:55:04.425408 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m14:55:04.435089 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m14:55:04.436963 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m14:55:04.438089 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace   view snowflake_prac.public.samp
  
   as (
    select * from 
snowflake_prac.public.tpch_orders as orders
  );
[0m14:55:04.438089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:05.105658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:55:05.115131 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 14:55:04.432625 => 14:55:05.115131
[0m14:55:05.115131 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m14:55:05.198871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed3c6a6e-4048-47b6-848a-f0fc7aa5c38c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EBF41F30>]}
[0m14:55:05.201423 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.samp ................................... [[32mSUCCESS 1[0m in 0.77s]
[0m14:55:05.201423 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m14:55:05.205432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:05.205432 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m14:55:05.205432 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m14:55:05.205432 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m14:55:05.205432 [info ] [MainThread]: 
[0m14:55:05.205432 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m14:55:05.209238 [debug] [MainThread]: Command end result
[0m14:55:05.217326 [info ] [MainThread]: 
[0m14:55:05.219382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:05.219382 [info ] [MainThread]: 
[0m14:55:05.219382 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:55:05.219382 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:05.219382 after 3.84 seconds
[0m14:55:05.219382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4D8F07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EBF408B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4EBEEF460>]}
[0m14:55:05.219382 [debug] [MainThread]: Flushing usage events
[0m15:51:02.690267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F81275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F7992EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F79939D0>]}


============================== 15:51:02.693369 | d2b783e4-5cb8-4e18-8cbe-9d98dc27724e ==============================
[0m15:51:02.693369 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:51:02.693369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:51:03.254649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F795BB20>]}
[0m15:51:03.337126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FF957970>]}
[0m15:51:03.337126 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:51:03.345486 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:51:03.443499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:03.443499 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\samp.sql
[0m15:51:03.557163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.mart
[0m15:51:03.565164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FFCB4A60>]}
[0m15:51:03.575648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FFA65DB0>]}
[0m15:51:03.575648 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:51:03.581653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FFA65810>]}
[0m15:51:03.582375 [info ] [MainThread]: 
[0m15:51:03.582375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:51:03.582375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m15:51:03.598086 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m15:51:03.598086 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m15:51:03.598086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:04.087223 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m15:51:04.087223 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m15:51:04.165270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:51:04.180984 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:51:04.180984 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:51:04.180984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:04.624726 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:51:04.632728 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:51:04.715366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FFEB5EA0>]}
[0m15:51:04.723475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:04.723475 [info ] [MainThread]: 
[0m15:51:04.723475 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m15:51:04.731570 [info ] [Thread-1 (]: 1 of 2 START sql view model public.tpch_orders ................................. [RUN]
[0m15:51:04.731570 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m15:51:04.731570 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m15:51:04.739568 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m15:51:04.739568 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 15:51:04.731570 => 15:51:04.739568
[0m15:51:04.747481 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m15:51:04.772511 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m15:51:04.772511 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m15:51:04.772511 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m15:51:04.772511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:05.400551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:51:05.440820 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 15:51:04.747481 => 15:51:05.432894
[0m15:51:05.441115 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m15:51:05.517360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FFEED1E0>]}
[0m15:51:05.525515 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.79s]
[0m15:51:05.525515 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m15:51:05.525515 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m15:51:05.525515 [info ] [Thread-1 (]: 2 of 2 START sql view model public.samp ........................................ [RUN]
[0m15:51:05.533518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m15:51:05.533518 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m15:51:05.544769 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m15:51:05.545470 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 15:51:05.533518 => 15:51:05.545470
[0m15:51:05.545470 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m15:51:05.550488 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m15:51:05.551330 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m15:51:05.551330 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace   view snowflake_prac.public.samp
  
   as (
    select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdata as orderdata,
o_totalprice as total+price
from 
snowflake_prac.public.tpch_orders as orders
  );
[0m15:51:05.551330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:05.856352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae3ed-0001-422a-0000-0008435ec1d1
[0m15:51:05.856352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 21 unexpected '+'.
[0m15:51:05.864428 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 15:51:05.545470 => 15:51:05.864428
[0m15:51:05.864428 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m15:51:05.961102 [debug] [Thread-1 (]: Database Error in model samp (models\marts\samp.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 21 unexpected '+'.
  compiled Code at target\run\practice\models\marts\samp.sql
[0m15:51:05.961102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2b783e4-5cb8-4e18-8cbe-9d98dc27724e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250FFEED090>]}
[0m15:51:05.961102 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.samp ............................... [[31mERROR[0m in 0.43s]
[0m15:51:05.967650 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m15:51:05.967650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:05.967650 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m15:51:05.967650 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:51:05.967650 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m15:51:05.967650 [info ] [MainThread]: 
[0m15:51:05.967650 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m15:51:05.975660 [debug] [MainThread]: Command end result
[0m15:51:05.984454 [info ] [MainThread]: 
[0m15:51:05.986580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:51:05.986580 [info ] [MainThread]: 
[0m15:51:05.988526 [error] [MainThread]:   Database Error in model samp (models\marts\samp.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 21 unexpected '+'.
  compiled Code at target\run\practice\models\marts\samp.sql
[0m15:51:05.989157 [info ] [MainThread]: 
[0m15:51:05.989157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:51:05.989157 [debug] [MainThread]: Command `dbt run` failed at 15:51:05.989157 after 3.37 seconds
[0m15:51:05.989157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250F81275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002508B053F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002508B052C50>]}
[0m15:51:05.992165 [debug] [MainThread]: Flushing usage events
[0m15:52:10.400273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE2C475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE24B2EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE24B39D0>]}


============================== 15:52:10.400273 | 01d47a7f-9a0f-4e55-bcec-2da423135206 ==============================
[0m15:52:10.400273 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:52:10.400273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:52:10.858595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE247BB20>]}
[0m15:52:10.952340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF4477970>]}
[0m15:52:10.952340 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:52:10.952340 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:52:11.039145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:11.039145 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\samp.sql
[0m15:52:11.149847 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.mart
[0m15:52:11.166853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF57A4A60>]}
[0m15:52:11.200819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF5551DB0>]}
[0m15:52:11.200819 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:52:11.200819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF5551810>]}
[0m15:52:11.200819 [info ] [MainThread]: 
[0m15:52:11.200819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:11.213335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m15:52:11.218299 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m15:52:11.218299 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m15:52:11.218299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:11.712675 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m15:52:11.712675 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m15:52:11.808391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:52:11.816645 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:52:11.816645 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:52:11.816645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:12.254868 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:52:12.254868 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:52:12.349893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF59A5EA0>]}
[0m15:52:12.349893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:12.349893 [info ] [MainThread]: 
[0m15:52:12.364406 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m15:52:12.364406 [info ] [Thread-1 (]: 1 of 2 START sql view model public.tpch_orders ................................. [RUN]
[0m15:52:12.374150 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m15:52:12.374150 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m15:52:12.384143 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m15:52:12.384143 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 15:52:12.374150 => 15:52:12.384143
[0m15:52:12.384143 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m15:52:12.414680 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m15:52:12.417454 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m15:52:12.417454 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m15:52:12.417454 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:12.916456 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:52:12.945099 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 15:52:12.389833 => 15:52:12.945099
[0m15:52:12.945099 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m15:52:13.024169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF59DD1E0>]}
[0m15:52:13.024169 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.66s]
[0m15:52:13.039815 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m15:52:13.039815 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m15:52:13.039815 [info ] [Thread-1 (]: 2 of 2 START sql view model public.samp ........................................ [RUN]
[0m15:52:13.039815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m15:52:13.045335 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m15:52:13.051330 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m15:52:13.051330 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 15:52:13.045335 => 15:52:13.051330
[0m15:52:13.051330 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m15:52:13.051330 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m15:52:13.051330 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m15:52:13.051330 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace   view snowflake_prac.public.samp
  
   as (
    select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdata as orderdata,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
  );
[0m15:52:13.051330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:13.402194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae3ee-0001-4231-0000-0008435ea9a5
[0m15:52:13.402194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 0
invalid identifier 'O_ORDERDATA'
[0m15:52:13.402194 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 15:52:13.051330 => 15:52:13.402194
[0m15:52:13.402194 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m15:52:13.503098 [debug] [Thread-1 (]: Database Error in model samp (models\marts\samp.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'O_ORDERDATA'
  compiled Code at target\run\practice\models\marts\samp.sql
[0m15:52:13.503098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d47a7f-9a0f-4e55-bcec-2da423135206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF5A67940>]}
[0m15:52:13.503098 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.samp ............................... [[31mERROR[0m in 0.46s]
[0m15:52:13.503098 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m15:52:13.503098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:13.503098 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m15:52:13.503098 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:52:13.503098 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m15:52:13.503098 [info ] [MainThread]: 
[0m15:52:13.503098 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m15:52:13.517916 [debug] [MainThread]: Command end result
[0m15:52:13.519124 [info ] [MainThread]: 
[0m15:52:13.529266 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:52:13.529266 [info ] [MainThread]: 
[0m15:52:13.529266 [error] [MainThread]:   Database Error in model samp (models\marts\samp.sql)
  000904 (42000): SQL compilation error: error line 7 at position 0
  invalid identifier 'O_ORDERDATA'
  compiled Code at target\run\practice\models\marts\samp.sql
[0m15:52:13.529266 [info ] [MainThread]: 
[0m15:52:13.529266 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:52:13.532779 [debug] [MainThread]: Command `dbt run` failed at 15:52:13.532779 after 3.19 seconds
[0m15:52:13.532779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE2C475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF5A8BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AF5A89DB0>]}
[0m15:52:13.532779 [debug] [MainThread]: Flushing usage events
[0m15:52:48.987354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FCED5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FC742F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FC7424D0>]}


============================== 15:52:48.987354 | 59fd1a67-d82c-42e6-a0a0-8976361bff56 ==============================
[0m15:52:48.987354 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:52:48.987354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:52:49.514211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FC70BE20>]}
[0m15:52:49.576717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78F726440>]}
[0m15:52:49.592250 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:52:49.592250 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:52:49.672235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:49.672235 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\samp.sql
[0m15:52:49.800866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.mart
[0m15:52:49.816650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78FA7C9A0>]}
[0m15:52:49.835607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78F82DCF0>]}
[0m15:52:49.835607 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:52:49.835607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78F82D750>]}
[0m15:52:49.835607 [info ] [MainThread]: 
[0m15:52:49.844909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:49.844909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m15:52:49.852802 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m15:52:49.863929 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m15:52:49.865163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:50.337091 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m15:52:50.352886 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m15:52:50.436701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:52:50.452318 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:52:50.452318 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:52:50.452318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:50.908313 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:52:50.915389 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:52:51.003236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78FC75DE0>]}
[0m15:52:51.003236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:51.003236 [info ] [MainThread]: 
[0m15:52:51.019504 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m15:52:51.019504 [info ] [Thread-1 (]: 1 of 2 START sql view model public.tpch_orders ................................. [RUN]
[0m15:52:51.019504 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m15:52:51.023614 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m15:52:51.032881 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m15:52:51.032881 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 15:52:51.023614 => 15:52:51.032881
[0m15:52:51.032881 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m15:52:51.065192 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m15:52:51.066474 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m15:52:51.066474 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m15:52:51.066474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:51.589076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:52:51.620180 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 15:52:51.032881 => 15:52:51.620180
[0m15:52:51.620180 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m15:52:51.713943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78FCACB20>]}
[0m15:52:51.713943 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.69s]
[0m15:52:51.713943 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m15:52:51.713943 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m15:52:51.713943 [info ] [Thread-1 (]: 2 of 2 START sql view model public.samp ........................................ [RUN]
[0m15:52:51.727938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m15:52:51.727938 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m15:52:51.733168 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m15:52:51.733168 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 15:52:51.727938 => 15:52:51.733168
[0m15:52:51.733168 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m15:52:51.733168 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m15:52:51.733168 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m15:52:51.743038 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace   view snowflake_prac.public.samp
  
   as (
    select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
  );
[0m15:52:51.743038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:52.340750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:52:52.340750 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 15:52:51.733168 => 15:52:52.340750
[0m15:52:52.340750 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m15:52:52.451956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59fd1a67-d82c-42e6-a0a0-8976361bff56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78FCAE5F0>]}
[0m15:52:52.451956 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.samp ................................... [[32mSUCCESS 1[0m in 0.74s]
[0m15:52:52.451956 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m15:52:52.451956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:52.451956 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m15:52:52.451956 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:52:52.451956 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m15:52:52.451956 [info ] [MainThread]: 
[0m15:52:52.451956 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m15:52:52.465797 [debug] [MainThread]: Command end result
[0m15:52:52.467668 [info ] [MainThread]: 
[0m15:52:52.467668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:52.467668 [info ] [MainThread]: 
[0m15:52:52.467668 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:52:52.467668 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:52.467668 after 3.55 seconds
[0m15:52:52.467668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FCED5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78FD50670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78FD522F0>]}
[0m15:52:52.481685 [debug] [MainThread]: Flushing usage events
[0m15:55:36.786363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4BC7975E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4BC002EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4BC002CB0>]}


============================== 15:55:36.786363 | 4c8fb552-cef0-49fd-b4e8-6242cee65a6b ==============================
[0m15:55:36.786363 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:55:36.786363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:55:37.347216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4BBFCBDF0>]}
[0m15:55:37.434502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CDF0CFA0>]}
[0m15:55:37.434502 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:55:37.444108 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:55:37.461712 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:55:37.461712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CDFCB0A0>]}
[0m15:55:38.424452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:55:38.424452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CF29B4C0>]}
[0m15:55:38.445215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CF3B34C0>]}
[0m15:55:38.445215 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:55:38.445215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CF3B31C0>]}
[0m15:55:38.445215 [info ] [MainThread]: 
[0m15:55:38.445215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:55:38.456228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m15:55:38.461192 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m15:55:38.461192 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m15:55:38.461192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:38.975586 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:55:38.991114 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m15:55:39.099221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:55:39.114838 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:55:39.114838 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:55:39.114838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:39.527667 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:55:39.531195 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:55:39.620888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CE040F70>]}
[0m15:55:39.620888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:39.620888 [info ] [MainThread]: 
[0m15:55:39.620888 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m15:55:39.620888 [info ] [Thread-1 (]: 1 of 2 START sql view model public.tpch_orders ................................. [RUN]
[0m15:55:39.637227 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m15:55:39.637227 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m15:55:39.645514 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m15:55:39.645514 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 15:55:39.637227 => 15:55:39.645514
[0m15:55:39.645514 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m15:55:39.664547 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m15:55:39.664547 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m15:55:39.677347 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m15:55:39.677347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:40.267471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:40.298737 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 15:55:39.645514 => 15:55:40.298737
[0m15:55:40.298737 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m15:55:40.392804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CF0B8FD0>]}
[0m15:55:40.392804 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.76s]
[0m15:55:40.392804 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m15:55:40.392804 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m15:55:40.392804 [info ] [Thread-1 (]: 2 of 2 START sql view model public.samp ........................................ [RUN]
[0m15:55:40.392804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m15:55:40.404206 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m15:55:40.410624 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m15:55:40.412631 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 15:55:40.404206 => 15:55:40.410624
[0m15:55:40.412811 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m15:55:40.412811 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m15:55:40.412811 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m15:55:40.412811 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace   view snowflake_prac.public.samp
  
   as (
    select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
  );
[0m15:55:40.412811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:40.912653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:55:40.912653 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 15:55:40.412811 => 15:55:40.912653
[0m15:55:40.912653 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m15:55:41.005737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8fb552-cef0-49fd-b4e8-6242cee65a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CF6728C0>]}
[0m15:55:41.005737 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.samp ................................... [[32mSUCCESS 1[0m in 0.61s]
[0m15:55:41.005737 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m15:55:41.005737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:41.005737 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m15:55:41.005737 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:55:41.005737 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m15:55:41.005737 [info ] [MainThread]: 
[0m15:55:41.005737 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m15:55:41.020779 [debug] [MainThread]: Command end result
[0m15:55:41.028503 [info ] [MainThread]: 
[0m15:55:41.032037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:41.032037 [info ] [MainThread]: 
[0m15:55:41.032037 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:55:41.032037 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:41.032037 after 4.31 seconds
[0m15:55:41.032037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4BC7975E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CDF8E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4CF5ADF60>]}
[0m15:55:41.032037 [debug] [MainThread]: Flushing usage events
[0m15:57:00.562357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018815F75C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188157E2F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188157E24D0>]}


============================== 15:57:00.562357 | b098db79-0fdd-413d-8cb3-5090e651b350 ==============================
[0m15:57:00.562357 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:57:00.562357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:00.562357 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  C:\Users\kumar\.dbt/profiles.yml
  
[0m15:57:00.562357 [debug] [MainThread]: Command `dbt run` failed at 15:57:00.562357 after 0.07 seconds
[0m15:57:00.562357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018815F75C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188157E2800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188157E24D0>]}
[0m15:57:00.578199 [debug] [MainThread]: Flushing usage events
[0m15:57:23.446550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDC9D6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDC242F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDC242830>]}


============================== 15:57:23.462285 | e4131ea5-b4a8-46d6-89a3-fd3c86b62df6 ==============================
[0m15:57:23.462285 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:57:23.462285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:57:24.014917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDC20BCA0>]}
[0m15:57:24.091256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF1D6170>]}
[0m15:57:24.091256 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:57:24.091256 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:57:24.129439 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:57:24.129439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEE10D8A0>]}
[0m15:57:25.149270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:57:25.152605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF4DB4F0>]}
[0m15:57:25.157811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF50B6D0>]}
[0m15:57:25.166989 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:57:25.166989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEE19DA50>]}
[0m15:57:25.166989 [info ] [MainThread]: 
[0m15:57:25.166989 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:25.166989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m15:57:25.177735 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m15:57:25.177735 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m15:57:25.177735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:25.691629 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m15:57:25.691629 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m15:57:25.787480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:57:25.802487 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:57:25.802487 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:57:25.802487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:26.085503 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:57:26.085503 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:57:26.178902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF358460>]}
[0m15:57:26.178902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:26.178902 [info ] [MainThread]: 
[0m15:57:26.196007 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m15:57:26.196007 [info ] [Thread-1 (]: 1 of 2 START sql view model public.tpch_orders ................................. [RUN]
[0m15:57:26.196007 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m15:57:26.196007 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m15:57:26.196007 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m15:57:26.196007 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 15:57:26.196007 => 15:57:26.196007
[0m15:57:26.207831 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m15:57:26.225890 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m15:57:26.225890 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m15:57:26.225890 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m15:57:26.225890 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:26.741586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:26.779454 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 15:57:26.207831 => 15:57:26.779454
[0m15:57:26.779454 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m15:57:26.869061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF2B6D10>]}
[0m15:57:26.869061 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.67s]
[0m15:57:26.884545 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m15:57:26.884545 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m15:57:26.884545 [info ] [Thread-1 (]: 2 of 2 START sql view model public.samp ........................................ [RUN]
[0m15:57:26.884545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m15:57:26.893027 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m15:57:26.898518 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m15:57:26.898518 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 15:57:26.893027 => 15:57:26.898518
[0m15:57:26.898518 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m15:57:26.898518 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m15:57:26.898518 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m15:57:26.898518 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace   view snowflake_prac.public.samp
  
   as (
    select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
  );
[0m15:57:26.898518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:27.510140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:27.510140 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 15:57:26.898518 => 15:57:27.510140
[0m15:57:27.510140 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m15:57:27.604028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4131ea5-b4a8-46d6-89a3-fd3c86b62df6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF7E90F0>]}
[0m15:57:27.604028 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.samp ................................... [[32mSUCCESS 1[0m in 0.72s]
[0m15:57:27.604028 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m15:57:27.619521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:27.619521 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m15:57:27.619521 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:57:27.619521 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m15:57:27.619521 [info ] [MainThread]: 
[0m15:57:27.619521 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m15:57:27.626330 [debug] [MainThread]: Command end result
[0m15:57:27.630495 [info ] [MainThread]: 
[0m15:57:27.630495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:27.630495 [info ] [MainThread]: 
[0m15:57:27.630495 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:57:27.641042 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:27.641042 after 4.26 seconds
[0m15:57:27.641042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEDC9D6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF4ADDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEEF84A770>]}
[0m15:57:27.641789 [debug] [MainThread]: Flushing usage events
[0m15:58:01.097485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91DF17610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91D782F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91D7831C0>]}


============================== 15:58:01.097485 | 65b1d3ca-18be-4944-91a2-a5896ad4b4e0 ==============================
[0m15:58:01.097485 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:58:01.097485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:01.596040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91D74BE20>]}
[0m15:58:01.674258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930715C00>]}
[0m15:58:01.674258 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:58:01.692103 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:58:01.778787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:01.778787 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\samp.sql
[0m15:58:01.873170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:58:01.889397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930A6C9A0>]}
[0m15:58:01.909152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930821DB0>]}
[0m15:58:01.909152 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:58:01.909152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930821810>]}
[0m15:58:01.909152 [info ] [MainThread]: 
[0m15:58:01.909152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:01.920169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m15:58:01.923924 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m15:58:01.923924 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m15:58:01.923924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:02.399778 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m15:58:02.415278 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m15:58:02.509114 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:58:02.524629 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:58:02.524629 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:58:02.524629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:02.934361 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:58:02.949875 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:58:03.046438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930C75D20>]}
[0m15:58:03.046438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:03.046438 [info ] [MainThread]: 
[0m15:58:03.060448 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m15:58:03.060448 [info ] [Thread-1 (]: 1 of 2 START sql view model public.tpch_orders ................................. [RUN]
[0m15:58:03.065497 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpch_orders'
[0m15:58:03.065497 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m15:58:03.074801 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m15:58:03.074801 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 15:58:03.066330 => 15:58:03.074801
[0m15:58:03.074801 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m15:58:03.094285 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m15:58:03.106828 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m15:58:03.106828 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m15:58:03.106828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:03.681713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:58:03.697287 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 15:58:03.074801 => 15:58:03.697287
[0m15:58:03.697287 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m15:58:03.791029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930CB5330>]}
[0m15:58:03.791029 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.73s]
[0m15:58:03.791029 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m15:58:03.791029 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m15:58:03.791029 [info ] [Thread-1 (]: 2 of 2 START sql table model public.samp ....................................... [RUN]
[0m15:58:03.791029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m15:58:03.791029 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m15:58:03.808415 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m15:58:03.808415 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 15:58:03.791029 => 15:58:03.808415
[0m15:58:03.808415 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m15:58:03.810857 [debug] [Thread-1 (]: Dropping relation "SNOWFLAKE_PRAC"."PUBLIC"."SAMP" because it is of type view
[0m15:58:03.824911 [debug] [Thread-1 (]: Applying DROP to: "SNOWFLAKE_PRAC"."PUBLIC"."SAMP"
[0m15:58:03.824911 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m15:58:03.824911 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
drop view if exists "SNOWFLAKE_PRAC"."PUBLIC"."SAMP" cascade
[0m15:58:03.824911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:04.196639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:58:04.227903 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m15:58:04.227903 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m15:58:04.227903 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace transient table snowflake_prac.public.samp
         as
        (

select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
        );
[0m15:58:07.377466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:58:07.377466 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 15:58:03.808415 => 15:58:07.377466
[0m15:58:07.377466 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m15:58:07.471679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b1d3ca-18be-4944-91a2-a5896ad4b4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930D6BA30>]}
[0m15:58:07.487335 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public.samp .................................. [[32mSUCCESS 1[0m in 3.68s]
[0m15:58:07.487335 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m15:58:07.487335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:07.487335 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m15:58:07.487335 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:58:07.487335 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m15:58:07.487335 [info ] [MainThread]: 
[0m15:58:07.499164 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m15:58:07.501832 [debug] [MainThread]: Command end result
[0m15:58:07.508090 [info ] [MainThread]: 
[0m15:58:07.511891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:07.511891 [info ] [MainThread]: 
[0m15:58:07.511891 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:58:07.511891 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:07.511891 after 6.47 seconds
[0m15:58:07.511891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E91DF17610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930D4BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E930D84760>]}
[0m15:58:07.515898 [debug] [MainThread]: Flushing usage events
[0m15:58:49.809668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE33C6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE2C32F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE2C32830>]}


============================== 15:58:49.825408 | cd3afaef-88e8-4a01-95aa-412f29f325ad ==============================
[0m15:58:49.825408 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:58:49.825408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:50.374534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd3afaef-88e8-4a01-95aa-412f29f325ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE2BFBCA0>]}
[0m15:58:50.452684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd3afaef-88e8-4a01-95aa-412f29f325ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF5BC6170>]}
[0m15:58:50.468286 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:58:50.468286 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:58:50.546908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:50.546908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:50.546908 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:58:50.555647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd3afaef-88e8-4a01-95aa-412f29f325ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF5DE0F10>]}
[0m15:58:50.563180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd3afaef-88e8-4a01-95aa-412f29f325ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF5CD1F90>]}
[0m15:58:50.571193 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:58:50.571937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3afaef-88e8-4a01-95aa-412f29f325ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF5CD19F0>]}
[0m15:58:50.572880 [info ] [MainThread]: 
[0m15:58:50.572880 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:50.575112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:58:50.588908 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:58:50.588908 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:58:50.588908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:51.092695 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:58:51.092695 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:58:51.194621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3afaef-88e8-4a01-95aa-412f29f325ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF5E231F0>]}
[0m15:58:51.194621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:51.202636 [info ] [MainThread]: 
[0m15:58:51.205503 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16
[0m15:58:51.205503 [info ] [Thread-1 (]: 1 of 2 START test source_not_null_tp_source_ORDERS_idO_ORDERKEY ................ [RUN]
[0m15:58:51.209759 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16'
[0m15:58:51.209759 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16
[0m15:58:51.222825 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16"
[0m15:58:51.222825 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16 (compile): 15:58:51.211469 => 15:58:51.222825
[0m15:58:51.222825 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16
[0m15:58:51.243563 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16"
[0m15:58:51.243563 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16"
[0m15:58:51.243563 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select idO_ORDERKEY
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
where idO_ORDERKEY is null



      
    ) dbt_internal_test
[0m15:58:51.254162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:51.685262 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae3f4-0001-4231-0000-0008435eaa5d
[0m15:58:51.685262 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'IDO_ORDERKEY'
[0m15:58:51.688281 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16 (execute): 15:58:51.222825 => 15:58:51.688281
[0m15:58:51.688281 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16: Close
[0m15:58:51.780947 [debug] [Thread-1 (]: Database Error in test source_not_null_tp_source_ORDERS_idO_ORDERKEY (models\staging\t_sources.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'IDO_ORDERKEY'
  compiled Code at target\run\practice\models\staging\t_sources.yml\source_not_null_tp_source_ORDERS_idO_ORDERKEY.sql
[0m15:58:51.780947 [error] [Thread-1 (]: 1 of 2 ERROR source_not_null_tp_source_ORDERS_idO_ORDERKEY ..................... [[31mERROR[0m in 0.58s]
[0m15:58:51.780947 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16
[0m15:58:51.780947 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2
[0m15:58:51.780947 [info ] [Thread-1 (]: 2 of 2 START test source_unique_tp_source_ORDERS_idO_ORDERKEY .................. [RUN]
[0m15:58:51.780947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_ORDERS_idO_ORDERKEY.14124ddc16, now test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2)
[0m15:58:51.780947 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2
[0m15:58:51.806392 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2"
[0m15:58:51.806392 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2 (compile): 15:58:51.780947 => 15:58:51.806392
[0m15:58:51.806392 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2
[0m15:58:51.811217 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2"
[0m15:58:51.811217 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2"
[0m15:58:51.811217 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    idO_ORDERKEY as unique_field,
    count(*) as n_records

from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
where idO_ORDERKEY is not null
group by idO_ORDERKEY
having count(*) > 1



      
    ) dbt_internal_test
[0m15:58:51.811217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:52.100970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae3f4-0001-4231-0000-0008435eaa61
[0m15:58:52.100970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'IDO_ORDERKEY'
[0m15:58:52.100970 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2 (execute): 15:58:51.806392 => 15:58:52.100970
[0m15:58:52.100970 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2: Close
[0m15:58:52.210313 [debug] [Thread-1 (]: Database Error in test source_unique_tp_source_ORDERS_idO_ORDERKEY (models\staging\t_sources.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'IDO_ORDERKEY'
  compiled Code at target\run\practice\models\staging\t_sources.yml\source_unique_tp_source_ORDERS_idO_ORDERKEY.sql
[0m15:58:52.210313 [error] [Thread-1 (]: 2 of 2 ERROR source_unique_tp_source_ORDERS_idO_ORDERKEY ....................... [[31mERROR[0m in 0.43s]
[0m15:58:52.210313 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2
[0m15:58:52.210313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:52.210313 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:58:52.210313 [debug] [MainThread]: Connection 'test.practice.source_unique_tp_source_ORDERS_idO_ORDERKEY.2b3bb3f0c2' was properly closed.
[0m15:58:52.225927 [info ] [MainThread]: 
[0m15:58:52.227294 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m15:58:52.228500 [debug] [MainThread]: Command end result
[0m15:58:52.238917 [info ] [MainThread]: 
[0m15:58:52.240140 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:58:52.240140 [info ] [MainThread]: 
[0m15:58:52.240140 [error] [MainThread]:   Database Error in test source_not_null_tp_source_ORDERS_idO_ORDERKEY (models\staging\t_sources.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'IDO_ORDERKEY'
  compiled Code at target\run\practice\models\staging\t_sources.yml\source_not_null_tp_source_ORDERS_idO_ORDERKEY.sql
[0m15:58:52.240140 [info ] [MainThread]: 
[0m15:58:52.240140 [error] [MainThread]:   Database Error in test source_unique_tp_source_ORDERS_idO_ORDERKEY (models\staging\t_sources.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'IDO_ORDERKEY'
  compiled Code at target\run\practice\models\staging\t_sources.yml\source_unique_tp_source_ORDERS_idO_ORDERKEY.sql
[0m15:58:52.240140 [info ] [MainThread]: 
[0m15:58:52.240140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:58:52.240140 [debug] [MainThread]: Command `dbt test` failed at 15:58:52.240140 after 2.49 seconds
[0m15:58:52.240140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE33C6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF6041FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF6041DE0>]}
[0m15:58:52.240140 [debug] [MainThread]: Flushing usage events
[0m15:59:13.417170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029312CD7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029312542F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293125431C0>]}


============================== 15:59:13.417170 | 5616eab7-1c97-4799-bb7a-8119205a3906 ==============================
[0m15:59:13.417170 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:59:13.417170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:13.935833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5616eab7-1c97-4799-bb7a-8119205a3906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002931250BE20>]}
[0m15:59:14.013969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5616eab7-1c97-4799-bb7a-8119205a3906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293254D5C00>]}
[0m15:59:14.013969 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:59:14.013969 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:59:14.094479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:14.102581 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m15:59:14.370670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:59:14.374440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5616eab7-1c97-4799-bb7a-8119205a3906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029325A66050>]}
[0m15:59:14.388052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5616eab7-1c97-4799-bb7a-8119205a3906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293255DDE10>]}
[0m15:59:14.388052 [info ] [MainThread]: Found 2 models, 2 tests, 1 source, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m15:59:14.388052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5616eab7-1c97-4799-bb7a-8119205a3906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293255DD870>]}
[0m15:59:14.388052 [info ] [MainThread]: 
[0m15:59:14.388052 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:14.394592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m15:59:14.402692 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m15:59:14.402692 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m15:59:14.410848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:14.908525 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:59:14.924049 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m15:59:15.017907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5616eab7-1c97-4799-bb7a-8119205a3906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029325AA2FE0>]}
[0m15:59:15.017907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:15.017907 [info ] [MainThread]: 
[0m15:59:15.033393 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m15:59:15.033393 [info ] [Thread-1 (]: 1 of 2 START test source_not_null_tp_source_ORDERS_O_ORDERKEY .................. [RUN]
[0m15:59:15.044548 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99'
[0m15:59:15.045933 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m15:59:15.056511 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m15:59:15.056511 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (compile): 15:59:15.045933 => 15:59:15.056511
[0m15:59:15.071544 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m15:59:15.089658 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m15:59:15.089658 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m15:59:15.089658 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select O_ORDERKEY
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
where O_ORDERKEY is null



      
    ) dbt_internal_test
[0m15:59:15.089658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:15.440382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:59:15.455861 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (execute): 15:59:15.071544 => 15:59:15.455861
[0m15:59:15.455861 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99: Close
[0m15:59:15.566125 [info ] [Thread-1 (]: 1 of 2 PASS source_not_null_tp_source_ORDERS_O_ORDERKEY ........................ [[32mPASS[0m in 0.53s]
[0m15:59:15.566125 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m15:59:15.566125 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m15:59:15.566125 [info ] [Thread-1 (]: 2 of 2 START test source_unique_tp_source_ORDERS_O_ORDERKEY .................... [RUN]
[0m15:59:15.566125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99, now test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22)
[0m15:59:15.575054 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m15:59:15.581241 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m15:59:15.588210 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (compile): 15:59:15.575889 => 15:59:15.581241
[0m15:59:15.588210 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m15:59:15.589521 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m15:59:15.589521 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m15:59:15.589521 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    O_ORDERKEY as unique_field,
    count(*) as n_records

from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
where O_ORDERKEY is not null
group by O_ORDERKEY
having count(*) > 1



      
    ) dbt_internal_test
[0m15:59:15.589521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:16.270944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:59:16.270944 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (execute): 15:59:15.588210 => 15:59:16.270944
[0m15:59:16.270944 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22: Close
[0m15:59:16.365309 [info ] [Thread-1 (]: 2 of 2 PASS source_unique_tp_source_ORDERS_O_ORDERKEY .......................... [[32mPASS[0m in 0.80s]
[0m15:59:16.365309 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m15:59:16.365309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:16.380792 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m15:59:16.380792 [debug] [MainThread]: Connection 'test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22' was properly closed.
[0m15:59:16.382779 [info ] [MainThread]: 
[0m15:59:16.384420 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m15:59:16.384420 [debug] [MainThread]: Command end result
[0m15:59:16.389708 [info ] [MainThread]: 
[0m15:59:16.389708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:16.399601 [info ] [MainThread]: 
[0m15:59:16.399601 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:59:16.399601 [debug] [MainThread]: Command `dbt test` succeeded at 15:59:16.399601 after 3.04 seconds
[0m15:59:16.399601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029312CD7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293255DCE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293255DF250>]}
[0m15:59:16.399601 [debug] [MainThread]: Flushing usage events
[0m16:36:10.641340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AA8B6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AA122F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AA122830>]}


============================== 16:36:10.643424 | aa089dc1-3a47-4931-a730-10e3ac6c00aa ==============================
[0m16:36:10.643424 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:36:10.643424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:11.160893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa089dc1-3a47-4931-a730-10e3ac6c00aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AA0EBCA0>]}
[0m16:36:11.241909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa089dc1-3a47-4931-a730-10e3ac6c00aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203BD0B6170>]}
[0m16:36:11.241909 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:36:11.250417 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:36:11.350649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:36:11.350649 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\tpc_lineage.sql
[0m16:36:11.350649 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m16:36:11.604009 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.tpc_lineage' (models\staging\tpc_lineage.sql) depends on a source named 'tp_source.lineitem' which was not found
[0m16:36:11.604009 [debug] [MainThread]: Command `dbt test` failed at 16:36:11.604009 after 1.02 seconds
[0m16:36:11.604009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AA8B6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203BD5E8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203BD5E9E70>]}
[0m16:36:11.604009 [debug] [MainThread]: Flushing usage events
[0m16:37:36.292219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226F45275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226F3D92EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226F3D92CB0>]}


============================== 16:37:36.300291 | a87e0530-6c53-4d61-af26-1d37e533d143 ==============================
[0m16:37:36.300291 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:37:36.300291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:36.818601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a87e0530-6c53-4d61-af26-1d37e533d143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226F3D5BDF0>]}
[0m16:37:36.897714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a87e0530-6c53-4d61-af26-1d37e533d143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FFC9CFA0>]}
[0m16:37:36.897714 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:37:36.905238 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:37:36.967675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:37:36.967675 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\tpc_lineage.sql
[0m16:37:36.970701 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m16:37:37.240621 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.tpc_lineage' (models\staging\tpc_lineage.sql) depends on a source named 'tp_source.lineitem' which was not found
[0m16:37:37.240621 [debug] [MainThread]: Command `dbt test` failed at 16:37:37.240621 after 1.00 seconds
[0m16:37:37.240621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226F45275E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022687259F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022687259F00>]}
[0m16:37:37.240621 [debug] [MainThread]: Flushing usage events
[0m16:37:57.920314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024049686920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024048EF2F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024048EF2830>]}


============================== 16:37:57.920314 | 2429720b-4df4-450b-821a-01af59e37f6c ==============================
[0m16:37:57.920314 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:37:57.924623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:58.440450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2429720b-4df4-450b-821a-01af59e37f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024048EBBCA0>]}
[0m16:37:58.520704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2429720b-4df4-450b-821a-01af59e37f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405BE86170>]}
[0m16:37:58.520704 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:37:58.520704 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:37:58.593606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:37:58.593606 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\tpc_lineage.sql
[0m16:37:58.593606 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m16:37:58.860375 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.tpc_lineage' (models\staging\tpc_lineage.sql) depends on a source named 'tp_source.lineitem' which was not found
[0m16:37:58.864138 [debug] [MainThread]: Command `dbt test` failed at 16:37:58.864138 after 1.00 seconds
[0m16:37:58.864138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024049686920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405C3B8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405C3B9E70>]}
[0m16:37:58.864138 [debug] [MainThread]: Flushing usage events
[0m16:38:27.495106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D033E07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D033672F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0336731C0>]}


============================== 16:38:27.498117 | 9f04cf42-b56a-48af-9736-7e78b3a0f29d ==============================
[0m16:38:27.498117 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:38:27.498117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:28.050828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f04cf42-b56a-48af-9736-7e78b3a0f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D03363BE20>]}
[0m16:38:28.125745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f04cf42-b56a-48af-9736-7e78b3a0f29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D046605C00>]}
[0m16:38:28.129427 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:38:28.142284 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:38:28.221781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:38:28.221781 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\tpc_lineage.sql
[0m16:38:28.221781 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m16:38:28.480819 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.tpc_lineage' (models\staging\tpc_lineage.sql) depends on a source named 'tp_source.LINEITEM' which was not found
[0m16:38:28.480819 [debug] [MainThread]: Command `dbt test` failed at 16:38:28.480819 after 1.05 seconds
[0m16:38:28.485359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D033E07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D046B3F880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D046B3DF00>]}
[0m16:38:28.485359 [debug] [MainThread]: Flushing usage events
[0m16:40:25.744792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDF095DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDE902F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDE9017E0>]}


============================== 16:40:25.744792 | 83370594-f707-4a76-95a8-09a060ea5e73 ==============================
[0m16:40:25.744792 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:40:25.750898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:40:26.235656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83370594-f707-4a76-95a8-09a060ea5e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDE8CBDC0>]}
[0m16:40:26.320829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83370594-f707-4a76-95a8-09a060ea5e73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF08C4FD0>]}
[0m16:40:26.322268 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:40:26.330561 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:40:26.362011 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading practice: staging\t_sources.yml - Runtime Error
    Syntax error near line 15
    ------------------------------
    12 |          - not_null
    13 |          - unique
    14 | 
    15 |   - name : LINEITEM
    16 |     columns :
    17 |       - name: L_ORDERKEY
    18 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 3
    did not find expected key
      in "<unicode string>", line 15, column 3
[0m16:40:26.366631 [debug] [MainThread]: Command `dbt test` failed at 16:40:26.366631 after 0.68 seconds
[0m16:40:26.366631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDF095DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1A63DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF1A639A0>]}
[0m16:40:26.366631 [debug] [MainThread]: Flushing usage events
[0m16:40:46.883361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021688097610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021687902F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216879031C0>]}


============================== 16:40:46.883361 | a230c1e0-920e-440a-8035-40140c3dbd3b ==============================
[0m16:40:46.883361 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:40:46.883361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:40:47.400879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a230c1e0-920e-440a-8035-40140c3dbd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216878CBE20>]}
[0m16:40:47.484404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a230c1e0-920e-440a-8035-40140c3dbd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169A895C00>]}
[0m16:40:47.484404 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:40:47.495540 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:40:47.570800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:40:47.571904 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\tpc_lineage.sql
[0m16:40:47.571904 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m16:40:47.845670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m16:40:47.850862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a230c1e0-920e-440a-8035-40140c3dbd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169AE1BFD0>]}
[0m16:40:47.860587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a230c1e0-920e-440a-8035-40140c3dbd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169A99D690>]}
[0m16:40:47.860587 [info ] [MainThread]: Found 3 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:40:47.860587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a230c1e0-920e-440a-8035-40140c3dbd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169A99DF00>]}
[0m16:40:47.865638 [info ] [MainThread]: 
[0m16:40:47.865638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:47.869139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m16:40:47.880572 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m16:40:47.880572 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m16:40:47.885680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:48.408783 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:40:48.411043 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m16:40:48.505648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a230c1e0-920e-440a-8035-40140c3dbd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169A99D5D0>]}
[0m16:40:48.507246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:48.507246 [info ] [MainThread]: 
[0m16:40:48.510852 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:40:48.520677 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_tp_source_LINEITEM_L_ORDERKEY ................ [RUN]
[0m16:40:48.524243 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba'
[0m16:40:48.525858 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:40:48.540722 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba"
[0m16:40:48.540722 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba (compile): 16:40:48.525858 => 16:40:48.540722
[0m16:40:48.540722 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:40:48.560582 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba"
[0m16:40:48.560582 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba"
[0m16:40:48.560582 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select L_ORDERKEY
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
where L_ORDERKEY is null



      
    ) dbt_internal_test
[0m16:40:48.560582 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:50.033548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:40:50.051090 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba (execute): 16:40:48.540722 => 16:40:50.051090
[0m16:40:50.051090 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba: Close
[0m16:40:50.141166 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_tp_source_LINEITEM_L_ORDERKEY ...................... [[32mPASS[0m in 1.62s]
[0m16:40:50.143200 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:40:50.143200 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:40:50.143200 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_tp_source_ORDERS_O_ORDERKEY .................. [RUN]
[0m16:40:50.151633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba, now test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99)
[0m16:40:50.151633 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:40:50.156678 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m16:40:50.160684 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (compile): 16:40:50.152918 => 16:40:50.160684
[0m16:40:50.162100 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:40:50.167695 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m16:40:50.167695 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m16:40:50.167695 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select O_ORDERKEY
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
where O_ORDERKEY is null



      
    ) dbt_internal_test
[0m16:40:50.167695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:50.482218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:40:50.482218 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (execute): 16:40:50.162100 => 16:40:50.482218
[0m16:40:50.482218 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99: Close
[0m16:40:50.580919 [info ] [Thread-1 (]: 2 of 4 PASS source_not_null_tp_source_ORDERS_O_ORDERKEY ........................ [[32mPASS[0m in 0.43s]
[0m16:40:50.582431 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:40:50.586498 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:40:50.586498 [info ] [Thread-1 (]: 3 of 4 START test source_unique_tp_source_LINEITEM_L_ORDERKEY .................. [RUN]
[0m16:40:50.586498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99, now test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88)
[0m16:40:50.590907 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:40:50.592852 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88"
[0m16:40:50.600868 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88 (compile): 16:40:50.590907 => 16:40:50.600868
[0m16:40:50.600868 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:40:50.604841 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88"
[0m16:40:50.606205 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88"
[0m16:40:50.606205 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    L_ORDERKEY as unique_field,
    count(*) as n_records

from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
where L_ORDERKEY is not null
group by L_ORDERKEY
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:50.606205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:52.095494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:40:52.100746 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88 (execute): 16:40:50.602386 => 16:40:52.100746
[0m16:40:52.105781 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88: Close
[0m16:40:52.190768 [error] [Thread-1 (]: 3 of 4 FAIL 1285828 source_unique_tp_source_LINEITEM_L_ORDERKEY ................ [[31mFAIL 1285828[0m in 1.60s]
[0m16:40:52.200627 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:40:52.200627 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:40:52.200627 [info ] [Thread-1 (]: 4 of 4 START test source_unique_tp_source_ORDERS_O_ORDERKEY .................... [RUN]
[0m16:40:52.200627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88, now test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22)
[0m16:40:52.207126 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:40:52.210769 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m16:40:52.210769 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (compile): 16:40:52.207126 => 16:40:52.210769
[0m16:40:52.210769 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:40:52.210769 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m16:40:52.220728 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m16:40:52.220728 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    O_ORDERKEY as unique_field,
    count(*) as n_records

from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
where O_ORDERKEY is not null
group by O_ORDERKEY
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:52.221459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:52.521062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:40:52.530600 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (execute): 16:40:52.210769 => 16:40:52.530600
[0m16:40:52.530600 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22: Close
[0m16:40:52.611178 [info ] [Thread-1 (]: 4 of 4 PASS source_unique_tp_source_ORDERS_O_ORDERKEY .......................... [[32mPASS[0m in 0.41s]
[0m16:40:52.620811 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:40:52.624873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:52.624873 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m16:40:52.624873 [debug] [MainThread]: Connection 'test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22' was properly closed.
[0m16:40:52.624873 [info ] [MainThread]: 
[0m16:40:52.624873 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m16:40:52.630999 [debug] [MainThread]: Command end result
[0m16:40:52.640665 [info ] [MainThread]: 
[0m16:40:52.640665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:40:52.640665 [info ] [MainThread]: 
[0m16:40:52.640665 [error] [MainThread]: [31mFailure in test source_unique_tp_source_LINEITEM_L_ORDERKEY (models\staging\t_sources.yml)[0m
[0m16:40:52.640665 [error] [MainThread]:   Got 1285828 results, configured to fail if != 0
[0m16:40:52.640665 [info ] [MainThread]: 
[0m16:40:52.640665 [info ] [MainThread]:   compiled Code at target\compiled\practice\models\staging\t_sources.yml\source_unique_tp_source_LINEITEM_L_ORDERKEY.sql
[0m16:40:52.640665 [info ] [MainThread]: 
[0m16:40:52.640665 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:40:52.640665 [debug] [MainThread]: Command `dbt test` failed at 16:40:52.640665 after 5.83 seconds
[0m16:40:52.640665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021688097610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169AE779A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169AE76980>]}
[0m16:40:52.640665 [debug] [MainThread]: Flushing usage events
[0m16:42:01.036205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269C4055DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269C38C3E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269C38C2BC0>]}


============================== 16:42:01.040857 | 9ed4cbc9-c8e7-419a-9645-e46d50bb3051 ==============================
[0m16:42:01.040857 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:42:01.040857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:42:01.155520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ed4cbc9-c8e7-419a-9645-e46d50bb3051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269C64198A0>]}
[0m16:42:01.169634 [debug] [MainThread]: Command `dbt clean` succeeded at 16:42:01.169634 after 0.20 seconds
[0m16:42:01.170652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269C4055DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269C388BE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269C6CCA0E0>]}
[0m16:42:01.170652 [debug] [MainThread]: Flushing usage events
[0m16:42:14.716748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E6C65C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E64D3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E64D2500>]}


============================== 16:42:14.717288 | 295f0b78-12a8-4dbe-9069-1bcc25259fda ==============================
[0m16:42:14.717288 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:42:14.720796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:42:15.236935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E649B9A0>]}
[0m16:42:15.310716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9465F30>]}
[0m16:42:15.310716 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:42:15.320838 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:42:15.320838 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:42:15.320838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F842A920>]}
[0m16:42:16.340661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m16:42:16.350856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9756860>]}
[0m16:42:16.370765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9734730>]}
[0m16:42:16.370919 [info ] [MainThread]: Found 3 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:42:16.370919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9736290>]}
[0m16:42:16.370919 [info ] [MainThread]: 
[0m16:42:16.370919 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:16.376586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m16:42:16.389096 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m16:42:16.389096 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m16:42:16.389096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:16.886173 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m16:42:16.890962 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m16:42:16.981576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m16:42:16.990983 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m16:42:16.990983 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m16:42:16.990983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:17.400862 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:42:17.405908 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m16:42:17.500964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9AD9030>]}
[0m16:42:17.500964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:17.500964 [info ] [MainThread]: 
[0m16:42:17.505972 [debug] [Thread-1 (]: Began running node model.practice.tpc_lineage
[0m16:42:17.510477 [info ] [Thread-1 (]: 1 of 3 START sql view model public.tpc_lineage ................................. [RUN]
[0m16:42:17.512356 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpc_lineage'
[0m16:42:17.512356 [debug] [Thread-1 (]: Began compiling node model.practice.tpc_lineage
[0m16:42:17.521380 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpc_lineage"
[0m16:42:17.521380 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (compile): 16:42:17.512356 => 16:42:17.521380
[0m16:42:17.521380 [debug] [Thread-1 (]: Began executing node model.practice.tpc_lineage
[0m16:42:17.552561 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpc_lineage"
[0m16:42:17.555290 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpc_lineage"
[0m16:42:17.555290 [debug] [Thread-1 (]: On model.practice.tpc_lineage: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpc_lineage"} */
create or replace   view snowflake_prac.public.tpc_lineage
  
   as (
    select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
  );
[0m16:42:17.555290 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:18.070741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:18.095867 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (execute): 16:42:17.521380 => 16:42:18.095867
[0m16:42:18.095867 [debug] [Thread-1 (]: On model.practice.tpc_lineage: Close
[0m16:42:18.170791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9B49AB0>]}
[0m16:42:18.177311 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.tpc_lineage ............................ [[32mSUCCESS 1[0m in 0.66s]
[0m16:42:18.180821 [debug] [Thread-1 (]: Finished running node model.practice.tpc_lineage
[0m16:42:18.181967 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m16:42:18.181967 [info ] [Thread-1 (]: 2 of 3 START sql view model public.tpch_orders ................................. [RUN]
[0m16:42:18.181967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpc_lineage, now model.practice.tpch_orders)
[0m16:42:18.181967 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m16:42:18.185566 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m16:42:18.185566 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 16:42:18.185566 => 16:42:18.185566
[0m16:42:18.191218 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m16:42:18.193427 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m16:42:18.196200 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m16:42:18.196200 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m16:42:18.196200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:18.660938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:18.672627 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 16:42:18.191218 => 16:42:18.672627
[0m16:42:18.672627 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m16:42:18.770968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9B806A0>]}
[0m16:42:18.770968 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.59s]
[0m16:42:18.770968 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m16:42:18.770968 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m16:42:18.770968 [info ] [Thread-1 (]: 3 of 3 START sql table model public.samp ....................................... [RUN]
[0m16:42:18.770968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m16:42:18.780416 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m16:42:18.786030 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m16:42:18.787387 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 16:42:18.781005 => 16:42:18.786030
[0m16:42:18.787387 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m16:42:18.804221 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m16:42:18.804221 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m16:42:18.804221 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace transient table snowflake_prac.public.samp
         as
        (

select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
        );
[0m16:42:18.804221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:22.085717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:42:22.090791 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 16:42:18.787387 => 16:42:22.085717
[0m16:42:22.090791 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m16:42:22.171152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '295f0b78-12a8-4dbe-9069-1bcc25259fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9BEB6A0>]}
[0m16:42:22.180669 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.samp .................................. [[32mSUCCESS 1[0m in 3.40s]
[0m16:42:22.180669 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m16:42:22.180669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:22.180669 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m16:42:22.180669 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m16:42:22.180669 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m16:42:22.180669 [info ] [MainThread]: 
[0m16:42:22.180669 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m16:42:22.188981 [debug] [MainThread]: Command end result
[0m16:42:22.190649 [info ] [MainThread]: 
[0m16:42:22.199881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:22.200887 [info ] [MainThread]: 
[0m16:42:22.200887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:42:22.202392 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:22.202392 after 7.54 seconds
[0m16:42:22.202392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E6C65C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F8428F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222F9754C40>]}
[0m16:42:22.204200 [debug] [MainThread]: Flushing usage events
[0m16:55:13.290662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4D906920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4D172F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4D172830>]}


============================== 16:55:13.293667 | 1cf5a04c-bb49-4855-814a-965cbee5c189 ==============================
[0m16:55:13.293667 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:55:13.293667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:13.811264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4D13BCA0>]}
[0m16:55:13.889293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5F136170>]}
[0m16:55:13.889293 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:55:13.889293 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:55:13.987565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:55:13.987565 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\order_lin.sql
[0m16:55:14.113285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:55:14.113285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60471A50>]}
[0m16:55:14.134066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED602E8460>]}
[0m16:55:14.134066 [info ] [MainThread]: Found 4 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:55:14.134066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED602EBEE0>]}
[0m16:55:14.144572 [info ] [MainThread]: 
[0m16:55:14.144572 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:14.144572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m16:55:14.160326 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m16:55:14.160326 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m16:55:14.160326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:14.674413 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:55:14.686942 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m16:55:14.770258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m16:55:14.789936 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m16:55:14.789936 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m16:55:14.789936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:15.080543 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:55:15.080543 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m16:55:15.190229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED60673190>]}
[0m16:55:15.190229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:15.190229 [info ] [MainThread]: 
[0m16:55:15.190229 [debug] [Thread-1 (]: Began running node model.practice.tpc_lineage
[0m16:55:15.190229 [info ] [Thread-1 (]: 1 of 4 START sql view model public.tpc_lineage ................................. [RUN]
[0m16:55:15.203528 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpc_lineage'
[0m16:55:15.204345 [debug] [Thread-1 (]: Began compiling node model.practice.tpc_lineage
[0m16:55:15.206970 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpc_lineage"
[0m16:55:15.206970 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (compile): 16:55:15.204345 => 16:55:15.206970
[0m16:55:15.215055 [debug] [Thread-1 (]: Began executing node model.practice.tpc_lineage
[0m16:55:15.235686 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpc_lineage"
[0m16:55:15.235686 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpc_lineage"
[0m16:55:15.235686 [debug] [Thread-1 (]: On model.practice.tpc_lineage: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpc_lineage"} */
create or replace   view snowflake_prac.public.tpc_lineage
  
   as (
    select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
  );
[0m16:55:15.235686 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:15.890540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:15.921743 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (execute): 16:55:15.215055 => 16:55:15.921743
[0m16:55:15.921743 [debug] [Thread-1 (]: On model.practice.tpc_lineage: Close
[0m16:55:15.999923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED606CBEE0>]}
[0m16:55:15.999923 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.tpc_lineage ............................ [[32mSUCCESS 1[0m in 0.81s]
[0m16:55:16.015436 [debug] [Thread-1 (]: Finished running node model.practice.tpc_lineage
[0m16:55:16.015436 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m16:55:16.015436 [info ] [Thread-1 (]: 2 of 4 START sql view model public.tpch_orders ................................. [RUN]
[0m16:55:16.015436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpc_lineage, now model.practice.tpch_orders)
[0m16:55:16.021829 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m16:55:16.027301 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m16:55:16.027301 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 16:55:16.021829 => 16:55:16.027301
[0m16:55:16.031679 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m16:55:16.032998 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m16:55:16.032998 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m16:55:16.032998 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m16:55:16.032998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:16.514250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:16.523767 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 16:55:16.031679 => 16:55:16.523767
[0m16:55:16.523767 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m16:55:16.617545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED606CB1F0>]}
[0m16:55:16.617545 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.60s]
[0m16:55:16.617545 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m16:55:16.617545 [debug] [Thread-1 (]: Began running node model.practice.order_lin
[0m16:55:16.617545 [info ] [Thread-1 (]: 3 of 4 START sql view model public.order_lin ................................... [RUN]
[0m16:55:16.631455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.order_lin)
[0m16:55:16.633387 [debug] [Thread-1 (]: Began compiling node model.practice.order_lin
[0m16:55:16.636676 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.order_lin"
[0m16:55:16.636676 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (compile): 16:55:16.633387 => 16:55:16.636676
[0m16:55:16.636676 [debug] [Thread-1 (]: Began executing node model.practice.order_lin
[0m16:55:16.646033 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.order_lin"
[0m16:55:16.646629 [debug] [Thread-1 (]: Using snowflake connection "model.practice.order_lin"
[0m16:55:16.648997 [debug] [Thread-1 (]: On model.practice.order_lin: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.order_lin"} */
create or replace   view snowflake_prac.public.order_lin
  
   as (
    select *
from
snowflake_prac.public.tpch_orders as orders
join 
snowflake_prac.public.tpc_lineage as tpc_lineage
on orders.orderkey=tpc_lineage.L_ORDERKEY
  );
[0m16:55:16.648997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:17.001403 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae42d-0001-422a-0000-0008435ec311
[0m16:55:17.001403 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 3
invalid identifier 'ORDERS.ORDERKEY'
[0m16:55:17.001403 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (execute): 16:55:16.641880 => 16:55:17.001403
[0m16:55:17.001403 [debug] [Thread-1 (]: On model.practice.order_lin: Close
[0m16:55:17.079526 [debug] [Thread-1 (]: Database Error in model order_lin (models\marts\order_lin.sql)
  000904 (42000): SQL compilation error: error line 9 at position 3
  invalid identifier 'ORDERS.ORDERKEY'
  compiled Code at target\run\practice\models\marts\order_lin.sql
[0m16:55:17.079526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED604B7820>]}
[0m16:55:17.079526 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.order_lin .......................... [[31mERROR[0m in 0.46s]
[0m16:55:17.079526 [debug] [Thread-1 (]: Finished running node model.practice.order_lin
[0m16:55:17.079526 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m16:55:17.095130 [info ] [Thread-1 (]: 4 of 4 START sql table model public.samp ....................................... [RUN]
[0m16:55:17.097633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.order_lin, now model.practice.samp)
[0m16:55:17.097633 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m16:55:17.097633 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m16:55:17.103244 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 16:55:17.097633 => 16:55:17.103244
[0m16:55:17.103244 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m16:55:17.119465 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m16:55:17.119465 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m16:55:17.119465 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace transient table snowflake_prac.public.samp
         as
        (

select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
        );
[0m16:55:17.119465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:19.304132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:55:19.307444 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 16:55:17.103244 => 16:55:19.307444
[0m16:55:19.309689 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m16:55:19.394293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cf5a04c-bb49-4855-814a-965cbee5c189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED602EA080>]}
[0m16:55:19.394293 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.samp .................................. [[32mSUCCESS 1[0m in 2.28s]
[0m16:55:19.394293 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m16:55:19.394293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:19.394293 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m16:55:19.394293 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m16:55:19.394293 [debug] [MainThread]: Connection 'model.practice.samp' was properly closed.
[0m16:55:19.394293 [info ] [MainThread]: 
[0m16:55:19.394293 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m16:55:19.402705 [debug] [MainThread]: Command end result
[0m16:55:19.403416 [info ] [MainThread]: 
[0m16:55:19.403416 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:19.417600 [info ] [MainThread]: 
[0m16:55:19.418311 [error] [MainThread]:   Database Error in model order_lin (models\marts\order_lin.sql)
  000904 (42000): SQL compilation error: error line 9 at position 3
  invalid identifier 'ORDERS.ORDERKEY'
  compiled Code at target\run\practice\models\marts\order_lin.sql
[0m16:55:19.419213 [info ] [MainThread]: 
[0m16:55:19.419213 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:55:19.419213 [debug] [MainThread]: Command `dbt run` failed at 16:55:19.419213 after 6.19 seconds
[0m16:55:19.419213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4D906920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6076F8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6076E800>]}
[0m16:55:19.419213 [debug] [MainThread]: Flushing usage events
[0m16:56:11.089447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001320CD87610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001320C5E2F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001320C5E31C0>]}


============================== 16:56:11.105059 | 47134528-ad87-44c9-bf59-15dfa95e6550 ==============================
[0m16:56:11.105059 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:56:11.105059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:11.659437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47134528-ad87-44c9-bf59-15dfa95e6550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001320C5ABE20>]}
[0m16:56:11.722976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47134528-ad87-44c9-bf59-15dfa95e6550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321E5B5C00>]}
[0m16:56:11.722976 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:56:11.737979 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:56:11.835876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:11.835876 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\order_lin.sql
[0m16:56:11.954555 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.order_lin' (models\marts\order_lin.sql) depends on a node named 'samo' which was not found
[0m16:56:11.954555 [debug] [MainThread]: Command `dbt run` failed at 16:56:11.954555 after 0.91 seconds
[0m16:56:11.954555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001320CD87610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321F78ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001321F7AC3A0>]}
[0m16:56:11.954555 [debug] [MainThread]: Flushing usage events
[0m16:56:27.623327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026503F475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265037B6EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265037B79D0>]}


============================== 16:56:27.623327 | 519ada5b-54dd-45bc-8b6d-2cfbd20a7963 ==============================
[0m16:56:27.623327 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:56:27.623327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:56:28.157848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650377FB20>]}
[0m16:56:28.236086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026515777970>]}
[0m16:56:28.236086 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:56:28.251679 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:56:28.328479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:28.328479 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\order_lin.sql
[0m16:56:28.432666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:56:28.432666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516AB5A80>]}
[0m16:56:28.453051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651692C250>]}
[0m16:56:28.453051 [info ] [MainThread]: Found 4 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:56:28.453051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651692C130>]}
[0m16:56:28.453051 [info ] [MainThread]: 
[0m16:56:28.453051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:28.453051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m16:56:28.466891 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m16:56:28.466891 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m16:56:28.466891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:28.996081 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:56:28.996081 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m16:56:29.089830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m16:56:29.089830 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m16:56:29.089830 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m16:56:29.105466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:29.395949 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m16:56:29.395949 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m16:56:29.505202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516CB5240>]}
[0m16:56:29.505202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:29.505202 [info ] [MainThread]: 
[0m16:56:29.513413 [debug] [Thread-1 (]: Began running node model.practice.tpc_lineage
[0m16:56:29.513413 [info ] [Thread-1 (]: 1 of 4 START sql view model public.tpc_lineage ................................. [RUN]
[0m16:56:29.521982 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpc_lineage'
[0m16:56:29.522778 [debug] [Thread-1 (]: Began compiling node model.practice.tpc_lineage
[0m16:56:29.531010 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpc_lineage"
[0m16:56:29.531010 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (compile): 16:56:29.522778 => 16:56:29.531010
[0m16:56:29.531010 [debug] [Thread-1 (]: Began executing node model.practice.tpc_lineage
[0m16:56:29.561413 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpc_lineage"
[0m16:56:29.561413 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpc_lineage"
[0m16:56:29.563041 [debug] [Thread-1 (]: On model.practice.tpc_lineage: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpc_lineage"} */
create or replace   view snowflake_prac.public.tpc_lineage
  
   as (
    select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
  );
[0m16:56:29.564227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:30.111017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:30.126511 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (execute): 16:56:29.531010 => 16:56:30.126511
[0m16:56:30.126511 [debug] [Thread-1 (]: On model.practice.tpc_lineage: Close
[0m16:56:30.220823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516D0BAC0>]}
[0m16:56:30.220823 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.tpc_lineage ............................ [[32mSUCCESS 1[0m in 0.70s]
[0m16:56:30.220823 [debug] [Thread-1 (]: Finished running node model.practice.tpc_lineage
[0m16:56:30.220823 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m16:56:30.220823 [info ] [Thread-1 (]: 2 of 4 START sql view model public.tpch_orders ................................. [RUN]
[0m16:56:30.220823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpc_lineage, now model.practice.tpch_orders)
[0m16:56:30.220823 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m16:56:30.236301 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m16:56:30.237446 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 16:56:30.220823 => 16:56:30.237446
[0m16:56:30.238112 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m16:56:30.241217 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m16:56:30.241217 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m16:56:30.241217 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m16:56:30.246325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:30.690337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:56:30.690337 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 16:56:30.238112 => 16:56:30.690337
[0m16:56:30.690337 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m16:56:30.784257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516D0B0D0>]}
[0m16:56:30.784257 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.56s]
[0m16:56:30.784257 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m16:56:30.799729 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m16:56:30.799729 [info ] [Thread-1 (]: 3 of 4 START sql table model public.samp ....................................... [RUN]
[0m16:56:30.799729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m16:56:30.799729 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m16:56:30.808207 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m16:56:30.813040 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 16:56:30.805740 => 16:56:30.813040
[0m16:56:30.813040 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m16:56:30.831801 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m16:56:30.831801 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m16:56:30.831801 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace transient table snowflake_prac.public.samp
         as
        (

select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
        );
[0m16:56:30.831801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:32.861652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:56:32.861652 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 16:56:30.814205 => 16:56:32.861652
[0m16:56:32.861652 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m16:56:32.955400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516AF6D70>]}
[0m16:56:32.955400 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.samp .................................. [[32mSUCCESS 1[0m in 2.16s]
[0m16:56:32.971985 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m16:56:32.971985 [debug] [Thread-1 (]: Began running node model.practice.order_lin
[0m16:56:32.971985 [info ] [Thread-1 (]: 4 of 4 START sql view model public.order_lin ................................... [RUN]
[0m16:56:32.971985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.samp, now model.practice.order_lin)
[0m16:56:32.977700 [debug] [Thread-1 (]: Began compiling node model.practice.order_lin
[0m16:56:32.982473 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.order_lin"
[0m16:56:32.982473 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (compile): 16:56:32.978532 => 16:56:32.982473
[0m16:56:32.982473 [debug] [Thread-1 (]: Began executing node model.practice.order_lin
[0m16:56:32.982473 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.order_lin"
[0m16:56:32.982473 [debug] [Thread-1 (]: Using snowflake connection "model.practice.order_lin"
[0m16:56:32.982473 [debug] [Thread-1 (]: On model.practice.order_lin: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.order_lin"} */
create or replace   view snowflake_prac.public.order_lin
  
   as (
    select *
from
snowflake_prac.public.samp as orders
join 
snowflake_prac.public.tpc_lineage as tpc_lineage
on orders.orderkey=tpc_lineage.L_ORDERKEY
  );
[0m16:56:32.982473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:33.583220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:33.583220 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (execute): 16:56:32.982473 => 16:56:33.583220
[0m16:56:33.583220 [debug] [Thread-1 (]: On model.practice.order_lin: Close
[0m16:56:34.299386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '519ada5b-54dd-45bc-8b6d-2cfbd20a7963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516AF7A30>]}
[0m16:56:34.299386 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.order_lin .............................. [[32mSUCCESS 1[0m in 1.33s]
[0m16:56:34.314873 [debug] [Thread-1 (]: Finished running node model.practice.order_lin
[0m16:56:34.314873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:34.314873 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m16:56:34.314873 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m16:56:34.314873 [debug] [MainThread]: Connection 'model.practice.order_lin' was properly closed.
[0m16:56:34.314873 [info ] [MainThread]: 
[0m16:56:34.314873 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m16:56:34.325687 [debug] [MainThread]: Command end result
[0m16:56:34.338189 [info ] [MainThread]: 
[0m16:56:34.338189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:34.338189 [info ] [MainThread]: 
[0m16:56:34.340242 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:56:34.340242 [debug] [MainThread]: Command `dbt run` succeeded at 16:56:34.340242 after 6.77 seconds
[0m16:56:34.340242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026503F475E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651692C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026516C3FEE0>]}
[0m16:56:34.340242 [debug] [MainThread]: Flushing usage events
[0m16:56:51.827414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A92BE7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A92452F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A924531C0>]}


============================== 16:56:51.827414 | 7b596a3c-56ce-49b6-83ac-72fcd9480dc0 ==============================
[0m16:56:51.827414 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:56:51.827414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:56:52.396339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9241BE20>]}
[0m16:56:52.480253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA53E5C00>]}
[0m16:56:52.480253 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:56:52.496165 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:56:52.565065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:52.565065 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\order_lin.sql
[0m16:56:52.707296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m16:56:52.714023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA5755A20>]}
[0m16:56:52.721012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA55D01F0>]}
[0m16:56:52.721012 [info ] [MainThread]: Found 4 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:56:52.721012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA55D00D0>]}
[0m16:56:52.729210 [info ] [MainThread]: 
[0m16:56:52.729210 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:52.729210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m16:56:52.741129 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m16:56:52.741129 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m16:56:52.741129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:53.206058 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m16:56:53.206058 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m16:56:53.299631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m16:56:53.309141 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m16:56:53.309141 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m16:56:53.309141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:53.580359 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:56:53.596065 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m16:56:53.680622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA5955120>]}
[0m16:56:53.680622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:53.680622 [info ] [MainThread]: 
[0m16:56:53.690144 [debug] [Thread-1 (]: Began running node model.practice.tpc_lineage
[0m16:56:53.690144 [info ] [Thread-1 (]: 1 of 4 START sql view model public.tpc_lineage ................................. [RUN]
[0m16:56:53.690144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpc_lineage'
[0m16:56:53.690144 [debug] [Thread-1 (]: Began compiling node model.practice.tpc_lineage
[0m16:56:53.698381 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpc_lineage"
[0m16:56:53.706394 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (compile): 16:56:53.690144 => 16:56:53.698381
[0m16:56:53.706394 [debug] [Thread-1 (]: Began executing node model.practice.tpc_lineage
[0m16:56:53.729201 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpc_lineage"
[0m16:56:53.735561 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpc_lineage"
[0m16:56:53.735561 [debug] [Thread-1 (]: On model.practice.tpc_lineage: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpc_lineage"} */
create or replace   view snowflake_prac.public.tpc_lineage
  
   as (
    select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
  );
[0m16:56:53.735561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:54.248051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:54.263075 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (execute): 16:56:53.706394 => 16:56:54.263075
[0m16:56:54.263075 [debug] [Thread-1 (]: On model.practice.tpc_lineage: Close
[0m16:56:54.349401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA59AFF70>]}
[0m16:56:54.349401 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.tpc_lineage ............................ [[32mSUCCESS 1[0m in 0.66s]
[0m16:56:54.349401 [debug] [Thread-1 (]: Finished running node model.practice.tpc_lineage
[0m16:56:54.349401 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m16:56:54.349401 [info ] [Thread-1 (]: 2 of 4 START sql view model public.tpch_orders ................................. [RUN]
[0m16:56:54.358436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpc_lineage, now model.practice.tpch_orders)
[0m16:56:54.358436 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m16:56:54.362450 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m16:56:54.362938 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 16:56:54.358436 => 16:56:54.362938
[0m16:56:54.362938 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m16:56:54.362938 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m16:56:54.362938 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m16:56:54.362938 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m16:56:54.362938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:55.447567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:55.447567 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 16:56:54.362938 => 16:56:55.447567
[0m16:56:55.447567 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m16:56:55.529812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA59AEBC0>]}
[0m16:56:55.529812 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 1.18s]
[0m16:56:55.529812 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m16:56:55.529812 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m16:56:55.529812 [info ] [Thread-1 (]: 3 of 4 START sql table model public.samp ....................................... [RUN]
[0m16:56:55.542820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m16:56:55.542820 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m16:56:55.546080 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m16:56:55.546080 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 16:56:55.542820 => 16:56:55.546080
[0m16:56:55.546080 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m16:56:55.567520 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m16:56:55.567520 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m16:56:55.567520 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace transient table snowflake_prac.public.samp
         as
        (

select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price
from 
snowflake_prac.public.tpch_orders as orders
        );
[0m16:56:55.567520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:57.704858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:56:57.712639 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 16:56:55.546080 => 16:56:57.704858
[0m16:56:57.713413 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m16:56:57.795536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA57975B0>]}
[0m16:56:57.799854 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.samp .................................. [[32mSUCCESS 1[0m in 2.25s]
[0m16:56:57.799854 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m16:56:57.804029 [debug] [Thread-1 (]: Began running node model.practice.order_lin
[0m16:56:57.804029 [info ] [Thread-1 (]: 4 of 4 START sql table model public.order_lin .................................. [RUN]
[0m16:56:57.804029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.samp, now model.practice.order_lin)
[0m16:56:57.808325 [debug] [Thread-1 (]: Began compiling node model.practice.order_lin
[0m16:56:57.813107 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.order_lin"
[0m16:56:57.817197 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (compile): 16:56:57.808325 => 16:56:57.816224
[0m16:56:57.818257 [debug] [Thread-1 (]: Began executing node model.practice.order_lin
[0m16:56:57.822509 [debug] [Thread-1 (]: Dropping relation "SNOWFLAKE_PRAC"."PUBLIC"."ORDER_LIN" because it is of type view
[0m16:56:57.836520 [debug] [Thread-1 (]: Applying DROP to: "SNOWFLAKE_PRAC"."PUBLIC"."ORDER_LIN"
[0m16:56:57.836520 [debug] [Thread-1 (]: Using snowflake connection "model.practice.order_lin"
[0m16:56:57.844661 [debug] [Thread-1 (]: On model.practice.order_lin: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.order_lin"} */
drop view if exists "SNOWFLAKE_PRAC"."PUBLIC"."ORDER_LIN" cascade
[0m16:56:57.844661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:58.246169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:56:58.247132 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.order_lin"
[0m16:56:58.247132 [debug] [Thread-1 (]: Using snowflake connection "model.practice.order_lin"
[0m16:56:58.253690 [debug] [Thread-1 (]: On model.practice.order_lin: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.order_lin"} */
create or replace transient table snowflake_prac.public.order_lin
         as
        (

select *
from
snowflake_prac.public.samp as orders
join 
snowflake_prac.public.tpc_lineage as tpc_lineage
on orders.orderkey=tpc_lineage.L_ORDERKEY
        );
[0m16:57:03.647332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m16:57:03.665102 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (execute): 16:56:57.818257 => 16:57:03.662639
[0m16:57:03.665102 [debug] [Thread-1 (]: On model.practice.order_lin: Close
[0m16:57:03.762913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b596a3c-56ce-49b6-83ac-72fcd9480dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA5797A60>]}
[0m16:57:03.762913 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.order_lin ............................. [[32mSUCCESS 1[0m in 5.96s]
[0m16:57:03.762913 [debug] [Thread-1 (]: Finished running node model.practice.order_lin
[0m16:57:03.773447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:03.773447 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m16:57:03.779081 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m16:57:03.780982 [debug] [MainThread]: Connection 'model.practice.order_lin' was properly closed.
[0m16:57:03.783108 [info ] [MainThread]: 
[0m16:57:03.783108 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m16:57:03.789197 [debug] [MainThread]: Command end result
[0m16:57:03.817454 [info ] [MainThread]: 
[0m16:57:03.823538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:03.823538 [info ] [MainThread]: 
[0m16:57:03.823538 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:57:03.829679 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:03.829679 after 12.07 seconds
[0m16:57:03.829679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A92BE7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA55D0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AA5A33FA0>]}
[0m16:57:03.829679 [debug] [MainThread]: Flushing usage events
[0m16:58:00.019595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2A245C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC29AB2EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC29AB2A10>]}


============================== 16:58:00.019595 | a14849ab-b424-4c50-a9b0-6054b67a588d ==============================
[0m16:58:00.019595 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:58:00.019595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m16:58:00.573645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14849ab-b424-4c50-a9b0-6054b67a588d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2A931870>]}
[0m16:58:00.660724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14849ab-b424-4c50-a9b0-6054b67a588d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3B9BCFA0>]}
[0m16:58:00.660724 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:58:00.668734 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:58:00.749286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:00.749286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:00.749286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:58:00.757396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14849ab-b424-4c50-a9b0-6054b67a588d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3CC6E020>]}
[0m16:58:00.757396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14849ab-b424-4c50-a9b0-6054b67a588d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3CC27550>]}
[0m16:58:00.765369 [info ] [MainThread]: Found 4 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m16:58:00.766124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14849ab-b424-4c50-a9b0-6054b67a588d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3CC27D00>]}
[0m16:58:00.767071 [info ] [MainThread]: 
[0m16:58:00.770638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:00.770638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m16:58:00.782327 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m16:58:00.782327 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m16:58:00.782327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:01.289452 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:58:01.305034 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m16:58:01.398788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14849ab-b424-4c50-a9b0-6054b67a588d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3CC60820>]}
[0m16:58:01.398788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:01.398788 [info ] [MainThread]: 
[0m16:58:01.398788 [debug] [Thread-1 (]: Began running node model.practice.tpc_lineage
[0m16:58:01.398788 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpc_lineage'
[0m16:58:01.398788 [debug] [Thread-1 (]: Began compiling node model.practice.tpc_lineage
[0m16:58:01.419073 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpc_lineage"
[0m16:58:01.419073 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (compile): 16:58:01.398788 => 16:58:01.419073
[0m16:58:01.419073 [debug] [Thread-1 (]: Began executing node model.practice.tpc_lineage
[0m16:58:01.419073 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (execute): 16:58:01.419073 => 16:58:01.419073
[0m16:58:01.419073 [debug] [Thread-1 (]: Finished running node model.practice.tpc_lineage
[0m16:58:01.419073 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m16:58:01.419073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpc_lineage, now model.practice.tpch_orders)
[0m16:58:01.427595 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m16:58:01.429457 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m16:58:01.429457 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 16:58:01.427595 => 16:58:01.429457
[0m16:58:01.429457 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m16:58:01.429457 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 16:58:01.429457 => 16:58:01.429457
[0m16:58:01.429457 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m16:58:01.429457 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:58:01.429457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba)
[0m16:58:01.429457 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:58:01.444583 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba"
[0m16:58:01.448185 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba (compile): 16:58:01.429457 => 16:58:01.448185
[0m16:58:01.448185 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:58:01.448185 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba (execute): 16:58:01.448185 => 16:58:01.448185
[0m16:58:01.448185 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m16:58:01.448185 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:58:01.448185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba, now test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99)
[0m16:58:01.448185 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:58:01.448185 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m16:58:01.448185 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (compile): 16:58:01.448185 => 16:58:01.448185
[0m16:58:01.448185 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:58:01.448185 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (execute): 16:58:01.448185 => 16:58:01.448185
[0m16:58:01.448185 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m16:58:01.459781 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:58:01.459781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99, now test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88)
[0m16:58:01.460667 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:58:01.462259 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88"
[0m16:58:01.462259 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88 (compile): 16:58:01.460667 => 16:58:01.462259
[0m16:58:01.462259 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:58:01.462259 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88 (execute): 16:58:01.462259 => 16:58:01.462259
[0m16:58:01.462259 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m16:58:01.462259 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:58:01.462259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88, now test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22)
[0m16:58:01.462259 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:58:01.475763 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m16:58:01.478576 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (compile): 16:58:01.462259 => 16:58:01.478576
[0m16:58:01.479326 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:58:01.479326 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (execute): 16:58:01.479326 => 16:58:01.479326
[0m16:58:01.479326 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m16:58:01.479326 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m16:58:01.479326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22, now model.practice.samp)
[0m16:58:01.479326 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m16:58:01.483835 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m16:58:01.483835 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 16:58:01.479326 => 16:58:01.483835
[0m16:58:01.483835 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m16:58:01.483835 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 16:58:01.483835 => 16:58:01.483835
[0m16:58:01.483835 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m16:58:01.483835 [debug] [Thread-1 (]: Began running node model.practice.order_lin
[0m16:58:01.483835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.samp, now model.practice.order_lin)
[0m16:58:01.483835 [debug] [Thread-1 (]: Began compiling node model.practice.order_lin
[0m16:58:01.491845 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.order_lin"
[0m16:58:01.491845 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (compile): 16:58:01.483835 => 16:58:01.491845
[0m16:58:01.491845 [debug] [Thread-1 (]: Began executing node model.practice.order_lin
[0m16:58:01.491845 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (execute): 16:58:01.491845 => 16:58:01.491845
[0m16:58:01.494184 [debug] [Thread-1 (]: Finished running node model.practice.order_lin
[0m16:58:01.494184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:01.494184 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m16:58:01.494184 [debug] [MainThread]: Connection 'model.practice.order_lin' was properly closed.
[0m16:58:01.494184 [debug] [MainThread]: Command end result
[0m16:58:01.881048 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m16:58:01.881048 [info ] [MainThread]: Building catalog
[0m16:58:01.881048 [debug] [ThreadPool]: Acquiring new snowflake connection 'snowflake_prac.information_schema'
[0m16:58:01.896246 [debug] [ThreadPool]: Using snowflake connection "snowflake_prac.information_schema"
[0m16:58:01.896246 [debug] [ThreadPool]: On snowflake_prac.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "snowflake_prac.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from snowflake_prac.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpc_lineage')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpch_orders')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('samp')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('order_lin')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from snowflake_prac.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpc_lineage')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpch_orders')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('samp')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('order_lin')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m16:58:01.896246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:04.315420 [debug] [ThreadPool]: SQL status: SUCCESS 49 in 2.0 seconds
[0m16:58:04.347300 [debug] [ThreadPool]: On snowflake_prac.information_schema: Close
[0m16:58:04.434549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly snowflake_prac.information_schema, now SNOWFLAKE_SAMPLE_DATA.information_schema)
[0m16:58:04.434549 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema"
[0m16:58:04.434549 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "SNOWFLAKE_SAMPLE_DATA.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('ORDERS')
                )
             or 
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('LINEITEM')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('ORDERS')
                )
             or 
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('LINEITEM')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m16:58:04.434549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:07.314347 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 3.0 seconds
[0m16:58:07.330651 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: Close
[0m16:58:07.440935 [info ] [MainThread]: Catalog written to D:\PROJECT\dbt\practice\target\catalog.json
[0m16:58:07.442306 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:58:07.442306 after 7.49 seconds
[0m16:58:07.442306 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:58:07.442306 [debug] [MainThread]: Connection 'SNOWFLAKE_SAMPLE_DATA.information_schema' was properly closed.
[0m16:58:07.442306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2A245C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC29A7BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC3CC342B0>]}
[0m16:58:07.442306 [debug] [MainThread]: Flushing usage events
[0m16:58:17.520202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7BB75C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7B3D3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7B3D16F0>]}


============================== 16:58:17.520202 | 8cffa038-fdea-47ed-9ae9-63c4fdb2ad36 ==============================
[0m16:58:17.520202 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:58:17.520202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:17.999626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cffa038-fdea-47ed-9ae9-63c4fdb2ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7E04F730>]}
[0m16:58:18.077751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cffa038-fdea-47ed-9ae9-63c4fdb2ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7F1C71C0>]}
[0m20:44:34.284033 [error] [MainThread]: Encountered an error:

[0m20:44:34.428679 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m20:44:34.440876 [debug] [MainThread]: Command `dbt docs serve` failed at 20:44:34.440876 after 13576.98 seconds
[0m20:44:34.440876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7BB75C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7B39BCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC7F3A5000>]}
[0m20:44:34.446232 [debug] [MainThread]: Flushing usage events
[0m23:23:33.487371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027797F96920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027797802F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027797802830>]}


============================== 23:23:33.492397 | 8d8a75bd-e65a-43f9-a680-ab5be52b338d ==============================
[0m23:23:33.492397 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:23:33.492397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:23:34.043220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277977CBCA0>]}
[0m23:23:34.112588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AA796170>]}
[0m23:23:34.117097 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:23:34.124989 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:23:34.204153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:23:34.205162 [debug] [MainThread]: Partial parsing: added file: practice://macros\pricing.sql
[0m23:23:34.205162 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\samp.sql
[0m23:23:34.312564 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:23:34.317140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AAB0CF10>]}
[0m23:23:34.327585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AA980400>]}
[0m23:23:34.327585 [info ] [MainThread]: Found 4 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m23:23:34.327585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AA9802E0>]}
[0m23:23:34.327585 [info ] [MainThread]: 
[0m23:23:34.337111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:23:34.337111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m23:23:34.347404 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m23:23:34.352005 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m23:23:34.352005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:35.087662 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m23:23:35.096936 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m23:23:35.192281 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m23:23:35.202396 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m23:23:35.202396 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m23:23:35.207427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:35.576172 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:23:35.576172 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m23:23:35.669793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AAD08280>]}
[0m23:23:35.669793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:35.669793 [info ] [MainThread]: 
[0m23:23:35.689046 [debug] [Thread-1 (]: Began running node model.practice.tpc_lineage
[0m23:23:35.690143 [info ] [Thread-1 (]: 1 of 4 START sql view model public.tpc_lineage ................................. [RUN]
[0m23:23:35.692618 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpc_lineage'
[0m23:23:35.693677 [debug] [Thread-1 (]: Began compiling node model.practice.tpc_lineage
[0m23:23:35.698209 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpc_lineage"
[0m23:23:35.698209 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (compile): 23:23:35.693677 => 23:23:35.698209
[0m23:23:35.698209 [debug] [Thread-1 (]: Began executing node model.practice.tpc_lineage
[0m23:23:35.714822 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpc_lineage"
[0m23:23:35.727969 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpc_lineage"
[0m23:23:35.728822 [debug] [Thread-1 (]: On model.practice.tpc_lineage: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpc_lineage"} */
create or replace   view snowflake_prac.public.tpc_lineage
  
   as (
    select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
  );
[0m23:23:35.728822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:23:36.436973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:23:36.455629 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (execute): 23:23:35.698209 => 23:23:36.455629
[0m23:23:36.455629 [debug] [Thread-1 (]: On model.practice.tpc_lineage: Close
[0m23:23:36.546943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AAD54730>]}
[0m23:23:36.546943 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.tpc_lineage ............................ [[32mSUCCESS 1[0m in 0.86s]
[0m23:23:36.546943 [debug] [Thread-1 (]: Finished running node model.practice.tpc_lineage
[0m23:23:36.546943 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m23:23:36.546943 [info ] [Thread-1 (]: 2 of 4 START sql view model public.tpch_orders ................................. [RUN]
[0m23:23:36.555965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpc_lineage, now model.practice.tpch_orders)
[0m23:23:36.555965 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m23:23:36.555965 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m23:23:36.563069 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 23:23:36.555965 => 23:23:36.563069
[0m23:23:36.563069 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m23:23:36.567121 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.tpch_orders"
[0m23:23:36.568263 [debug] [Thread-1 (]: Using snowflake connection "model.practice.tpch_orders"
[0m23:23:36.569408 [debug] [Thread-1 (]: On model.practice.tpch_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.tpch_orders"} */
create or replace   view snowflake_prac.public.tpch_orders
  
   as (
    select 
*
from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS
  );
[0m23:23:36.569408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:37.017037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:23:37.017037 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 23:23:36.563069 => 23:23:37.017037
[0m23:23:37.017037 [debug] [Thread-1 (]: On model.practice.tpch_orders: Close
[0m23:23:37.111073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AADC12D0>]}
[0m23:23:37.111073 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.tpch_orders ............................ [[32mSUCCESS 1[0m in 0.56s]
[0m23:23:37.111073 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m23:23:37.111073 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m23:23:37.111073 [info ] [Thread-1 (]: 3 of 4 START sql table model public.samp ....................................... [RUN]
[0m23:23:37.111073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now model.practice.samp)
[0m23:23:37.111073 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m23:23:37.129473 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m23:23:37.129473 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 23:23:37.111073 => 23:23:37.129473
[0m23:23:37.129473 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m23:23:37.145089 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.samp"
[0m23:23:37.145089 [debug] [Thread-1 (]: Using snowflake connection "model.practice.samp"
[0m23:23:37.145089 [debug] [Thread-1 (]: On model.practice.samp: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.samp"} */
create or replace transient table snowflake_prac.public.samp
         as
        (

select 
o_comment as comments,
o_orderkey as orderkey,
o_orderdate as orderdate,
o_totalprice as total_price,
  
    (total_price / 100)::numeric(16, 2)
 as amount_usd
from 
snowflake_prac.public.tpch_orders as orders
        );
[0m23:23:37.145089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:41.861500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m23:23:41.861500 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 23:23:37.129473 => 23:23:41.861500
[0m23:23:41.861500 [debug] [Thread-1 (]: On model.practice.samp: Close
[0m23:23:41.939680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AADC0C70>]}
[0m23:23:41.939680 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.samp .................................. [[32mSUCCESS 1[0m in 4.83s]
[0m23:23:41.955196 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m23:23:41.955196 [debug] [Thread-1 (]: Began running node model.practice.order_lin
[0m23:23:41.955196 [info ] [Thread-1 (]: 4 of 4 START sql table model public.order_lin .................................. [RUN]
[0m23:23:41.955196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.samp, now model.practice.order_lin)
[0m23:23:41.955196 [debug] [Thread-1 (]: Began compiling node model.practice.order_lin
[0m23:23:41.955196 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.order_lin"
[0m23:23:41.955196 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (compile): 23:23:41.955196 => 23:23:41.955196
[0m23:23:41.955196 [debug] [Thread-1 (]: Began executing node model.practice.order_lin
[0m23:23:41.973287 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.order_lin"
[0m23:23:41.974217 [debug] [Thread-1 (]: Using snowflake connection "model.practice.order_lin"
[0m23:23:41.974217 [debug] [Thread-1 (]: On model.practice.order_lin: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.order_lin"} */
create or replace transient table snowflake_prac.public.order_lin
         as
        (

select *
from
snowflake_prac.public.samp as orders
join 
snowflake_prac.public.tpc_lineage as tpc_lineage
on orders.orderkey=tpc_lineage.L_ORDERKEY
        );
[0m23:23:41.974217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:47.648420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m23:23:47.648420 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (execute): 23:23:41.955196 => 23:23:47.648420
[0m23:23:47.648420 [debug] [Thread-1 (]: On model.practice.order_lin: Close
[0m23:23:47.742170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8a75bd-e65a-43f9-a680-ab5be52b338d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AAE32410>]}
[0m23:23:47.742170 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.order_lin ............................. [[32mSUCCESS 1[0m in 5.79s]
[0m23:23:47.742170 [debug] [Thread-1 (]: Finished running node model.practice.order_lin
[0m23:23:47.742170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:47.742170 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m23:23:47.742170 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m23:23:47.742170 [debug] [MainThread]: Connection 'model.practice.order_lin' was properly closed.
[0m23:23:47.742170 [info ] [MainThread]: 
[0m23:23:47.757639 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 13.41 seconds (13.41s).
[0m23:23:47.759967 [debug] [MainThread]: Command end result
[0m23:23:47.771978 [info ] [MainThread]: 
[0m23:23:47.772926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:47.774881 [info ] [MainThread]: 
[0m23:23:47.774881 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:23:47.777020 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:47.777020 after 14.35 seconds
[0m23:23:47.777020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027797F96920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AA980430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AADA6C80>]}
[0m23:23:47.777020 [debug] [MainThread]: Flushing usage events
[0m23:30:23.984539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF2EA7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF2712F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF2713220>]}


============================== 23:30:23.984539 | 15ebce35-5685-4b96-84d1-d511c7aeac1f ==============================
[0m23:30:23.984539 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:30:23.991568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:30:24.527898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15ebce35-5685-4b96-84d1-d511c7aeac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF26DBE20>]}
[0m23:30:24.601607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15ebce35-5685-4b96-84d1-d511c7aeac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A84572B60>]}
[0m23:30:24.601607 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:30:24.611957 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:30:24.683765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:30:24.683765 [debug] [MainThread]: Partial parsing: added file: practice://seeds\sample.csv
[0m23:30:24.766753 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:30:24.776882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15ebce35-5685-4b96-84d1-d511c7aeac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85A62650>]}
[0m23:30:24.786771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15ebce35-5685-4b96-84d1-d511c7aeac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A859071C0>]}
[0m23:30:24.786771 [info ] [MainThread]: Found 4 models, 4 tests, 1 seed, 2 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m23:30:24.786771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ebce35-5685-4b96-84d1-d511c7aeac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85907F10>]}
[0m23:30:24.791886 [info ] [MainThread]: 
[0m23:30:24.791886 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:30:24.791886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m23:30:24.806533 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m23:30:24.806533 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m23:30:24.806533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:25.414347 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m23:30:25.414347 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m23:30:25.508406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m23:30:25.523895 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m23:30:25.523895 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m23:30:25.523895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:25.821610 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:30:25.821610 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m23:30:25.910299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15ebce35-5685-4b96-84d1-d511c7aeac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85C3C8B0>]}
[0m23:30:25.912513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:30:25.912513 [info ] [MainThread]: 
[0m23:30:25.915228 [debug] [Thread-1 (]: Began running node seed.practice.sample
[0m23:30:25.915228 [info ] [Thread-1 (]: 1 of 1 START seed file public.sample ........................................... [RUN]
[0m23:30:25.915228 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.practice.sample'
[0m23:30:25.921008 [debug] [Thread-1 (]: Began compiling node seed.practice.sample
[0m23:30:25.921733 [debug] [Thread-1 (]: Timing info for seed.practice.sample (compile): 23:30:25.921733 => 23:30:25.921733
[0m23:30:25.922761 [debug] [Thread-1 (]: Began executing node seed.practice.sample
[0m23:30:25.949342 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:30:25.949342 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
create table snowflake_prac.public.sample (name text,city text,state text)
[0m23:30:25.949342 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:30:26.373556 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae5b8-0001-4231-0000-0008435eac0d
[0m23:30:26.373556 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 34 unexpected '.'.
[0m23:30:26.373556 [debug] [Thread-1 (]: Timing info for seed.practice.sample (execute): 23:30:25.922761 => 23:30:26.373556
[0m23:30:26.373556 [debug] [Thread-1 (]: On seed.practice.sample: Close
[0m23:30:26.481298 [debug] [Thread-1 (]: Database Error in seed sample (seeds\sample.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 34 unexpected '.'.
[0m23:30:26.481298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15ebce35-5685-4b96-84d1-d511c7aeac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85CA3D30>]}
[0m23:30:26.482400 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.sample ................................... [[31mERROR[0m in 0.57s]
[0m23:30:26.483305 [debug] [Thread-1 (]: Finished running node seed.practice.sample
[0m23:30:26.486029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:26.486029 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m23:30:26.487140 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m23:30:26.487140 [debug] [MainThread]: Connection 'seed.practice.sample' was properly closed.
[0m23:30:26.487140 [info ] [MainThread]: 
[0m23:30:26.488128 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m23:30:26.490091 [debug] [MainThread]: Command end result
[0m23:30:26.503193 [info ] [MainThread]: 
[0m23:30:26.504383 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:30:26.504383 [info ] [MainThread]: 
[0m23:30:26.504383 [error] [MainThread]:   Database Error in seed sample (seeds\sample.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 34 unexpected '.'.
[0m23:30:26.504383 [info ] [MainThread]: 
[0m23:30:26.504383 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:30:26.504383 [debug] [MainThread]: Command `dbt seed` failed at 23:30:26.504383 after 2.58 seconds
[0m23:30:26.504383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AF2EA7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85AA7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85AA7280>]}
[0m23:30:26.504383 [debug] [MainThread]: Flushing usage events
[0m23:35:45.863073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F84E575E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F846C2EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F846C0AC0>]}


============================== 23:35:45.863073 | 264f7721-622b-4e56-856d-1fde8451b7f0 ==============================
[0m23:35:45.863073 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:35:45.863073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m23:35:46.396187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '264f7721-622b-4e56-856d-1fde8451b7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F8468BB20>]}
[0m23:35:46.458653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '264f7721-622b-4e56-856d-1fde8451b7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F865E06A0>]}
[0m23:35:46.458653 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:35:46.474193 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:35:46.539776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:46.539776 [debug] [MainThread]: Partial parsing: updated file: practice://seeds\sample.csv
[0m23:35:46.636401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:35:46.636401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '264f7721-622b-4e56-856d-1fde8451b7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F979A66B0>]}
[0m23:35:46.656187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '264f7721-622b-4e56-856d-1fde8451b7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F9659AD40>]}
[0m23:35:46.656187 [info ] [MainThread]: Found 4 models, 4 tests, 1 seed, 2 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m23:35:46.657700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '264f7721-622b-4e56-856d-1fde8451b7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F978480A0>]}
[0m23:35:46.657700 [info ] [MainThread]: 
[0m23:35:46.657700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:35:46.657700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m23:35:46.672474 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m23:35:46.672474 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m23:35:46.672474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:47.180461 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m23:35:47.196038 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m23:35:47.274161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m23:35:47.289808 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m23:35:47.289808 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m23:35:47.289808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:47.566203 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:35:47.574249 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m23:35:47.650967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '264f7721-622b-4e56-856d-1fde8451b7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F97B20910>]}
[0m23:35:47.666545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:47.666545 [info ] [MainThread]: 
[0m23:35:47.666545 [debug] [Thread-1 (]: Began running node seed.practice.sample
[0m23:35:47.666545 [info ] [Thread-1 (]: 1 of 1 START seed file public.sample ........................................... [RUN]
[0m23:35:47.666545 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.practice.sample'
[0m23:35:47.678150 [debug] [Thread-1 (]: Began compiling node seed.practice.sample
[0m23:35:47.678150 [debug] [Thread-1 (]: Timing info for seed.practice.sample (compile): 23:35:47.678150 => 23:35:47.678150
[0m23:35:47.679054 [debug] [Thread-1 (]: Began executing node seed.practice.sample
[0m23:35:47.707222 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:35:47.708219 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
create table snowflake_prac.public.sample (id integer,name text,age integer)
[0m23:35:47.708219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:35:47.976514 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae5bd-0001-422a-0000-0008435ec41d
[0m23:35:47.976514 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 34 unexpected '.'.
[0m23:35:47.976514 [debug] [Thread-1 (]: Timing info for seed.practice.sample (execute): 23:35:47.679054 => 23:35:47.976514
[0m23:35:47.976514 [debug] [Thread-1 (]: On seed.practice.sample: Close
[0m23:35:48.055321 [debug] [Thread-1 (]: Database Error in seed sample (seeds\sample.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 34 unexpected '.'.
[0m23:35:48.055321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264f7721-622b-4e56-856d-1fde8451b7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F97BC44F0>]}
[0m23:35:48.055321 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.sample ................................... [[31mERROR[0m in 0.39s]
[0m23:35:48.070963 [debug] [Thread-1 (]: Finished running node seed.practice.sample
[0m23:35:48.070963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:48.070963 [debug] [MainThread]: Connection 'list_snowflake_prac' was properly closed.
[0m23:35:48.070963 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m23:35:48.070963 [debug] [MainThread]: Connection 'seed.practice.sample' was properly closed.
[0m23:35:48.070963 [info ] [MainThread]: 
[0m23:35:48.070963 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m23:35:48.078655 [debug] [MainThread]: Command end result
[0m23:35:48.089535 [info ] [MainThread]: 
[0m23:35:48.090583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:35:48.091532 [info ] [MainThread]: 
[0m23:35:48.092566 [error] [MainThread]:   Database Error in seed sample (seeds\sample.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 34 unexpected '.'.
[0m23:35:48.093826 [info ] [MainThread]: 
[0m23:35:48.093826 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:35:48.093826 [debug] [MainThread]: Command `dbt seed` failed at 23:35:48.093826 after 2.28 seconds
[0m23:35:48.093826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F84E575E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F97BEB370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F97BEBC10>]}
[0m23:35:48.093826 [debug] [MainThread]: Flushing usage events
[0m23:40:34.683976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151F6DC75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151F6632EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151F6630AC0>]}


============================== 23:40:34.683976 | 1e08fd6e-af3a-4a10-b47f-372fa3adfbba ==============================
[0m23:40:34.683976 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:40:34.683976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:40:35.163088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e08fd6e-af3a-4a10-b47f-372fa3adfbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151F65FBB20>]}
[0m23:40:35.237204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e08fd6e-af3a-4a10-b47f-372fa3adfbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151F85506A0>]}
[0m23:40:35.237204 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:40:35.252930 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:40:35.343245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:40:35.343245 [debug] [MainThread]: Partial parsing: added file: practice://seeds\seeds.yml
[0m23:40:35.414643 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:40:35.415652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e08fd6e-af3a-4a10-b47f-372fa3adfbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189952800>]}
[0m23:40:35.415652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e08fd6e-af3a-4a10-b47f-372fa3adfbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189805F30>]}
[0m23:40:35.431171 [info ] [MainThread]: Found 4 models, 4 tests, 1 seed, 2 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m23:40:35.431638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e08fd6e-af3a-4a10-b47f-372fa3adfbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189807F10>]}
[0m23:40:35.432368 [info ] [MainThread]: 
[0m23:40:35.434820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:40:35.434820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac'
[0m23:40:35.448080 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac"
[0m23:40:35.448080 [debug] [ThreadPool]: On list_snowflake_prac: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac"} */
show terse schemas in database snowflake_prac
    limit 10000
[0m23:40:35.448080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:35.961270 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m23:40:35.976767 [debug] [ThreadPool]: On list_snowflake_prac: Close
[0m23:40:36.061795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_snowflake_prac, now create_snowflake_prac_public_public)
[0m23:40:36.077440 [debug] [ThreadPool]: Creating schema "database: "snowflake_prac"
schema: "public_public"
"
[0m23:40:36.077440 [debug] [ThreadPool]: Using snowflake connection "create_snowflake_prac_public_public"
[0m23:40:36.077440 [debug] [ThreadPool]: On create_snowflake_prac_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "create_snowflake_prac_public_public"} */
create schema if not exists snowflake_prac.public_public
[0m23:40:36.077440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:36.403435 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:40:36.403435 [debug] [ThreadPool]: On create_snowflake_prac_public_public: Close
[0m23:40:36.497078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public_public'
[0m23:40:36.512711 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public_public"
[0m23:40:36.512711 [debug] [ThreadPool]: On list_snowflake_prac_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public_public"} */
show terse objects in snowflake_prac.public_public limit 10000
[0m23:40:36.512711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:36.951910 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:40:36.951910 [debug] [ThreadPool]: On list_snowflake_prac_public_public: Close
[0m23:40:37.051095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_snowflake_prac_public_public, now list_snowflake_prac_public)
[0m23:40:37.051095 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m23:40:37.051095 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m23:40:37.051095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:37.328036 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:40:37.343620 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m23:40:37.421804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e08fd6e-af3a-4a10-b47f-372fa3adfbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189807280>]}
[0m23:40:37.438257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:37.438257 [info ] [MainThread]: 
[0m23:40:37.438257 [debug] [Thread-1 (]: Began running node seed.practice.sample
[0m23:40:37.438257 [info ] [Thread-1 (]: 1 of 1 START seed file public_public.sample_data ............................... [RUN]
[0m23:40:37.446790 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.practice.sample'
[0m23:40:37.446790 [debug] [Thread-1 (]: Began compiling node seed.practice.sample
[0m23:40:37.447715 [debug] [Thread-1 (]: Timing info for seed.practice.sample (compile): 23:40:37.447715 => 23:40:37.447715
[0m23:40:37.447715 [debug] [Thread-1 (]: Began executing node seed.practice.sample
[0m23:40:37.483302 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:40:37.483302 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
create table snowflake_prac.public_public.sample_data (id integer,name text,age integer)
[0m23:40:37.483302 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:37.845044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:40:37.876243 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:40:37.876243 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
BEGIN
[0m23:40:37.970039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:40:37.970039 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:40:37.970039 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
insert into snowflake_prac.public_public.sample_data (id, name, age) values
            (%s,%s,%s),(%s,%s,%s)...
[0m23:40:39.051307 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.0 seconds
[0m23:40:39.051307 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:40:39.051307 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
COMMIT
[0m23:40:39.273211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:40:39.273211 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.practice.sample"
[0m23:40:39.288838 [debug] [Thread-1 (]: Timing info for seed.practice.sample (execute): 23:40:37.447715 => 23:40:39.288838
[0m23:40:39.288838 [debug] [Thread-1 (]: On seed.practice.sample: Close
[0m23:40:39.389101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e08fd6e-af3a-4a10-b47f-372fa3adfbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189BAF490>]}
[0m23:40:39.396681 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_public.sample_data ........................... [[32mINSERT 2[0m in 1.95s]
[0m23:40:39.396681 [debug] [Thread-1 (]: Finished running node seed.practice.sample
[0m23:40:39.396681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:39.396681 [debug] [MainThread]: Connection 'create_snowflake_prac_public_public' was properly closed.
[0m23:40:39.396681 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m23:40:39.405191 [debug] [MainThread]: Connection 'seed.practice.sample' was properly closed.
[0m23:40:39.405191 [info ] [MainThread]: 
[0m23:40:39.405191 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m23:40:39.405191 [debug] [MainThread]: Command end result
[0m23:40:39.415687 [info ] [MainThread]: 
[0m23:40:39.415687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:39.415687 [info ] [MainThread]: 
[0m23:40:39.415687 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:40:39.415687 [debug] [MainThread]: Command `dbt seed` succeeded at 23:40:39.415687 after 4.79 seconds
[0m23:40:39.415687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151F6DC75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189BADBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015189BAD750>]}
[0m23:40:39.415687 [debug] [MainThread]: Flushing usage events
[0m23:44:27.610278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023774F67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237747D6F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237747D7220>]}


============================== 23:44:27.610278 | d1d38351-1147-43ee-acec-df62d837cb5e ==============================
[0m23:44:27.610278 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:44:27.610278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m23:44:28.090040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1d38351-1147-43ee-acec-df62d837cb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002377479FE20>]}
[0m23:44:28.169477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1d38351-1147-43ee-acec-df62d837cb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023706676B60>]}
[0m23:44:28.185207 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:44:28.185207 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:44:28.280344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:44:28.280344 [debug] [MainThread]: Partial parsing: updated file: practice://seeds\seeds.yml
[0m23:44:28.396772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:44:28.396772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1d38351-1147-43ee-acec-df62d837cb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707BFDA20>]}
[0m23:44:28.411486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1d38351-1147-43ee-acec-df62d837cb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707B7FEE0>]}
[0m23:44:28.411486 [info ] [MainThread]: Found 4 models, 4 tests, 1 seed, 2 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m23:44:28.411486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1d38351-1147-43ee-acec-df62d837cb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707B7FA90>]}
[0m23:44:28.411486 [info ] [MainThread]: 
[0m23:44:28.422984 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:44:28.424479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC'
[0m23:44:28.424479 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC"
[0m23:44:28.424479 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC"} */
show terse schemas in database SNOWFLAKE_PRAC
    limit 10000
[0m23:44:28.424479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:29.043331 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m23:44:29.043331 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC: Close
[0m23:44:29.137602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_snowflake_prac_public'
[0m23:44:29.153642 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m23:44:29.153642 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m23:44:29.153642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:29.589072 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:44:29.589072 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m23:44:29.683192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_snowflake_prac_public, now list_SNOWFLAKE_PRAC_public_public)
[0m23:44:29.683192 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public_public"
[0m23:44:29.683192 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public_public"} */
show terse objects in SNOWFLAKE_PRAC.public_public limit 10000
[0m23:44:29.683192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:29.978570 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:44:29.994157 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public_public: Close
[0m23:44:30.087815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1d38351-1147-43ee-acec-df62d837cb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707E15600>]}
[0m23:44:30.087815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:30.087815 [info ] [MainThread]: 
[0m23:44:30.087815 [debug] [Thread-1 (]: Began running node seed.practice.sample
[0m23:44:30.087815 [info ] [Thread-1 (]: 1 of 1 START seed file SNOWFLAKE_PRAC.public_public.sample_data ................ [RUN]
[0m23:44:30.104805 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.practice.sample'
[0m23:44:30.105723 [debug] [Thread-1 (]: Began compiling node seed.practice.sample
[0m23:44:30.106247 [debug] [Thread-1 (]: Timing info for seed.practice.sample (compile): 23:44:30.106247 => 23:44:30.106247
[0m23:44:30.106247 [debug] [Thread-1 (]: Began executing node seed.practice.sample
[0m23:44:30.140204 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:44:30.140204 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
BEGIN
[0m23:44:30.140204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:44:30.430429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:44:30.430429 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:44:30.430429 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
truncate table "SNOWFLAKE_PRAC"."PUBLIC_PUBLIC"."SAMPLE_DATA"
  ;
[0m23:44:30.590486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:44:30.590486 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:44:30.590486 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
COMMIT
[0m23:44:30.806420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:44:30.822059 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:44:30.822059 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
BEGIN
[0m23:44:30.900779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:44:30.900779 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:44:30.900779 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
insert into SNOWFLAKE_PRAC.public_public.sample_data (id, name, age) values
            (%s,%s,%s),(%s,%s,%s)...
[0m23:44:31.567663 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.0 seconds
[0m23:44:31.567663 [debug] [Thread-1 (]: Using snowflake connection "seed.practice.sample"
[0m23:44:31.567663 [debug] [Thread-1 (]: On seed.practice.sample: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "seed.practice.sample"} */
COMMIT
[0m23:44:31.755873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:44:31.770390 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.practice.sample"
[0m23:44:31.786025 [debug] [Thread-1 (]: Timing info for seed.practice.sample (execute): 23:44:30.106247 => 23:44:31.786025
[0m23:44:31.786025 [debug] [Thread-1 (]: On seed.practice.sample: Close
[0m23:44:31.872324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1d38351-1147-43ee-acec-df62d837cb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707D51CF0>]}
[0m23:44:31.872324 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public_public.sample_data ........................... [[32mINSERT 2[0m in 1.77s]
[0m23:44:31.872324 [debug] [Thread-1 (]: Finished running node seed.practice.sample
[0m23:44:31.872324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:31.872324 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC' was properly closed.
[0m23:44:31.872324 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public_public' was properly closed.
[0m23:44:31.872324 [debug] [MainThread]: Connection 'seed.practice.sample' was properly closed.
[0m23:44:31.872324 [info ] [MainThread]: 
[0m23:44:31.888975 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m23:44:31.889096 [debug] [MainThread]: Command end result
[0m23:44:31.896101 [info ] [MainThread]: 
[0m23:44:31.896101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:31.896101 [info ] [MainThread]: 
[0m23:44:31.896101 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:44:31.896101 [debug] [MainThread]: Command `dbt seed` succeeded at 23:44:31.896101 after 4.36 seconds
[0m23:44:31.896101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023774F67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237067E8D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023707DBC850>]}
[0m23:44:31.896101 [debug] [MainThread]: Flushing usage events
[0m23:50:36.907658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B867DC5C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B867632EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B867632CB0>]}


============================== 23:50:36.911166 | 834d930c-617a-44e9-bd3d-837f4bacc922 ==============================
[0m23:50:36.911166 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:50:36.911166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:50:37.429090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '834d930c-617a-44e9-bd3d-837f4bacc922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8675FB730>]}
[0m23:50:37.506693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '834d930c-617a-44e9-bd3d-837f4bacc922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B87953CFA0>]}
[0m23:50:37.506693 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:50:37.524409 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:50:37.602915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:37.602915 [debug] [MainThread]: Partial parsing: updated file: practice://seeds\seeds.yml
[0m23:50:37.618919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:50:37.622126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '834d930c-617a-44e9-bd3d-837f4bacc922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B87A8340D0>]}
[0m23:50:37.622126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '834d930c-617a-44e9-bd3d-837f4bacc922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B87A595060>]}
[0m23:50:37.622126 [info ] [MainThread]: Found 4 models, 4 tests, 1 seed, 2 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m23:50:37.628565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834d930c-617a-44e9-bd3d-837f4bacc922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B87A597490>]}
[0m23:50:37.630528 [info ] [MainThread]: 
[0m23:50:37.630528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:50:37.635600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public_public'
[0m23:50:37.647662 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public_public"
[0m23:50:37.647662 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public_public"} */
show terse objects in SNOWFLAKE_PRAC.public_public limit 10000
[0m23:50:37.647662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:38.206108 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:50:38.206108 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public_public: Close
[0m23:50:38.300000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public_public, now list_snowflake_prac_public)
[0m23:50:38.315517 [debug] [ThreadPool]: Using snowflake connection "list_snowflake_prac_public"
[0m23:50:38.315517 [debug] [ThreadPool]: On list_snowflake_prac_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_snowflake_prac_public"} */
show terse objects in snowflake_prac.public limit 10000
[0m23:50:38.315517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:38.589215 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:50:38.589215 [debug] [ThreadPool]: On list_snowflake_prac_public: Close
[0m23:50:38.683619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834d930c-617a-44e9-bd3d-837f4bacc922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B87A7BC520>]}
[0m23:50:38.683619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:50:38.683619 [info ] [MainThread]: 
[0m23:50:38.699199 [debug] [Thread-1 (]: Began running node model.practice.tpc_lineage
[0m23:50:38.699199 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.tpc_lineage'
[0m23:50:38.699199 [debug] [Thread-1 (]: Began compiling node model.practice.tpc_lineage
[0m23:50:38.699199 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpc_lineage"
[0m23:50:38.699199 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (compile): 23:50:38.699199 => 23:50:38.699199
[0m23:50:38.699199 [debug] [Thread-1 (]: Began executing node model.practice.tpc_lineage
[0m23:50:38.699199 [debug] [Thread-1 (]: Timing info for model.practice.tpc_lineage (execute): 23:50:38.699199 => 23:50:38.699199
[0m23:50:38.699199 [debug] [Thread-1 (]: Finished running node model.practice.tpc_lineage
[0m23:50:38.699199 [debug] [Thread-1 (]: Began running node model.practice.tpch_orders
[0m23:50:38.699199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpc_lineage, now model.practice.tpch_orders)
[0m23:50:38.699199 [debug] [Thread-1 (]: Began compiling node model.practice.tpch_orders
[0m23:50:38.716742 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.tpch_orders"
[0m23:50:38.716742 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (compile): 23:50:38.699199 => 23:50:38.716742
[0m23:50:38.716742 [debug] [Thread-1 (]: Began executing node model.practice.tpch_orders
[0m23:50:38.720495 [debug] [Thread-1 (]: Timing info for model.practice.tpch_orders (execute): 23:50:38.720495 => 23:50:38.720495
[0m23:50:38.721232 [debug] [Thread-1 (]: Finished running node model.practice.tpch_orders
[0m23:50:38.721232 [debug] [Thread-1 (]: Began running node seed.practice.sample
[0m23:50:38.721232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.tpch_orders, now seed.practice.sample)
[0m23:50:38.721232 [debug] [Thread-1 (]: Began compiling node seed.practice.sample
[0m23:50:38.721232 [debug] [Thread-1 (]: Timing info for seed.practice.sample (compile): 23:50:38.721232 => 23:50:38.721232
[0m23:50:38.721232 [debug] [Thread-1 (]: Began executing node seed.practice.sample
[0m23:50:38.721232 [debug] [Thread-1 (]: Timing info for seed.practice.sample (execute): 23:50:38.721232 => 23:50:38.721232
[0m23:50:38.721232 [debug] [Thread-1 (]: Finished running node seed.practice.sample
[0m23:50:38.721232 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m23:50:38.721232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.practice.sample, now test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba)
[0m23:50:38.729005 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m23:50:38.730686 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba"
[0m23:50:38.730686 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba (compile): 23:50:38.729005 => 23:50:38.730686
[0m23:50:38.730686 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m23:50:38.730686 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba (execute): 23:50:38.730686 => 23:50:38.730686
[0m23:50:38.730686 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba
[0m23:50:38.730686 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m23:50:38.744694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_LINEITEM_L_ORDERKEY.f16501ebba, now test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99)
[0m23:50:38.744694 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m23:50:38.745710 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99"
[0m23:50:38.752590 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (compile): 23:50:38.744694 => 23:50:38.752590
[0m23:50:38.752590 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m23:50:38.752590 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99 (execute): 23:50:38.752590 => 23:50:38.752590
[0m23:50:38.752590 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99
[0m23:50:38.752590 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m23:50:38.752590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_ORDERS_O_ORDERKEY.642202fd99, now test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88)
[0m23:50:38.752590 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m23:50:38.760595 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88"
[0m23:50:38.762404 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88 (compile): 23:50:38.752590 => 23:50:38.762404
[0m23:50:38.762404 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m23:50:38.763870 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88 (execute): 23:50:38.763870 => 23:50:38.763870
[0m23:50:38.763870 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88
[0m23:50:38.763870 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m23:50:38.763870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_LINEITEM_L_ORDERKEY.da6d717a88, now test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22)
[0m23:50:38.763870 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m23:50:38.763870 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22"
[0m23:50:38.763870 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (compile): 23:50:38.763870 => 23:50:38.763870
[0m23:50:38.763870 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m23:50:38.763870 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22 (execute): 23:50:38.763870 => 23:50:38.763870
[0m23:50:38.763870 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22
[0m23:50:38.763870 [debug] [Thread-1 (]: Began running node model.practice.samp
[0m23:50:38.763870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_ORDERS_O_ORDERKEY.a380cd7f22, now model.practice.samp)
[0m23:50:38.763870 [debug] [Thread-1 (]: Began compiling node model.practice.samp
[0m23:50:38.776463 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.samp"
[0m23:50:38.778985 [debug] [Thread-1 (]: Timing info for model.practice.samp (compile): 23:50:38.763870 => 23:50:38.776463
[0m23:50:38.778985 [debug] [Thread-1 (]: Began executing node model.practice.samp
[0m23:50:38.778985 [debug] [Thread-1 (]: Timing info for model.practice.samp (execute): 23:50:38.778985 => 23:50:38.778985
[0m23:50:38.778985 [debug] [Thread-1 (]: Finished running node model.practice.samp
[0m23:50:38.781391 [debug] [Thread-1 (]: Began running node model.practice.order_lin
[0m23:50:38.781391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.samp, now model.practice.order_lin)
[0m23:50:38.781391 [debug] [Thread-1 (]: Began compiling node model.practice.order_lin
[0m23:50:38.784900 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.order_lin"
[0m23:50:38.784900 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (compile): 23:50:38.781391 => 23:50:38.784900
[0m23:50:38.784900 [debug] [Thread-1 (]: Began executing node model.practice.order_lin
[0m23:50:38.784900 [debug] [Thread-1 (]: Timing info for model.practice.order_lin (execute): 23:50:38.784900 => 23:50:38.784900
[0m23:50:38.784900 [debug] [Thread-1 (]: Finished running node model.practice.order_lin
[0m23:50:38.784900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:38.784900 [debug] [MainThread]: Connection 'list_snowflake_prac_public' was properly closed.
[0m23:50:38.784900 [debug] [MainThread]: Connection 'model.practice.order_lin' was properly closed.
[0m23:50:38.784900 [debug] [MainThread]: Command end result
[0m23:50:38.795855 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m23:50:38.795855 [info ] [MainThread]: Building catalog
[0m23:50:38.801363 [debug] [ThreadPool]: Acquiring new snowflake connection 'snowflake_prac.information_schema'
[0m23:50:38.813299 [debug] [ThreadPool]: Using snowflake connection "snowflake_prac.information_schema"
[0m23:50:38.813299 [debug] [ThreadPool]: On snowflake_prac.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "snowflake_prac.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from snowflake_prac.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('order_lin')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpc_lineage')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpch_orders')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('samp')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from snowflake_prac.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('order_lin')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpc_lineage')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('tpch_orders')
                )
             or 
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('samp')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:50:38.813299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:41.178939 [debug] [ThreadPool]: SQL status: SUCCESS 51 in 2.0 seconds
[0m23:50:41.209091 [debug] [ThreadPool]: On snowflake_prac.information_schema: Close
[0m23:50:41.293216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly snowflake_prac.information_schema, now SNOWFLAKE_PRAC.information_schema)
[0m23:50:41.293216 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_PRAC.information_schema"
[0m23:50:41.293216 [debug] [ThreadPool]: On SNOWFLAKE_PRAC.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "SNOWFLAKE_PRAC.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from SNOWFLAKE_PRAC.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('public_public')
                    and upper("table_name") = upper('sample_data')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from SNOWFLAKE_PRAC.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('public_public')
                    and upper("table_name") = upper('sample_data')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:50:41.293216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:43.277493 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m23:50:43.277493 [debug] [ThreadPool]: On SNOWFLAKE_PRAC.information_schema: Close
[0m23:50:43.371109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly SNOWFLAKE_PRAC.information_schema, now SNOWFLAKE_SAMPLE_DATA.information_schema)
[0m23:50:43.371109 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema"
[0m23:50:43.371109 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "SNOWFLAKE_SAMPLE_DATA.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('LINEITEM')
                )
             or 
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('ORDERS')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('LINEITEM')
                )
             or 
                (
                    upper("table_schema") = upper('TPCH_SF1')
                    and upper("table_name") = upper('ORDERS')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:50:43.371109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:45.990259 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 3.0 seconds
[0m23:50:45.990259 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: Close
[0m23:50:46.099976 [info ] [MainThread]: Catalog written to D:\PROJECT\dbt\practice\target\catalog.json
[0m23:50:46.099976 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:50:46.099976 after 9.26 seconds
[0m23:50:46.099976 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:50:46.099976 [debug] [MainThread]: Connection 'SNOWFLAKE_SAMPLE_DATA.information_schema' was properly closed.
[0m23:50:46.099976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B867DC5C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8675FBE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B87A595060>]}
[0m23:50:46.099976 [debug] [MainThread]: Flushing usage events
[0m23:50:56.275120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014840605DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001483FE73F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001483FE71690>]}


============================== 23:50:56.290768 | 3f3336dc-3bbc-429b-aeea-23bb2a7cf41f ==============================
[0m23:50:56.290768 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:50:56.290768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m23:50:56.776522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f3336dc-3bbc-429b-aeea-23bb2a7cf41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148429CBDC0>]}
[0m23:50:56.870357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f3336dc-3bbc-429b-aeea-23bb2a7cf41f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001483FE3BE20>]}
[0m23:51:41.702215 [error] [MainThread]: Encountered an error:

[0m23:51:41.702215 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\kumar\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m23:51:41.723473 [debug] [MainThread]: Command `dbt docs serve` failed at 23:51:41.723473 after 45.49 seconds
[0m23:51:41.723473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014840605DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014851E052D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014851E040D0>]}
[0m23:51:41.723473 [debug] [MainThread]: Flushing usage events
[0m22:29:23.144270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A7E675E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A76D3EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A76D1720>]}


============================== 22:29:23.147940 | 7ebf1b66-cc2a-4899-8a78-23ed452e2ed5 ==============================
[0m22:29:23.147940 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:29:23.149464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:29:23.149464 [info ] [MainThread]: dbt version: 1.7.4
[0m22:29:23.149464 [info ] [MainThread]: python version: 3.10.0
[0m22:29:23.149464 [info ] [MainThread]: python path: C:\Users\kumar\AppData\Local\Programs\Python\Python310\python.exe
[0m22:29:23.149464 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m22:29:23.564790 [info ] [MainThread]: Using profiles dir at C:\Users\kumar\.dbt
[0m22:29:23.564790 [info ] [MainThread]: Using profiles.yml file at C:\Users\kumar\.dbt\profiles.yml
[0m22:29:23.564790 [info ] [MainThread]: Using dbt_project.yml file at D:\PROJECT\dbt\practice\dbt_project.yml
[0m22:29:23.564790 [info ] [MainThread]: adapter type: snowflake
[0m22:29:23.564790 [info ] [MainThread]: adapter version: 1.7.1
[0m22:29:23.647877 [info ] [MainThread]: Configuration:
[0m22:29:23.648617 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:29:23.648617 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:29:23.649627 [info ] [MainThread]: Required dependencies:
[0m22:29:23.649627 [debug] [MainThread]: Executing "git --help"
[0m22:29:23.673709 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:29:23.673709 [debug] [MainThread]: STDERR: "b''"
[0m22:29:23.673709 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:29:23.673709 [info ] [MainThread]: Connection:
[0m22:29:23.673709 [info ] [MainThread]:   account: LZLTXPB-FW41340
[0m22:29:23.673709 [info ] [MainThread]:   user: KAVIN11
[0m22:29:23.673709 [info ] [MainThread]:   database: RIDE_SHARING_DB
[0m22:29:23.681037 [info ] [MainThread]:   warehouse: compute_wh
[0m22:29:23.681211 [info ] [MainThread]:   role: accountadmin
[0m22:29:23.682093 [info ] [MainThread]:   schema: raw
[0m22:29:23.682554 [info ] [MainThread]:   authenticator: None
[0m22:29:23.682554 [info ] [MainThread]:   private_key_path: None
[0m22:29:23.682554 [info ] [MainThread]:   token: None
[0m22:29:23.685212 [info ] [MainThread]:   oauth_client_id: None
[0m22:29:23.685534 [info ] [MainThread]:   query_tag: None
[0m22:29:23.685534 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:29:23.685534 [info ] [MainThread]:   host: None
[0m22:29:23.685534 [info ] [MainThread]:   port: None
[0m22:29:23.685534 [info ] [MainThread]:   proxy_host: None
[0m22:29:23.685534 [info ] [MainThread]:   proxy_port: None
[0m22:29:23.691195 [info ] [MainThread]:   protocol: None
[0m22:29:23.691718 [info ] [MainThread]:   connect_retries: 1
[0m22:29:23.692228 [info ] [MainThread]:   connect_timeout: None
[0m22:29:23.692735 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:29:23.694022 [info ] [MainThread]:   retry_all: False
[0m22:29:23.695131 [info ] [MainThread]:   insecure_mode: False
[0m22:29:23.695697 [info ] [MainThread]:   reuse_connections: None
[0m22:29:23.696721 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:29:23.697906 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:29:23.698495 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:29:23.699038 [debug] [MainThread]: On debug: select 1 as id
[0m22:29:23.699647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:24.213378 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:24.213378 [debug] [MainThread]: On debug: Close
[0m22:29:24.298321 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:29:24.298321 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:29:24.298321 [debug] [MainThread]: Command `dbt debug` succeeded at 22:29:24.298321 after 1.26 seconds
[0m22:29:24.298321 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:29:24.298321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A7E675E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B95E11E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1B95E06A0>]}
[0m22:29:24.298321 [debug] [MainThread]: Flushing usage events
[0m23:00:19.779722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E09C65C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E094D0EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E094D1840>]}


============================== 23:00:19.790195 | 41ab4dfd-856d-409a-b345-2cb9476b1dda ==============================
[0m23:00:19.790195 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:00:19.790195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:00:21.445790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41ab4dfd-856d-409a-b345-2cb9476b1dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E0949BDC0>]}
[0m23:00:21.512587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41ab4dfd-856d-409a-b345-2cb9476b1dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1C466440>]}
[0m23:00:21.512587 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:00:21.541051 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:00:21.582192 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:00:21.582192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41ab4dfd-856d-409a-b345-2cb9476b1dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1B2E5A50>]}
[0m23:00:24.060716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:00:24.064398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41ab4dfd-856d-409a-b345-2cb9476b1dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1CA643D0>]}
[0m23:00:24.102642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41ab4dfd-856d-409a-b345-2cb9476b1dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1C9C7550>]}
[0m23:00:24.102642 [info ] [MainThread]: Found 1 model, 1 seed, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:00:24.102642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ab4dfd-856d-409a-b345-2cb9476b1dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1C9C4160>]}
[0m23:00:24.112337 [info ] [MainThread]: 
[0m23:00:24.112337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:00:24.115466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw'
[0m23:00:24.128989 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:00:24.128989 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:00:24.128989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:24.781571 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m23:00:24.781571 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:00:24.880171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:00:24.880171 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:00:24.880171 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:00:24.880171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:25.363693 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc1a-0001-429b-0008-435e00013f46
[0m23:00:25.363693 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:00:25.363693 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:00:25.363693 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:00:25.363693 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:00:25.446181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41ab4dfd-856d-409a-b345-2cb9476b1dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1CA51FC0>]}
[0m23:00:25.446181 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:00:25.446181 [info ] [MainThread]: 
[0m23:00:25.446181 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:00:25.446181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:00:25.461213 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:00:25.468368 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:00:25.476881 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:00:25.461213 => 23:00:25.468368
[0m23:00:25.476881 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:00:25.476881 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:00:25.476881 => 23:00:25.476881
[0m23:00:25.478905 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:00:25.481100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:25.481100 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:00:25.481100 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:00:25.481100 [debug] [MainThread]: Command end result
[0m23:00:25.481100 [info ] [MainThread]: Compiled node 'stg_customers' is:
WITH customer_cast AS (
    SELECT 
        CAST(customer_id AS BIGINT) AS customer_id,
        CAST(product_id AS VARCHAR(255)) AS product_id,
        CAST(payment_month AS DATE) AS payment_month,
        CAST(revenue_type AS INT) AS revenue_type,
        CAST(revenue AS DECIMAL(18,2)) AS revenue,
        CAST(quantity AS INT) AS quantity,
        CAST(companies AS VARCHAR(255)) AS companies
    FROM RIDE_SHARING_DB.RAW.CUSTOMERS
)
SELECT * FROM CastedData;
[0m23:00:25.492605 [debug] [MainThread]: Command `dbt compile` succeeded at 23:00:25.492605 after 5.79 seconds
[0m23:00:25.492605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E09C65C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1CA51F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1C91A8C0>]}
[0m23:00:25.495566 [debug] [MainThread]: Flushing usage events
[0m23:02:26.989474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1392E75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D138B51DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D138B52A10>]}


============================== 23:02:26.989474 | 0810958e-1681-400d-bfb0-225d51b12584 ==============================
[0m23:02:26.989474 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:02:26.999609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:02:27.515310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0810958e-1681-400d-bfb0-225d51b12584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D138B1BDF0>]}
[0m23:02:27.588892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0810958e-1681-400d-bfb0-225d51b12584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14AA60FA0>]}
[0m23:02:27.588892 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:02:27.605821 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:02:27.683772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:27.683772 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:02:27.789039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:02:27.805362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0810958e-1681-400d-bfb0-225d51b12584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14BE51240>]}
[0m23:02:27.807678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0810958e-1681-400d-bfb0-225d51b12584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14BCD6BC0>]}
[0m23:02:27.807678 [info ] [MainThread]: Found 1 seed, 4 tests, 1 model, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:02:27.818777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0810958e-1681-400d-bfb0-225d51b12584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14BCD43D0>]}
[0m23:02:27.818777 [info ] [MainThread]: 
[0m23:02:27.822086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:27.822870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:02:27.834976 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:02:27.836742 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:02:27.836742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:28.323375 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m23:02:28.323375 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:02:28.423656 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:02:28.451047 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:02:28.451047 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:02:28.451047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:28.884409 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc1c-0001-429a-0008-435e0001a7de
[0m23:02:28.884409 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:02:28.884409 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:02:28.889009 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:02:28.889604 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:02:28.977506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw)
[0m23:02:28.985628 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:02:28.985628 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:02:28.986839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:29.306021 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:02:29.306923 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:02:29.407034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0810958e-1681-400d-bfb0-225d51b12584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14BCD6410>]}
[0m23:02:29.415636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:29.415636 [info ] [MainThread]: 
[0m23:02:29.427657 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:02:29.427657 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customers .................................. [RUN]
[0m23:02:29.431720 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:02:29.435046 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:02:29.440258 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:02:29.440258 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:02:29.435046 => 23:02:29.440258
[0m23:02:29.440258 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:02:29.473636 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:02:29.481053 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:02:29.481053 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw.stg_customers
  
   as (
    WITH customer_cast AS (
    SELECT 
       *
    FROM RIDE_SHARING_DB.RAW.CUSTOMERS
)
SELECT * into casted_ride_sharing_data FROM CastedData;
[0m23:02:29.481053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:29.788679 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc1c-0001-429a-0008-435e0001a7e6
[0m23:02:29.789053 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 54 unexpected ';'.
[0m23:02:29.789053 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:02:29.440258 => 23:02:29.789053
[0m23:02:29.789053 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:02:29.889648 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 54 unexpected ';'.
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:02:29.889648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0810958e-1681-400d-bfb0-225d51b12584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14BFE2E00>]}
[0m23:02:29.889648 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customers ......................... [[31mERROR[0m in 0.46s]
[0m23:02:29.889648 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:02:29.889648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:29.889648 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:02:29.889648 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw' was properly closed.
[0m23:02:29.889648 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:02:29.889648 [info ] [MainThread]: 
[0m23:02:29.889648 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m23:02:29.889648 [debug] [MainThread]: Command end result
[0m23:02:29.906086 [info ] [MainThread]: 
[0m23:02:29.907096 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:29.907096 [info ] [MainThread]: 
[0m23:02:29.907096 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 54 unexpected ';'.
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:02:29.910374 [info ] [MainThread]: 
[0m23:02:29.910374 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:02:29.910374 [debug] [MainThread]: Command `dbt run` failed at 23:02:29.910374 after 2.98 seconds
[0m23:02:29.910374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1392E75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14C16FA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14C16F8B0>]}
[0m23:02:29.910374 [debug] [MainThread]: Flushing usage events
[0m23:02:41.105819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A54306920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A53B71E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A53B72E60>]}


============================== 23:02:41.105819 | 77f682ba-f004-4ee9-9b2e-6b58c04f0c72 ==============================
[0m23:02:41.105819 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:02:41.114912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:02:41.587976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77f682ba-f004-4ee9-9b2e-6b58c04f0c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A53B3BDC0>]}
[0m23:02:41.677298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77f682ba-f004-4ee9-9b2e-6b58c04f0c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A66B05B40>]}
[0m23:02:41.677298 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:02:41.690610 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:02:41.764971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:41.764971 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:02:41.871728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:02:41.884372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77f682ba-f004-4ee9-9b2e-6b58c04f0c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A66E691B0>]}
[0m23:02:41.896021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77f682ba-f004-4ee9-9b2e-6b58c04f0c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A66CEA590>]}
[0m23:02:41.896021 [info ] [MainThread]: Found 1 seed, 4 tests, 1 model, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:02:41.896021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77f682ba-f004-4ee9-9b2e-6b58c04f0c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A66CEB280>]}
[0m23:02:41.900448 [info ] [MainThread]: 
[0m23:02:41.901753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:41.901753 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:02:41.915733 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:02:41.915733 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:02:41.915733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:42.388362 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m23:02:42.389303 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:02:42.472833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:02:42.488981 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:02:42.503575 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:02:42.503575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:42.988738 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc1c-0001-429a-0008-435e0001a7ea
[0m23:02:42.988738 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:02:42.988738 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:02:42.988738 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:02:42.988738 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:02:43.088844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw)
[0m23:02:43.088844 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:02:43.088844 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:02:43.088844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:02:43.572306 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:02:43.572306 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:02:43.674263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77f682ba-f004-4ee9-9b2e-6b58c04f0c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A66CEA500>]}
[0m23:02:43.680788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:02:43.680788 [info ] [MainThread]: 
[0m23:02:43.680788 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:02:43.680788 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customers .................................. [RUN]
[0m23:02:43.689059 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:02:43.689059 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:02:43.698126 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:02:43.698126 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:02:43.689059 => 23:02:43.698126
[0m23:02:43.698126 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:02:43.725249 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:02:43.725249 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:02:43.725249 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw.stg_customers
  
   as (
    WITH customer_cast AS (
    SELECT 
       *
    FROM RIDE_SHARING_DB.RAW.CUSTOMERS
)
SELECT * into casted_ride_sharing_data FROM CastedData
  );
[0m23:02:43.725249 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:44.009531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc1c-0001-429a-0008-435e0001a7ee
[0m23:02:44.009531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001138 (42601): SQL compilation error: error line 9 at position 0 INTO clause is not allowed in this context
[0m23:02:44.009531 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:02:43.698126 => 23:02:44.009531
[0m23:02:44.017047 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:02:44.106957 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001138 (42601): SQL compilation error: error line 9 at position 0 INTO clause is not allowed in this context
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:02:44.106957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77f682ba-f004-4ee9-9b2e-6b58c04f0c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A67067D90>]}
[0m23:02:44.106957 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customers ......................... [[31mERROR[0m in 0.42s]
[0m23:02:44.106957 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:02:44.122700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:44.122700 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:02:44.122700 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw' was properly closed.
[0m23:02:44.122700 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:02:44.122700 [info ] [MainThread]: 
[0m23:02:44.122700 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m23:02:44.127774 [debug] [MainThread]: Command end result
[0m23:02:44.139153 [info ] [MainThread]: 
[0m23:02:44.140784 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:44.142041 [info ] [MainThread]: 
[0m23:02:44.142041 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001138 (42601): SQL compilation error: error line 9 at position 0 INTO clause is not allowed in this context
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:02:44.142041 [info ] [MainThread]: 
[0m23:02:44.142041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:02:44.142041 [debug] [MainThread]: Command `dbt run` failed at 23:02:44.142041 after 3.09 seconds
[0m23:02:44.142041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A54306920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A670AB250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A67193B80>]}
[0m23:02:44.142041 [debug] [MainThread]: Flushing usage events
[0m23:03:22.069488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48AAB6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48A321E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48A322E60>]}


============================== 23:03:22.069488 | 162f9a32-c025-4cd9-8c24-57d4f6327de4 ==============================
[0m23:03:22.069488 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:03:22.069488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m23:03:22.552450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '162f9a32-c025-4cd9-8c24-57d4f6327de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48A2EBDC0>]}
[0m23:03:22.635829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '162f9a32-c025-4cd9-8c24-57d4f6327de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C2E6170>]}
[0m23:03:22.635829 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:03:22.645579 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:03:22.724984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:03:22.724984 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:03:22.836160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:03:22.848261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '162f9a32-c025-4cd9-8c24-57d4f6327de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D6211B0>]}
[0m23:03:22.852883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162f9a32-c025-4cd9-8c24-57d4f6327de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D49A560>]}
[0m23:03:22.852883 [info ] [MainThread]: Found 1 seed, 4 tests, 1 model, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:03:22.852883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162f9a32-c025-4cd9-8c24-57d4f6327de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D49B280>]}
[0m23:03:22.864480 [info ] [MainThread]: 
[0m23:03:22.864480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:22.864480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:03:22.869596 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:03:22.869596 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:03:22.869596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:23.378921 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m23:03:23.387081 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:03:23.486770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw'
[0m23:03:23.499809 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:03:23.502476 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:03:23.502476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:23.914443 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:03:23.920060 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:03:24.003880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:03:24.020135 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:03:24.020135 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:03:24.020135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:24.326036 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc1d-0001-429b-0008-435e00013f5a
[0m23:03:24.326036 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:03:24.326036 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:03:24.330555 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:03:24.330555 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:03:24.420226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162f9a32-c025-4cd9-8c24-57d4f6327de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D49A5C0>]}
[0m23:03:24.420226 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:24.420226 [info ] [MainThread]: 
[0m23:03:24.433236 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:03:24.436130 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customers .................................. [RUN]
[0m23:03:24.438331 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:03:24.438947 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:03:24.441959 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:03:24.441959 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:03:24.438947 => 23:03:24.441959
[0m23:03:24.441959 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:03:24.472814 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:03:24.472814 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:03:24.472814 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw.stg_customers
  
   as (
    SELECT 
       *
    into casted_ride_sharing_data
    FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:03:24.472814 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:03:24.786711 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc1d-0001-429a-0008-435e0001a7f6
[0m23:03:24.786711 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001138 (42601): SQL compilation error: error line 4 at position 4 INTO clause is not allowed in this context
[0m23:03:24.786711 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:03:24.441959 => 23:03:24.786711
[0m23:03:24.786711 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:03:24.887117 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001138 (42601): SQL compilation error: error line 4 at position 4 INTO clause is not allowed in this context
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:03:24.887117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '162f9a32-c025-4cd9-8c24-57d4f6327de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D80B700>]}
[0m23:03:24.887117 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customers ......................... [[31mERROR[0m in 0.45s]
[0m23:03:24.898672 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:03:24.902482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:24.902482 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:03:24.902482 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:03:24.902482 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:03:24.902482 [info ] [MainThread]: 
[0m23:03:24.902482 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m23:03:24.906318 [debug] [MainThread]: Command end result
[0m23:03:24.910164 [info ] [MainThread]: 
[0m23:03:24.910164 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:03:24.910164 [info ] [MainThread]: 
[0m23:03:24.918846 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001138 (42601): SQL compilation error: error line 4 at position 4 INTO clause is not allowed in this context
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:03:24.918846 [info ] [MainThread]: 
[0m23:03:24.918846 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:03:24.918846 [debug] [MainThread]: Command `dbt run` failed at 23:03:24.918846 after 2.90 seconds
[0m23:03:24.918846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48AAB6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D84F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D87EA70>]}
[0m23:03:24.918846 [debug] [MainThread]: Flushing usage events
[0m23:06:43.345226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E02FFF7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E02F861E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E02F862860>]}


============================== 23:06:43.353730 | 456bb037-3b0c-467e-aeaf-fa765db4cd2c ==============================
[0m23:06:43.353730 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:06:43.358125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:43.935673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '456bb037-3b0c-467e-aeaf-fa765db4cd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E02F82BDC0>]}
[0m23:06:44.008280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '456bb037-3b0c-467e-aeaf-fa765db4cd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E0427FA080>]}
[0m23:06:44.008280 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:06:44.027449 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:06:44.106467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:06:44.106467 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:06:44.225643 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  expected token ',', got 'a'
    line 2
      materialized='view'  -- Creates a physical table in Snowflake
[0m23:06:44.225643 [debug] [MainThread]: Command `dbt run` failed at 23:06:44.225643 after 0.95 seconds
[0m23:06:44.225643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E02FFF7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E042AF25F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E042AF24A0>]}
[0m23:06:44.225643 [debug] [MainThread]: Flushing usage events
[0m23:07:06.882352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D5C85DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D54F77C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D54F57E0>]}


============================== 23:07:06.885681 | d45bb61c-ce16-49b6-afdc-0a095c78e1e9 ==============================
[0m23:07:06.885681 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:07:06.885681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:07:07.373131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd45bb61c-ce16-49b6-afdc-0a095c78e1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D54BFE20>]}
[0m23:07:07.457308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd45bb61c-ce16-49b6-afdc-0a095c78e1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E848A860>]}
[0m23:07:07.457308 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:07:07.457308 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:07:07.536712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:07.539649 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:07:07.656594 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:07:07.673374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd45bb61c-ce16-49b6-afdc-0a095c78e1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E87F1150>]}
[0m23:07:07.685801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd45bb61c-ce16-49b6-afdc-0a095c78e1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E8668F40>]}
[0m23:07:07.686414 [info ] [MainThread]: Found 1 seed, 4 tests, 1 model, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:07:07.686784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45bb61c-ce16-49b6-afdc-0a095c78e1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E866B280>]}
[0m23:07:07.687840 [info ] [MainThread]: 
[0m23:07:07.689686 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:07.690825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:07:07.701830 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:07:07.701830 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:07:07.701830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:08.214358 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m23:07:08.223385 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:07:08.320168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:07:08.324252 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:07:08.324252 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:07:08.324252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:08.621867 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc21-0001-429a-0008-435e0001a7fe
[0m23:07:08.624118 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:07:08.624118 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:07:08.624118 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:07:08.624118 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:07:08.973690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw)
[0m23:07:08.990102 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:07:08.990102 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:07:08.990102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:09.291058 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:07:09.291058 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:07:09.383054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45bb61c-ce16-49b6-afdc-0a095c78e1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E866A5F0>]}
[0m23:07:09.391192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:09.391192 [info ] [MainThread]: 
[0m23:07:09.391192 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:07:09.391192 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customers .................................. [RUN]
[0m23:07:09.391192 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:07:09.401798 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:07:09.407452 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:07:09.407452 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:07:09.401798 => 23:07:09.407452
[0m23:07:09.407452 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:07:09.441427 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:07:09.441427 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:07:09.441427 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw.stg_customers
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:07:09.441427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:09.973870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:07:09.990121 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:07:09.407452 => 23:07:09.990121
[0m23:07:10.004216 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:07:10.091351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45bb61c-ce16-49b6-afdc-0a095c78e1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E8B86CB0>]}
[0m23:07:10.091351 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.stg_customers ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m23:07:10.100367 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:07:10.100367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:10.100367 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:07:10.106203 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw' was properly closed.
[0m23:07:10.107077 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:07:10.107077 [info ] [MainThread]: 
[0m23:07:10.107077 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m23:07:10.107077 [debug] [MainThread]: Command end result
[0m23:07:10.116178 [info ] [MainThread]: 
[0m23:07:10.119418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:07:10.119418 [info ] [MainThread]: 
[0m23:07:10.119418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:07:10.119418 [debug] [MainThread]: Command `dbt run` succeeded at 23:07:10.119418 after 3.31 seconds
[0m23:07:10.122767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233D5C85DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E8806E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233E8A1B250>]}
[0m23:07:10.122767 [debug] [MainThread]: Flushing usage events
[0m23:10:17.179443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEDDC6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FED631E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FED632E60>]}


============================== 23:10:17.179443 | b09647ac-cb56-4a3c-b42c-b72204f733af ==============================
[0m23:10:17.179443 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:10:17.179443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:10:17.662727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FED5FBDC0>]}
[0m23:10:17.745888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFF5FA170>]}
[0m23:10:17.745888 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:10:17.745888 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:10:17.780264 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:10:17.780264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFF50DBD0>]}
[0m23:10:18.829161 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:10:18.829161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFFBEC610>]}
[0m23:10:18.847821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFFB00B50>]}
[0m23:10:18.847821 [info ] [MainThread]: Found 1 model, 1 seed, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:10:18.847821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFFB00AF0>]}
[0m23:10:18.847821 [info ] [MainThread]: 
[0m23:10:18.856850 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:18.856850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:10:18.864537 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:10:18.864537 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:10:18.864537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:19.496774 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:10:19.496774 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:10:19.609062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:10:19.629600 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:10:19.629600 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:10:19.629600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:20.018371 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc24-0001-429a-0008-435e0001a842
[0m23:10:20.018371 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:10:20.018371 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:10:20.022384 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:10:20.022384 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:10:20.096030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw)
[0m23:10:20.109637 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:10:20.109637 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:10:20.112305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:20.430264 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:10:20.430264 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:10:20.530031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFFC1B5E0>]}
[0m23:10:20.530031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:10:20.530031 [info ] [MainThread]: 
[0m23:10:20.548147 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:10:20.548147 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customers .................................. [RUN]
[0m23:10:20.550655 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:10:20.550655 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:10:20.562107 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:10:20.563622 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:10:20.550655 => 23:10:20.563622
[0m23:10:20.563622 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:10:20.583433 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:10:20.583433 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:10:20.583433 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw.stg_customers
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:10:20.583433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:20.981219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:10:20.995945 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:10:20.563622 => 23:10:20.995945
[0m23:10:20.995945 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:10:21.082347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b09647ac-cb56-4a3c-b42c-b72204f733af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFFF53880>]}
[0m23:10:21.091372 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.stg_customers ............................. [[32mSUCCESS 1[0m in 0.53s]
[0m23:10:21.091372 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:10:21.097765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:21.097765 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:10:21.097765 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw' was properly closed.
[0m23:10:21.097765 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:10:21.097765 [info ] [MainThread]: 
[0m23:10:21.097765 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m23:10:21.097765 [debug] [MainThread]: Command end result
[0m23:10:21.112700 [info ] [MainThread]: 
[0m23:10:21.112700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:21.115712 [info ] [MainThread]: 
[0m23:10:21.116393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:10:21.116393 [debug] [MainThread]: Command `dbt run` succeeded at 23:10:21.116393 after 4.00 seconds
[0m23:10:21.118138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEDDC6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFF50F340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FFFD91F60>]}
[0m23:10:21.118138 [debug] [MainThread]: Flushing usage events
[0m23:11:44.938635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AE125DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AD9937C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AD9917E0>]}


============================== 23:11:44.942036 | 1ded0840-a415-4897-a051-baefd40e3215 ==============================
[0m23:11:44.942036 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:11:44.942036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:11:45.457611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ded0840-a415-4897-a051-baefd40e3215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AD95BE20>]}
[0m23:11:45.541018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ded0840-a415-4897-a051-baefd40e3215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C0928FD0>]}
[0m23:11:45.541018 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:11:45.541018 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:11:45.657433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:45.658073 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:11:45.757506 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  expected token ',', got 'materialized'
    line 3
      materialized='view'
[0m23:11:45.757506 [debug] [MainThread]: Command `dbt run` failed at 23:11:45.757506 after 0.88 seconds
[0m23:11:45.757506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5AE125DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C0C2C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C0C2C520>]}
[0m23:11:45.757506 [debug] [MainThread]: Flushing usage events
[0m23:11:54.357453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241998C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024199131DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024199133A30>]}


============================== 23:11:54.368050 | e43355bf-c710-4e00-af8d-c30e204d14ba ==============================
[0m23:11:54.368050 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:11:54.368050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m23:11:54.857104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e43355bf-c710-4e00-af8d-c30e204d14ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241990FBD90>]}
[0m23:11:54.940510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e43355bf-c710-4e00-af8d-c30e204d14ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC0CB970>]}
[0m23:11:54.940510 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:11:54.958246 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:11:55.024167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:55.024167 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:11:55.140603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:11:55.152373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e43355bf-c710-4e00-af8d-c30e204d14ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC4411E0>]}
[0m23:11:55.164980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e43355bf-c710-4e00-af8d-c30e204d14ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC2A65C0>]}
[0m23:11:55.165590 [info ] [MainThread]: Found 1 seed, 4 tests, 1 model, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:11:55.165590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43355bf-c710-4e00-af8d-c30e204d14ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC2A72B0>]}
[0m23:11:55.168153 [info ] [MainThread]: 
[0m23:11:55.168153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:11:55.171928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:11:55.175366 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:11:55.175366 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:11:55.175366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:55.708463 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:11:55.708463 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:11:55.800670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB, now create_RIDE_SHARING_DB_raw_STAGING)
[0m23:11:55.807888 [debug] [ThreadPool]: Creating schema "database: "RIDE_SHARING_DB"
schema: "raw_STAGING"
"
[0m23:11:55.816484 [debug] [ThreadPool]: Using snowflake connection "create_RIDE_SHARING_DB_raw_STAGING"
[0m23:11:55.816484 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "create_RIDE_SHARING_DB_raw_STAGING"} */
create schema if not exists RIDE_SHARING_DB.raw_STAGING
[0m23:11:55.816484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:56.275025 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:11:56.285134 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:11:56.375456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:11:56.391242 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:11:56.391242 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:11:56.391242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:56.792635 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc25-0001-429a-0008-435e0001a8aa
[0m23:11:56.792635 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:11:56.792635 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:11:56.792635 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:11:56.792635 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:11:56.885353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:11:56.891699 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:11:56.891699 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:11:56.891699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:57.211680 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:11:57.213283 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:11:57.307998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43355bf-c710-4e00-af8d-c30e204d14ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC42EEC0>]}
[0m23:11:57.307998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:11:57.307998 [info ] [MainThread]: 
[0m23:11:57.320091 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:11:57.320091 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:11:57.324032 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:11:57.325206 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:11:57.328929 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:11:57.328929 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:11:57.325206 => 23:11:57.328929
[0m23:11:57.328929 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:11:57.361401 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:11:57.361401 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:11:57.361401 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:11:57.361401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:11:57.769202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:11:57.790566 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:11:57.328929 => 23:11:57.790566
[0m23:11:57.790566 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:11:57.891351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43355bf-c710-4e00-af8d-c30e204d14ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC7A7CA0>]}
[0m23:11:57.892324 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.57s]
[0m23:11:57.892324 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:11:57.900334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:57.901788 [debug] [MainThread]: Connection 'create_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:11:57.902238 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:11:57.903158 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:11:57.903158 [info ] [MainThread]: 
[0m23:11:57.903158 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m23:11:57.908073 [debug] [MainThread]: Command end result
[0m23:11:57.916156 [info ] [MainThread]: 
[0m23:11:57.916156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:57.916156 [info ] [MainThread]: 
[0m23:11:57.916156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:11:57.916156 [debug] [MainThread]: Command `dbt run` succeeded at 23:11:57.916156 after 3.61 seconds
[0m23:11:57.923391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241998C75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC7A7CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC2A6740>]}
[0m23:11:57.924419 [debug] [MainThread]: Flushing usage events
[0m23:23:47.939911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF82D75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF7B41DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF7B42CE0>]}


============================== 23:23:47.939911 | e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7 ==============================
[0m23:23:47.939911 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:23:47.954503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:23:48.489756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF7B0BDC0>]}
[0m23:23:48.572938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFFA4FEE0>]}
[0m23:23:48.572938 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:23:48.590654 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:23:48.660347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m23:23:48.660347 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\stg_transaction.sql
[0m23:23:48.660347 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\stg_product.sql
[0m23:23:48.773116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:23:48.773116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFFE71A80>]}
[0m23:23:48.796301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFFCF2E90>]}
[0m23:23:48.796301 [info ] [MainThread]: Found 1 seed, 4 tests, 3 models, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:23:48.796301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFFCF3730>]}
[0m23:23:48.796301 [info ] [MainThread]: 
[0m23:23:48.796301 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:23:48.796301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:23:48.812521 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:23:48.812521 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:23:48.812521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:49.323938 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:23:49.323938 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:23:49.423998 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw'
[0m23:23:49.440347 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:23:49.440347 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:23:49.440347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:49.740537 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:23:49.752234 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:23:49.840448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:23:49.856298 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:23:49.856938 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:23:49.856938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:50.123131 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:23:50.123131 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:23:50.206763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:23:50.223579 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:23:50.223579 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:23:50.223579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:50.644858 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc31-0001-429b-0008-435e0001d0aa
[0m23:23:50.644858 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:23:50.644858 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:23:50.644858 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:23:50.644858 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:23:50.739778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFFE86AA0>]}
[0m23:23:50.740771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:50.740771 [info ] [MainThread]: 
[0m23:23:50.740771 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:23:50.740771 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:23:50.752349 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:23:50.753297 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:23:50.757868 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:23:50.757868 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:23:50.753297 => 23:23:50.757868
[0m23:23:50.757868 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:23:50.790655 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:23:50.790655 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:23:50.790655 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:23:50.790655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:23:51.200751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:23:51.232598 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:23:50.757868 => 23:23:51.232598
[0m23:23:51.232598 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:23:51.323803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8bcde25-1cef-40ae-8552-3dbcdfa3bfe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8B1FFFD0>]}
[0m23:23:51.323803 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.58s]
[0m23:23:51.323803 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:23:51.323803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:51.323803 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:23:51.323803 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:23:51.337652 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:23:51.339387 [info ] [MainThread]: 
[0m23:23:51.340757 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m23:23:51.340757 [debug] [MainThread]: Command end result
[0m23:23:51.352264 [info ] [MainThread]: 
[0m23:23:51.352264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:23:51.352264 [info ] [MainThread]: 
[0m23:23:51.352264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:23:51.355962 [debug] [MainThread]: Command `dbt run` succeeded at 23:23:51.355962 after 3.46 seconds
[0m23:23:51.355962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF82D75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED8B1FFFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFFCF2680>]}
[0m23:23:51.355962 [debug] [MainThread]: Flushing usage events
[0m23:24:40.713689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93C866950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93C0D1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93C0D15D0>]}


============================== 23:24:40.713689 | 0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9 ==============================
[0m23:24:40.713689 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:24:40.713689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:24:41.203687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93C0D36A0>]}
[0m23:24:41.287130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94DEB4CA0>]}
[0m23:24:41.287130 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:24:41.303586 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:24:41.322307 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:24:41.322307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94E066890>]}
[0m23:24:42.487728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:24:42.496606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F65CDF0>]}
[0m23:24:42.508614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F5ED720>]}
[0m23:24:42.515272 [info ] [MainThread]: Found 3 models, 1 seed, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:24:42.515272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F5ED540>]}
[0m23:24:42.517776 [info ] [MainThread]: 
[0m23:24:42.517776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:24:42.517776 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:24:42.533691 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:24:42.533691 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:24:42.533691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:43.004128 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:24:43.004128 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:24:43.088338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB, now create_RIDE_SHARING_DB_raw_STAGING)
[0m23:24:43.088338 [debug] [ThreadPool]: Creating schema "database: "RIDE_SHARING_DB"
schema: "raw_STAGING"
"
[0m23:24:43.088338 [debug] [ThreadPool]: Using snowflake connection "create_RIDE_SHARING_DB_raw_STAGING"
[0m23:24:43.088338 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "create_RIDE_SHARING_DB_raw_STAGING"} */
create schema if not exists RIDE_SHARING_DB.raw_STAGING
[0m23:24:43.088338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:43.489270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:24:43.489270 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:24:43.837919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw'
[0m23:24:43.872099 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:24:43.872099 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:24:43.872099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:44.328409 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:24:44.328409 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:24:44.420987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:24:44.420987 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:24:44.420987 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:24:44.420987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:44.753868 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc32-0001-429a-0008-435e0001a96e
[0m23:24:44.754750 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:24:44.754750 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:24:44.754750 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:24:44.754750 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:24:44.854843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:24:44.854843 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:24:44.854843 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:24:44.854843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:45.137857 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m23:24:45.154564 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:24:45.254463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F65E080>]}
[0m23:24:45.254463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:45.254463 [info ] [MainThread]: 
[0m23:24:45.254463 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:24:45.267410 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:24:45.270229 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:24:45.270300 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:24:45.272320 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:24:45.281826 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:24:45.270300 => 23:24:45.272320
[0m23:24:45.281826 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:24:45.304057 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:24:45.304057 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:24:45.304057 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:24:45.304057 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:24:45.730268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:24:45.753533 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:24:45.281826 => 23:24:45.753533
[0m23:24:45.753533 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:24:45.856051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ba8f453-53b2-4731-ae53-cc3bc7ca7fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F8BB520>]}
[0m23:24:45.856051 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.59s]
[0m23:24:45.856051 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:24:45.856051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:45.856051 [debug] [MainThread]: Connection 'create_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:24:45.856051 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:24:45.856051 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:24:45.856051 [info ] [MainThread]: 
[0m23:24:45.856051 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m23:24:45.856051 [debug] [MainThread]: Command end result
[0m23:24:45.870934 [info ] [MainThread]: 
[0m23:24:45.870934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:24:45.875467 [info ] [MainThread]: 
[0m23:24:45.875467 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:24:45.875467 [debug] [MainThread]: Command `dbt run` succeeded at 23:24:45.875467 after 5.24 seconds
[0m23:24:45.875467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93C866950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F47DF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F94F8BB430>]}
[0m23:24:45.875467 [debug] [MainThread]: Flushing usage events
[0m23:26:12.992318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0298B5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B029111E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B029112860>]}


============================== 23:26:12.992318 | 31b3cd41-3d0d-4f8b-8c64-8ea5ca09ae08 ==============================
[0m23:26:12.992318 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:26:12.992318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_product', 'send_anonymous_usage_stats': 'True'}
[0m23:26:13.499479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31b3cd41-3d0d-4f8b-8c64-8ea5ca09ae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0290DBDC0>]}
[0m23:26:13.580367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31b3cd41-3d0d-4f8b-8c64-8ea5ca09ae08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B03B0EA080>]}
[0m23:26:13.583018 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:26:13.583018 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:26:13.672867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:26:13.672867 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m23:26:13.782828 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_product' (models\staging\stg_product.sql) depends on a source named 'tp_source.PRODUCTS' which was not found
[0m23:26:13.782828 [debug] [MainThread]: Command `dbt run` failed at 23:26:13.782828 after 0.85 seconds
[0m23:26:13.782828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0298B5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B03C3E8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B03C3E8250>]}
[0m23:26:13.782828 [debug] [MainThread]: Flushing usage events
[0m23:26:49.351665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA2FA75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA2811DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA2812CE0>]}


============================== 23:26:49.351665 | 9d5f2e4c-e09f-4d15-9628-6ef5dbb37007 ==============================
[0m23:26:49.351665 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:26:49.351665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_product', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:49.847539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d5f2e4c-e09f-4d15-9628-6ef5dbb37007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA27DBDC0>]}
[0m23:26:49.914350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d5f2e4c-e09f-4d15-9628-6ef5dbb37007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA27DBF10>]}
[0m23:26:49.914350 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:26:49.930878 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:26:50.005110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:26:50.005110 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m23:26:50.005110 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m23:26:50.264432 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_product' (models\staging\stg_product.sql) depends on a source named 'tp_source.PRODUCTS' which was not found
[0m23:26:50.264432 [debug] [MainThread]: Command `dbt run` failed at 23:26:50.264432 after 0.99 seconds
[0m23:26:50.264432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FA2FA75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FB59B6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FB5C38A00>]}
[0m23:26:50.264432 [debug] [MainThread]: Flushing usage events
[0m23:27:15.912764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441D156920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441C9C1DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441C9C3A30>]}


============================== 23:27:15.916991 | 34644810-0f22-4fa0-86e4-b052774856d6 ==============================
[0m23:27:15.916991 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:27:15.916991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_product', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:27:16.479384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34644810-0f22-4fa0-86e4-b052774856d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441C98BD90>]}
[0m23:27:16.555920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34644810-0f22-4fa0-86e4-b052774856d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441C98BF10>]}
[0m23:27:16.563105 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:27:16.563105 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:27:16.635581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:27:16.635581 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m23:27:16.635581 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m23:27:16.910428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:27:16.913274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34644810-0f22-4fa0-86e4-b052774856d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442FEE40D0>]}
[0m23:27:16.926283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34644810-0f22-4fa0-86e4-b052774856d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442FB4C5B0>]}
[0m23:27:16.927292 [info ] [MainThread]: Found 3 models, 1 seed, 4 tests, 2 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:27:16.928103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34644810-0f22-4fa0-86e4-b052774856d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442FB4C490>]}
[0m23:27:16.930057 [info ] [MainThread]: 
[0m23:27:16.931963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:27:16.931963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:27:16.946834 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:27:16.946834 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:27:16.946834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:17.530816 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:27:17.530816 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:27:17.639096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw'
[0m23:27:17.654865 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:27:17.654865 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:27:17.654865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:18.163174 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:27:18.164170 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:27:18.264228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:27:18.264228 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:27:18.264228 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:27:18.264228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:18.697889 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:27:18.697889 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:27:18.784946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:27:18.796045 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:27:18.796045 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:27:18.796045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:19.061482 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc35-0001-429b-0008-435e0001d102
[0m23:27:19.063838 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:27:19.063838 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:27:19.063838 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:27:19.063838 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:27:19.157678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34644810-0f22-4fa0-86e4-b052774856d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442FEE8550>]}
[0m23:27:19.162918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:19.163692 [info ] [MainThread]: 
[0m23:27:19.163692 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m23:27:19.163692 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m23:27:19.171547 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_product'
[0m23:27:19.171547 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m23:27:19.180933 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m23:27:19.180933 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 23:27:19.172617 => 23:27:19.180933
[0m23:27:19.180933 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m23:27:19.210795 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m23:27:19.210795 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m23:27:19.213624 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m23:27:19.214280 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:27:19.597113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:27:19.629529 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 23:27:19.186543 => 23:27:19.629529
[0m23:27:19.629529 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m23:27:19.713721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34644810-0f22-4fa0-86e4-b052774856d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442FB35240>]}
[0m23:27:19.713721 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_product ....................... [[32mSUCCESS 1[0m in 0.55s]
[0m23:27:19.713721 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m23:27:19.722740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:19.724599 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:27:19.725290 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:27:19.726441 [debug] [MainThread]: Connection 'model.practice.stg_product' was properly closed.
[0m23:27:19.726441 [info ] [MainThread]: 
[0m23:27:19.726441 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m23:27:19.731172 [debug] [MainThread]: Command end result
[0m23:27:19.738622 [info ] [MainThread]: 
[0m23:27:19.738622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:19.738622 [info ] [MainThread]: 
[0m23:27:19.738622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:27:19.738622 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:19.738622 after 3.89 seconds
[0m23:27:19.738622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002441D156920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442FB4C730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244301702B0>]}
[0m23:27:19.738622 [debug] [MainThread]: Flushing usage events
[0m23:28:05.009163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA58CD5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA58541E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA58542860>]}


============================== 23:28:05.010872 | 7edf202d-81d3-4f10-88a2-bb3f9e6c2f6f ==============================
[0m23:28:05.010872 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:28:05.010872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_product', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:28:05.510623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7edf202d-81d3-4f10-88a2-bb3f9e6c2f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA5850BDC0>]}
[0m23:28:05.577362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7edf202d-81d3-4f10-88a2-bb3f9e6c2f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6B4D5C00>]}
[0m23:28:05.577362 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:28:05.594237 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:28:05.684988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:28:05.684988 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\stg_country.sql
[0m23:28:05.794142 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_country' (models\staging\stg_country.sql) depends on a source named 'tp_source.COUNTRY' which was not found
[0m23:28:05.794142 [debug] [MainThread]: Command `dbt run` failed at 23:28:05.794142 after 0.84 seconds
[0m23:28:05.794142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA58CD5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6B6E7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6B804970>]}
[0m23:28:05.794142 [debug] [MainThread]: Flushing usage events
[0m23:29:12.682536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0635A6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C062E11DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C062E13A30>]}


============================== 23:29:12.686578 | 2e0d342d-7c7b-434d-b887-e95a157d657f ==============================
[0m23:29:12.686578 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:29:12.686578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_product', 'send_anonymous_usage_stats': 'True'}
[0m23:29:13.202705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e0d342d-7c7b-434d-b887-e95a157d657f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C062DDBD90>]}
[0m23:29:13.274237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e0d342d-7c7b-434d-b887-e95a157d657f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C062DDBF10>]}
[0m23:29:13.274237 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:29:13.291012 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:29:13.357564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:29:13.357564 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\stg_country.sql
[0m23:29:13.365080 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m23:29:13.641195 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_country' (models\staging\stg_country.sql) depends on a source named 'tp_source.COUNTRY' which was not found
[0m23:29:13.641195 [debug] [MainThread]: Command `dbt run` failed at 23:29:13.641195 after 1.04 seconds
[0m23:29:13.641195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0635A6920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C07611E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C076143C70>]}
[0m23:29:13.641195 [debug] [MainThread]: Flushing usage events
[0m23:29:27.657297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF77F57610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF777B1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF777B2E60>]}


============================== 23:29:27.666784 | 6a39af88-dc10-4844-9617-6c3995a25142 ==============================
[0m23:29:27.666784 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:29:27.666784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_product', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:28.150805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a39af88-dc10-4844-9617-6c3995a25142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7777BDC0>]}
[0m23:29:28.223821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a39af88-dc10-4844-9617-6c3995a25142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F789B40>]}
[0m23:29:28.223821 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:29:28.223821 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:29:28.304956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:29:28.304956 [debug] [MainThread]: Partial parsing: added file: practice://models\staging\stg_country.sql
[0m23:29:28.304956 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m23:29:28.573664 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:29:28.573664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a39af88-dc10-4844-9617-6c3995a25142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FD180D0>]}
[0m23:29:28.596690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a39af88-dc10-4844-9617-6c3995a25142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FC4D7B0>]}
[0m23:29:28.596690 [info ] [MainThread]: Found 4 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:29:28.596690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a39af88-dc10-4844-9617-6c3995a25142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FC4D690>]}
[0m23:29:28.596690 [info ] [MainThread]: 
[0m23:29:28.602698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:29:28.602698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:29:28.618844 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:29:28.618844 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:29:28.618844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:29.134302 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:29:29.140452 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:29:29.224673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:29:29.256921 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:29:29.256921 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:29:29.256921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:29.541646 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc37-0001-429a-0008-435e0001a9f6
[0m23:29:29.541646 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:29:29.541646 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:29:29.541646 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:29:29.541646 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:29:29.641208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:29:29.641208 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:29:29.641208 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:29:29.641208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:29.958002 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m23:29:29.958002 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:29:30.062372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_RIDE_SHARING_DB_raw)
[0m23:29:30.073603 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:29:30.073973 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:29:30.073973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:30.557096 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:29:30.557096 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:29:30.662952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a39af88-dc10-4844-9617-6c3995a25142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF0B0F70D0>]}
[0m23:29:30.670978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:30.670978 [info ] [MainThread]: 
[0m23:29:30.670978 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m23:29:30.670978 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m23:29:30.678999 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_product'
[0m23:29:30.679156 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m23:29:30.690151 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m23:29:30.691837 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 23:29:30.679684 => 23:29:30.691837
[0m23:29:30.691837 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m23:29:30.711468 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m23:29:30.711468 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m23:29:30.711468 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m23:29:30.711468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:29:31.141301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:31.173750 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 23:29:30.691837 => 23:29:31.173750
[0m23:29:31.173750 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m23:29:31.274497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a39af88-dc10-4844-9617-6c3995a25142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FEBE170>]}
[0m23:29:31.274497 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_product ....................... [[32mSUCCESS 1[0m in 0.60s]
[0m23:29:31.274497 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m23:29:31.274497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:31.274497 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:29:31.284105 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw' was properly closed.
[0m23:29:31.284105 [debug] [MainThread]: Connection 'model.practice.stg_product' was properly closed.
[0m23:29:31.286579 [info ] [MainThread]: 
[0m23:29:31.287743 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m23:29:31.290019 [debug] [MainThread]: Command end result
[0m23:29:31.300133 [info ] [MainThread]: 
[0m23:29:31.300133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:31.300133 [info ] [MainThread]: 
[0m23:29:31.300133 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:29:31.300133 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:31.300133 after 3.70 seconds
[0m23:29:31.300133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF77F57610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7F6CECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF7FD63D00>]}
[0m23:29:31.300133 [debug] [MainThread]: Flushing usage events
[0m23:31:11.029665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926465DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925CD37C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925CD17E0>]}


============================== 23:31:11.029665 | 55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb ==============================
[0m23:31:11.029665 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:31:11.029665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_country', 'send_anonymous_usage_stats': 'True'}
[0m23:31:11.502621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925C9BE20>]}
[0m23:31:11.585900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938C6A860>]}
[0m23:31:11.585900 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:31:11.585900 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:31:11.668145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:11.668145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:11.668145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:31:11.676067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938E9C0D0>]}
[0m23:31:11.689553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938E602B0>]}
[0m23:31:11.689553 [info ] [MainThread]: Found 4 models, 1 seed, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:31:11.689553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938E605B0>]}
[0m23:31:11.689553 [info ] [MainThread]: 
[0m23:31:11.689553 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:31:11.689553 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:31:11.706570 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:31:11.706570 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:31:11.706570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:12.186992 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:31:12.198606 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:31:12.299726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:31:12.303356 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:31:12.303356 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:31:12.303356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:12.738385 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc39-0001-429e-0008-435e0001bb0a
[0m23:31:12.738385 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:31:12.738385 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:31:12.738385 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:31:12.738385 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:31:12.819475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw)
[0m23:31:12.819475 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:31:12.819475 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:31:12.833200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:13.111359 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:31:13.111359 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:31:13.199551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:31:13.203753 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:31:13.203753 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:31:13.203753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:13.501764 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m23:31:13.503594 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:31:13.602906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F938E4FAC0>]}
[0m23:31:13.603510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:31:13.603510 [info ] [MainThread]: 
[0m23:31:13.615491 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m23:31:13.619285 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_country ............................ [RUN]
[0m23:31:13.619285 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m23:31:13.621799 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m23:31:13.623614 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m23:31:13.623614 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 23:31:13.621799 => 23:31:13.623614
[0m23:31:13.623614 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m23:31:13.657264 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m23:31:13.657264 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m23:31:13.657264 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_country
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m23:31:13.657264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:31:14.046742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:31:14.069284 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 23:31:13.634088 => 23:31:14.069284
[0m23:31:14.069284 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m23:31:14.170335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55226a4a-4438-4d0d-bc6e-5fef9bc5cdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F939226350>]}
[0m23:31:14.180851 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_country ....................... [[32mSUCCESS 1[0m in 0.55s]
[0m23:31:14.180851 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m23:31:14.186710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:14.186710 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:31:14.186710 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:31:14.186710 [debug] [MainThread]: Connection 'model.practice.stg_country' was properly closed.
[0m23:31:14.186710 [info ] [MainThread]: 
[0m23:31:14.186710 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m23:31:14.192502 [debug] [MainThread]: Command end result
[0m23:31:14.204061 [info ] [MainThread]: 
[0m23:31:14.204061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:14.204061 [info ] [MainThread]: 
[0m23:31:14.207775 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:31:14.209142 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:14.209142 after 3.23 seconds
[0m23:31:14.209142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926465DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9391D6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9391D6D40>]}
[0m23:31:14.209142 [debug] [MainThread]: Flushing usage events
[0m23:32:54.637181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA3A5975E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA39E01DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA39E02CE0>]}


============================== 23:32:54.637181 | f386b68d-b7ea-41ad-9eaa-f5bcb64bf37f ==============================
[0m23:32:54.637181 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:32:54.637181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_transaction', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:32:55.114978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f386b68d-b7ea-41ad-9eaa-f5bcb64bf37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA39DCBDC0>]}
[0m23:32:55.198233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f386b68d-b7ea-41ad-9eaa-f5bcb64bf37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA39DCBF10>]}
[0m23:32:55.198233 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:32:55.198233 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:32:55.280876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:55.280876 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\t_sources.yml
[0m23:32:55.559279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:32:55.564978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f386b68d-b7ea-41ad-9eaa-f5bcb64bf37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA4D320520>]}
[0m23:32:55.582951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f386b68d-b7ea-41ad-9eaa-f5bcb64bf37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA4D25D780>]}
[0m23:32:55.582951 [info ] [MainThread]: Found 4 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:32:55.582951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f386b68d-b7ea-41ad-9eaa-f5bcb64bf37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA4D25DC00>]}
[0m23:32:55.582951 [warn ] [MainThread]: The selection criterion 'stg_transaction' does not match any nodes
[0m23:32:55.582951 [info ] [MainThread]: 
[0m23:32:55.582951 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:32:55.582951 [debug] [MainThread]: Command end result
[0m23:32:55.590989 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:55.590989 after 1.02 seconds
[0m23:32:55.590989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA3A5975E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA39DCBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DA4D25DB40>]}
[0m23:32:55.590989 [debug] [MainThread]: Flushing usage events
[0m23:33:30.530348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C1DD5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C1640EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C1641840>]}


============================== 23:33:30.530348 | 3f5e4a47-9f30-43e2-9054-dc28caca431e ==============================
[0m23:33:30.530348 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:33:30.530348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_transaction', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:33:31.030066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5e4a47-9f30-43e2-9054-dc28caca431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C160BDC0>]}
[0m23:33:31.096861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5e4a47-9f30-43e2-9054-dc28caca431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C160BF10>]}
[0m23:33:31.096861 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:33:31.113709 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:33:31.194578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:31.194578 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m23:33:31.313716 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:33:31.323812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f5e4a47-9f30-43e2-9054-dc28caca431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D49680D0>]}
[0m23:33:31.330424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f5e4a47-9f30-43e2-9054-dc28caca431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D47D0A90>]}
[0m23:33:31.330424 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:33:31.330424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5e4a47-9f30-43e2-9054-dc28caca431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D47D17B0>]}
[0m23:33:31.338319 [info ] [MainThread]: 
[0m23:33:31.339845 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:33:31.341989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:33:31.348078 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:33:31.348078 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:33:31.348078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:32.299838 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:33:32.299838 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:33:32.414727 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:33:32.430045 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:33:32.430045 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:33:32.430045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:32.853566 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc3b-0001-429e-0008-435e0001bb76
[0m23:33:32.853566 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:33:32.853566 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:33:32.853566 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:33:32.853566 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:33:32.947828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:33:32.964207 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:33:32.964207 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:33:32.964207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:33.398034 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m23:33:33.398034 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:33:33.498313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5e4a47-9f30-43e2-9054-dc28caca431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D47BFF40>]}
[0m23:33:33.507414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:33:33.507414 [info ] [MainThread]: 
[0m23:33:33.513647 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m23:33:33.513647 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_transaction ........................ [RUN]
[0m23:33:33.513647 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_transaction'
[0m23:33:33.516898 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m23:33:33.522051 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m23:33:33.530051 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 23:33:33.516898 => 23:33:33.530051
[0m23:33:33.531383 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m23:33:33.553050 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m23:33:33.553050 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m23:33:33.553050 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_transaction
  
   as (
    

SELECT 
*
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m23:33:33.553050 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:33:34.101728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:33:34.131416 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 23:33:33.531383 => 23:33:34.131416
[0m23:33:34.131416 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m23:33:34.231220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5e4a47-9f30-43e2-9054-dc28caca431e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D4C795A0>]}
[0m23:33:34.231220 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_transaction ................... [[32mSUCCESS 1[0m in 0.72s]
[0m23:33:34.239735 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m23:33:34.239735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:34.239735 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:33:34.246719 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:33:34.247334 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m23:33:34.247334 [info ] [MainThread]: 
[0m23:33:34.247334 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m23:33:34.253369 [debug] [MainThread]: Command end result
[0m23:33:34.266396 [info ] [MainThread]: 
[0m23:33:34.266396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:34.266396 [info ] [MainThread]: 
[0m23:33:34.266396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:33:34.275905 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:34.275905 after 3.80 seconds
[0m23:33:34.275905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C1DD5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D4C7A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D4C7A290>]}
[0m23:33:34.275905 [debug] [MainThread]: Flushing usage events
[0m23:37:07.587109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3986375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397EA5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397EA6A10>]}


============================== 23:37:07.587852 | dc0e6bd7-12ed-49ff-84e9-6f699c8b3635 ==============================
[0m23:37:07.587852 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:37:07.587852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:37:08.070977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc0e6bd7-12ed-49ff-84e9-6f699c8b3635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397E6FDF0>]}
[0m23:37:08.137995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc0e6bd7-12ed-49ff-84e9-6f699c8b3635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F397E6FF10>]}
[0m23:37:08.137995 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:37:08.154734 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:37:08.244864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:37:08.244864 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_country.sql
[0m23:37:08.244864 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:37:08.354408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:37:08.371269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc0e6bd7-12ed-49ff-84e9-6f699c8b3635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB1B00D0>]}
[0m23:37:08.371269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc0e6bd7-12ed-49ff-84e9-6f699c8b3635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB038C70>]}
[0m23:37:08.382286 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:37:08.382286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc0e6bd7-12ed-49ff-84e9-6f699c8b3635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB0398D0>]}
[0m23:37:08.384931 [info ] [MainThread]: 
[0m23:37:08.384931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:37:08.388272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:37:08.398375 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:37:08.398375 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:37:08.398375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:09.008108 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:37:09.008108 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:37:09.138889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:37:09.154713 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:37:09.154713 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:37:09.154713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:09.704672 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc3f-0001-429a-0008-435e0001aada
[0m23:37:09.704672 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:37:09.704672 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:37:09.704672 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:37:09.704672 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:37:09.806431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:37:09.816465 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:37:09.816465 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:37:09.821077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:10.147528 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:37:10.155339 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:37:10.254657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc0e6bd7-12ed-49ff-84e9-6f699c8b3635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB01FF10>]}
[0m23:37:10.262642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:10.262642 [info ] [MainThread]: 
[0m23:37:10.270547 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:37:10.270547 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:37:10.276044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:37:10.277041 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:37:10.280813 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:37:10.287670 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:37:10.277041 => 23:37:10.287670
[0m23:37:10.289008 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:37:10.308567 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:37:10.308567 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:37:10.308567 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
	PRODUCT_ID,
	PAYMENT_MONTH,
	REVENUE_TYPE
	REVENUE,
	QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:37:10.308567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:10.640890 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc3f-0001-429e-0008-435e0001bbde
[0m23:37:10.640890 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 1
invalid identifier 'PRODUCT_ID'
[0m23:37:10.645418 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:37:10.289798 => 23:37:10.640890
[0m23:37:10.645418 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:37:10.738500 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 1
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:37:10.738500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc0e6bd7-12ed-49ff-84e9-6f699c8b3635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB568340>]}
[0m23:37:10.738500 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_customers ................. [[31mERROR[0m in 0.47s]
[0m23:37:10.738500 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:37:10.749512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:10.749512 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:37:10.749512 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:37:10.754067 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:37:10.754469 [info ] [MainThread]: 
[0m23:37:10.754469 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m23:37:10.756623 [debug] [MainThread]: Command end result
[0m23:37:10.761204 [info ] [MainThread]: 
[0m23:37:10.761204 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:37:10.770691 [info ] [MainThread]: 
[0m23:37:10.770691 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 1
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:37:10.770691 [info ] [MainThread]: 
[0m23:37:10.770691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:37:10.770691 [debug] [MainThread]: Command `dbt run` failed at 23:37:10.770691 after 3.24 seconds
[0m23:37:10.770691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3986375E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB56B040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AB568CA0>]}
[0m23:37:10.775792 [debug] [MainThread]: Flushing usage events
[0m23:37:41.360822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6776920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB5FE1DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB5FE3A30>]}


============================== 23:37:41.360822 | 34ee56e4-166f-48ce-8c89-38b337b96726 ==============================
[0m23:37:41.360822 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:37:41.360822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:37:41.886381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34ee56e4-166f-48ce-8c89-38b337b96726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB5FABD90>]}
[0m23:37:41.969530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34ee56e4-166f-48ce-8c89-38b337b96726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB5FABF10>]}
[0m23:37:41.984067 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:37:41.986430 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:37:42.079763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:37:42.079763 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:37:42.203209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:37:42.219987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34ee56e4-166f-48ce-8c89-38b337b96726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC92F00D0>]}
[0m23:37:42.232494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34ee56e4-166f-48ce-8c89-38b337b96726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9178B50>]}
[0m23:37:42.232494 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:37:42.232494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ee56e4-166f-48ce-8c89-38b337b96726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9179870>]}
[0m23:37:42.235204 [info ] [MainThread]: 
[0m23:37:42.236149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:37:42.237794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:37:42.246306 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:37:42.246306 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:37:42.246306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:42.837399 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:37:42.853151 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:37:42.956109 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m23:37:42.970632 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:37:42.970632 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:37:42.970632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:43.403197 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:37:43.411108 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:37:43.491174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:37:43.499208 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:37:43.503035 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:37:43.503755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:43.854149 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc3f-0001-429e-0008-435e0001bbea
[0m23:37:43.854149 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:37:43.854149 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:37:43.854149 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:37:43.863748 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:37:43.955443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ee56e4-166f-48ce-8c89-38b337b96726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC915EB30>]}
[0m23:37:43.961361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:37:43.961361 [info ] [MainThread]: 
[0m23:37:43.969616 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:37:43.969616 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:37:43.969616 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:37:43.969616 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:37:43.976306 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:37:43.985937 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:37:43.969616 => 23:37:43.985317
[0m23:37:43.986746 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:37:44.006523 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:37:44.006523 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:37:44.006523 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
	PRODUCT_ID,
	PAYMENT_MONTH,
	REVENUE_TYPE,
	REVENUE,
	QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:37:44.006523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:37:44.453912 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc3f-0001-429b-0008-435e0001d246
[0m23:37:44.453912 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 1
invalid identifier 'PRODUCT_ID'
[0m23:37:44.453912 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:37:43.986746 => 23:37:44.453912
[0m23:37:44.453912 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:37:44.554506 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 1
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:37:44.554506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ee56e4-166f-48ce-8c89-38b337b96726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9570160>]}
[0m23:37:44.554506 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_customers ................. [[31mERROR[0m in 0.58s]
[0m23:37:44.554506 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:37:44.569445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:44.569445 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:37:44.569445 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:37:44.569445 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:37:44.569445 [info ] [MainThread]: 
[0m23:37:44.571797 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m23:37:44.573401 [debug] [MainThread]: Command end result
[0m23:37:44.576995 [info ] [MainThread]: 
[0m23:37:44.576995 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:37:44.576995 [info ] [MainThread]: 
[0m23:37:44.586035 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 1
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:37:44.586035 [info ] [MainThread]: 
[0m23:37:44.586035 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:37:44.586035 [debug] [MainThread]: Command `dbt run` failed at 23:37:44.586035 after 3.29 seconds
[0m23:37:44.586035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6776920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9570880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9573130>]}
[0m23:37:44.586035 [debug] [MainThread]: Flushing usage events
[0m23:38:36.495528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001778F8D7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001778F141E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001778F142860>]}


============================== 23:38:36.500983 | f5bd96f5-d6c0-479e-a893-66b099afbfcb ==============================
[0m23:38:36.500983 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:38:36.500983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m23:38:37.124246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5bd96f5-d6c0-479e-a893-66b099afbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001778F10BDC0>]}
[0m23:38:37.218785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5bd96f5-d6c0-479e-a893-66b099afbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A20DA080>]}
[0m23:38:37.218785 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:38:37.233756 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:38:37.324049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:37.324049 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:38:37.444817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:38:37.450950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5bd96f5-d6c0-479e-a893-66b099afbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A24540D0>]}
[0m23:38:37.460508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5bd96f5-d6c0-479e-a893-66b099afbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A22D8130>]}
[0m23:38:37.461459 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:38:37.462195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5bd96f5-d6c0-479e-a893-66b099afbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A22D8B20>]}
[0m23:38:37.462195 [info ] [MainThread]: 
[0m23:38:37.462195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:38:37.465909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:38:37.468502 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:38:37.468502 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:38:37.468502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:38.085874 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:38:38.085874 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:38:38.185305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m23:38:38.201331 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:38:38.201331 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:38:38.201331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:38.640179 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:38:38.640179 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:38:38.718163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:38:38.718163 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:38:38.718163 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:38:38.718163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:39.118579 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc40-0001-429b-0008-435e0001d24e
[0m23:38:39.118579 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:38:39.118579 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:38:39.118579 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:38:39.118579 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:38:39.227725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5bd96f5-d6c0-479e-a893-66b099afbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A22BFFA0>]}
[0m23:38:39.227725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:38:39.234161 [info ] [MainThread]: 
[0m23:38:39.235194 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:38:39.235194 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:38:39.247101 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:38:39.247101 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:38:39.251574 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:38:39.251574 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:38:39.247101 => 23:38:39.251574
[0m23:38:39.251574 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:38:39.286212 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:38:39.286212 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:38:39.286212 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:38:39.286212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:38:39.608895 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc40-0001-429a-0008-435e0001aae6
[0m23:38:39.608895 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'PRODUCT_ID'
[0m23:38:39.608895 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:38:39.251574 => 23:38:39.608895
[0m23:38:39.608895 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:38:39.701836 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:38:39.701836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5bd96f5-d6c0-479e-a893-66b099afbfcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A26D0100>]}
[0m23:38:39.701836 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_customers ................. [[31mERROR[0m in 0.46s]
[0m23:38:39.712847 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:38:39.717406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:39.717406 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:38:39.717406 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:38:39.717406 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:38:39.717406 [info ] [MainThread]: 
[0m23:38:39.717406 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m23:38:39.722632 [debug] [MainThread]: Command end result
[0m23:38:39.727018 [info ] [MainThread]: 
[0m23:38:39.733695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:38:39.735314 [info ] [MainThread]: 
[0m23:38:39.735314 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:38:39.735314 [info ] [MainThread]: 
[0m23:38:39.735314 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:38:39.735314 [debug] [MainThread]: Command `dbt run` failed at 23:38:39.735314 after 3.31 seconds
[0m23:38:39.735314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001778F8D7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A26D0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177A26D3190>]}
[0m23:38:39.735314 [debug] [MainThread]: Flushing usage events
[0m23:39:59.038785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002584B7F75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002584B061DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002584B062CE0>]}


============================== 23:39:59.047523 | 45dfca50-97b5-406f-ab3e-fd94c9e6e539 ==============================
[0m23:39:59.047523 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:39:59.047610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:39:59.558548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45dfca50-97b5-406f-ab3e-fd94c9e6e539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002584B02BDC0>]}
[0m23:39:59.647511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45dfca50-97b5-406f-ab3e-fd94c9e6e539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002584B02BF10>]}
[0m23:39:59.647511 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:39:59.647511 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:39:59.743284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:39:59.743284 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:39:59.864040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:39:59.864040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45dfca50-97b5-406f-ab3e-fd94c9e6e539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E3340D0>]}
[0m23:39:59.883007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45dfca50-97b5-406f-ab3e-fd94c9e6e539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E1F4BE0>]}
[0m23:39:59.883007 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:39:59.883007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45dfca50-97b5-406f-ab3e-fd94c9e6e539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E1F5A20>]}
[0m23:39:59.883007 [info ] [MainThread]: 
[0m23:39:59.883007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:59.883007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:39:59.897641 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:39:59.897641 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:39:59.897641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:00.380642 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:40:00.380642 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:40:00.464254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:40:00.481316 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:40:00.481316 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:40:00.481316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:00.895051 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc42-0001-429b-0008-435e0001d25e
[0m23:40:00.895051 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:40:00.897411 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:40:00.897946 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:40:00.897946 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:40:00.992995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:40:00.998234 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:40:00.998234 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:40:00.998234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:01.266779 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:40:01.275943 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:40:01.365154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45dfca50-97b5-406f-ab3e-fd94c9e6e539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E1DAAA0>]}
[0m23:40:01.376766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:01.376766 [info ] [MainThread]: 
[0m23:40:01.381628 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:40:01.381628 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:40:01.392044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:40:01.393149 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:40:01.397593 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:40:01.397593 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:40:01.393149 => 23:40:01.397593
[0m23:40:01.397593 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:40:01.430931 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:40:01.430931 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:40:01.430931 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:40:01.430931 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:01.865539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc42-0001-429e-0008-435e0001bbfe
[0m23:40:01.865539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'PAYMENT_MONTH'
[0m23:40:01.865539 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:40:01.397593 => 23:40:01.865539
[0m23:40:01.865539 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:40:01.964199 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:40:01.965137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45dfca50-97b5-406f-ab3e-fd94c9e6e539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E728340>]}
[0m23:40:01.965137 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_customers ................. [[31mERROR[0m in 0.58s]
[0m23:40:01.965137 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:40:01.976486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:01.976486 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:40:01.976486 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:40:01.976486 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:40:01.980672 [info ] [MainThread]: 
[0m23:40:01.980672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m23:40:01.982822 [debug] [MainThread]: Command end result
[0m23:40:01.987251 [info ] [MainThread]: 
[0m23:40:01.987251 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:40:01.987251 [info ] [MainThread]: 
[0m23:40:01.987251 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:40:01.987251 [info ] [MainThread]: 
[0m23:40:01.996295 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:40:01.996890 [debug] [MainThread]: Command `dbt run` failed at 23:40:01.996890 after 3.01 seconds
[0m23:40:01.996890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002584B7F75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E72B040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002585E728CD0>]}
[0m23:40:01.996890 [debug] [MainThread]: Flushing usage events
[0m23:40:33.273869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A69C5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A6230EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A6231840>]}


============================== 23:40:33.279370 | bfbc954b-dea1-453e-a779-cbf3b7c39135 ==============================
[0m23:40:33.279370 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:40:33.279370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m23:40:33.745902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfbc954b-dea1-453e-a779-cbf3b7c39135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A61FBDC0>]}
[0m23:40:33.828997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfbc954b-dea1-453e-a779-cbf3b7c39135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A61FBF10>]}
[0m23:40:33.828997 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:40:33.846014 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:40:33.931673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:40:33.931673 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:40:34.045939 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:40:34.056942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfbc954b-dea1-453e-a779-cbf3b7c39135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B95480D0>]}
[0m23:40:34.062642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfbc954b-dea1-453e-a779-cbf3b7c39135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B93C8A90>]}
[0m23:40:34.062642 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:40:34.062642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfbc954b-dea1-453e-a779-cbf3b7c39135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B93C97B0>]}
[0m23:40:34.072159 [info ] [MainThread]: 
[0m23:40:34.072159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:40:34.075841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:40:34.080259 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:40:34.080259 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:40:34.080259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:34.606341 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:40:34.612864 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:40:34.696135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:40:34.696135 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:40:34.696135 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:40:34.696135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:34.990086 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc42-0001-429a-0008-435e0001ab02
[0m23:40:34.990086 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:40:34.990086 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:40:34.990086 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:40:34.990086 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:40:35.080728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw)
[0m23:40:35.080728 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw"
[0m23:40:35.080728 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw"} */
show terse objects in RIDE_SHARING_DB.raw limit 10000
[0m23:40:35.093824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:35.382104 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:40:35.382104 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw: Close
[0m23:40:35.479152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:40:35.486452 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:40:35.495926 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:40:35.497126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:36.163460 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m23:40:36.175067 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:40:36.263211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfbc954b-dea1-453e-a779-cbf3b7c39135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B93AE710>]}
[0m23:40:36.263211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:36.271729 [info ] [MainThread]: 
[0m23:40:36.281622 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:40:36.283454 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customers .................................. [RUN]
[0m23:40:36.283454 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:40:36.283454 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:40:36.295510 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:40:36.295510 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:40:36.283454 => 23:40:36.295510
[0m23:40:36.295510 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:40:36.316678 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:40:36.327192 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:40:36.327192 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw.stg_customers
  
   as (
    SELECT 
    "CUSTOMER_ID",
    "PRODUCT_ID",
    "PAYMENT_MONTH",
    "REVENUE_TYPE",
    "REVENUE",
    "QUANTITY",
    "COMPANIES"
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:40:36.327192 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:36.749374 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc42-0001-429a-0008-435e0001ab0a
[0m23:40:36.749374 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'PRODUCT_ID'
[0m23:40:36.749374 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:40:36.299605 => 23:40:36.749374
[0m23:40:36.749374 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:40:36.846910 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:40:36.846910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfbc954b-dea1-453e-a779-cbf3b7c39135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B98A12D0>]}
[0m23:40:36.846910 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customers ......................... [[31mERROR[0m in 0.56s]
[0m23:40:36.859006 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:40:36.862744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:36.862744 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:40:36.862744 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:40:36.862744 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:40:36.862744 [info ] [MainThread]: 
[0m23:40:36.862744 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m23:40:36.870791 [debug] [MainThread]: Command end result
[0m23:40:36.884093 [info ] [MainThread]: 
[0m23:40:36.884093 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:40:36.884093 [info ] [MainThread]: 
[0m23:40:36.884093 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'PRODUCT_ID'
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:40:36.884093 [info ] [MainThread]: 
[0m23:40:36.884093 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:40:36.884093 [debug] [MainThread]: Command `dbt run` failed at 23:40:36.884093 after 3.67 seconds
[0m23:40:36.884093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A69C5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B9563F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B93C8550>]}
[0m23:40:36.884093 [debug] [MainThread]: Flushing usage events
[0m23:42:25.024784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018730C07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018730471E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018730472860>]}


============================== 23:42:25.024784 | 9d2c7ccb-640a-41d4-8275-d3ef01ff04a8 ==============================
[0m23:42:25.024784 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:42:25.024784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_transaction', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:42:25.557958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d2c7ccb-640a-41d4-8275-d3ef01ff04a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001873043BDC0>]}
[0m23:42:25.624420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d2c7ccb-640a-41d4-8275-d3ef01ff04a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018743409C00>]}
[0m23:42:25.624420 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:42:25.640701 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:42:25.729889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:42:25.729889 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m23:42:25.729889 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:42:25.841339 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  expected token ',', got 'materialized'
    line 3
      materialized='view'
[0m23:42:25.841339 [debug] [MainThread]: Command `dbt run` failed at 23:42:25.841339 after 0.88 seconds
[0m23:42:25.841339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018730C07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187437585B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018743758340>]}
[0m23:42:25.841339 [debug] [MainThread]: Flushing usage events
[0m23:43:28.255413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5C8F7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5C161E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5C162860>]}


============================== 23:43:28.255413 | d77350f8-cbb1-4f78-a0af-4ee170949e10 ==============================
[0m23:43:28.255413 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:43:28.267971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m23:43:28.771835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd77350f8-cbb1-4f78-a0af-4ee170949e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5C12BDC0>]}
[0m23:43:28.866150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd77350f8-cbb1-4f78-a0af-4ee170949e10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F0F6080>]}
[0m23:43:28.866150 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:43:28.871828 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:43:28.954000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:43:28.954000 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m23:43:28.954000 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:43:29.055204 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  expected token ',', got 'materialized'
    line 3
      materialized='view'
[0m23:43:29.068315 [debug] [MainThread]: Command `dbt run` failed at 23:43:29.068315 after 0.87 seconds
[0m23:43:29.068315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5C8F7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F44C5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6F44C340>]}
[0m23:43:29.068315 [debug] [MainThread]: Flushing usage events
[0m23:43:47.554595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0DEB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0D711DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0D713A30>]}


============================== 23:43:47.568139 | 9f1a1d70-8f42-43d1-a091-b2861076caa4 ==============================
[0m23:43:47.568139 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:43:47.568139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:43:48.054495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f1a1d70-8f42-43d1-a091-b2861076caa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0D6DBD90>]}
[0m23:43:48.121049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f1a1d70-8f42-43d1-a091-b2861076caa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0D6DBF10>]}
[0m23:43:48.121049 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:43:48.137831 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:43:48.205383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:43:48.205383 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m23:43:48.205383 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:43:48.321150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:43:48.337436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f1a1d70-8f42-43d1-a091-b2861076caa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD20A340D0>]}
[0m23:43:48.350404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f1a1d70-8f42-43d1-a091-b2861076caa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD208B8C10>]}
[0m23:43:48.350404 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:43:48.350404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1a1d70-8f42-43d1-a091-b2861076caa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD208B9870>]}
[0m23:43:48.354631 [info ] [MainThread]: 
[0m23:43:48.354631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:43:48.354631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:43:48.366228 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:43:48.366228 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:43:48.366228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:48.971917 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:43:48.986043 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:43:49.088928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m23:43:49.104673 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:43:49.104673 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:43:49.104673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:49.704392 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m23:43:49.704876 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:43:49.806018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:43:49.806018 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:43:49.806018 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:43:49.806018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:50.235849 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc45-0001-429b-0008-435e0001d26e
[0m23:43:50.237809 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:43:50.238587 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:43:50.238587 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:43:50.238587 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:43:50.331886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1a1d70-8f42-43d1-a091-b2861076caa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD20A21840>]}
[0m23:43:50.338677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:43:50.338677 [info ] [MainThread]: 
[0m23:43:50.347690 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m23:43:50.349193 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_transaction ........................ [RUN]
[0m23:43:50.349847 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_transaction'
[0m23:43:50.349847 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m23:43:50.354780 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m23:43:50.354780 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 23:43:50.349847 => 23:43:50.354780
[0m23:43:50.354780 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m23:43:50.388394 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m23:43:50.388394 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m23:43:50.388394 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,  -- Check if this matches Snowflake
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m23:43:50.388394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:43:50.839720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:43:50.871183 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 23:43:50.363787 => 23:43:50.871183
[0m23:43:50.871183 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m23:43:50.972874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1a1d70-8f42-43d1-a091-b2861076caa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2089F640>]}
[0m23:43:50.972874 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_transaction ................... [[32mSUCCESS 1[0m in 0.62s]
[0m23:43:50.972874 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m23:43:50.983480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:50.983480 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:43:50.983480 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:43:50.987439 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m23:43:50.987730 [info ] [MainThread]: 
[0m23:43:50.987730 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m23:43:50.990196 [debug] [MainThread]: Command end result
[0m23:43:50.994280 [info ] [MainThread]: 
[0m23:43:50.994280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:43:50.994280 [info ] [MainThread]: 
[0m23:43:50.994280 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:43:51.004100 [debug] [MainThread]: Command `dbt run` succeeded at 23:43:51.004100 after 3.49 seconds
[0m23:43:51.004100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0DEB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD208B8A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD208B89A0>]}
[0m23:43:51.004100 [debug] [MainThread]: Flushing usage events
[0m23:47:45.706104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EC7F7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EC051E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EC052860>]}


============================== 23:47:45.706952 | 2e8f5d8e-80dd-455b-8f5b-2c4bb8891342 ==============================
[0m23:47:45.706952 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:47:45.706952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_transaction', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:47:46.211593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e8f5d8e-80dd-455b-8f5b-2c4bb8891342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EC01BDC0>]}
[0m23:47:46.294981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e8f5d8e-80dd-455b-8f5b-2c4bb8891342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FE025C00>]}
[0m23:47:46.294981 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:47:46.311814 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:47:46.395028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:47:46.395028 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m23:47:46.495033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:47:46.511724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e8f5d8e-80dd-455b-8f5b-2c4bb8891342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FF36C0D0>]}
[0m23:47:46.524863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e8f5d8e-80dd-455b-8f5b-2c4bb8891342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FF1F8130>]}
[0m23:47:46.524863 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:47:46.526746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e8f5d8e-80dd-455b-8f5b-2c4bb8891342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FF1F8B20>]}
[0m23:47:46.528180 [info ] [MainThread]: 
[0m23:47:46.530168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:47:46.530254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:47:46.545157 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:47:46.545157 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:47:46.545157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:47.045759 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:47:47.062369 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:47:47.155407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m23:47:47.161783 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:47:47.161783 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:47:47.161783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:47.628360 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:47:47.628360 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:47:47.711825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:47:47.711825 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:47:47.711825 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:47:47.711825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:48.012682 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc49-0001-429e-0008-435e0001bc26
[0m23:47:48.012682 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:47:48.012682 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:47:48.012682 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:47:48.012682 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:47:48.106389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e8f5d8e-80dd-455b-8f5b-2c4bb8891342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FF1DFFA0>]}
[0m23:47:48.112449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:47:48.112449 [info ] [MainThread]: 
[0m23:47:48.112449 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m23:47:48.112449 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_transaction ........................ [RUN]
[0m23:47:48.122688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_transaction'
[0m23:47:48.122688 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m23:47:48.129570 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m23:47:48.129570 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 23:47:48.124063 => 23:47:48.129570
[0m23:47:48.129570 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m23:47:48.163115 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m23:47:48.163115 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m23:47:48.163115 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m23:47:48.163115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:47:48.507920 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc49-0001-429e-0008-435e0001bc2a
[0m23:47:48.507920 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 4 unexpected 'REVENUE_TYPE'.
[0m23:47:48.512345 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 23:47:48.129570 => 23:47:48.512345
[0m23:47:48.512345 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m23:47:48.613551 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 4 unexpected 'REVENUE_TYPE'.
  compiled Code at target\run\practice\models\staging\stg_transaction.sql
[0m23:47:48.613551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e8f5d8e-80dd-455b-8f5b-2c4bb8891342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FF5E0100>]}
[0m23:47:48.613551 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_transaction ............... [[31mERROR[0m in 0.50s]
[0m23:47:48.626061 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m23:47:48.628961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:48.628961 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:47:48.628961 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:47:48.628961 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m23:47:48.628961 [info ] [MainThread]: 
[0m23:47:48.628961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m23:47:48.636920 [debug] [MainThread]: Command end result
[0m23:47:48.646185 [info ] [MainThread]: 
[0m23:47:48.646185 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:47:48.646185 [info ] [MainThread]: 
[0m23:47:48.646185 [error] [MainThread]:   Database Error in model stg_transaction (models\staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 4 unexpected 'REVENUE_TYPE'.
  compiled Code at target\run\practice\models\staging\stg_transaction.sql
[0m23:47:48.646185 [info ] [MainThread]: 
[0m23:47:48.646185 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:47:48.646185 [debug] [MainThread]: Command `dbt run` failed at 23:47:48.646185 after 3.02 seconds
[0m23:47:48.646185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204EC7F7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FF5E0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204FF5E3490>]}
[0m23:47:48.646185 [debug] [MainThread]: Flushing usage events
[0m23:47:58.248425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444FC36920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444F4A1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444F4A2E60>]}


============================== 23:47:58.248425 | f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6 ==============================
[0m23:47:58.248425 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:47:58.252930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m23:47:58.727813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444F46BDC0>]}
[0m23:47:58.794445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462446170>]}
[0m23:47:58.811026 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:47:58.811026 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:47:58.904905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:47:58.904905 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m23:47:59.011180 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:47:59.028050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244627BC0D0>]}
[0m23:47:59.028050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462648BE0>]}
[0m23:47:59.040157 [info ] [MainThread]: Found 1 seed, 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:47:59.041448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462649840>]}
[0m23:47:59.042301 [info ] [MainThread]: 
[0m23:47:59.044190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:47:59.045622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:47:59.056220 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:47:59.056220 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:47:59.056220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:59.496289 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m23:47:59.496289 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:47:59.611241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:47:59.627227 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:47:59.627227 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:47:59.627227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:00.143998 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc4a-0001-429a-0008-435e0001ab4e
[0m23:48:00.143998 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:48:00.151104 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:48:00.151104 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:48:00.151104 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:48:00.245075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:48:00.245075 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:48:00.245075 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:48:00.245075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:00.562272 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:48:00.578180 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:48:00.662288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446262FFD0>]}
[0m23:48:00.671347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:00.671347 [info ] [MainThread]: 
[0m23:48:00.678169 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m23:48:00.678169 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_transaction ........................ [RUN]
[0m23:48:00.688282 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_transaction'
[0m23:48:00.688282 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m23:48:00.698449 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m23:48:00.698449 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 23:48:00.688282 => 23:48:00.698449
[0m23:48:00.698449 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m23:48:00.729118 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m23:48:00.729118 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m23:48:00.729118 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m23:48:00.729118 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:48:01.178983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:48:01.194723 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 23:48:00.698449 => 23:48:01.194723
[0m23:48:01.194723 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m23:48:01.292737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f78e5e4e-a2a3-4880-9eb1-8337bc5d8dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462B1E6B0>]}
[0m23:48:01.295452 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_transaction ................... [[32mSUCCESS 1[0m in 0.61s]
[0m23:48:01.295452 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m23:48:01.295452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:01.295452 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:48:01.295452 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:48:01.295452 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m23:48:01.295452 [info ] [MainThread]: 
[0m23:48:01.295452 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m23:48:01.308291 [debug] [MainThread]: Command end result
[0m23:48:01.317749 [info ] [MainThread]: 
[0m23:48:01.317749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:01.319886 [info ] [MainThread]: 
[0m23:48:01.319886 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:48:01.319886 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:01.319886 after 3.14 seconds
[0m23:48:01.319886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444FC36920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462B1C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024462B1C850>]}
[0m23:48:01.319886 [debug] [MainThread]: Flushing usage events
[0m23:53:13.549638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E1457610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E0CC1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E0CC2860>]}


============================== 23:53:13.549638 | 6a5cae7f-e28b-49be-8e95-63344693c308 ==============================
[0m23:53:13.549638 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:53:13.549638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_product', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:14.060292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a5cae7f-e28b-49be-8e95-63344693c308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E0C8BDC0>]}
[0m23:53:14.149317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a5cae7f-e28b-49be-8e95-63344693c308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F2C86080>]}
[0m23:53:14.149317 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:53:14.149317 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:53:14.247607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:14.255614 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m23:53:14.362811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m23:53:14.366384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a5cae7f-e28b-49be-8e95-63344693c308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F3F940D0>]}
[0m23:53:14.383706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a5cae7f-e28b-49be-8e95-63344693c308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F3E58130>]}
[0m23:53:14.383706 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:53:14.383706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a5cae7f-e28b-49be-8e95-63344693c308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F3E58B20>]}
[0m23:53:14.383706 [info ] [MainThread]: 
[0m23:53:14.383706 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:53:14.383706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:53:14.399614 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:53:14.399614 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:53:14.399614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:15.042573 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:53:15.042573 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:53:15.133598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m23:53:15.149881 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:53:15.161900 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:53:15.161900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:15.553147 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc4f-0001-429b-0008-435e0001d302
[0m23:53:15.553147 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:53:15.553147 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:53:15.553147 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:53:15.553147 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:53:15.649647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m23:53:15.649647 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:53:15.649647 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:53:15.649647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:16.526939 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m23:53:16.532688 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:53:16.633519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a5cae7f-e28b-49be-8e95-63344693c308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F3FF7DC0>]}
[0m23:53:16.633519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:16.646042 [info ] [MainThread]: 
[0m23:53:16.649776 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m23:53:16.649776 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m23:53:16.653711 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_product'
[0m23:53:16.653711 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m23:53:16.658122 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m23:53:16.658122 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 23:53:16.654586 => 23:53:16.658122
[0m23:53:16.665580 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m23:53:16.685899 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m23:53:16.685899 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m23:53:16.685899 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m23:53:16.685899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:53:17.100162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:53:17.132417 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 23:53:16.666702 => 23:53:17.132417
[0m23:53:17.132417 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m23:53:17.232692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a5cae7f-e28b-49be-8e95-63344693c308', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F42FD600>]}
[0m23:53:17.233677 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_product ....................... [[32mSUCCESS 1[0m in 0.58s]
[0m23:53:17.233677 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m23:53:17.233677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:17.233677 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:53:17.242197 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m23:53:17.244294 [debug] [MainThread]: Connection 'model.practice.stg_product' was properly closed.
[0m23:53:17.245226 [info ] [MainThread]: 
[0m23:53:17.245226 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m23:53:17.248872 [debug] [MainThread]: Command end result
[0m23:53:17.259849 [info ] [MainThread]: 
[0m23:53:17.259849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:17.262517 [info ] [MainThread]: 
[0m23:53:17.262517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:53:17.262517 [debug] [MainThread]: Command `dbt run` succeeded at 23:53:17.262517 after 3.77 seconds
[0m23:53:17.262517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E1457610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F42FE470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2F42FE2F0>]}
[0m23:53:17.262517 [debug] [MainThread]: Flushing usage events
[0m23:57:05.890685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFAFB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA821DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA823A30>]}


============================== 23:57:05.890685 | fb9e3398-bca1-48f7-b7cd-aa02a5b2972a ==============================
[0m23:57:05.890685 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:57:05.890685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:06.407119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb9e3398-bca1-48f7-b7cd-aa02a5b2972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA7EBD90>]}
[0m23:57:06.490436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb9e3398-bca1-48f7-b7cd-aa02a5b2972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA7EBF10>]}
[0m23:57:06.490436 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:57:06.490436 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:57:06.589260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:57:06.589260 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:57:06.704184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:57:06.707384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb9e3398-bca1-48f7-b7cd-aa02a5b2972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DB640D0>]}
[0m23:57:06.720901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb9e3398-bca1-48f7-b7cd-aa02a5b2972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DA28B50>]}
[0m23:57:06.721659 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:57:06.721659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9e3398-bca1-48f7-b7cd-aa02a5b2972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DA29870>]}
[0m23:57:06.725044 [info ] [MainThread]: 
[0m23:57:06.725044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:06.725044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:57:06.740948 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:57:06.740948 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:57:06.740948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:07.383980 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:57:07.383980 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:57:07.536001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m23:57:07.557400 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:57:07.557400 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:57:07.557400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:07.982272 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:57:07.982272 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:57:08.074749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:57:08.074749 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:57:08.074749 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:57:08.074749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:08.521452 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc53-0001-429b-0008-435e0001d32a
[0m23:57:08.524871 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:57:08.524871 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:57:08.524871 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:57:08.524871 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:57:08.617440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9e3398-bca1-48f7-b7cd-aa02a5b2972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DA0EB90>]}
[0m23:57:08.617440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:08.623852 [info ] [MainThread]: 
[0m23:57:08.624697 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:57:08.634818 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:57:08.636632 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:57:08.636632 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:57:08.642134 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:57:08.642134 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:57:08.640255 => 23:57:08.642134
[0m23:57:08.642134 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:57:08.674292 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:57:08.674292 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:57:08.674292 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:57:08.674292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:57:09.058182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:57:09.090468 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:57:08.642134 => 23:57:09.090468
[0m23:57:09.090468 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:57:09.458112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb9e3398-bca1-48f7-b7cd-aa02a5b2972a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DB886D0>]}
[0m23:57:09.458112 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.82s]
[0m23:57:09.458112 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:57:09.458112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:09.458112 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:57:09.458112 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:57:09.458112 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:57:09.458112 [info ] [MainThread]: 
[0m23:57:09.458112 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m23:57:09.472598 [debug] [MainThread]: Command end result
[0m23:57:09.476929 [info ] [MainThread]: 
[0m23:57:09.476929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:09.476929 [info ] [MainThread]: 
[0m23:57:09.476929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:57:09.476929 [debug] [MainThread]: Command `dbt run` succeeded at 23:57:09.476929 after 3.64 seconds
[0m23:57:09.476929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFAFB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DA289A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8DB886D0>]}
[0m23:57:09.476929 [debug] [MainThread]: Flushing usage events
[0m23:57:43.890225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021366C57610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213664C1E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213664C2860>]}


============================== 23:57:43.890225 | 82ecd750-f221-499d-b17f-31eaa6e9845a ==============================
[0m23:57:43.890225 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:57:43.890225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:57:44.429043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82ecd750-f221-499d-b17f-31eaa6e9845a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136648BDC0>]}
[0m23:57:44.522176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82ecd750-f221-499d-b17f-31eaa6e9845a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021379459C00>]}
[0m23:57:44.522176 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m23:57:44.530132 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:57:44.620754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:57:44.628806 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m23:57:44.739408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m23:57:44.746821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82ecd750-f221-499d-b17f-31eaa6e9845a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213797D00D0>]}
[0m23:57:44.756535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ecd750-f221-499d-b17f-31eaa6e9845a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021379658130>]}
[0m23:57:44.756535 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m23:57:44.756535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ecd750-f221-499d-b17f-31eaa6e9845a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021379658B20>]}
[0m23:57:44.767640 [info ] [MainThread]: 
[0m23:57:44.767640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:44.767640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m23:57:44.783272 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m23:57:44.783272 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m23:57:44.783272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:45.290157 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m23:57:45.290157 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m23:57:45.391303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m23:57:45.406399 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m23:57:45.406399 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m23:57:45.406399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:45.722664 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m23:57:45.723557 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m23:57:45.856649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m23:57:45.856649 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m23:57:45.856649 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m23:57:45.856649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:46.133149 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc53-0001-429b-0008-435e0001d336
[0m23:57:46.133149 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:57:46.133149 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:57:46.137184 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:57:46.139303 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m23:57:46.223731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ecd750-f221-499d-b17f-31eaa6e9845a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137963E710>]}
[0m23:57:46.223731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:46.223731 [info ] [MainThread]: 
[0m23:57:46.240605 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m23:57:46.240605 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m23:57:46.240605 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_customers'
[0m23:57:46.240605 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m23:57:46.259911 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m23:57:46.259911 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 23:57:46.240605 => 23:57:46.259911
[0m23:57:46.259911 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m23:57:46.290468 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m23:57:46.290468 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m23:57:46.290468 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
    REGEXP_REPLACE(CUSTOMERNAME, '\\(.*?\\)', '') AS CUST  -- Remove text inside ()

FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m23:57:46.290468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:57:46.707609 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc53-0001-429e-0008-435e0001bcc6
[0m23:57:46.707609 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 18 unexpected '('.
[0m23:57:46.707609 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 23:57:46.259911 => 23:57:46.707609
[0m23:57:46.707609 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m23:57:46.806901 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 18 unexpected '('.
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:57:46.806901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ecd750-f221-499d-b17f-31eaa6e9845a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021379A50100>]}
[0m23:57:46.806901 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_customers ................. [[31mERROR[0m in 0.57s]
[0m23:57:46.806901 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m23:57:46.806901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:46.820913 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m23:57:46.820913 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m23:57:46.822607 [debug] [MainThread]: Connection 'model.practice.stg_customers' was properly closed.
[0m23:57:46.823556 [info ] [MainThread]: 
[0m23:57:46.824080 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m23:57:46.824080 [debug] [MainThread]: Command end result
[0m23:57:46.824080 [info ] [MainThread]: 
[0m23:57:46.835653 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:57:46.836658 [info ] [MainThread]: 
[0m23:57:46.836658 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 18 unexpected '('.
  compiled Code at target\run\practice\models\staging\stg_customers.sql
[0m23:57:46.838712 [info ] [MainThread]: 
[0m23:57:46.838712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:57:46.838712 [debug] [MainThread]: Command `dbt run` failed at 23:57:46.838712 after 3.01 seconds
[0m23:57:46.838712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021366C57610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021379A50760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021379A53490>]}
[0m23:57:46.838712 [debug] [MainThread]: Flushing usage events
[0m00:01:35.510206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6DB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6625DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6627A30>]}


============================== 00:01:35.513992 | 0bba96cb-0c9e-46a8-8948-edb04a76a993 ==============================
[0m00:01:35.513992 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:01:35.513992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:36.006609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bba96cb-0c9e-46a8-8948-edb04a76a993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB65EFD90>]}
[0m00:01:36.080333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bba96cb-0c9e-46a8-8948-edb04a76a993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB65EFF10>]}
[0m00:01:36.080333 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:01:36.096395 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:01:36.180315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:01:36.180315 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_customers.sql
[0m00:01:36.180315 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m00:01:36.297342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m00:01:36.297342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bba96cb-0c9e-46a8-8948-edb04a76a993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC992C0D0>]}
[0m00:01:36.318134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bba96cb-0c9e-46a8-8948-edb04a76a993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC97B8C10>]}
[0m00:01:36.318134 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:01:36.318134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bba96cb-0c9e-46a8-8948-edb04a76a993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC97B9870>]}
[0m00:01:36.318134 [info ] [MainThread]: 
[0m00:01:36.318134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:36.327223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m00:01:36.334091 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m00:01:36.343099 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m00:01:36.343099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:36.864454 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m00:01:36.864454 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m00:01:36.964217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m00:01:36.973871 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m00:01:36.973871 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m00:01:36.973871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:37.431163 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc57-0001-429e-0008-435e0001bd1a
[0m00:01:37.431163 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:01:37.431163 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:01:37.431163 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:01:37.431163 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m00:01:37.515748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m00:01:37.531195 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m00:01:37.531195 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m00:01:37.531195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:37.832993 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:37.832993 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m00:01:37.931286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bba96cb-0c9e-46a8-8948-edb04a76a993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC979EB60>]}
[0m00:01:37.931286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:37.931286 [info ] [MainThread]: 
[0m00:01:37.947651 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m00:01:37.947651 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m00:01:37.955031 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_product'
[0m00:01:37.955911 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m00:01:37.964596 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m00:01:37.964596 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 00:01:37.955911 => 00:01:37.964596
[0m00:01:37.964596 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m00:01:37.984905 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m00:01:37.994910 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m00:01:37.994910 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    CAST(PRODUCT_FAMILY AS INT) AS PRODUCT_FAMILY
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m00:01:37.994910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:01:38.264735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc57-0001-429e-0008-435e0001bd1e
[0m00:01:38.264735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 4 unexpected 'PRODUCT_FAMILY'.
[0m00:01:38.264735 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 00:01:37.964596 => 00:01:38.264735
[0m00:01:38.272843 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m00:01:38.365808 [debug] [Thread-1 (]: Database Error in model stg_product (models\staging\stg_product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'PRODUCT_FAMILY'.
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:01:38.365808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bba96cb-0c9e-46a8-8948-edb04a76a993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9CE4340>]}
[0m00:01:38.376407 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_product ................... [[31mERROR[0m in 0.42s]
[0m00:01:38.376407 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m00:01:38.380633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:38.380633 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m00:01:38.380633 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m00:01:38.380633 [debug] [MainThread]: Connection 'model.practice.stg_product' was properly closed.
[0m00:01:38.380633 [info ] [MainThread]: 
[0m00:01:38.380633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m00:01:38.385520 [debug] [MainThread]: Command end result
[0m00:01:38.389430 [info ] [MainThread]: 
[0m00:01:38.397849 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:01:38.398439 [info ] [MainThread]: 
[0m00:01:38.398439 [error] [MainThread]:   Database Error in model stg_product (models\staging\stg_product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'PRODUCT_FAMILY'.
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:01:38.398439 [info ] [MainThread]: 
[0m00:01:38.398439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:01:38.398439 [debug] [MainThread]: Command `dbt run` failed at 00:01:38.398439 after 2.95 seconds
[0m00:01:38.398439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADB6DB75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9CE7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADC9CE4C40>]}
[0m00:01:38.398439 [debug] [MainThread]: Flushing usage events
[0m00:01:49.780181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259892C5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025988B337C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025988B317E0>]}


============================== 00:01:49.780181 | 3e9234e4-4381-4b8c-8f09-856a4bb52c4a ==============================
[0m00:01:49.780181 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:01:49.780181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:50.309692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e9234e4-4381-4b8c-8f09-856a4bb52c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025988AFBE20>]}
[0m00:01:50.391192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e9234e4-4381-4b8c-8f09-856a4bb52c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599AAFA860>]}
[0m00:01:50.391192 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:01:50.398065 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:01:50.480152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:01:50.480152 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m00:01:50.596958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m00:01:50.596958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e9234e4-4381-4b8c-8f09-856a4bb52c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599BE040D0>]}
[0m00:01:50.613739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e9234e4-4381-4b8c-8f09-856a4bb52c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599BCC80A0>]}
[0m00:01:50.613739 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:01:50.613739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9234e4-4381-4b8c-8f09-856a4bb52c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599BCC8B20>]}
[0m00:01:50.624859 [info ] [MainThread]: 
[0m00:01:50.624859 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:50.624859 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m00:01:50.630060 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m00:01:50.630060 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m00:01:50.640686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:51.213981 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m00:01:51.213981 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m00:01:51.356121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m00:01:51.365013 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m00:01:51.365013 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m00:01:51.365013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:51.714602 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc57-0001-429b-0008-435e0001d39e
[0m00:01:51.714602 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:01:51.714602 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:01:51.714602 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:01:51.714602 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m00:01:51.814474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m00:01:51.830852 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m00:01:51.830957 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m00:01:51.830957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:52.163892 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:01:52.177403 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m00:01:52.280964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9234e4-4381-4b8c-8f09-856a4bb52c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599BCAEB30>]}
[0m00:01:52.280964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:52.280964 [info ] [MainThread]: 
[0m00:01:52.280964 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m00:01:52.280964 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m00:01:52.294926 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_product'
[0m00:01:52.296135 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m00:01:52.300646 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m00:01:52.300646 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 00:01:52.296135 => 00:01:52.300646
[0m00:01:52.300646 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m00:01:52.330344 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m00:01:52.330344 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m00:01:52.330344 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    CAST(PRODUCT_FAMILY AS INT) AS PRODUCT_FAMILY,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m00:01:52.330344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:01:53.014207 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc57-0001-429b-0008-435e0001d3a2
[0m00:01:53.014207 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'PRODUCT_FAMILY'
[0m00:01:53.014207 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 00:01:52.300646 => 00:01:53.014207
[0m00:01:53.014207 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m00:01:53.117447 [debug] [Thread-1 (]: Database Error in model stg_product (models\staging\stg_product.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:01:53.117447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9234e4-4381-4b8c-8f09-856a4bb52c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599C1F4340>]}
[0m00:01:53.117447 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw_STAGING.stg_product ................... [[31mERROR[0m in 0.84s]
[0m00:01:53.117447 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m00:01:53.117447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:53.117447 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m00:01:53.117447 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m00:01:53.117447 [debug] [MainThread]: Connection 'model.practice.stg_product' was properly closed.
[0m00:01:53.117447 [info ] [MainThread]: 
[0m00:01:53.117447 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m00:01:53.117447 [debug] [MainThread]: Command end result
[0m00:01:53.131336 [info ] [MainThread]: 
[0m00:01:53.131336 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:01:53.137979 [info ] [MainThread]: 
[0m00:01:53.137979 [error] [MainThread]:   Database Error in model stg_product (models\staging\stg_product.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:01:53.137979 [info ] [MainThread]: 
[0m00:01:53.137979 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:01:53.137979 [debug] [MainThread]: Command `dbt run` failed at 00:01:53.137979 after 3.41 seconds
[0m00:01:53.137979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259892C5DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599C1F7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599C1F4C10>]}
[0m00:01:53.137979 [debug] [MainThread]: Flushing usage events
[0m00:13:26.091384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104FE25DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104F692F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104F6917E0>]}


============================== 00:13:26.099013 | 37770deb-e76a-415e-92e9-3ae11d837481 ==============================
[0m00:13:26.099013 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:13:26.101518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:13:26.620154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104F65BDC0>]}
[0m00:13:26.706559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062624FD0>]}
[0m00:13:26.706559 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:13:26.717850 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:13:26.804548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:13:26.804548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:13:26.804548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m00:13:26.804548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106285C0D0>]}
[0m00:13:26.822184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210628140A0>]}
[0m00:13:26.823150 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:13:26.823765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062814C40>]}
[0m00:13:26.823765 [info ] [MainThread]: 
[0m00:13:26.826640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:13:26.826640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m00:13:26.840405 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m00:13:26.840405 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m00:13:26.840405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:27.323736 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m00:13:27.335249 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m00:13:27.424280 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m00:13:27.439172 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m00:13:27.439172 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m00:13:27.439172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:27.840382 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:13:27.840382 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m00:13:27.934984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m00:13:27.939852 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m00:13:27.939852 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m00:13:27.939852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:28.225723 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc63-0001-429e-0008-435e0001befa
[0m00:13:28.225723 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:13:28.225723 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:13:28.229745 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:13:28.231324 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m00:13:28.318931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106280EAD0>]}
[0m00:13:28.318931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:28.322990 [info ] [MainThread]: 
[0m00:13:28.322990 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m00:13:28.322990 [info ] [Thread-1 (]: 1 of 4 START sql view model raw_STAGING.stg_country ............................ [RUN]
[0m00:13:28.322990 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m00:13:28.334583 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m00:13:28.356893 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m00:13:28.356893 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 00:13:28.336639 => 00:13:28.356893
[0m00:13:28.356893 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m00:13:28.405486 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m00:13:28.411495 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m00:13:28.411495 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m00:13:28.411495 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:13:28.839664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:13:28.872269 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 00:13:28.356893 => 00:13:28.872269
[0m00:13:28.872269 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m00:13:28.957057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062883A30>]}
[0m00:13:28.957057 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw_STAGING.stg_country ....................... [[32mSUCCESS 1[0m in 0.63s]
[0m00:13:28.965074 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m00:13:28.965074 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m00:13:28.965074 [info ] [Thread-1 (]: 2 of 4 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m00:13:28.972465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m00:13:28.973477 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m00:13:28.973477 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m00:13:28.983008 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 00:13:28.973477 => 00:13:28.981567
[0m00:13:28.983008 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m00:13:28.983008 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m00:13:28.983008 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m00:13:28.983008 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m00:13:28.983008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:29.356389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:13:29.356389 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 00:13:28.983008 => 00:13:29.356389
[0m00:13:29.356389 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m00:13:29.722430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062BC5060>]}
[0m00:13:29.723141 [info ] [Thread-1 (]: 2 of 4 OK created sql view model raw_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m00:13:29.723141 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m00:13:29.723141 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m00:13:29.723141 [info ] [Thread-1 (]: 3 of 4 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m00:13:29.723141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m00:13:29.733459 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m00:13:29.740135 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m00:13:29.740135 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 00:13:29.733459 => 00:13:29.740135
[0m00:13:29.740135 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m00:13:29.740135 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m00:13:29.740135 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m00:13:29.740135 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    CAST(PRODUCT_FAMILY AS INT) AS PRODUCT_FAMILY,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m00:13:29.740135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:30.039933 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc63-0001-429e-0008-435e0001bf02
[0m00:13:30.039933 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'PRODUCT_FAMILY'
[0m00:13:30.056506 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 00:13:29.740135 => 00:13:30.039933
[0m00:13:30.056506 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m00:13:30.140003 [debug] [Thread-1 (]: Database Error in model stg_product (models\staging\stg_product.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:13:30.152127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062BC6710>]}
[0m00:13:30.152127 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model raw_STAGING.stg_product ................... [[31mERROR[0m in 0.43s]
[0m00:13:30.156367 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m00:13:30.156367 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m00:13:30.156367 [info ] [Thread-1 (]: 4 of 4 START sql view model raw_STAGING.stg_transaction ........................ [RUN]
[0m00:13:30.156367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m00:13:30.156367 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m00:13:30.156367 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m00:13:30.156367 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 00:13:30.156367 => 00:13:30.156367
[0m00:13:30.156367 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m00:13:30.170750 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m00:13:30.173636 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m00:13:30.173636 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m00:13:30.173636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:30.640490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:13:30.640490 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 00:13:30.156367 => 00:13:30.640490
[0m00:13:30.640490 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m00:13:30.740562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37770deb-e76a-415e-92e9-3ae11d837481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062A9F9A0>]}
[0m00:13:30.740562 [info ] [Thread-1 (]: 4 of 4 OK created sql view model raw_STAGING.stg_transaction ................... [[32mSUCCESS 1[0m in 0.58s]
[0m00:13:30.740562 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m00:13:30.740562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:30.740562 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m00:13:30.740562 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m00:13:30.740562 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m00:13:30.740562 [info ] [MainThread]: 
[0m00:13:30.740562 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m00:13:30.754806 [debug] [MainThread]: Command end result
[0m00:13:30.762822 [info ] [MainThread]: 
[0m00:13:30.768658 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:30.770106 [info ] [MainThread]: 
[0m00:13:30.771127 [error] [MainThread]:   Database Error in model stg_product (models\staging\stg_product.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:13:30.771127 [info ] [MainThread]: 
[0m00:13:30.771127 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:13:30.771127 [debug] [MainThread]: Command `dbt run` failed at 00:13:30.771127 after 4.74 seconds
[0m00:13:30.771127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104FE25DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062A85600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021062A91CF0>]}
[0m00:13:30.771127 [debug] [MainThread]: Flushing usage events
[0m00:14:01.079852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E93197610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E92A02F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E92A031C0>]}


============================== 00:14:01.079852 | 8c2f6782-a88a-4dec-b99f-7e3770615242 ==============================
[0m00:14:01.079852 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:14:01.079852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:01.688268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E929CBE20>]}
[0m00:14:01.788838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA5995C00>]}
[0m00:14:01.794881 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:14:01.802909 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:14:01.879262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:01.879262 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m00:14:01.999849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m00:14:02.004876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA5D080D0>]}
[0m00:14:02.021658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA5B84130>]}
[0m00:14:02.028654 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:14:02.028654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA5B84B20>]}
[0m00:14:02.031675 [info ] [MainThread]: 
[0m00:14:02.031675 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:14:02.031675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m00:14:02.047747 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m00:14:02.047747 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m00:14:02.047747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:02.672228 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m00:14:02.672228 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m00:14:02.772548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m00:14:02.788528 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m00:14:02.788528 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m00:14:02.788528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:03.205405 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc64-0001-429e-0008-435e0001bf0a
[0m00:14:03.205405 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:14:03.205405 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:14:03.205405 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:14:03.205405 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m00:14:03.288645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m00:14:03.288645 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m00:14:03.288645 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m00:14:03.288645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:03.590280 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:14:03.590280 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m00:14:03.688521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA5CF9150>]}
[0m00:14:03.688521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:03.688521 [info ] [MainThread]: 
[0m00:14:03.704489 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m00:14:03.704489 [info ] [Thread-1 (]: 1 of 4 START sql view model raw_STAGING.stg_country ............................ [RUN]
[0m00:14:03.709005 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m00:14:03.709005 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m00:14:03.711603 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m00:14:03.711603 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 00:14:03.709005 => 00:14:03.711603
[0m00:14:03.722936 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m00:14:03.742100 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m00:14:03.754235 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m00:14:03.756114 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m00:14:03.756114 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:04.121526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:04.155299 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 00:14:03.722936 => 00:14:04.155299
[0m00:14:04.155299 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m00:14:04.255493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E92A53010>]}
[0m00:14:04.255493 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw_STAGING.stg_country ....................... [[32mSUCCESS 1[0m in 0.55s]
[0m00:14:04.255493 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m00:14:04.255493 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m00:14:04.255493 [info ] [Thread-1 (]: 2 of 4 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m00:14:04.255493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m00:14:04.255493 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m00:14:04.255493 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m00:14:04.255493 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 00:14:04.255493 => 00:14:04.255493
[0m00:14:04.255493 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m00:14:04.270498 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m00:14:04.273003 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m00:14:04.273003 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m00:14:04.273003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:04.681742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:04.691482 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 00:14:04.255493 => 00:14:04.691482
[0m00:14:04.691482 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m00:14:04.785307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA6035AE0>]}
[0m00:14:04.785307 [info ] [Thread-1 (]: 2 of 4 OK created sql view model raw_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.53s]
[0m00:14:04.793303 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m00:14:04.793531 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m00:14:04.793531 [info ] [Thread-1 (]: 3 of 4 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m00:14:04.793531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m00:14:04.793531 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m00:14:04.806901 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m00:14:04.806901 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 00:14:04.793531 => 00:14:04.806901
[0m00:14:04.806901 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m00:14:04.806901 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m00:14:04.806901 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m00:14:04.806901 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m00:14:04.806901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:05.097676 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafc64-0001-429b-0008-435e0001d592
[0m00:14:05.097676 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'PRODUCT_FAMILY'
[0m00:14:05.097676 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 00:14:04.806901 => 00:14:05.097676
[0m00:14:05.097676 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m00:14:05.189705 [debug] [Thread-1 (]: Database Error in model stg_product (models\staging\stg_product.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:14:05.190581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA6058850>]}
[0m00:14:05.190581 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model raw_STAGING.stg_product ................... [[31mERROR[0m in 0.40s]
[0m00:14:05.190581 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m00:14:05.190581 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m00:14:05.190581 [info ] [Thread-1 (]: 4 of 4 START sql view model raw_STAGING.stg_transaction ........................ [RUN]
[0m00:14:05.190581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m00:14:05.190581 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m00:14:05.204563 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m00:14:05.206282 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 00:14:05.190581 => 00:14:05.206061
[0m00:14:05.206282 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m00:14:05.206282 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m00:14:05.206282 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m00:14:05.206282 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m00:14:05.206282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:05.624347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:05.633449 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 00:14:05.206282 => 00:14:05.633449
[0m00:14:05.633449 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m00:14:05.721519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c2f6782-a88a-4dec-b99f-7e3770615242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA60BBDF0>]}
[0m00:14:05.723087 [info ] [Thread-1 (]: 4 of 4 OK created sql view model raw_STAGING.stg_transaction ................... [[32mSUCCESS 1[0m in 0.53s]
[0m00:14:05.727501 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m00:14:05.727501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:05.727501 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m00:14:05.727501 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m00:14:05.727501 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m00:14:05.727501 [info ] [MainThread]: 
[0m00:14:05.727501 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m00:14:05.727501 [debug] [MainThread]: Command end result
[0m00:14:05.743941 [info ] [MainThread]: 
[0m00:14:05.743941 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:05.752474 [info ] [MainThread]: 
[0m00:14:05.752474 [error] [MainThread]:   Database Error in model stg_product (models\staging\stg_product.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\staging\stg_product.sql
[0m00:14:05.754089 [info ] [MainThread]: 
[0m00:14:05.754089 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:14:05.755950 [debug] [MainThread]: Command `dbt run` failed at 00:14:05.755950 after 4.75 seconds
[0m00:14:05.755950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E93197610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA60E6CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EA60E7970>]}
[0m00:14:05.755950 [debug] [MainThread]: Flushing usage events
[0m00:14:20.855509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E5D77610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E55E2F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E55E31C0>]}


============================== 00:14:20.855509 | d78c73f1-28b5-4840-a2d5-08a97bdf7869 ==============================
[0m00:14:20.855509 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:14:20.855509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:21.437948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E55ABE20>]}
[0m00:14:21.520873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F75A5C00>]}
[0m00:14:21.520873 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:14:21.537311 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:14:21.620231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:21.620231 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m00:14:21.747806 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m00:14:21.753930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F88EC0D0>]}
[0m00:14:21.765381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F8768130>]}
[0m00:14:21.769438 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:14:21.771723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F8768B20>]}
[0m00:14:21.772839 [info ] [MainThread]: 
[0m00:14:21.772839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:14:21.772839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m00:14:21.786948 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m00:14:21.786948 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m00:14:21.786948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:22.389621 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m00:14:22.389621 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m00:14:22.488210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_raw_STAGING'
[0m00:14:22.504752 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m00:14:22.504752 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m00:14:22.504752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:22.807801 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:14:22.817366 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m00:14:22.904071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_raw_STAGING, now list_SNOWFLAKE_PRAC_raw_public)
[0m00:14:22.912334 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m00:14:22.912334 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m00:14:22.917585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:23.189606 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc64-0001-429b-0008-435e0001d5a2
[0m00:14:23.206210 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:14:23.206210 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:14:23.206210 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:14:23.206210 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m00:14:23.301070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F88DD180>]}
[0m00:14:23.305363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:23.305363 [info ] [MainThread]: 
[0m00:14:23.305363 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m00:14:23.305363 [info ] [Thread-1 (]: 1 of 4 START sql view model raw_STAGING.stg_country ............................ [RUN]
[0m00:14:23.305363 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m00:14:23.305363 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m00:14:23.320273 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m00:14:23.320273 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 00:14:23.305363 => 00:14:23.320273
[0m00:14:23.325281 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m00:14:23.342224 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m00:14:23.352739 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m00:14:23.352739 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m00:14:23.355435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:24.100556 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:14:24.120643 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 00:14:23.325512 => 00:14:24.120643
[0m00:14:24.120643 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m00:14:24.207359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F875EA70>]}
[0m00:14:24.207359 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw_STAGING.stg_country ....................... [[32mSUCCESS 1[0m in 0.90s]
[0m00:14:24.207359 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m00:14:24.207359 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m00:14:24.207359 [info ] [Thread-1 (]: 2 of 4 START sql view model raw_STAGING.stg_customers .......................... [RUN]
[0m00:14:24.207359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m00:14:24.220260 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m00:14:24.221888 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m00:14:24.221888 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 00:14:24.220260 => 00:14:24.221888
[0m00:14:24.227417 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m00:14:24.227417 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m00:14:24.227417 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m00:14:24.227417 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m00:14:24.227417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:24.753903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:14:24.756733 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 00:14:24.227417 => 00:14:24.756733
[0m00:14:24.760668 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m00:14:24.842595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F8B1B490>]}
[0m00:14:24.842595 [info ] [Thread-1 (]: 2 of 4 OK created sql view model raw_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.64s]
[0m00:14:24.842595 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m00:14:24.842595 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m00:14:24.842595 [info ] [Thread-1 (]: 3 of 4 START sql view model raw_STAGING.stg_product ............................ [RUN]
[0m00:14:24.842595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m00:14:24.842595 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m00:14:24.855252 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m00:14:24.855252 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 00:14:24.842595 => 00:14:24.855252
[0m00:14:24.855252 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m00:14:24.855252 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m00:14:24.855252 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m00:14:24.855252 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m00:14:24.855252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:25.271689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:25.287835 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 00:14:24.855252 => 00:14:25.284987
[0m00:14:25.287835 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m00:14:25.370989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F8C5F0D0>]}
[0m00:14:25.370989 [info ] [Thread-1 (]: 3 of 4 OK created sql view model raw_STAGING.stg_product ....................... [[32mSUCCESS 1[0m in 0.53s]
[0m00:14:25.370989 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m00:14:25.370989 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m00:14:25.370989 [info ] [Thread-1 (]: 4 of 4 START sql view model raw_STAGING.stg_transaction ........................ [RUN]
[0m00:14:25.370989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m00:14:25.370989 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m00:14:25.389523 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m00:14:25.389523 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 00:14:25.370989 => 00:14:25.389523
[0m00:14:25.389523 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m00:14:25.389523 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m00:14:25.400536 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m00:14:25.400536 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.raw_STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m00:14:25.400536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:25.870640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:25.870640 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 00:14:25.389523 => 00:14:25.870640
[0m00:14:25.870640 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m00:14:25.954643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd78c73f1-28b5-4840-a2d5-08a97bdf7869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F8B431F0>]}
[0m00:14:25.954643 [info ] [Thread-1 (]: 4 of 4 OK created sql view model raw_STAGING.stg_transaction ................... [[32mSUCCESS 1[0m in 0.58s]
[0m00:14:25.954643 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m00:14:25.954643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:25.954643 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m00:14:25.954643 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_raw_public' was properly closed.
[0m00:14:25.954643 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m00:14:25.954643 [info ] [MainThread]: 
[0m00:14:25.954643 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m00:14:25.954643 [debug] [MainThread]: Command end result
[0m00:14:25.977620 [info ] [MainThread]: 
[0m00:14:25.977620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:25.977620 [info ] [MainThread]: 
[0m00:14:25.977620 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:14:25.977620 [debug] [MainThread]: Command `dbt run` succeeded at 00:14:25.977620 after 5.21 seconds
[0m00:14:25.977620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E5D77610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F8C5F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F8CC6CE0>]}
[0m00:14:25.977620 [debug] [MainThread]: Flushing usage events
[0m00:14:34.105760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E63EC5C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E63733370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E63732500>]}


============================== 00:14:34.105760 | cd6e64dd-82c0-4551-a64b-eccc0923490d ==============================
[0m00:14:34.105760 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:14:34.115346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\kumar\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\PROJECT\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:34.603450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd6e64dd-82c0-4551-a64b-eccc0923490d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E636FF9A0>]}
[0m00:14:34.684049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd6e64dd-82c0-4551-a64b-eccc0923490d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E766C5F30>]}
[0m00:14:34.684049 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m00:14:34.687052 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m00:14:34.770374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:34.770374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:34.772499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m00:14:34.772499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd6e64dd-82c0-4551-a64b-eccc0923490d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E769000D0>]}
[0m00:14:34.789691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd6e64dd-82c0-4551-a64b-eccc0923490d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E76770B50>]}
[0m00:14:34.789691 [info ] [MainThread]: Found 1 seed, 8 tests, 4 models, 4 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:14:34.789691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6e64dd-82c0-4551-a64b-eccc0923490d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E76771750>]}
[0m00:14:34.792348 [info ] [MainThread]: 
[0m00:14:34.792348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:14:34.792348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_raw_public'
[0m00:14:34.808744 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_raw_public"
[0m00:14:34.808744 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_raw_public"} */
show terse objects in SNOWFLAKE_PRAC.raw_public limit 10000
[0m00:14:34.808744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:35.270984 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafc64-0001-429b-0008-435e0001d5ae
[0m00:14:35.270984 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:14:35.286618 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:14:35.287166 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:14:35.287166 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_raw_public: Close
[0m00:14:35.371109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_raw_public, now list_RIDE_SHARING_DB_raw_STAGING)
[0m00:14:35.371109 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_raw_STAGING"
[0m00:14:35.371109 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_raw_STAGING"} */
show terse objects in RIDE_SHARING_DB.raw_STAGING limit 10000
[0m00:14:35.371109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:35.721523 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m00:14:35.729040 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_raw_STAGING: Close
[0m00:14:35.821888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6e64dd-82c0-4551-a64b-eccc0923490d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E768ADFF0>]}
[0m00:14:35.821888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:35.832900 [info ] [MainThread]: 
[0m00:14:35.836914 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m00:14:35.836914 [info ] [Thread-1 (]: 1 of 8 START test source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID ......... [RUN]
[0m00:14:35.841959 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935'
[0m00:14:35.841959 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m00:14:35.854969 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935"
[0m00:14:35.854969 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935 (compile): 00:14:35.841959 => 00:14:35.854969
[0m00:14:35.854969 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m00:14:35.904654 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935"
[0m00:14:35.905776 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935"
[0m00:14:35.905776 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CUSTOMER_ID
from RIDE_SHARING_DB.RAW.COUNTRY_REGION
where CUSTOMER_ID is null



      
    ) dbt_internal_test
[0m00:14:35.909282 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:36.379955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:36.405005 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935 (execute): 00:14:35.854969 => 00:14:36.403690
[0m00:14:36.405005 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935: Close
[0m00:14:36.488381 [info ] [Thread-1 (]: 1 of 8 PASS source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID ............... [[32mPASS[0m in 0.65s]
[0m00:14:36.501777 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m00:14:36.503345 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m00:14:36.503345 [info ] [Thread-1 (]: 2 of 8 START test source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID .............. [RUN]
[0m00:14:36.503345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935, now test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9)
[0m00:14:36.508356 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m00:14:36.508738 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9"
[0m00:14:36.508738 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9 (compile): 00:14:36.508738 => 00:14:36.508738
[0m00:14:36.508738 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m00:14:36.519710 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9"
[0m00:14:36.519710 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9"
[0m00:14:36.519710 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CUSTOMER_ID
from RIDE_SHARING_DB.RAW.CUSTOMERS
where CUSTOMER_ID is null



      
    ) dbt_internal_test
[0m00:14:36.525032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:36.871710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:36.871710 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9 (execute): 00:14:36.508738 => 00:14:36.871710
[0m00:14:36.871710 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9: Close
[0m00:14:37.004862 [info ] [Thread-1 (]: 2 of 8 PASS source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID .................... [[32mPASS[0m in 0.50s]
[0m00:14:37.004862 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m00:14:37.004862 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m00:14:37.004862 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_tp_source_PRODUCTS_PRODUCT_ID ................ [RUN]
[0m00:14:37.014545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9, now test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be)
[0m00:14:37.015882 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m00:14:37.022408 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be"
[0m00:14:37.022408 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be (compile): 00:14:37.016793 => 00:14:37.022408
[0m00:14:37.030414 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m00:14:37.030414 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be"
[0m00:14:37.037117 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be"
[0m00:14:37.037117 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select PRODUCT_ID
from RIDE_SHARING_DB.RAW.PRODUCTS
where PRODUCT_ID is null



      
    ) dbt_internal_test
[0m00:14:37.037117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:37.820748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:14:37.820748 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be (execute): 00:14:37.030414 => 00:14:37.820748
[0m00:14:37.820748 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be: Close
[0m00:14:37.915643 [error] [Thread-1 (]: 3 of 8 FAIL 1 source_not_null_tp_source_PRODUCTS_PRODUCT_ID .................... [[31mFAIL 1[0m in 0.91s]
[0m00:14:37.920799 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m00:14:37.920799 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m00:14:37.920799 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_tp_source_TRANSACTION_CUSTOMER_ID ............ [RUN]
[0m00:14:37.926503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be, now test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6)
[0m00:14:37.926503 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m00:14:37.936366 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6"
[0m00:14:37.937985 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6 (compile): 00:14:37.926503 => 00:14:37.937985
[0m00:14:37.937985 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m00:14:37.937985 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6"
[0m00:14:37.945316 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6"
[0m00:14:37.945316 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CUSTOMER_ID
from RIDE_SHARING_DB.RAW.TRANSACTION
where CUSTOMER_ID is null



      
    ) dbt_internal_test
[0m00:14:37.945316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:38.347672 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:38.354065 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6 (execute): 00:14:37.937985 => 00:14:38.354065
[0m00:14:38.354065 [debug] [Thread-1 (]: On test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6: Close
[0m00:14:38.454473 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_tp_source_TRANSACTION_CUSTOMER_ID .................. [[32mPASS[0m in 0.53s]
[0m00:14:38.454473 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m00:14:38.454473 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m00:14:38.454473 [info ] [Thread-1 (]: 5 of 8 START test source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID ........... [RUN]
[0m00:14:38.454473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6, now test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30)
[0m00:14:38.463988 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m00:14:38.471332 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30"
[0m00:14:38.471332 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30 (compile): 00:14:38.466223 => 00:14:38.471332
[0m00:14:38.471332 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m00:14:38.479843 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30"
[0m00:14:38.484468 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30"
[0m00:14:38.484468 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_ID as unique_field,
    count(*) as n_records

from RIDE_SHARING_DB.RAW.COUNTRY_REGION
where CUSTOMER_ID is not null
group by CUSTOMER_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:38.484468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:39.871520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:14:39.871520 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30 (execute): 00:14:38.471332 => 00:14:39.871520
[0m00:14:39.871520 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30: Close
[0m00:14:39.953768 [error] [Thread-1 (]: 5 of 8 FAIL 1656 source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID ............ [[31mFAIL 1656[0m in 1.50s]
[0m00:14:39.953768 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m00:14:39.953768 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m00:14:39.953768 [info ] [Thread-1 (]: 6 of 8 START test source_unique_tp_source_CUSTOMERS_CUSTOMER_ID ................ [RUN]
[0m00:14:39.962356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30, now test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f)
[0m00:14:39.962356 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m00:14:39.962356 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f"
[0m00:14:39.970456 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f (compile): 00:14:39.962356 => 00:14:39.962356
[0m00:14:39.970877 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m00:14:39.973453 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f"
[0m00:14:39.973453 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f"
[0m00:14:39.973453 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_ID as unique_field,
    count(*) as n_records

from RIDE_SHARING_DB.RAW.CUSTOMERS
where CUSTOMER_ID is not null
group by CUSTOMER_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:39.973453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:40.320938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:40.320938 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f (execute): 00:14:39.970877 => 00:14:40.320938
[0m00:14:40.320938 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f: Close
[0m00:14:40.404021 [error] [Thread-1 (]: 6 of 8 FAIL 4 source_unique_tp_source_CUSTOMERS_CUSTOMER_ID .................... [[31mFAIL 4[0m in 0.44s]
[0m00:14:40.404021 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m00:14:40.404021 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m00:14:40.404021 [info ] [Thread-1 (]: 7 of 8 START test source_unique_tp_source_PRODUCTS_PRODUCT_ID .................. [RUN]
[0m00:14:40.404021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f, now test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678)
[0m00:14:40.404021 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m00:14:40.418662 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678"
[0m00:14:40.420711 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678 (compile): 00:14:40.404021 => 00:14:40.420711
[0m00:14:40.421863 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m00:14:40.426765 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678"
[0m00:14:40.426765 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678"
[0m00:14:40.426765 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    PRODUCT_ID as unique_field,
    count(*) as n_records

from RIDE_SHARING_DB.RAW.PRODUCTS
where PRODUCT_ID is not null
group by PRODUCT_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:40.426765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:40.753868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:40.753868 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678 (execute): 00:14:40.421863 => 00:14:40.753868
[0m00:14:40.753868 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678: Close
[0m00:14:40.849457 [error] [Thread-1 (]: 7 of 8 FAIL 24 source_unique_tp_source_PRODUCTS_PRODUCT_ID ..................... [[31mFAIL 24[0m in 0.45s]
[0m00:14:40.849457 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m00:14:40.849457 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m00:14:40.849457 [info ] [Thread-1 (]: 8 of 8 START test source_unique_tp_source_TRANSACTION_CUSTOMER_ID .............. [RUN]
[0m00:14:40.849457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678, now test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3)
[0m00:14:40.853532 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m00:14:40.853532 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3"
[0m00:14:40.853532 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3 (compile): 00:14:40.853532 => 00:14:40.853532
[0m00:14:40.853532 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m00:14:40.865541 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3"
[0m00:14:40.868623 [debug] [Thread-1 (]: Using snowflake connection "test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3"
[0m00:14:40.869677 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_ID as unique_field,
    count(*) as n_records

from RIDE_SHARING_DB.RAW.TRANSACTION
where CUSTOMER_ID is not null
group by CUSTOMER_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m00:14:40.871059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:41.253961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:14:41.261693 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3 (execute): 00:14:40.853532 => 00:14:41.253961
[0m00:14:41.261693 [debug] [Thread-1 (]: On test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3: Close
[0m00:14:41.353979 [error] [Thread-1 (]: 8 of 8 FAIL 181 source_unique_tp_source_TRANSACTION_CUSTOMER_ID ................ [[31mFAIL 181[0m in 0.50s]
[0m00:14:41.353979 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m00:14:41.353979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:41.353979 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_raw_STAGING' was properly closed.
[0m00:14:41.353979 [debug] [MainThread]: Connection 'test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3' was properly closed.
[0m00:14:41.353979 [info ] [MainThread]: 
[0m00:14:41.353979 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m00:14:41.370722 [debug] [MainThread]: Command end result
[0m00:14:41.387180 [info ] [MainThread]: 
[0m00:14:41.387180 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m00:14:41.387180 [info ] [MainThread]: 
[0m00:14:41.387180 [error] [MainThread]: [31mFailure in test source_not_null_tp_source_PRODUCTS_PRODUCT_ID (models\staging\t_sources.yml)[0m
[0m00:14:41.387180 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:14:41.387180 [info ] [MainThread]: 
[0m00:14:41.398193 [info ] [MainThread]:   compiled Code at target\compiled\practice\models\staging\t_sources.yml\source_not_null_tp_source_PRODUCTS_PRODUCT_ID.sql
[0m00:14:41.398193 [info ] [MainThread]: 
[0m00:14:41.398193 [error] [MainThread]: [31mFailure in test source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID (models\staging\t_sources.yml)[0m
[0m00:14:41.398193 [error] [MainThread]:   Got 1656 results, configured to fail if != 0
[0m00:14:41.402878 [info ] [MainThread]: 
[0m00:14:41.403450 [info ] [MainThread]:   compiled Code at target\compiled\practice\models\staging\t_sources.yml\source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.sql
[0m00:14:41.406223 [info ] [MainThread]: 
[0m00:14:41.406223 [error] [MainThread]: [31mFailure in test source_unique_tp_source_CUSTOMERS_CUSTOMER_ID (models\staging\t_sources.yml)[0m
[0m00:14:41.406223 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m00:14:41.406223 [info ] [MainThread]: 
[0m00:14:41.411954 [info ] [MainThread]:   compiled Code at target\compiled\practice\models\staging\t_sources.yml\source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.sql
[0m00:14:41.412497 [info ] [MainThread]: 
[0m00:14:41.412497 [error] [MainThread]: [31mFailure in test source_unique_tp_source_PRODUCTS_PRODUCT_ID (models\staging\t_sources.yml)[0m
[0m00:14:41.414004 [error] [MainThread]:   Got 24 results, configured to fail if != 0
[0m00:14:41.414004 [info ] [MainThread]: 
[0m00:14:41.414004 [info ] [MainThread]:   compiled Code at target\compiled\practice\models\staging\t_sources.yml\source_unique_tp_source_PRODUCTS_PRODUCT_ID.sql
[0m00:14:41.414004 [info ] [MainThread]: 
[0m00:14:41.414004 [error] [MainThread]: [31mFailure in test source_unique_tp_source_TRANSACTION_CUSTOMER_ID (models\staging\t_sources.yml)[0m
[0m00:14:41.419564 [error] [MainThread]:   Got 181 results, configured to fail if != 0
[0m00:14:41.420394 [info ] [MainThread]: 
[0m00:14:41.420394 [info ] [MainThread]:   compiled Code at target\compiled\practice\models\staging\t_sources.yml\source_unique_tp_source_TRANSACTION_CUSTOMER_ID.sql
[0m00:14:41.420394 [info ] [MainThread]: 
[0m00:14:41.420394 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=5 SKIP=0 TOTAL=8
[0m00:14:41.420394 [debug] [MainThread]: Command `dbt test` failed at 00:14:41.420394 after 7.37 seconds
[0m00:14:41.420394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E63EC5C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E76C769B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E76C76CB0>]}
[0m00:14:41.420394 [debug] [MainThread]: Flushing usage events
[0m09:46:43.020717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E78542F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E78541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E78555E0>]}


============================== 09:46:43.039718 | b5774955-a4f2-4742-abe1-2f0d7ce8907e ==============================
[0m09:46:43.039718 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:46:43.040720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:46:43.043719 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'practice'
[0m09:46:43.044719 [debug] [MainThread]: Command `dbt run` failed at 09:46:43.044719 after 0.15 seconds
[0m09:46:43.044719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E783FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E753E4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E7856C00>]}
[0m09:46:43.045719 [debug] [MainThread]: Flushing usage events
[0m09:48:13.689434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B264854260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2648542C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B264855550>]}


============================== 09:48:13.693436 | cea9cd61-6eed-4aec-b03d-68c308c11c53 ==============================
[0m09:48:13.693436 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:48:13.694436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:48:13.697434 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'practice'
[0m09:48:13.698436 [debug] [MainThread]: Command `dbt run` failed at 09:48:13.698436 after 0.15 seconds
[0m09:48:13.698436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B264722A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2646C9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26432B0E0>]}
[0m09:48:13.699433 [debug] [MainThread]: Flushing usage events
[0m09:49:16.670867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DEC359490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DEC3591F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DEC359640>]}


============================== 09:49:16.683871 | 486da645-5550-4c77-8028-635928a38e89 ==============================
[0m09:49:16.683871 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:49:16.684871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:50:00.652935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '486da645-5550-4c77-8028-635928a38e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF87D1160>]}
[0m09:50:00.742547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '486da645-5550-4c77-8028-635928a38e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF8B73A70>]}
[0m09:50:00.751517 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:50:00.839128 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:50:01.085282 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:50:01.086283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '486da645-5550-4c77-8028-635928a38e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF694EE70>]}
[0m09:50:10.077857 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_product' (models\staging\stg_product.sql) depends on a node named 'dim_product' which was not found
[0m09:50:10.078837 [debug] [MainThread]: Command `dbt run` failed at 09:50:10.078837 after 53.50 seconds
[0m09:50:10.079827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DEC387950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF8EA1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DF8D14110>]}
[0m09:50:10.079827 [debug] [MainThread]: Flushing usage events
[0m09:51:36.431813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A53571D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A5356630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A5355850>]}


============================== 09:51:36.436819 | cf375e0e-e5b6-49ee-971a-34ca8a751500 ==============================
[0m09:51:36.436819 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:51:36.437819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:51:37.531820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf375e0e-e5b6-49ee-971a-34ca8a751500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B12BCB00>]}
[0m09:51:37.621432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf375e0e-e5b6-49ee-971a-34ca8a751500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B17CA5D0>]}
[0m09:51:37.622432 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:51:37.631403 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:51:37.644407 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:51:37.645407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf375e0e-e5b6-49ee-971a-34ca8a751500', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B1D13950>]}
[0m09:51:39.168878 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_product' (models\staging\stg_product.sql) depends on a node named 'dim_product' which was not found
[0m09:51:39.170881 [debug] [MainThread]: Command `dbt run` failed at 09:51:39.169879 after 2.80 seconds
[0m09:51:39.170881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128A525A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B2084B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128B1ECE480>]}
[0m09:51:39.171877 [debug] [MainThread]: Flushing usage events
[0m09:52:41.528633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F8ACAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F8C541A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F8C55370>]}


============================== 09:52:41.532670 | 6b8ef6e7-5dc1-4da7-bae7-f09415fae2e7 ==============================
[0m09:52:41.532670 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:52:41.533633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_country', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:42.464885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b8ef6e7-5dc1-4da7-bae7-f09415fae2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350154B980>]}
[0m09:52:42.556435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b8ef6e7-5dc1-4da7-bae7-f09415fae2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234FF998E30>]}
[0m09:52:42.557435 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:52:42.565466 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:52:42.577012 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:52:42.577012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b8ef6e7-5dc1-4da7-bae7-f09415fae2e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023501750EC0>]}
[0m09:52:43.934169 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_transaction' (models\staging\stg_transaction.sql) depends on a node named 'stg_ride_sharing_data' which was not found
[0m09:52:43.936173 [debug] [MainThread]: Command `dbt run` failed at 09:52:43.935170 after 2.47 seconds
[0m09:52:43.936173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F8B81910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235013D7A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235016A1BE0>]}
[0m09:52:43.937171 [debug] [MainThread]: Flushing usage events
[0m09:54:22.070937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD8702C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD88554F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD88555B0>]}


============================== 09:54:22.075938 | d0567f46-79b1-442c-96a1-03c74007055f ==============================
[0m09:54:22.075938 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:54:22.077939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_country', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:54:23.037186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0567f46-79b1-442c-96a1-03c74007055f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FE524FFE0>]}
[0m09:54:23.129702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0567f46-79b1-442c-96a1-03c74007055f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FE386DEE0>]}
[0m09:54:23.130703 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:54:23.140701 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:54:23.150702 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:54:23.150702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0567f46-79b1-442c-96a1-03c74007055f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FE521B080>]}
[0m09:54:24.631482 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_transaction' (models\staging\stg_transaction.sql) depends on a node named 'stg_ride_sharing_data' which was not found
[0m09:54:24.632482 [debug] [MainThread]: Command `dbt run` failed at 09:54:24.632482 after 2.69 seconds
[0m09:54:24.633482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD8781910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FE5627410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FE5627770>]}
[0m09:54:24.633482 [debug] [MainThread]: Flushing usage events
[0m09:54:56.636619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021340D553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021340D550A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021340D55550>]}


============================== 09:54:56.641616 | 2bcd82c1-6e3d-49ca-aa8c-03a3b083d603 ==============================
[0m09:54:56.641616 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:54:56.642121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_country', 'send_anonymous_usage_stats': 'True'}
[0m09:54:57.511353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D64FEF0>]}
[0m09:54:57.606873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D6D8470>]}
[0m09:54:57.607871 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:54:57.616871 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:54:57.627879 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:54:57.627879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D84D160>]}
[0m09:54:59.021105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m09:54:59.028108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134DAD1970>]}
[0m09:54:59.092624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D89E9F0>]}
[0m09:54:59.093626 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 444 macros, 0 groups, 0 semantic models
[0m09:54:59.094625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D8F3920>]}
[0m09:54:59.096627 [info ] [MainThread]: 
[0m09:54:59.097624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:59.098623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m09:54:59.114624 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m09:54:59.115623 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m09:54:59.115623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:02.970383 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 4.0 seconds
[0m09:55:02.972427 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m09:55:03.253036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_RAW_public'
[0m09:55:03.262034 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_RAW_public"
[0m09:55:03.263034 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_RAW_public"} */
show terse objects in SNOWFLAKE_PRAC.RAW_public limit 10000
[0m09:55:03.263034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:05.363913 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafea9-0001-42d7-0008-435e0001f056
[0m09:55:05.363913 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m09:55:05.364913 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m09:55:05.364913 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:55:05.365944 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: Close
[0m09:55:05.456425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_RAW_public, now list_RIDE_SHARING_DB_RAW)
[0m09:55:05.459425 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW"
[0m09:55:05.459425 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW"} */
show terse objects in RIDE_SHARING_DB.RAW limit 10000
[0m09:55:05.459425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:05.918596 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:55:05.920596 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: Close
[0m09:55:06.014212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW, now list_RIDE_SHARING_DB_RAW_STAGING)
[0m09:55:06.018210 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_STAGING"
[0m09:55:06.018210 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_STAGING"} */
show terse objects in RIDE_SHARING_DB.RAW_STAGING limit 10000
[0m09:55:06.019213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:06.326863 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:55:06.328862 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: Close
[0m09:55:06.416411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134DD64440>]}
[0m09:55:06.417411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:06.418410 [info ] [MainThread]: 
[0m09:55:06.475995 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m09:55:06.476992 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW_STAGING.stg_country ............................ [RUN]
[0m09:55:06.477995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m09:55:06.478992 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m09:55:06.490992 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m09:55:06.491993 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 09:55:06.478992 => 09:55:06.491993
[0m09:55:06.492992 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m09:55:06.527991 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m09:55:06.528991 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m09:55:06.528991 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.RAW_STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m09:55:06.529991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:06.953702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:55:06.976673 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 09:55:06.492992 => 09:55:06.975673
[0m09:55:06.976673 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m09:55:07.059711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcd82c1-6e3d-49ca-aa8c-03a3b083d603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D95F3E0>]}
[0m09:55:07.060711 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW_STAGING.stg_country ....................... [[32mSUCCESS 1[0m in 0.58s]
[0m09:55:07.061712 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m09:55:07.063713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:07.063713 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m09:55:07.064713 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_RAW_STAGING' was properly closed.
[0m09:55:07.064713 [debug] [MainThread]: Connection 'model.practice.stg_country' was properly closed.
[0m09:55:07.064713 [info ] [MainThread]: 
[0m09:55:07.065713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m09:55:07.066712 [debug] [MainThread]: Command end result
[0m09:55:07.075712 [info ] [MainThread]: 
[0m09:55:07.076714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:07.078714 [info ] [MainThread]: 
[0m09:55:07.078714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:55:07.080712 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:07.080712 after 10.51 seconds
[0m09:55:07.080712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021340D87950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021340C81AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213408291F0>]}
[0m09:55:07.081712 [debug] [MainThread]: Flushing usage events
[0m09:55:20.211570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0115B260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0115A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B01159FA0>]}


============================== 09:55:20.215571 | 5d2625a4-b445-4cda-a053-2556bf103db7 ==============================
[0m09:55:20.215571 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:55:20.216540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:55:21.085964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0D8C4BF0>]}
[0m09:55:21.177987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B01158470>]}
[0m09:55:21.178987 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:55:21.186987 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:55:21.326033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:55:21.327033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:55:21.327033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m09:55:21.334034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0DA48770>]}
[0m09:55:21.346050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0DC4A570>]}
[0m09:55:21.347045 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 444 macros, 0 groups, 0 semantic models
[0m09:55:21.348047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0D78DA00>]}
[0m09:55:21.350044 [info ] [MainThread]: 
[0m09:55:21.352045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:55:21.355045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m09:55:21.369559 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m09:55:21.370560 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m09:55:21.370560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:22.366012 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m09:55:22.367012 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m09:55:22.450025 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m09:55:22.451025 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m09:55:22.451025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:23.017937 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m09:55:23.019936 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m09:55:23.104520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_RAW_public'
[0m09:55:23.112517 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_RAW_public"
[0m09:55:23.112517 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_RAW_public"} */
show terse objects in SNOWFLAKE_PRAC.RAW_public limit 10000
[0m09:55:23.113517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:23.526574 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafea9-0001-429e-0008-435e0001e266
[0m09:55:23.575088 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m09:55:23.575088 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m09:55:23.575088 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:55:23.576088 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: Close
[0m09:55:23.671603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_RAW_public, now list_RIDE_SHARING_DB_RAW)
[0m09:55:23.675603 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW"
[0m09:55:23.675603 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW"} */
show terse objects in RIDE_SHARING_DB.RAW limit 10000
[0m09:55:23.676603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:24.043796 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:55:24.045796 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: Close
[0m09:55:24.132304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW, now list_RIDE_SHARING_DB_RAW_STAGING)
[0m09:55:24.135306 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_STAGING"
[0m09:55:24.136304 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_STAGING"} */
show terse objects in RIDE_SHARING_DB.RAW_STAGING limit 10000
[0m09:55:24.136304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:24.433009 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m09:55:24.434010 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: Close
[0m09:55:24.522622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0DF23620>]}
[0m09:55:24.523622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:24.524590 [info ] [MainThread]: 
[0m09:55:24.528590 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m09:55:24.528590 [info ] [Thread-1 (]: 1 of 5 START sql view model RAW.prod_transaction ............................... [RUN]
[0m09:55:24.529589 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m09:55:24.530590 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m09:55:24.537592 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m09:55:24.594181 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 09:55:24.530590 => 09:55:24.593211
[0m09:55:24.594181 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m09:55:24.626177 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m09:55:24.676733 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m09:55:24.676733 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace   view RIDE_SHARING_DB.RAW.prod_transaction
  
   as (
    WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM ref{}
    GROUP BY CUSTOMER_ID
)
SELECT 
    COUNT(CASE WHEN first_purchase = '2024-01-01' THEN CUSTOMER_ID END) AS new_customers,
    COUNT(CASE WHEN last_purchase < '2024-01-01' THEN CUSTOMER_ID END) AS churned_customers
FROM customer_activity;
[0m09:55:24.677764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:25.054521 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafea9-0001-429b-0008-435e0001d792
[0m09:55:25.054521 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '{'.
syntax error line 15 at position 22 unexpected ';'.
[0m09:55:25.055520 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 09:55:24.594181 => 09:55:25.054521
[0m09:55:25.055520 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m09:55:25.149038 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '{'.
  syntax error line 15 at position 22 unexpected ';'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m09:55:25.149038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0E04B740>]}
[0m09:55:25.150037 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model RAW.prod_transaction ...................... [[31mERROR[0m in 0.62s]
[0m09:55:25.151037 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m09:55:25.152037 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m09:55:25.152037 [info ] [Thread-1 (]: 2 of 5 START sql view model RAW_STAGING.stg_country ............................ [RUN]
[0m09:55:25.154038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.prod_transaction, now model.practice.stg_country)
[0m09:55:25.154038 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m09:55:25.157037 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m09:55:25.158542 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 09:55:25.154038 => 09:55:25.158542
[0m09:55:25.159549 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m09:55:25.162549 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m09:55:25.164552 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m09:55:25.164552 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.RAW_STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m09:55:25.165551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:25.620328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:55:25.642327 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 09:55:25.159549 => 09:55:25.642327
[0m09:55:25.643327 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m09:55:25.919941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0E033FE0>]}
[0m09:55:25.920941 [info ] [Thread-1 (]: 2 of 5 OK created sql view model RAW_STAGING.stg_country ....................... [[32mSUCCESS 1[0m in 0.77s]
[0m09:55:25.921940 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m09:55:25.921940 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m09:55:25.922940 [info ] [Thread-1 (]: 3 of 5 START sql view model RAW_STAGING.stg_customers .......................... [RUN]
[0m09:55:25.923941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m09:55:25.923941 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m09:55:25.927940 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m09:55:25.992459 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 09:55:25.924940 => 09:55:25.992459
[0m09:55:25.993460 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m09:55:25.997460 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m09:55:25.998459 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m09:55:25.999460 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.RAW_STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m09:55:25.999460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:26.531520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:55:26.534555 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 09:55:25.993460 => 09:55:26.534555
[0m09:55:26.535554 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m09:55:26.635099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0E031AC0>]}
[0m09:55:26.636099 [info ] [Thread-1 (]: 3 of 5 OK created sql view model RAW_STAGING.stg_customers ..................... [[32mSUCCESS 1[0m in 0.71s]
[0m09:55:26.637099 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m09:55:26.637099 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m09:55:26.638101 [info ] [Thread-1 (]: 4 of 5 START sql view model RAW_STAGING.stg_product ............................ [RUN]
[0m09:55:26.639100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m09:55:26.639100 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m09:55:26.644099 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m09:55:26.645104 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 09:55:26.640100 => 09:55:26.645104
[0m09:55:26.645104 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m09:55:26.649104 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m09:55:26.650106 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m09:55:26.650106 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.RAW_STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m09:55:26.651104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:27.166061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:55:27.169062 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 09:55:26.646105 => 09:55:27.169062
[0m09:55:27.169062 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m09:55:27.262545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0E0945F0>]}
[0m09:55:27.263546 [info ] [Thread-1 (]: 4 of 5 OK created sql view model RAW_STAGING.stg_product ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m09:55:27.264544 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m09:55:27.265545 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m09:55:27.265545 [info ] [Thread-1 (]: 5 of 5 START sql view model RAW_STAGING.stg_transaction ........................ [RUN]
[0m09:55:27.266546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m09:55:27.267547 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m09:55:27.270547 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m09:55:27.272548 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 09:55:27.267547 => 09:55:27.271549
[0m09:55:27.272548 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m09:55:27.276551 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m09:55:27.320548 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m09:55:27.321546 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.RAW_STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m09:55:27.322549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:27.957619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:55:27.960135 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 09:55:27.273548 => 09:55:27.960135
[0m09:55:27.961142 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m09:55:28.042142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2625a4-b445-4cda-a053-2556bf103db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0E0947D0>]}
[0m09:55:28.042142 [info ] [Thread-1 (]: 5 of 5 OK created sql view model RAW_STAGING.stg_transaction ................... [[32mSUCCESS 1[0m in 0.78s]
[0m09:55:28.043142 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m09:55:28.046150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:28.046150 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m09:55:28.046150 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_RAW_STAGING' was properly closed.
[0m09:55:28.047149 [debug] [MainThread]: Connection 'model.practice.stg_transaction' was properly closed.
[0m09:55:28.047149 [info ] [MainThread]: 
[0m09:55:28.048150 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m09:55:28.050153 [debug] [MainThread]: Command end result
[0m09:55:28.060152 [info ] [MainThread]: 
[0m09:55:28.061528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:55:28.062529 [info ] [MainThread]: 
[0m09:55:28.062529 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '{'.
  syntax error line 15 at position 22 unexpected ';'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m09:55:28.063527 [info ] [MainThread]: 
[0m09:55:28.064527 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:55:28.065527 [debug] [MainThread]: Command `dbt run` failed at 09:55:28.065527 after 7.92 seconds
[0m09:55:28.065527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B01050440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0118BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0118BFB0>]}
[0m09:55:28.066527 [debug] [MainThread]: Flushing usage events
[0m09:59:36.164002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F39FE55310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F39FE55280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F39FE556A0>]}


============================== 09:59:36.168042 | 719a9c88-5612-415f-b263-22eaaebc730b ==============================
[0m09:59:36.168042 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:59:36.169040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:37.216764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '719a9c88-5612-415f-b263-22eaaebc730b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F3AC74FFE0>]}
[0m09:59:37.310281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '719a9c88-5612-415f-b263-22eaaebc730b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F3AC3C0B60>]}
[0m09:59:37.311282 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:59:37.320280 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:59:37.421867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:59:37.422868 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m09:59:37.423866 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m09:59:37.423866 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m09:59:37.572441 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_transaction' (models\staging\stg_transaction.sql) depends on a node named 'stg_ride_sharing_data' which was not found
[0m09:59:37.573412 [debug] [MainThread]: Command `dbt run` failed at 09:59:37.573412 after 1.47 seconds
[0m09:59:37.573412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F39FD21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F3AC9DD040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F3AC64B830>]}
[0m09:59:37.574441 [debug] [MainThread]: Flushing usage events
[0m10:00:19.673481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD2E959040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD2E958200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD2E9595E0>]}


============================== 10:00:19.678480 | 932fe3dc-fa1f-4d36-8d62-f11cf5dd4267 ==============================
[0m10:00:19.678480 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:00:19.679482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:00:20.652580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '932fe3dc-fa1f-4d36-8d62-f11cf5dd4267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD393ECB00>]}
[0m10:00:20.744855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '932fe3dc-fa1f-4d36-8d62-f11cf5dd4267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD39ED3920>]}
[0m10:00:20.745856 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:00:20.754925 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:00:20.848932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:00:20.849932 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m10:00:20.849932 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:00:20.992592 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_product' (models\staging\stg_product.sql) depends on a node named 'dim_product' which was not found
[0m10:00:20.993593 [debug] [MainThread]: Command `dbt run` failed at 10:00:20.993593 after 1.38 seconds
[0m10:00:20.994593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD2E881A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3933F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3B3793D0>]}
[0m10:00:20.994593 [debug] [MainThread]: Flushing usage events
[0m10:00:38.601317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D377553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D37754080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D377555E0>]}


============================== 10:00:38.606320 | 0d9ee78e-3aab-49a1-9161-102c9937b7d6 ==============================
[0m10:00:38.606320 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:00:38.606861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m10:00:39.507332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d9ee78e-3aab-49a1-9161-102c9937b7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D44021970>]}
[0m10:00:39.600579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d9ee78e-3aab-49a1-9161-102c9937b7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D42710BF0>]}
[0m10:00:39.601552 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:00:39.610136 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:00:39.701181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:00:39.702151 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m10:00:39.702151 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:00:39.844189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:00:39.851189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d9ee78e-3aab-49a1-9161-102c9937b7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D441B9A00>]}
[0m10:00:39.866187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d9ee78e-3aab-49a1-9161-102c9937b7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D444721E0>]}
[0m10:00:39.867188 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 444 macros, 0 groups, 0 semantic models
[0m10:00:39.868209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d9ee78e-3aab-49a1-9161-102c9937b7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D37757170>]}
[0m10:00:39.871186 [info ] [MainThread]: 
[0m10:00:39.873187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:00:39.874186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:00:39.890189 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:00:39.891187 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:00:39.891187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:41.000784 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m10:00:41.006783 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:00:41.111868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_RAW'
[0m10:00:41.125868 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW"
[0m10:00:41.126870 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW"} */
show terse objects in RIDE_SHARING_DB.RAW limit 10000
[0m10:00:41.128869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:41.557154 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:00:41.560112 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: Close
[0m10:00:41.656560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW, now list_RIDE_SHARING_DB_RAW_MART)
[0m10:00:41.659558 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_MART"
[0m10:00:41.660558 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_MART"} */
show terse objects in RIDE_SHARING_DB.RAW_MART limit 10000
[0m10:00:41.660558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:41.962759 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeae-0001-429e-0008-435e0001e276
[0m10:00:41.962759 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:00:41.963793 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:00:41.963793 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:00:41.963793 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: Close
[0m10:00:42.081243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW_MART, now list_SNOWFLAKE_PRAC_RAW_public)
[0m10:00:42.084244 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_RAW_public"
[0m10:00:42.084244 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_RAW_public"} */
show terse objects in SNOWFLAKE_PRAC.RAW_public limit 10000
[0m10:00:42.085211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:42.511245 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeae-0001-429b-0008-435e0001d7ba
[0m10:00:42.512243 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:00:42.512243 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:00:42.512243 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:00:42.512243 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: Close
[0m10:00:42.600310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_RAW_public, now list_RIDE_SHARING_DB_RAW_STAGING)
[0m10:00:42.604325 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_STAGING"
[0m10:00:42.604325 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_STAGING"} */
show terse objects in RIDE_SHARING_DB.RAW_STAGING limit 10000
[0m10:00:42.605337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:42.931897 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:00:42.932893 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: Close
[0m10:00:43.015716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d9ee78e-3aab-49a1-9161-102c9937b7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D4444B320>]}
[0m10:00:43.015716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:00:43.016689 [info ] [MainThread]: 
[0m10:00:43.021689 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:00:43.021689 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.prod_transaction ............................... [RUN]
[0m10:00:43.023691 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:00:43.023691 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:00:43.030690 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:00:43.032689 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:00:43.024722 => 10:00:43.031722
[0m10:00:43.032689 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:00:43.067720 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:00:43.070692 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:00:43.070692 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace   view RIDE_SHARING_DB.RAW.prod_transaction
  
   as (
    WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM ref{'stg_transaction'}
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATE_DIFF('month', first_purchase, last_purchase) AS months_active  
FROM customer_activity;
[0m10:00:43.071691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:00:43.388569 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeae-0001-429b-0008-435e0001d7c2
[0m10:00:43.388569 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '{'.
syntax error line 17 at position 22 unexpected ';'.
[0m10:00:43.389602 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:00:43.033721 => 10:00:43.389602
[0m10:00:43.389602 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:00:43.477243 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '{'.
  syntax error line 17 at position 22 unexpected ';'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:00:43.478243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d9ee78e-3aab-49a1-9161-102c9937b7d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D4442E600>]}
[0m10:00:43.478243 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.prod_transaction ...................... [[31mERROR[0m in 0.45s]
[0m10:00:43.479209 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:00:43.482245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:43.482245 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:00:43.483243 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_RAW_STAGING' was properly closed.
[0m10:00:43.483243 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:00:43.483243 [info ] [MainThread]: 
[0m10:00:43.484211 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m10:00:43.486215 [debug] [MainThread]: Command end result
[0m10:00:43.497254 [info ] [MainThread]: 
[0m10:00:43.498246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:00:43.499215 [info ] [MainThread]: 
[0m10:00:43.499637 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '{'.
  syntax error line 17 at position 22 unexpected ';'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:00:43.500501 [info ] [MainThread]: 
[0m10:00:43.501517 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:00:43.502510 [debug] [MainThread]: Command `dbt run` failed at 10:00:43.502510 after 4.96 seconds
[0m10:00:43.503510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D37659100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D44118B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D3733F3B0>]}
[0m10:00:43.504543 [debug] [MainThread]: Flushing usage events
[0m10:00:56.430131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B4C556A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B4C554F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B4C57C80>]}


============================== 10:00:56.434130 | 02e2d6cc-dda7-4af6-aee5-d06ae08597cd ==============================
[0m10:00:56.434130 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:00:56.435098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:00:57.349883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e2d6cc-dda7-4af6-aee5-d06ae08597cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C164B980>]}
[0m10:00:57.444077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e2d6cc-dda7-4af6-aee5-d06ae08597cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BF7580B0>]}
[0m10:00:57.446077 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:00:57.455036 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:00:57.586240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:00:57.587240 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:00:57.730093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:00:57.736100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e2d6cc-dda7-4af6-aee5-d06ae08597cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C192DC10>]}
[0m10:00:57.750331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e2d6cc-dda7-4af6-aee5-d06ae08597cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C1752210>]}
[0m10:00:57.750331 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 444 macros, 0 groups, 0 semantic models
[0m10:00:57.751363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e2d6cc-dda7-4af6-aee5-d06ae08597cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BF268EC0>]}
[0m10:00:57.755337 [info ] [MainThread]: 
[0m10:00:57.756330 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:00:57.758362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:00:57.773363 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:00:57.773363 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:00:57.773363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:58.925014 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m10:00:58.928023 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:00:59.032542 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_RAW'
[0m10:00:59.054062 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW"
[0m10:00:59.055059 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW"} */
show terse objects in RIDE_SHARING_DB.RAW limit 10000
[0m10:00:59.055059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:59.377996 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:00:59.381029 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: Close
[0m10:00:59.477658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW, now list_RIDE_SHARING_DB_RAW_STAGING)
[0m10:00:59.479633 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_STAGING"
[0m10:00:59.480633 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_STAGING"} */
show terse objects in RIDE_SHARING_DB.RAW_STAGING limit 10000
[0m10:00:59.480633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:59.794967 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:00:59.796960 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: Close
[0m10:00:59.893118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW_STAGING, now list_SNOWFLAKE_PRAC_RAW_public)
[0m10:00:59.903152 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_RAW_public"
[0m10:00:59.904150 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_RAW_public"} */
show terse objects in SNOWFLAKE_PRAC.RAW_public limit 10000
[0m10:00:59.905150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:00.216702 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeae-0001-429a-0008-435e0001aeae
[0m10:01:00.216702 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:01:00.217702 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:01:00.217702 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:01:00.218735 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: Close
[0m10:01:00.306744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_RAW_public, now list_RIDE_SHARING_DB_RAW_MART)
[0m10:01:00.309773 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_MART"
[0m10:01:00.309773 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_MART"} */
show terse objects in RIDE_SHARING_DB.RAW_MART limit 10000
[0m10:01:00.310747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:00.580176 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeae-0001-429e-0008-435e0001e27a
[0m10:01:00.580176 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:01:00.580176 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:01:00.581198 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:01:00.581198 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: Close
[0m10:01:00.667219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e2d6cc-dda7-4af6-aee5-d06ae08597cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C1A055B0>]}
[0m10:01:00.668182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:01:00.669185 [info ] [MainThread]: 
[0m10:01:00.673183 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:01:00.674208 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.prod_transaction ............................... [RUN]
[0m10:01:00.675183 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:01:00.676185 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:01:00.683210 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:01:00.684183 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:01:00.676185 => 10:01:00.684183
[0m10:01:00.685183 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:01:00.720192 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:01:00.723218 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:01:00.723218 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace   view RIDE_SHARING_DB.RAW.prod_transaction
  
   as (
    WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM ref{'stg_transaction'}
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATE_DIFF('month', first_purchase, last_purchase) AS months_active  
FROM customer_activity
  );
[0m10:01:00.724224 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:01:01.149766 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeaf-0001-429b-0008-435e0001d7c6
[0m10:01:01.150766 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 12 unexpected '{'.
[0m10:01:01.151729 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:01:00.685183 => 10:01:01.151729
[0m10:01:01.152728 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:01:01.255801 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '{'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:01:01.256801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e2d6cc-dda7-4af6-aee5-d06ae08597cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C1BA7140>]}
[0m10:01:01.257804 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.prod_transaction ...................... [[31mERROR[0m in 0.58s]
[0m10:01:01.259763 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:01:01.263773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:01.264793 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:01:01.265793 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_RAW_MART' was properly closed.
[0m10:01:01.265793 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:01:01.266793 [info ] [MainThread]: 
[0m10:01:01.267756 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m10:01:01.268756 [debug] [MainThread]: Command end result
[0m10:01:01.279769 [info ] [MainThread]: 
[0m10:01:01.280757 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:01:01.281756 [info ] [MainThread]: 
[0m10:01:01.282757 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 12 unexpected '{'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:01:01.283788 [info ] [MainThread]: 
[0m10:01:01.284762 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:01:01.285756 [debug] [MainThread]: Command `dbt run` failed at 10:01:01.285756 after 4.92 seconds
[0m10:01:01.286795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B2B31220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C13C6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C18DCD40>]}
[0m10:01:01.286795 [debug] [MainThread]: Flushing usage events
[0m10:02:34.232079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DA61591F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DA4FCBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DA6158200>]}


============================== 10:02:34.246078 | b2ba4826-7b81-416b-a80e-c2bb3cd8786c ==============================
[0m10:02:34.246078 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:02:34.246078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_transaction', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:02:36.355879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2ba4826-7b81-416b-a80e-c2bb3cd8786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DB28C2A50>]}
[0m10:02:36.446040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2ba4826-7b81-416b-a80e-c2bb3cd8786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DB074F0B0>]}
[0m10:02:36.447040 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:02:36.459039 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:02:36.593536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:02:36.594537 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:02:36.735045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:02:36.742045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2ba4826-7b81-416b-a80e-c2bb3cd8786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DB2E49970>]}
[0m10:02:36.754068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2ba4826-7b81-416b-a80e-c2bb3cd8786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DB2C8EA50>]}
[0m10:02:36.754068 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 444 macros, 0 groups, 0 semantic models
[0m10:02:36.755062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ba4826-7b81-416b-a80e-c2bb3cd8786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DB2B48980>]}
[0m10:02:36.757065 [info ] [MainThread]: 
[0m10:02:36.758064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:02:36.759063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:02:36.774062 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:02:36.775067 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:02:36.776067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:38.170068 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m10:02:38.172068 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:02:38.534659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_RAW_MART'
[0m10:02:38.545623 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_MART"
[0m10:02:38.546623 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_MART"} */
show terse objects in RIDE_SHARING_DB.RAW_MART limit 10000
[0m10:02:38.546623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:38.873951 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeb0-0001-429a-0008-435e0001aeb6
[0m10:02:38.874947 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:02:38.874947 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:02:38.874947 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:02:38.875946 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: Close
[0m10:02:38.961855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW_MART, now list_RIDE_SHARING_DB_RAW_STAGING)
[0m10:02:38.964856 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_STAGING"
[0m10:02:38.965856 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_STAGING"} */
show terse objects in RIDE_SHARING_DB.RAW_STAGING limit 10000
[0m10:02:38.965856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:39.562343 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:02:39.570347 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: Close
[0m10:02:39.673671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW_STAGING, now list_RIDE_SHARING_DB_RAW)
[0m10:02:39.677672 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW"
[0m10:02:39.678674 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW"} */
show terse objects in RIDE_SHARING_DB.RAW limit 10000
[0m10:02:39.678674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:40.023307 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:02:40.025308 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: Close
[0m10:02:40.117031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW, now list_SNOWFLAKE_PRAC_RAW_public)
[0m10:02:40.121547 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_RAW_public"
[0m10:02:40.122547 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_RAW_public"} */
show terse objects in SNOWFLAKE_PRAC.RAW_public limit 10000
[0m10:02:40.124582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:40.400687 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeb0-0001-429e-0008-435e0001e282
[0m10:02:40.401702 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:02:40.401702 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:02:40.402688 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:02:40.402688 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: Close
[0m10:02:40.489511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ba4826-7b81-416b-a80e-c2bb3cd8786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DB2F201A0>]}
[0m10:02:40.492524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:40.493462 [info ] [MainThread]: 
[0m10:02:40.504021 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:02:40.505057 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.prod_transaction ............................... [RUN]
[0m10:02:40.507067 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:02:40.507067 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:02:40.517095 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:02:40.519063 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:02:40.508098 => 10:02:40.518095
[0m10:02:40.519063 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:02:40.551638 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:02:40.553608 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:02:40.554640 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace   view RIDE_SHARING_DB.RAW.prod_transaction
  
   as (
    WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.RAW_STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATE_DIFF('month', first_purchase, last_purchase) AS months_active  
FROM customer_activity
  );
[0m10:02:40.554640 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:02:41.025112 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeb0-0001-429b-0008-435e0001d7ca
[0m10:02:41.026112 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function DATE_DIFF
[0m10:02:41.027112 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:02:40.519063 => 10:02:41.026112
[0m10:02:41.027112 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:02:41.111961 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:02:41.112961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ba4826-7b81-416b-a80e-c2bb3cd8786c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DB314FE30>]}
[0m10:02:41.113960 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.prod_transaction ...................... [[31mERROR[0m in 0.61s]
[0m10:02:41.114929 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:02:41.117929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:41.117929 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:02:41.118932 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_RAW_public' was properly closed.
[0m10:02:41.118932 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:02:41.119931 [info ] [MainThread]: 
[0m10:02:41.119931 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m10:02:41.120930 [debug] [MainThread]: Command end result
[0m10:02:41.131320 [info ] [MainThread]: 
[0m10:02:41.132289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:02:41.133288 [info ] [MainThread]: 
[0m10:02:41.134288 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:02:41.135290 [info ] [MainThread]: 
[0m10:02:41.136313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:02:41.137291 [debug] [MainThread]: Command `dbt run` failed at 10:02:41.137291 after 6.98 seconds
[0m10:02:41.138324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DA4D39910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DA4E67A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DA6050680>]}
[0m10:02:41.138324 [debug] [MainThread]: Flushing usage events
[0m10:03:01.108613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610DC64890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610DACB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610D0FAC00>]}


============================== 10:03:01.112581 | c7bccc8c-7b6a-4c53-b486-7bd2a82273c1 ==============================
[0m10:03:01.112581 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:03:01.113612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:01.982663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7bccc8c-7b6a-4c53-b486-7bd2a82273c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161182DF530>]}
[0m10:03:02.078279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7bccc8c-7b6a-4c53-b486-7bd2a82273c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611A4439B0>]}
[0m10:03:02.079279 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:03:02.088196 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:03:02.194749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:02.195750 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:03:02.346437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:03:02.353400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7bccc8c-7b6a-4c53-b486-7bd2a82273c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611AB45760>]}
[0m10:03:02.366913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7bccc8c-7b6a-4c53-b486-7bd2a82273c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611A952120>]}
[0m10:03:02.366913 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 444 macros, 0 groups, 0 semantic models
[0m10:03:02.367913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7bccc8c-7b6a-4c53-b486-7bd2a82273c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611A952090>]}
[0m10:03:02.369913 [info ] [MainThread]: 
[0m10:03:02.371911 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:03:02.372912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:03:02.387910 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:03:02.388910 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:03:02.388910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:03.585376 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m10:03:03.587374 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:03:03.672474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_RAW_MART'
[0m10:03:03.681471 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_MART"
[0m10:03:03.682471 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_MART"} */
show terse objects in RIDE_SHARING_DB.RAW_MART limit 10000
[0m10:03:03.682471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:04.013126 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeb1-0001-429e-0008-435e0001e28a
[0m10:03:04.013126 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:03:04.014125 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:03:04.015124 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:03:04.016123 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_MART: Close
[0m10:03:04.103488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW_MART, now list_RIDE_SHARING_DB_RAW_STAGING)
[0m10:03:04.106489 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW_STAGING"
[0m10:03:04.106489 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW_STAGING"} */
show terse objects in RIDE_SHARING_DB.RAW_STAGING limit 10000
[0m10:03:04.107511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:04.545312 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:03:04.547283 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW_STAGING: Close
[0m10:03:04.633891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW_STAGING, now list_SNOWFLAKE_PRAC_RAW_public)
[0m10:03:04.635878 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_RAW_public"
[0m10:03:04.636896 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_RAW_public"} */
show terse objects in SNOWFLAKE_PRAC.RAW_public limit 10000
[0m10:03:04.636896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:05.184978 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeb1-0001-429b-0008-435e0001d7ce
[0m10:03:05.184978 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:03:05.185980 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:03:05.185980 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:03:05.185980 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_RAW_public: Close
[0m10:03:05.276622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_RAW_public, now list_RIDE_SHARING_DB_RAW)
[0m10:03:05.278652 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW"
[0m10:03:05.279623 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW"} */
show terse objects in RIDE_SHARING_DB.RAW limit 10000
[0m10:03:05.279623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:05.590294 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:03:05.592292 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: Close
[0m10:03:05.680334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7bccc8c-7b6a-4c53-b486-7bd2a82273c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611AC74680>]}
[0m10:03:05.681334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:05.683338 [info ] [MainThread]: 
[0m10:03:05.688333 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:03:05.689362 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.prod_transaction ............................... [RUN]
[0m10:03:05.690335 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:03:05.691358 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:03:05.701364 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:03:05.702332 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:03:05.692333 => 10:03:05.702332
[0m10:03:05.703331 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:03:05.737332 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:03:05.739332 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:03:05.740332 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace   view RIDE_SHARING_DB.RAW.prod_transaction
  
   as (
    WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.RAW_STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
FROM customer_activity
  );
[0m10:03:05.740332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:03:06.191387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:03:06.211385 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:03:05.703331 => 10:03:06.211385
[0m10:03:06.212358 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:03:06.298594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7bccc8c-7b6a-4c53-b486-7bd2a82273c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001611AE44260>]}
[0m10:03:06.299592 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.prod_transaction .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m10:03:06.300592 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:03:06.303594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:06.303594 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:03:06.303594 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_RAW' was properly closed.
[0m10:03:06.304596 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:03:06.304596 [info ] [MainThread]: 
[0m10:03:06.305591 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m10:03:06.307594 [debug] [MainThread]: Command end result
[0m10:03:06.320592 [info ] [MainThread]: 
[0m10:03:06.321590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:06.322595 [info ] [MainThread]: 
[0m10:03:06.323592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:03:06.326598 [debug] [MainThread]: Command `dbt run` succeeded at 10:03:06.325593 after 5.28 seconds
[0m10:03:06.326598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610DB19880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610DB19AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001610DE87F50>]}
[0m10:03:06.327594 [debug] [MainThread]: Flushing usage events
[0m10:05:05.729805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC43FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC8555B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC855670>]}


============================== 10:05:05.742805 | 89ca9185-fec0-42b0-9bf3-113206e74660 ==============================
[0m10:05:05.742805 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:05:05.743773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_transaction', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:05:13.958266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ca9185-fec0-42b0-9bf3-113206e74660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F90BC170>]}
[0m10:05:14.051850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ca9185-fec0-42b0-9bf3-113206e74660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC722840>]}
[0m10:05:14.059849 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:05:14.077883 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:05:15.469404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:05:15.470406 [debug] [MainThread]: Partial parsing: added file: practice://macros\generate_schema_name.sql
[0m10:05:15.470406 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:05:15.473404 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m10:05:16.807117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:05:16.813116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ca9185-fec0-42b0-9bf3-113206e74660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F975F050>]}
[0m10:05:16.849683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ca9185-fec0-42b0-9bf3-113206e74660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F93C1820>]}
[0m10:05:16.849683 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:05:16.850664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ca9185-fec0-42b0-9bf3-113206e74660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F9512570>]}
[0m10:05:16.854681 [info ] [MainThread]: 
[0m10:05:16.856667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:05:16.857667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:05:16.871666 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:05:16.872669 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:05:16.872669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:17.870451 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m10:05:17.872483 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:05:17.974534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_RAW'
[0m10:05:17.995534 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_RAW"
[0m10:05:17.996562 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_RAW"} */
show terse objects in RIDE_SHARING_DB.RAW limit 10000
[0m10:05:17.997558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:18.423434 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m10:05:18.425430 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_RAW: Close
[0m10:05:18.506034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_RAW, now list_RIDE_SHARING_DB_STAGING)
[0m10:05:18.509967 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:05:18.509967 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:05:18.509967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:18.811922 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m10:05:18.812915 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:05:18.898954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m10:05:18.901954 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:05:18.901954 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:05:18.902952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:19.210998 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:05:19.214993 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:05:19.328399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m10:05:19.333398 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:05:19.333398 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:05:19.333398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:19.816660 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeb3-0001-429e-0008-435e0001e2ca
[0m10:05:19.817660 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:05:19.817660 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:05:19.818660 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:05:19.818660 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:05:19.895934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m10:05:19.899967 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:05:19.899967 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:05:19.899967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:20.193255 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m10:05:20.195253 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:05:20.271424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ca9185-fec0-42b0-9bf3-113206e74660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F9606810>]}
[0m10:05:20.272458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:05:20.273364 [info ] [MainThread]: 
[0m10:05:20.277688 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:05:20.277688 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:05:20.279688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:05:20.279688 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:05:20.289694 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:05:20.290688 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:05:20.280688 => 10:05:20.290688
[0m10:05:20.291720 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:05:20.326720 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:05:20.328688 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:05:20.328688 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
FROM customer_activity
        );
[0m10:05:20.329719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:05:20.793380 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeb3-0001-429a-0008-435e0001aef6
[0m10:05:20.793380 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RIDE_SHARING_DB.STAGING.STG_TRANSACTION' does not exist or not authorized.
[0m10:05:20.794387 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:05:20.291720 => 10:05:20.794387
[0m10:05:20.794387 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:05:20.874868 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'RIDE_SHARING_DB.STAGING.STG_TRANSACTION' does not exist or not authorized.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:05:20.875867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ca9185-fec0-42b0-9bf3-113206e74660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5F975C9B0>]}
[0m10:05:20.875867 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.60s]
[0m10:05:20.877835 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:05:20.879834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:20.880868 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:05:20.880868 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m10:05:20.880868 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:05:20.881865 [info ] [MainThread]: 
[0m10:05:20.881865 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m10:05:20.883868 [debug] [MainThread]: Command end result
[0m10:05:20.895834 [info ] [MainThread]: 
[0m10:05:20.896836 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:05:20.897837 [info ] [MainThread]: 
[0m10:05:20.897837 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'RIDE_SHARING_DB.STAGING.STG_TRANSACTION' does not exist or not authorized.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:05:20.898835 [info ] [MainThread]: 
[0m10:05:20.899865 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:05:20.901721 [debug] [MainThread]: Command `dbt run` failed at 10:05:20.900712 after 15.31 seconds
[0m10:05:20.901721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC609880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC75B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5EC83FD70>]}
[0m10:05:20.902722 [debug] [MainThread]: Flushing usage events
[0m10:07:31.750386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D854140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D32B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D8540B0>]}


============================== 10:07:31.754384 | 86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079 ==============================
[0m10:07:31.754384 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:07:31.755391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:07:32.632278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A0EFDA0>]}
[0m10:07:32.722533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B08EC0AD0>]}
[0m10:07:32.723531 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:07:32.732585 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:07:32.756584 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:07:32.757584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A352210>]}
[0m10:07:34.104583 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:07:34.109614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A6016A0>]}
[0m10:07:34.124584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A54CDA0>]}
[0m10:07:34.124584 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:07:34.125584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A572720>]}
[0m10:07:34.127583 [info ] [MainThread]: 
[0m10:07:34.129615 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:07:34.130607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:07:34.145614 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:07:34.146584 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:07:34.146584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:35.107519 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m10:07:35.114518 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:07:35.206791 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:07:35.207798 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:07:35.207798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:35.626153 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m10:07:35.629151 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:07:35.723672 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:07:35.724706 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:07:35.725673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:36.018359 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m10:07:36.019355 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:07:36.107071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB, now create_RIDE_SHARING_DB_MART)
[0m10:07:36.108701 [debug] [ThreadPool]: Creating schema "database: "RIDE_SHARING_DB"
schema: "MART"
"
[0m10:07:36.113709 [debug] [ThreadPool]: Using snowflake connection "create_RIDE_SHARING_DB_MART"
[0m10:07:36.114710 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "create_RIDE_SHARING_DB_MART"} */
create schema if not exists RIDE_SHARING_DB.MART
[0m10:07:36.114710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:36.596898 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:07:36.597867 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_MART: Close
[0m10:07:36.684912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:07:36.692886 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:07:36.693887 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:07:36.693887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:37.023344 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m10:07:37.024339 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:07:37.104065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m10:07:37.106649 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:07:37.106649 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:07:37.107615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:37.394304 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m10:07:37.395302 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:07:37.475293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m10:07:37.479292 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:07:37.480284 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:07:37.480284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:37.801757 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m10:07:37.803755 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:07:37.892658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m10:07:37.895659 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:07:37.896660 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:07:37.896660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:38.181645 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:07:38.182643 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:07:38.262776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A486C90>]}
[0m10:07:38.264780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:07:38.265740 [info ] [MainThread]: 
[0m10:07:38.268859 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m10:07:38.269897 [info ] [Thread-1 (]: 1 of 5 START sql view model STAGING.stg_country ................................ [RUN]
[0m10:07:38.270865 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m10:07:38.271868 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m10:07:38.282865 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m10:07:38.292799 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 10:07:38.271868 => 10:07:38.291794
[0m10:07:38.292799 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m10:07:38.325387 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m10:07:38.333345 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m10:07:38.333345 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m10:07:38.334341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:07:38.760180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:07:38.779186 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 10:07:38.293799 => 10:07:38.778154
[0m10:07:38.779186 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m10:07:38.859729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A8E0FB0>]}
[0m10:07:38.859729 [info ] [Thread-1 (]: 1 of 5 OK created sql view model STAGING.stg_country ........................... [[32mSUCCESS 1[0m in 0.59s]
[0m10:07:38.860878 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m10:07:38.861915 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m10:07:38.861915 [info ] [Thread-1 (]: 2 of 5 START sql view model STAGING.stg_customers .............................. [RUN]
[0m10:07:38.862922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m10:07:38.863916 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m10:07:38.866884 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m10:07:38.868893 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 10:07:38.863916 => 10:07:38.867897
[0m10:07:38.868893 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m10:07:38.872885 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m10:07:38.873917 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m10:07:38.874919 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m10:07:38.874919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:39.325785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:07:39.328821 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 10:07:38.868893 => 10:07:39.328821
[0m10:07:39.329786 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m10:07:39.411221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A8E0FB0>]}
[0m10:07:39.412186 [info ] [Thread-1 (]: 2 of 5 OK created sql view model STAGING.stg_customers ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m10:07:39.413187 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m10:07:39.413187 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m10:07:39.414187 [info ] [Thread-1 (]: 3 of 5 START sql table model MART.stg_product .................................. [RUN]
[0m10:07:39.415186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m10:07:39.415186 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m10:07:39.419198 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m10:07:39.421188 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 10:07:39.416186 => 10:07:39.420219
[0m10:07:39.421188 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m10:07:39.445220 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m10:07:39.446219 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m10:07:39.447219 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace transient table RIDE_SHARING_DB.MART.stg_product
         as
        (

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS



        );
[0m10:07:39.447219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:40.906635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:07:40.909635 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 10:07:39.422220 => 10:07:40.909635
[0m10:07:40.909635 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m10:07:40.994963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A9AB350>]}
[0m10:07:40.996007 [info ] [Thread-1 (]: 3 of 5 OK created sql table model MART.stg_product ............................. [[32mSUCCESS 1[0m in 1.58s]
[0m10:07:40.996970 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m10:07:40.998009 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m10:07:40.999006 [info ] [Thread-1 (]: 4 of 5 START sql view model STAGING.stg_transaction ............................ [RUN]
[0m10:07:40.999970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m10:07:41.001004 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m10:07:41.005005 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m10:07:41.006970 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 10:07:41.001004 => 10:07:41.006003
[0m10:07:41.006970 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m10:07:41.011486 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m10:07:41.013485 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m10:07:41.013485 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m10:07:41.014523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:41.449307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:07:41.452308 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 10:07:41.006970 => 10:07:41.451308
[0m10:07:41.452308 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m10:07:41.537386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A9AAED0>]}
[0m10:07:41.537386 [info ] [Thread-1 (]: 4 of 5 OK created sql view model STAGING.stg_transaction ....................... [[32mSUCCESS 1[0m in 0.54s]
[0m10:07:41.539386 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m10:07:41.539386 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:07:41.540387 [info ] [Thread-1 (]: 5 of 5 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:07:41.541389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_transaction, now model.practice.prod_transaction)
[0m10:07:41.542385 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:07:41.545385 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:07:41.546386 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:07:41.542385 => 10:07:41.546386
[0m10:07:41.546386 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:07:41.549385 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:07:41.551387 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:07:41.551387 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
FROM customer_activity
        );
[0m10:07:41.552388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:43.954895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:07:43.957892 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:07:41.547387 => 10:07:43.957892
[0m10:07:43.958892 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:07:44.046416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86c27d6b-6c2b-42f8-bf9b-ba0e3fff0079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B0A96EB70>]}
[0m10:07:44.048369 [info ] [Thread-1 (]: 5 of 5 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 2.50s]
[0m10:07:44.050371 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:07:44.055402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:44.055402 [debug] [MainThread]: Connection 'create_RIDE_SHARING_DB_MART' was properly closed.
[0m10:07:44.056401 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m10:07:44.057405 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:07:44.057405 [info ] [MainThread]: 
[0m10:07:44.059368 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 9.93 seconds (9.93s).
[0m10:07:44.061397 [debug] [MainThread]: Command end result
[0m10:07:44.073360 [info ] [MainThread]: 
[0m10:07:44.074361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:44.075360 [info ] [MainThread]: 
[0m10:07:44.076360 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:07:44.077105 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:44.077105 after 12.40 seconds
[0m10:07:44.078146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D439E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D43BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D518260>]}
[0m10:07:44.078146 [debug] [MainThread]: Flushing usage events
[0m10:09:34.053205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A89555370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A89554140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A89555CD0>]}


============================== 10:09:34.056788 | af72f8fc-d848-4f79-829d-d47bcdff28f6 ==============================
[0m10:09:34.056788 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:09:34.057787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:09:35.000578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A95C4F200>]}
[0m10:09:35.097163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A89557050>]}
[0m10:09:35.098168 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:09:35.107163 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:09:35.212648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:09:35.213651 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m10:09:35.350310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:09:35.355339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A95E1B890>]}
[0m10:09:35.367883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A95F521E0>]}
[0m10:09:35.368883 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:09:35.369882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A95CD6510>]}
[0m10:09:35.372887 [info ] [MainThread]: 
[0m10:09:35.374882 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:09:35.375840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:09:35.391880 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:09:35.392882 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:09:35.392882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:36.219273 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m10:09:36.221274 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:09:36.317882 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:09:36.318886 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:09:36.318886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:36.626058 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m10:09:36.627055 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:09:36.720958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m10:09:36.729958 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:09:36.729958 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:09:36.729958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:37.036206 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:09:37.038205 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:09:37.123722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m10:09:37.128724 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:09:37.128724 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:09:37.128724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:37.422163 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:09:37.423163 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:09:37.508681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m10:09:37.511681 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:09:37.511681 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:09:37.512683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:37.919113 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m10:09:37.921112 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:09:38.020484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A963E7320>]}
[0m10:09:38.021452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:38.022452 [info ] [MainThread]: 
[0m10:09:38.026454 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m10:09:38.027453 [info ] [Thread-1 (]: 1 of 5 START sql view model STAGING.stg_country ................................ [RUN]
[0m10:09:38.028452 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m10:09:38.029453 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m10:09:38.040483 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m10:09:38.041452 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 10:09:38.029453 => 10:09:38.041452
[0m10:09:38.042453 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m10:09:38.075044 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m10:09:38.076002 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m10:09:38.077006 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m10:09:38.077006 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:09:38.496743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:09:38.526697 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 10:09:38.042453 => 10:09:38.526697
[0m10:09:38.527696 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m10:09:38.617171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A963E90A0>]}
[0m10:09:38.618176 [info ] [Thread-1 (]: 1 of 5 OK created sql view model STAGING.stg_country ........................... [[32mSUCCESS 1[0m in 0.59s]
[0m10:09:38.619172 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m10:09:38.620173 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m10:09:38.621173 [info ] [Thread-1 (]: 2 of 5 START sql view model STAGING.stg_customers .............................. [RUN]
[0m10:09:38.622173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m10:09:38.622173 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m10:09:38.625172 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m10:09:38.627172 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 10:09:38.622173 => 10:09:38.626173
[0m10:09:38.627172 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m10:09:38.632215 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m10:09:38.633205 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m10:09:38.634171 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m10:09:38.635175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:39.083842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:09:39.086841 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 10:09:38.627172 => 10:09:39.086841
[0m10:09:39.087842 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m10:09:39.177954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A9643D280>]}
[0m10:09:39.177954 [info ] [Thread-1 (]: 2 of 5 OK created sql view model STAGING.stg_customers ......................... [[32mSUCCESS 1[0m in 0.56s]
[0m10:09:39.179931 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m10:09:39.179931 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m10:09:39.180928 [info ] [Thread-1 (]: 3 of 5 START sql view model STAGING.stg_product ................................ [RUN]
[0m10:09:39.181928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m10:09:39.181928 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m10:09:39.185929 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m10:09:39.186929 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 10:09:39.181928 => 10:09:39.186929
[0m10:09:39.187927 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m10:09:39.190927 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m10:09:39.192928 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m10:09:39.192928 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_product
  
   as (
    

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS
  );
[0m10:09:39.192928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:39.607689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:09:39.610691 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 10:09:39.187927 => 10:09:39.609714
[0m10:09:39.610691 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m10:09:39.690204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A963E42C0>]}
[0m10:09:39.691204 [info ] [Thread-1 (]: 3 of 5 OK created sql view model STAGING.stg_product ........................... [[32mSUCCESS 1[0m in 0.51s]
[0m10:09:39.692203 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m10:09:39.692203 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m10:09:39.693203 [info ] [Thread-1 (]: 4 of 5 START sql view model STAGING.stg_transaction ............................ [RUN]
[0m10:09:39.694205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m10:09:39.695205 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m10:09:39.698205 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m10:09:39.700205 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 10:09:39.695205 => 10:09:39.699206
[0m10:09:39.700205 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m10:09:39.705205 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m10:09:39.707206 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m10:09:39.707206 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m10:09:39.708204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:40.138550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:09:40.142567 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 10:09:39.701206 => 10:09:40.141552
[0m10:09:40.144552 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m10:09:40.230068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A963E89E0>]}
[0m10:09:40.231069 [info ] [Thread-1 (]: 4 of 5 OK created sql view model STAGING.stg_transaction ....................... [[32mSUCCESS 1[0m in 0.54s]
[0m10:09:40.232068 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m10:09:40.232068 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:09:40.233066 [info ] [Thread-1 (]: 5 of 5 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:09:40.234068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_transaction, now model.practice.prod_transaction)
[0m10:09:40.235072 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:09:40.263077 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:09:40.265163 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:09:40.235072 => 10:09:40.265163
[0m10:09:40.266160 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:09:40.305178 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:09:40.307162 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:09:40.308161 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
FROM customer_activity
        );
[0m10:09:40.308161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:41.984214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:09:41.987214 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:09:40.266160 => 10:09:41.987214
[0m10:09:41.987214 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:09:42.073746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af72f8fc-d848-4f79-829d-d47bcdff28f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A963E89E0>]}
[0m10:09:42.074745 [info ] [Thread-1 (]: 5 of 5 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 1.84s]
[0m10:09:42.075747 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:09:42.078747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:42.078747 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:09:42.078747 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m10:09:42.079746 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:09:42.079746 [info ] [MainThread]: 
[0m10:09:42.080748 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m10:09:42.082747 [debug] [MainThread]: Command end result
[0m10:09:42.099747 [info ] [MainThread]: 
[0m10:09:42.101749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:09:42.102747 [info ] [MainThread]: 
[0m10:09:42.104746 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:09:42.105748 [debug] [MainThread]: Command `dbt run` succeeded at 10:09:42.105748 after 8.12 seconds
[0m10:09:42.106749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A894225A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A893CD670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A893CCE30>]}
[0m10:09:42.106749 [debug] [MainThread]: Flushing usage events
[0m10:11:56.247602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70AE12C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70C0F4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70C1DFCB0>]}


============================== 10:11:56.251602 | a310f056-c42f-497f-bf73-57a58dd92462 ==============================
[0m10:11:56.251602 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:11:56.252603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_tranaction', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:11:57.110743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a310f056-c42f-497f-bf73-57a58dd92462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D716B580B0>]}
[0m10:11:57.197325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a310f056-c42f-497f-bf73-57a58dd92462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D716A26B40>]}
[0m10:11:57.198325 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:11:57.207932 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:11:57.315383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:57.316384 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:11:57.448996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:11:57.454963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a310f056-c42f-497f-bf73-57a58dd92462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D718ED8320>]}
[0m10:11:57.470970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a310f056-c42f-497f-bf73-57a58dd92462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D718F36360>]}
[0m10:11:57.470970 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:11:57.471970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a310f056-c42f-497f-bf73-57a58dd92462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70C4B86E0>]}
[0m10:11:57.472970 [warn ] [MainThread]: The selection criterion 'prod_tranaction' does not match any nodes
[0m10:11:57.475000 [info ] [MainThread]: 
[0m10:11:57.475000 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:11:57.476000 [debug] [MainThread]: Command end result
[0m10:11:57.484060 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:57.484060 after 1.30 seconds
[0m10:11:57.485062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70AE12C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D70674CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D718A5BBF0>]}
[0m10:11:57.485062 [debug] [MainThread]: Flushing usage events
[0m10:12:08.339861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5C55190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5C54F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5C553D0>]}


============================== 10:12:08.343893 | 9d52ca21-4260-44d5-9fe7-090de2134e91 ==============================
[0m10:12:08.343893 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:12:08.344896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:09.287097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d52ca21-4260-44d5-9fe7-090de2134e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB254F140>]}
[0m10:12:09.388620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d52ca21-4260-44d5-9fe7-090de2134e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB030B2C0>]}
[0m10:12:09.389616 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:12:09.400656 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:12:09.550181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:09.550181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:09.551183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:12:09.559185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d52ca21-4260-44d5-9fe7-090de2134e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB2578E00>]}
[0m10:12:09.572186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d52ca21-4260-44d5-9fe7-090de2134e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB26520C0>]}
[0m10:12:09.573184 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:12:09.574184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d52ca21-4260-44d5-9fe7-090de2134e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB24EE1E0>]}
[0m10:12:09.576185 [info ] [MainThread]: 
[0m10:12:09.578185 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:12:09.579192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:12:09.601709 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:12:09.602710 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:12:09.602710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:10.491170 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:12:10.493675 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:12:10.590660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m10:12:10.598676 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:12:10.599678 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:12:10.599678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:10.933239 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:12:10.935237 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:12:11.032764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m10:12:11.035763 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:12:11.035763 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:12:11.036763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:11.474822 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:12:11.476822 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:12:11.566238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d52ca21-4260-44d5-9fe7-090de2134e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB24EEC60>]}
[0m10:12:11.567240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:11.568239 [info ] [MainThread]: 
[0m10:12:11.571238 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:12:11.572238 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.prod_transaction ........................... [RUN]
[0m10:12:11.574243 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:12:11.574243 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:12:11.588245 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:12:11.590242 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:12:11.575238 => 10:12:11.589244
[0m10:12:11.591246 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:12:11.636755 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:12:11.638755 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:12:11.638755 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.prod_transaction
  
   as (
    WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATE_DIFF('day', first_purchase, last_purchase) AS days_active  
FROM customer_activity
  );
[0m10:12:11.639754 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:12:11.975908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeba-0001-429a-0008-435e000200aa
[0m10:12:11.976908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function DATE_DIFF
[0m10:12:11.976908 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:12:11.591246 => 10:12:11.976908
[0m10:12:11.977939 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:12:12.066476 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:12:12.067476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d52ca21-4260-44d5-9fe7-090de2134e91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AB29A4B90>]}
[0m10:12:12.067476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model STAGING.prod_transaction .................. [[31mERROR[0m in 0.49s]
[0m10:12:12.068501 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:12:12.071504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:12.071504 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:12:12.072478 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m10:12:12.072478 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:12:12.072478 [info ] [MainThread]: 
[0m10:12:12.073477 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m10:12:12.074478 [debug] [MainThread]: Command end result
[0m10:12:12.086482 [info ] [MainThread]: 
[0m10:12:12.087483 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:12:12.088483 [info ] [MainThread]: 
[0m10:12:12.088483 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:12:12.089514 [info ] [MainThread]: 
[0m10:12:12.090486 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:12:12.092525 [debug] [MainThread]: Command `dbt run` failed at 10:12:12.091485 after 3.81 seconds
[0m10:12:12.092525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5C87830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5A86B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA5C55190>]}
[0m10:12:12.092525 [debug] [MainThread]: Flushing usage events
[0m10:12:58.716083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633F8DCF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633FB55010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633FB552E0>]}


============================== 10:12:58.721083 | eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd ==============================
[0m10:12:58.721083 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:12:58.722084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:59.753647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633D8BA960>]}
[0m10:12:59.846164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001634A197D70>]}
[0m10:12:59.847165 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:12:59.856198 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:12:59.946778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:12:59.947778 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:13:00.098364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:13:00.104363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001634C7AFEF0>]}
[0m10:13:00.116368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001634C54E330>]}
[0m10:13:00.117367 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:13:00.118365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001634C72F230>]}
[0m10:13:00.120368 [info ] [MainThread]: 
[0m10:13:00.122366 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:13:00.124375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:13:00.140364 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:13:00.140364 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:13:00.141363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:00.900548 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:13:00.902550 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:13:00.989070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m10:13:00.998066 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:13:00.999067 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:13:00.999067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:01.310230 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:13:01.312230 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:13:01.386521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m10:13:01.389489 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:13:01.389489 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:13:01.390515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:01.833498 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:13:01.836497 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:13:01.920016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m10:13:01.923016 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:13:01.924016 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:13:01.924016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:02.205576 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:13:02.207577 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:13:02.288125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001634C015730>]}
[0m10:13:02.289125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:13:02.290127 [info ] [MainThread]: 
[0m10:13:02.293129 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:13:02.294094 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:13:02.295094 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:13:02.296094 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:13:02.305103 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:13:02.306095 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:13:02.296094 => 10:13:02.306095
[0m10:13:02.307127 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:13:02.338097 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:13:02.339095 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:13:02.340095 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATE_DIFF('day', first_purchase, last_purchase) AS days_active  
FROM customer_activity
        );
[0m10:13:02.341098 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:13:02.683945 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafebb-0001-429e-0008-435e0001e476
[0m10:13:02.683945 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function DATE_DIFF
[0m10:13:02.684944 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:13:02.307127 => 10:13:02.684944
[0m10:13:02.684944 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:13:02.770464 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:13:02.771463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eabd94e9-cde9-4e5e-9e80-321cb4e3c6fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001634C7B7AD0>]}
[0m10:13:02.771463 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.48s]
[0m10:13:02.772463 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:13:02.775465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:02.776467 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:13:02.776467 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m10:13:02.776467 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:13:02.777464 [info ] [MainThread]: 
[0m10:13:02.778466 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m10:13:02.779466 [debug] [MainThread]: Command end result
[0m10:13:02.795464 [info ] [MainThread]: 
[0m10:13:02.796465 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:13:02.796465 [info ] [MainThread]: 
[0m10:13:02.797467 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:13:02.798466 [info ] [MainThread]: 
[0m10:13:02.798466 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:13:02.800464 [debug] [MainThread]: Command `dbt run` failed at 10:13:02.799464 after 4.15 seconds
[0m10:13:02.800464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633F7CFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633FB3FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633FA58680>]}
[0m10:13:02.801468 [debug] [MainThread]: Flushing usage events
[0m10:15:01.800576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC56DFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC5954140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC5955040>]}


============================== 10:15:01.813552 | 59d73cc6-4329-428c-a6bb-76b9b80c71d7 ==============================
[0m10:15:01.813552 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:15:01.814554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:15:10.622534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d73cc6-4329-428c-a6bb-76b9b80c71d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD224BF50>]}
[0m10:15:10.740652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59d73cc6-4329-428c-a6bb-76b9b80c71d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACFFE7650>]}
[0m10:15:10.742650 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:15:10.757169 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:15:11.288876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:15:11.290878 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:15:11.480947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:15:11.488946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d73cc6-4329-428c-a6bb-76b9b80c71d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD25FFE30>]}
[0m10:15:11.521947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d73cc6-4329-428c-a6bb-76b9b80c71d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD2352300>]}
[0m10:15:11.522946 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:15:11.523949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d73cc6-4329-428c-a6bb-76b9b80c71d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD2544DA0>]}
[0m10:15:11.527956 [info ] [MainThread]: 
[0m10:15:11.533947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:11.536946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:15:11.560474 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:15:11.561469 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:15:11.562471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:14.986983 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m10:15:14.995985 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:15:15.107824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m10:15:15.118825 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:15:15.119825 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:15:15.119825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:15.573378 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:15:15.575380 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:15:15.654512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m10:15:15.659550 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:15:15.659550 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:15:15.660551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:15.961343 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:15:15.962344 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:15:16.053850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m10:15:16.056854 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:15:16.057856 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:15:16.057856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:17.409409 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:15:17.410408 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:15:17.513536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d73cc6-4329-428c-a6bb-76b9b80c71d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD227A720>]}
[0m10:15:17.515534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:17.517534 [info ] [MainThread]: 
[0m10:15:17.543538 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:15:17.544531 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:15:17.546530 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:15:17.546530 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:15:17.558533 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:15:17.563532 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:15:17.547532 => 10:15:17.562530
[0m10:15:17.563532 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:15:17.603595 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:15:17.619599 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:15:17.620597 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATE_DIFF(first_purchase,last_purchase,'DAY') AS days_active  
FROM customer_activity
        );
[0m10:15:17.621598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:18.096925 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafebd-0001-429a-0008-435e000200ca
[0m10:15:18.098923 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function DATE_DIFF
[0m10:15:18.100926 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:15:17.564533 => 10:15:18.099932
[0m10:15:18.102927 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:15:18.212578 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:15:18.213578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d73cc6-4329-428c-a6bb-76b9b80c71d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD27DEDE0>]}
[0m10:15:18.213578 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.67s]
[0m10:15:18.215580 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:15:18.227578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:18.228578 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:15:18.228578 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m10:15:18.229576 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:15:18.229576 [info ] [MainThread]: 
[0m10:15:18.230578 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m10:15:18.231579 [debug] [MainThread]: Command end result
[0m10:15:18.247578 [info ] [MainThread]: 
[0m10:15:18.250587 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:15:18.253582 [info ] [MainThread]: 
[0m10:15:18.256577 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002140 (42601): SQL compilation error:
  Unknown function DATE_DIFF
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:15:18.259579 [info ] [MainThread]: 
[0m10:15:18.260577 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:15:18.263582 [debug] [MainThread]: Command `dbt run` failed at 10:15:18.263582 after 16.57 seconds
[0m10:15:18.264580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC54F7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC56DFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC5954140>]}
[0m10:15:18.264580 [debug] [MainThread]: Flushing usage events
[0m10:15:31.865773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC26C58170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC26C582F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC26C59550>]}


============================== 10:15:31.875016 | c7edbc9c-d45c-45fd-acdf-8faca4a75380 ==============================
[0m10:15:31.875016 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:15:31.876015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:15:33.430697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7edbc9c-d45c-45fd-acdf-8faca4a75380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC33522630>]}
[0m10:15:33.520741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7edbc9c-d45c-45fd-acdf-8faca4a75380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC31657C20>]}
[0m10:15:33.521742 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:15:33.530741 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:15:33.693617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:15:33.694617 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:15:33.833666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:15:33.839651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7edbc9c-d45c-45fd-acdf-8faca4a75380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC339444D0>]}
[0m10:15:33.855652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7edbc9c-d45c-45fd-acdf-8faca4a75380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC3374E4B0>]}
[0m10:15:33.855652 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:15:33.856653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7edbc9c-d45c-45fd-acdf-8faca4a75380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC339AFE90>]}
[0m10:15:33.858684 [info ] [MainThread]: 
[0m10:15:33.859653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:33.861654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:15:33.875690 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:15:33.876686 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:15:33.876686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:35.381184 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m10:15:35.383183 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:15:35.466909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:15:35.475909 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:15:35.476910 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:15:35.486798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:36.010851 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:15:36.012882 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:15:36.112861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m10:15:36.117372 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:15:36.117372 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:15:36.117372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:36.482301 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:15:36.484306 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:15:36.638040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m10:15:36.641010 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:15:36.642020 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:15:36.642020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:37.004007 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:15:37.006004 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:15:37.108024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7edbc9c-d45c-45fd-acdf-8faca4a75380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2651A750>]}
[0m10:15:37.109024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:37.110024 [info ] [MainThread]: 
[0m10:15:37.115564 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:15:37.115564 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:15:37.117572 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:15:37.118574 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:15:37.126571 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:15:37.127570 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:15:37.118574 => 10:15:37.127570
[0m10:15:37.127570 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:15:37.159572 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:15:37.161570 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:15:37.161570 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATEDIFF(first_purchase,last_purchase,'DAY') AS days_active  
FROM customer_activity
        );
[0m10:15:37.162569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:37.588102 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafebd-0001-429e-0008-435e0001e492
[0m10:15:37.589101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002151 (22023): SQL compilation error: ['FIRST_PURCHASE'] is not a valid date/time component for function DATEDIFF.
[0m10:15:37.589101 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:15:37.128570 => 10:15:37.589101
[0m10:15:37.590100 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:15:37.690816 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002151 (22023): SQL compilation error: ['FIRST_PURCHASE'] is not a valid date/time component for function DATEDIFF.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:15:37.690816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7edbc9c-d45c-45fd-acdf-8faca4a75380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC336174A0>]}
[0m10:15:37.691817 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.57s]
[0m10:15:37.692785 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:15:37.694786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:37.695784 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:15:37.695784 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m10:15:37.695784 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:15:37.696785 [info ] [MainThread]: 
[0m10:15:37.697785 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m10:15:37.698802 [debug] [MainThread]: Command end result
[0m10:15:37.711795 [info ] [MainThread]: 
[0m10:15:37.712796 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:15:37.713797 [info ] [MainThread]: 
[0m10:15:37.713797 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  002151 (22023): SQL compilation error: ['FIRST_PURCHASE'] is not a valid date/time component for function DATEDIFF.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:15:37.714964 [info ] [MainThread]: 
[0m10:15:37.715972 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:15:37.717981 [debug] [MainThread]: Command `dbt run` failed at 10:15:37.717010 after 5.93 seconds
[0m10:15:37.717981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC26919AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC24F70BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC330D3440>]}
[0m10:15:37.718988 [debug] [MainThread]: Flushing usage events
[0m10:15:59.778073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7060576E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B706056450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B706056EA0>]}


============================== 10:15:59.782111 | 05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e ==============================
[0m10:15:59.782111 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:15:59.783105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:00.624451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7127B2420>]}
[0m10:16:00.710457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7126EA3F0>]}
[0m10:16:00.711457 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:16:00.719910 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:16:00.814988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:16:00.814988 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:16:01.015642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:16:01.024275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B712A13C80>]}
[0m10:16:01.038237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B712A8B230>]}
[0m10:16:01.038237 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 445 macros, 0 groups, 0 semantic models
[0m10:16:01.039269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7126E8440>]}
[0m10:16:01.041269 [info ] [MainThread]: 
[0m10:16:01.042269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:16:01.043279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:16:01.058286 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:16:01.059285 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:16:01.059285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:02.145397 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:16:02.147427 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:16:02.304807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:16:02.314809 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:16:02.314809 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:16:02.314809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:02.864557 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m10:16:03.085413 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:16:03.240638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m10:16:03.243638 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:16:03.243638 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:16:03.244641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:03.686664 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:16:03.688625 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:16:03.797923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m10:16:03.800922 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:16:03.801922 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:16:03.801922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:04.179477 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:16:04.243483 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:16:04.368565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B712D6FFB0>]}
[0m10:16:04.368565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:04.369596 [info ] [MainThread]: 
[0m10:16:04.373566 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:16:04.373566 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:16:04.374567 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:16:04.375565 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:16:04.383563 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:16:04.384565 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:16:04.375565 => 10:16:04.384565
[0m10:16:04.385566 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:16:04.416562 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:16:04.418569 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:16:04.419573 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    DATEDIFF('DAY',first_purchase,last_purchase) AS days_active  
FROM customer_activity
        );
[0m10:16:04.419573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:16:05.527316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:16:05.853004 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:16:04.385566 => 10:16:05.853004
[0m10:16:05.853004 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:16:05.933154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05aa5a9d-3d91-46cb-bf92-c1ba3d01ca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B712EE1550>]}
[0m10:16:05.934155 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 1.56s]
[0m10:16:05.934624 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:16:05.936632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:05.937664 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:16:05.937664 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m10:16:05.938665 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:16:05.938665 [info ] [MainThread]: 
[0m10:16:05.939631 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m10:16:05.940633 [debug] [MainThread]: Command end result
[0m10:16:05.953638 [info ] [MainThread]: 
[0m10:16:05.954648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:05.955647 [info ] [MainThread]: 
[0m10:16:05.955647 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:05.956645 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:05.956645 after 6.24 seconds
[0m10:16:05.957645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B70603FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B704C14C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7060838C0>]}
[0m10:16:05.957645 [debug] [MainThread]: Flushing usage events
[0m10:24:29.892763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130E825AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130E85C4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130EA054620>]}


============================== 10:24:29.998325 | 5bee6b07-309d-4cf6-83fc-1c13250f4a65 ==============================
[0m10:24:29.998325 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:24:30.002306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:39.790927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bee6b07-309d-4cf6-83fc-1c13250f4a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F687BF20>]}
[0m10:24:39.878931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bee6b07-309d-4cf6-83fc-1c13250f4a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F46EBC50>]}
[0m10:24:39.886930 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:24:39.912067 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:24:41.628149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m10:24:41.629149 [debug] [MainThread]: Partial parsing: added file: practice://macros\date_diff.sql
[0m10:24:41.629149 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m10:24:41.630149 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:24:41.630149 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m10:24:41.775936 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_transaction' (models\staging\stg_transaction.sql) depends on a node named 'stg_ride_sharing_data' which was not found
[0m10:24:41.812807 [debug] [MainThread]: Command `dbt run` failed at 10:24:41.811807 after 12.01 seconds
[0m10:24:41.814807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130E8CF4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F6CE1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F6CD2300>]}
[0m10:24:41.814807 [debug] [MainThread]: Flushing usage events
[0m10:25:05.761898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EA20CAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EA0E4B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EA22557C0>]}


============================== 10:25:05.766933 | 804c530d-354a-47bd-a9c8-124970f5b6fe ==============================
[0m10:25:05.766933 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:25:05.767898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:06.683420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '804c530d-354a-47bd-a9c8-124970f5b6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EA0BB3230>]}
[0m10:25:06.771938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '804c530d-354a-47bd-a9c8-124970f5b6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EAE9D0290>]}
[0m10:25:06.772947 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:25:06.780936 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:25:06.894091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m10:25:06.894091 [debug] [MainThread]: Partial parsing: added file: practice://macros\date_diff.sql
[0m10:25:06.895091 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_product.sql
[0m10:25:06.895091 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:25:07.056040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:25:07.066067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '804c530d-354a-47bd-a9c8-124970f5b6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EAEDD2990>]}
[0m10:25:07.101315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '804c530d-354a-47bd-a9c8-124970f5b6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EAEB19EE0>]}
[0m10:25:07.102330 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:25:07.102330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '804c530d-354a-47bd-a9c8-124970f5b6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EAEDF0D10>]}
[0m10:25:07.105293 [info ] [MainThread]: 
[0m10:25:07.106292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:25:07.107709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:25:07.121748 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:25:07.122749 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:25:07.122749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:08.414755 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:25:08.417754 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:25:08.520121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m10:25:08.552136 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:25:08.553135 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:25:08.553644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:09.114770 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:25:09.115770 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:25:09.229315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m10:25:09.231346 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:25:09.232315 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:25:09.232315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:09.623941 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:25:09.626975 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:25:09.734093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m10:25:09.737093 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:25:09.737093 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:25:09.738093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:10.385929 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafec7-0001-429e-0008-435e0001e4be
[0m10:25:10.385929 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:25:10.386929 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:25:10.386929 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:25:10.387929 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:25:10.481350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m10:25:10.484325 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:25:10.484325 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:25:10.485353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:10.840565 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:25:10.842571 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:25:10.932303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '804c530d-354a-47bd-a9c8-124970f5b6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EAEEFBDD0>]}
[0m10:25:10.933280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:25:10.934304 [info ] [MainThread]: 
[0m10:25:10.942843 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:25:10.942843 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:25:10.944843 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:25:10.944843 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:25:10.953866 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:25:10.971416 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:25:10.944843 => 10:25:10.970440
[0m10:25:10.972445 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:25:11.010415 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:25:11.013391 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:25:11.014392 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
     
    (datediff('day', , ))
 AS days_active  
FROM customer_activity
        );
[0m10:25:11.014392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:25:11.388000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafec7-0001-429e-0008-435e0001e4c6
[0m10:25:11.388000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 21 unexpected ','.
syntax error line 19 at position 23 unexpected ')'.
[0m10:25:11.389032 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:25:10.973447 => 10:25:11.389032
[0m10:25:11.389032 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:25:11.476558 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ','.
  syntax error line 19 at position 23 unexpected ')'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:25:11.477583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '804c530d-354a-47bd-a9c8-124970f5b6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EAEDE1910>]}
[0m10:25:11.478586 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.53s]
[0m10:25:11.479558 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:25:11.482560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:11.483587 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:25:11.483587 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m10:25:11.483587 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:25:11.484582 [info ] [MainThread]: 
[0m10:25:11.485557 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m10:25:11.486585 [debug] [MainThread]: Command end result
[0m10:25:11.498558 [info ] [MainThread]: 
[0m10:25:11.499559 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:25:11.500567 [info ] [MainThread]: 
[0m10:25:11.501560 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ','.
  syntax error line 19 at position 23 unexpected ')'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:25:11.502563 [info ] [MainThread]: 
[0m10:25:11.502563 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:25:11.504590 [debug] [MainThread]: Command `dbt run` failed at 10:25:11.503597 after 5.80 seconds
[0m10:25:11.504590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EA0E24CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EA04C91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EA20C9010>]}
[0m10:25:11.504590 [debug] [MainThread]: Flushing usage events
[0m10:27:15.047444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC1541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC154320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC154050>]}


============================== 10:27:15.052443 | ff184887-d92b-4f4c-970d-8077d717eb57 ==============================
[0m10:27:15.052443 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:27:15.053443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:15.969496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff184887-d92b-4f4c-970d-8077d717eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CB95A8F20>]}
[0m10:27:16.060111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff184887-d92b-4f4c-970d-8077d717eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC6E87650>]}
[0m10:27:16.061111 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:27:16.070115 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:27:16.182343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:27:16.183312 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:27:16.326531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:27:16.332568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff184887-d92b-4f4c-970d-8077d717eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC8C10500>]}
[0m10:27:16.344531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff184887-d92b-4f4c-970d-8077d717eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC8B4F110>]}
[0m10:27:16.345531 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:27:16.346532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff184887-d92b-4f4c-970d-8077d717eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC8E9C6B0>]}
[0m10:27:16.347564 [info ] [MainThread]: 
[0m10:27:16.350535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:27:16.352532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:27:16.367571 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:27:16.368573 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:27:16.369577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:17.242524 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:27:17.243524 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:27:17.327752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:27:17.336790 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:27:17.337789 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:27:17.337789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:17.691393 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:27:17.692393 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:27:17.774010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m10:27:17.777977 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:27:17.778977 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:27:17.778977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:18.078122 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:27:18.081125 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:27:18.174320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m10:27:18.179350 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:27:18.179350 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:27:18.179350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:18.493079 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafec9-0001-429a-0008-435e0002010a
[0m10:27:18.494091 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:27:18.494091 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:27:18.495091 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:27:18.495091 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:27:18.586628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m10:27:18.589628 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:27:18.589628 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:27:18.590628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:19.039219 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:27:19.040212 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:27:19.129845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff184887-d92b-4f4c-970d-8077d717eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC8B4FBF0>]}
[0m10:27:19.130846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:19.131846 [info ] [MainThread]: 
[0m10:27:19.135849 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:27:19.136847 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:27:19.137877 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:27:19.138845 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:27:19.147877 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:27:19.148878 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:27:19.138845 => 10:27:19.148878
[0m10:27:19.149847 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:27:19.179916 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:27:19.181884 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:27:19.181884 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('day', , ))
 AS days_active  
FROM customer_activity
        );
[0m10:27:19.181884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:19.508511 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafec9-0001-429e-0008-435e0001e4ce
[0m10:27:19.509512 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 21 unexpected ','.
syntax error line 19 at position 23 unexpected ')'.
[0m10:27:19.509512 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:27:19.149847 => 10:27:19.509512
[0m10:27:19.510512 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:27:19.604847 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ','.
  syntax error line 19 at position 23 unexpected ')'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:27:19.605846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff184887-d92b-4f4c-970d-8077d717eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC8F3B8F0>]}
[0m10:27:19.606846 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.47s]
[0m10:27:19.608847 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:27:19.611846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:19.612845 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:27:19.612845 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m10:27:19.613845 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:27:19.613845 [info ] [MainThread]: 
[0m10:27:19.615052 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m10:27:19.617062 [debug] [MainThread]: Command end result
[0m10:27:19.628096 [info ] [MainThread]: 
[0m10:27:19.629090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:19.630081 [info ] [MainThread]: 
[0m10:27:19.631072 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ','.
  syntax error line 19 at position 23 unexpected ')'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:27:19.632080 [info ] [MainThread]: 
[0m10:27:19.632609 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:19.634617 [debug] [MainThread]: Command `dbt run` failed at 10:27:19.633617 after 4.66 seconds
[0m10:27:19.634617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC183920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBAF08710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CBC0591F0>]}
[0m10:27:19.634617 [debug] [MainThread]: Flushing usage events
[0m10:28:47.509087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE47B2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE6558560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE655BB90>]}


============================== 10:28:47.513680 | ea3b9a92-0291-4f25-83c1-ee6cc273c4b2 ==============================
[0m10:28:47.513680 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:28:47.514981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:48.403449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea3b9a92-0291-4f25-83c1-ee6cc273c4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE63CB2C0>]}
[0m10:28:48.491033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea3b9a92-0291-4f25-83c1-ee6cc273c4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BF2BC7EC0>]}
[0m10:28:48.492028 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:28:48.501007 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:28:48.615156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:48.616166 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:28:48.751675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:28:48.756674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea3b9a92-0291-4f25-83c1-ee6cc273c4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BF2A35760>]}
[0m10:28:48.768675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea3b9a92-0291-4f25-83c1-ee6cc273c4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BF310F770>]}
[0m10:28:48.769678 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:28:48.770643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3b9a92-0291-4f25-83c1-ee6cc273c4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BF2E7FAA0>]}
[0m10:28:48.772645 [info ] [MainThread]: 
[0m10:28:48.773646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:28:48.775674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:28:48.789675 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:28:48.790677 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:28:48.790677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:49.745670 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:28:49.748670 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:28:49.917586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m10:28:49.927594 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:28:49.927594 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:28:49.927594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:50.386492 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:28:50.389489 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:28:50.555052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m10:28:50.560051 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:28:50.560051 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:28:50.560051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:51.019392 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:28:51.021429 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:28:51.117029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m10:28:51.120066 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:28:51.121061 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:28:51.121061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:51.663525 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeca-0001-429b-0008-435e0001d9ea
[0m10:28:51.663525 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:28:51.664525 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:28:51.664525 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:28:51.665525 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:28:51.745820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m10:28:51.749785 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:28:51.750785 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:28:51.750785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:52.063651 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:28:52.066612 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:28:52.155772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea3b9a92-0291-4f25-83c1-ee6cc273c4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BF3297BC0>]}
[0m10:28:52.159845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:52.162799 [info ] [MainThread]: 
[0m10:28:52.172788 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:28:52.173823 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:28:52.176789 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:28:52.177829 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:28:52.194822 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:28:52.196820 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:28:52.178789 => 10:28:52.196820
[0m10:28:52.197823 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:28:52.230821 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:28:52.231790 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:28:52.232836 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('day', first_purchase, last_purchase))
 AS days_active  
FROM customer_activity
        );
[0m10:28:52.232836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:28:54.138545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m10:28:54.162163 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:28:52.197823 => 10:28:54.162163
[0m10:28:54.162163 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:28:54.246012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea3b9a92-0291-4f25-83c1-ee6cc273c4b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BF32C3E00>]}
[0m10:28:54.248054 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 2.07s]
[0m10:28:54.250019 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:28:54.255055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:54.255055 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:28:54.256610 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m10:28:54.257670 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:28:54.258671 [info ] [MainThread]: 
[0m10:28:54.260627 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m10:28:54.262627 [debug] [MainThread]: Command end result
[0m10:28:54.275507 [info ] [MainThread]: 
[0m10:28:54.291594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:54.292591 [info ] [MainThread]: 
[0m10:28:54.293595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:28:54.294561 [debug] [MainThread]: Command `dbt run` succeeded at 10:28:54.294561 after 6.85 seconds
[0m10:28:54.295559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE623CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE653FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE4FF11F0>]}
[0m10:28:54.295559 [debug] [MainThread]: Flushing usage events
[0m10:35:44.613579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C0054200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C0054320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C0055430>]}


============================== 10:35:44.627189 | 021a16d0-68c0-4390-8515-7910847b7f4e ==============================
[0m10:35:44.627189 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:35:44.628158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:53.892552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '021a16d0-68c0-4390-8515-7910847b7f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6CC4C2810>]}
[0m10:35:53.985130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '021a16d0-68c0-4390-8515-7910847b7f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C0085580>]}
[0m10:35:53.993135 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:35:54.011141 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:35:55.289802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:35:55.290805 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:35:55.430388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:35:55.436390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '021a16d0-68c0-4390-8515-7910847b7f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6CAA27DD0>]}
[0m10:35:55.463827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '021a16d0-68c0-4390-8515-7910847b7f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6CCC42720>]}
[0m10:35:55.463827 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:35:55.465797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '021a16d0-68c0-4390-8515-7910847b7f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6CA738EC0>]}
[0m10:35:55.468798 [info ] [MainThread]: 
[0m10:35:55.471218 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:35:55.473218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:35:55.488217 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:35:55.489228 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:35:55.489228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:56.973688 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:35:56.975689 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:35:57.063202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:35:57.072206 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:35:57.072206 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:35:57.072206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:57.505933 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:35:57.507933 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:35:57.593907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m10:35:57.602878 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:35:57.603838 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:35:57.604838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:57.915846 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:35:57.917837 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:35:58.008549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m10:35:58.011577 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:35:58.011577 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:35:58.011577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:58.428860 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafed1-0001-429a-0008-435e00020196
[0m10:35:58.428860 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:35:58.429891 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:35:58.429891 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:35:58.429891 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:35:58.513380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m10:35:58.517380 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:35:58.517380 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:35:58.518380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:58.948768 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:35:58.950768 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:35:59.059337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '021a16d0-68c0-4390-8515-7910847b7f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6CCC92F90>]}
[0m10:35:59.062344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:59.065592 [info ] [MainThread]: 
[0m10:35:59.082258 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:35:59.084263 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:35:59.086774 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:35:59.087789 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:35:59.101786 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:35:59.103787 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:35:59.088793 => 10:35:59.103787
[0m10:35:59.104789 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:35:59.141784 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:35:59.143785 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:35:59.143785 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('day', first_purchase, last_purchase))
 AS days_active,
    COUNT(CASE WHEN first_purchase = '2024-01-01' THEN CUSTOMER_ID END) AS new_customers,
    COUNT(CASE WHEN last_purchase < '2024-01-01' THEN CUSTOMER_ID END) AS churned_customers
FROM customer_activity
        );
[0m10:35:59.144785 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:35:59.553498 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafed1-0001-429a-0008-435e0002019a
[0m10:35:59.553498 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[CUSTOMER_ACTIVITY.CUSTOMER_ID] is not a valid group by expression
[0m10:35:59.554499 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:35:59.104789 => 10:35:59.554499
[0m10:35:59.554499 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:35:59.635599 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000979 (42601): SQL compilation error:
  [CUSTOMER_ACTIVITY.CUSTOMER_ID] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:35:59.635599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '021a16d0-68c0-4390-8515-7910847b7f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6CCF9AC90>]}
[0m10:35:59.636599 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.55s]
[0m10:35:59.637568 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:35:59.639568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:59.640599 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:35:59.640599 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m10:35:59.640599 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:35:59.641599 [info ] [MainThread]: 
[0m10:35:59.641599 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m10:35:59.643600 [debug] [MainThread]: Command end result
[0m10:35:59.654569 [info ] [MainThread]: 
[0m10:35:59.747155 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:35:59.748160 [info ] [MainThread]: 
[0m10:35:59.749160 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000979 (42601): SQL compilation error:
  [CUSTOMER_ACTIVITY.CUSTOMER_ID] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:35:59.750158 [info ] [MainThread]: 
[0m10:35:59.755159 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:35:59.758162 [debug] [MainThread]: Command `dbt run` failed at 10:35:59.758162 after 15.23 seconds
[0m10:35:59.759159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C0087F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BECB7F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BECB6D80>]}
[0m10:35:59.760158 [debug] [MainThread]: Flushing usage events
[0m10:37:59.391488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB157D2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB17656FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB17654CE0>]}


============================== 10:37:59.396519 | 6d91b500-697f-494f-93bf-65f78c4c393c ==============================
[0m10:37:59.396519 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:37:59.397488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:38:00.300208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d91b500-697f-494f-93bf-65f78c4c393c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB2404BDA0>]}
[0m10:38:00.387823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d91b500-697f-494f-93bf-65f78c4c393c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB22C67C80>]}
[0m10:38:00.388824 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:38:00.397508 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:38:00.512094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:00.512094 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:38:00.653719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:38:00.659266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d91b500-697f-494f-93bf-65f78c4c393c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB242D6B10>]}
[0m10:38:00.670296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d91b500-697f-494f-93bf-65f78c4c393c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB242F1820>]}
[0m10:38:00.671298 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:38:00.671298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d91b500-697f-494f-93bf-65f78c4c393c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB21ADF590>]}
[0m10:38:00.673299 [info ] [MainThread]: 
[0m10:38:00.675265 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:38:00.676296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:38:00.691295 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:38:00.691295 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:38:00.692296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:01.936324 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:38:01.938324 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:38:02.038376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:38:02.076992 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:38:02.078938 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:38:02.080940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:02.549681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:38:02.553681 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:38:02.774161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m10:38:02.780196 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:38:02.781161 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:38:02.782162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:03.516296 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m10:38:03.521294 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:38:03.609629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m10:38:03.614630 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:38:03.615599 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:38:03.615599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:04.166816 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafed4-0001-429a-0008-435e000201a2
[0m10:38:04.167814 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:38:04.167814 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:38:04.168815 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:38:04.168815 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:38:04.259077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m10:38:04.262076 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:38:04.262076 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:38:04.263077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:04.550389 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:38:04.552388 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:38:04.627921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d91b500-697f-494f-93bf-65f78c4c393c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB2442FBC0>]}
[0m10:38:04.628890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:04.629924 [info ] [MainThread]: 
[0m10:38:04.634115 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:38:04.634115 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:38:04.635182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:38:04.636190 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:38:04.645189 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:38:04.646189 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:38:04.636190 => 10:38:04.645189
[0m10:38:04.646189 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:38:04.676269 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:38:04.678225 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:38:04.678225 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('day', first_purchase, last_purchase))
 AS days_active,
    COUNT(CASE WHEN first_purchase >= '2024-01-01' THEN CUSTOMER_ID END) AS new_customers,
    COUNT(CASE WHEN last_purchase < '2024-01-01' THEN CUSTOMER_ID END) AS churned_customers
FROM customer_activity
        );
[0m10:38:04.679257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:38:05.030167 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafed4-0001-429a-0008-435e000201a6
[0m10:38:05.030167 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[CUSTOMER_ACTIVITY.CUSTOMER_ID] is not a valid group by expression
[0m10:38:05.031199 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:38:04.647221 => 10:38:05.030167
[0m10:38:05.031199 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:38:05.132922 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000979 (42601): SQL compilation error:
  [CUSTOMER_ACTIVITY.CUSTOMER_ID] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:38:05.134914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d91b500-697f-494f-93bf-65f78c4c393c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB2466C710>]}
[0m10:38:05.135915 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.50s]
[0m10:38:05.138908 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:38:05.143899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:05.144899 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:38:05.144899 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m10:38:05.145899 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:38:05.146900 [info ] [MainThread]: 
[0m10:38:05.147860 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m10:38:05.149899 [debug] [MainThread]: Command end result
[0m10:38:05.164858 [info ] [MainThread]: 
[0m10:38:05.165862 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:38:05.167867 [info ] [MainThread]: 
[0m10:38:05.168858 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000979 (42601): SQL compilation error:
  [CUSTOMER_ACTIVITY.CUSTOMER_ID] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:38:05.169860 [info ] [MainThread]: 
[0m10:38:05.169860 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:38:05.171891 [debug] [MainThread]: Command `dbt run` failed at 10:38:05.171891 after 5.84 seconds
[0m10:38:05.171891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB17683950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB157D2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB17654CE0>]}
[0m10:38:05.172893 [debug] [MainThread]: Flushing usage events
[0m10:41:57.133471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2527CAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252954110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252955220>]}


============================== 10:41:57.137471 | fb5b083a-7211-4d1f-bf17-159ac0015d8e ==============================
[0m10:41:57.137471 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:41:57.138471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:41:58.246450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb5b083a-7211-4d1f-bf17-159ac0015d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25F181970>]}
[0m10:41:58.333028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb5b083a-7211-4d1f-bf17-159ac0015d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25D3581D0>]}
[0m10:41:58.334035 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:41:58.343063 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:41:58.462727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:41:58.463727 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:41:58.602214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m10:41:58.607244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb5b083a-7211-4d1f-bf17-159ac0015d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25F5F7890>]}
[0m10:41:58.619738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb5b083a-7211-4d1f-bf17-159ac0015d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25F1EEFF0>]}
[0m10:41:58.619738 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:41:58.620734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5b083a-7211-4d1f-bf17-159ac0015d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2529B4890>]}
[0m10:41:58.622770 [info ] [MainThread]: 
[0m10:41:58.623738 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:41:58.625768 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:41:58.641807 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:41:58.641807 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:41:58.642806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:59.733392 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:41:59.735392 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:41:59.834442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:41:59.844441 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:41:59.845441 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:41:59.845441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:00.149021 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:42:00.150996 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:42:00.252922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m10:42:00.259915 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:42:00.261914 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:42:00.264916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:00.565403 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafed7-0001-429e-0008-435e0001e59a
[0m10:42:00.566443 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:42:00.566443 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:42:00.567443 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:42:00.567443 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:42:00.652685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m10:42:00.658677 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:42:00.658677 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:42:00.659677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:00.939513 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:42:00.943494 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:42:01.026366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m10:42:01.035371 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:42:01.036374 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:42:01.037337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:01.339843 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:42:01.346838 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:42:01.445404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5b083a-7211-4d1f-bf17-159ac0015d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25F218980>]}
[0m10:42:01.448394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:42:01.451689 [info ] [MainThread]: 
[0m10:42:01.465673 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:42:01.466179 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:42:01.468223 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:42:01.468223 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:42:01.478184 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:42:01.480186 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:42:01.468223 => 10:42:01.479183
[0m10:42:01.480186 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:42:01.512186 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:42:01.514185 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:42:01.514185 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('day', first_purchase, last_purchase))
 AS days_active,
    
FROM customer_activity
        );
[0m10:42:01.515185 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:42:04.262684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m10:42:04.291269 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:42:01.480186 => 10:42:04.291269
[0m10:42:04.292268 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:42:04.367346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb5b083a-7211-4d1f-bf17-159ac0015d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F25F3125A0>]}
[0m10:42:04.368345 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 2.90s]
[0m10:42:04.369346 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:42:04.371379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:04.372381 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:42:04.372381 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m10:42:04.372381 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:42:04.373346 [info ] [MainThread]: 
[0m10:42:04.374347 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.75 seconds (5.75s).
[0m10:42:04.375348 [debug] [MainThread]: Command end result
[0m10:42:04.388867 [info ] [MainThread]: 
[0m10:42:04.389872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:04.390882 [info ] [MainThread]: 
[0m10:42:04.391868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:04.392868 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:04.392868 after 7.32 seconds
[0m10:42:04.393868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2527CAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252311220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F252619AF0>]}
[0m10:42:04.393868 [debug] [MainThread]: Flushing usage events
[0m10:43:56.844648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72F954470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72F954410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72F9540E0>]}


============================== 10:43:56.849651 | b4c4ee94-bc46-4017-a077-39b72cd73152 ==============================
[0m10:43:56.849651 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:43:56.850658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m10:43:57.817855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4c4ee94-bc46-4017-a077-39b72cd73152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73C24B920>]}
[0m10:43:57.906371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4c4ee94-bc46-4017-a077-39b72cd73152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73A99FC80>]}
[0m10:43:57.907371 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:43:57.915403 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:43:58.044957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:43:58.044957 [debug] [MainThread]: Partial parsing: updated file: practice://macros\date_diff.sql
[0m10:43:58.045955 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:43:58.185532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:43:58.191546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4c4ee94-bc46-4017-a077-39b72cd73152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73C5FBA10>]}
[0m10:43:58.203515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4c4ee94-bc46-4017-a077-39b72cd73152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73C512420>]}
[0m10:43:58.203515 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:43:58.204514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c4ee94-bc46-4017-a077-39b72cd73152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73C1EEEA0>]}
[0m10:43:58.207537 [info ] [MainThread]: 
[0m10:43:58.208516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:43:58.210548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:43:58.226543 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:43:58.226543 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:43:58.227546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:59.118726 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:43:59.119725 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:43:59.209033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m10:43:59.218032 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:43:59.219063 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:43:59.219063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:59.632929 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:43:59.636928 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:43:59.723090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m10:43:59.728090 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:43:59.728090 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:43:59.729090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:59.989603 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:43:59.990601 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:44:00.067402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m10:44:00.069935 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:44:00.069935 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:44:00.070935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:00.331693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:44:00.332691 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:44:00.425818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m10:44:00.438808 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:44:00.439811 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:44:00.440809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:00.721829 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafed9-0001-429b-0008-435e0001da9a
[0m10:44:00.722804 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:44:00.722804 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:44:00.722804 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:44:00.723803 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:44:00.805660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c4ee94-bc46-4017-a077-39b72cd73152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73C5FB950>]}
[0m10:44:00.806659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:00.807660 [info ] [MainThread]: 
[0m10:44:00.811931 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:44:00.811931 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:44:00.813108 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:44:00.814162 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:44:00.822146 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:44:00.824115 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:44:00.814162 => 10:44:00.823146
[0m10:44:00.824115 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:44:00.855115 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:44:00.857114 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:44:00.857114 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
FROM customer_activity
        );
[0m10:44:00.858153 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:44:02.158345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:44:02.182756 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:44:00.824115 => 10:44:02.181756
[0m10:44:02.182756 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:44:02.277240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c4ee94-bc46-4017-a077-39b72cd73152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73C7C9850>]}
[0m10:44:02.277240 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 1.46s]
[0m10:44:02.279238 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:44:02.280238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:02.281240 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:44:02.281240 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m10:44:02.282238 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:44:02.282238 [info ] [MainThread]: 
[0m10:44:02.283238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m10:44:02.284240 [debug] [MainThread]: Command end result
[0m10:44:02.295240 [info ] [MainThread]: 
[0m10:44:02.296240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:02.297240 [info ] [MainThread]: 
[0m10:44:02.297240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:02.299241 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:02.299241 after 5.52 seconds
[0m10:44:02.300240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72F53F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72F954410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F72F954470>]}
[0m10:44:02.300240 [debug] [MainThread]: Flushing usage events
[0m10:56:39.717177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB8D654080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB8D654170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB8D655580>]}


============================== 10:56:39.730202 | 384bf744-d418-4892-9757-3c23a27453ec ==============================
[0m10:56:39.730202 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:56:39.731176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m10:56:50.251338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '384bf744-d418-4892-9757-3c23a27453ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB98EF7C20>]}
[0m10:56:50.350892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '384bf744-d418-4892-9757-3c23a27453ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB98DE7C50>]}
[0m10:56:50.359891 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:56:50.381894 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:56:51.800547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:56:51.800547 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m10:56:51.950595 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m10:56:51.957597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '384bf744-d418-4892-9757-3c23a27453ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB9A39C9B0>]}
[0m10:56:51.985595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '384bf744-d418-4892-9757-3c23a27453ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB9A342F90>]}
[0m10:56:51.985595 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m10:56:51.987598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384bf744-d418-4892-9757-3c23a27453ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB98ECD4C0>]}
[0m10:56:51.990596 [info ] [MainThread]: 
[0m10:56:51.991595 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:56:51.993595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m10:56:52.008594 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m10:56:52.008594 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m10:56:52.008594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:53.146691 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m10:56:53.148692 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m10:56:53.237215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m10:56:53.249213 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m10:56:53.249213 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m10:56:53.249213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:53.656452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m10:56:53.658452 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m10:56:53.737632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m10:56:53.740665 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m10:56:53.741664 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m10:56:53.741664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:54.167221 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafee6-0001-429e-0008-435e0001e5ee
[0m10:56:54.168221 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:56:54.168221 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:56:54.169220 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:56:54.169220 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m10:56:54.252979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m10:56:54.255978 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m10:56:54.255978 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m10:56:54.256978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:54.675933 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m10:56:54.677932 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m10:56:54.756204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m10:56:54.762240 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m10:56:54.762240 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m10:56:54.763241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:55.137822 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m10:56:55.140814 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m10:56:55.232643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384bf744-d418-4892-9757-3c23a27453ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB9A36B710>]}
[0m10:56:55.235702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:56:55.236477 [info ] [MainThread]: 
[0m10:56:55.244193 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m10:56:55.244193 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m10:56:55.245699 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m10:56:55.246737 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m10:56:55.254737 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m10:56:55.256706 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 10:56:55.246737 => 10:56:55.255737
[0m10:56:55.256706 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m10:56:55.289741 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m10:56:55.291706 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m10:56:55.291706 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase,
        DATE_TRUNC('MONTH',PAYMENT_MONTH) as pay_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
FROM customer_activity
        );
[0m10:56:55.292706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:56:56.332486 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee6-0001-429a-0008-435e00020242
[0m10:56:56.332486 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 11 at position 27
'STG_TRANSACTION.PAYMENT_MONTH' in select clause is neither an aggregate nor in the group by clause.
[0m10:56:56.333494 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 10:56:55.256706 => 10:56:56.333494
[0m10:56:56.333494 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m10:56:56.421719 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001104 (42601): SQL compilation error: error line 11 at position 27
  'STG_TRANSACTION.PAYMENT_MONTH' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:56:56.421719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384bf744-d418-4892-9757-3c23a27453ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB9A251EB0>]}
[0m10:56:56.422719 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 1.18s]
[0m10:56:56.423693 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m10:56:56.425693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:56.426710 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m10:56:56.426710 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m10:56:56.426710 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m10:56:56.427719 [info ] [MainThread]: 
[0m10:56:56.438804 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m10:56:56.439803 [debug] [MainThread]: Command end result
[0m10:56:56.451347 [info ] [MainThread]: 
[0m10:56:56.452347 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:56:56.453347 [info ] [MainThread]: 
[0m10:56:56.454346 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001104 (42601): SQL compilation error: error line 11 at position 27
  'STG_TRANSACTION.PAYMENT_MONTH' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m10:56:56.455346 [info ] [MainThread]: 
[0m10:56:56.456348 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:56:56.457346 [debug] [MainThread]: Command `dbt run` failed at 10:56:56.457346 after 16.83 seconds
[0m10:56:56.457346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB8D2F4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB8D559100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB8D4C9880>]}
[0m10:56:56.458346 [debug] [MainThread]: Flushing usage events
[0m11:00:13.445017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC23757C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC23754FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC23754170>]}


============================== 11:00:13.450017 | bd8324fa-787f-4df6-9b1a-b218f7b52a38 ==============================
[0m11:00:13.450017 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:00:13.451017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:00:14.386400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd8324fa-787f-4df6-9b1a-b218f7b52a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC3004BAA0>]}
[0m11:00:14.472436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd8324fa-787f-4df6-9b1a-b218f7b52a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2EC58680>]}
[0m11:00:14.473437 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:00:14.481666 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:00:14.593428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:00:14.594428 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:00:14.727011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:00:14.732043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8324fa-787f-4df6-9b1a-b218f7b52a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC303FB560>]}
[0m11:00:14.745012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd8324fa-787f-4df6-9b1a-b218f7b52a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC302F2960>]}
[0m11:00:14.745012 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:00:14.747015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8324fa-787f-4df6-9b1a-b218f7b52a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC303FF770>]}
[0m11:00:14.749057 [info ] [MainThread]: 
[0m11:00:14.751043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:14.752042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:00:14.765013 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:00:14.766012 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:00:14.766012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:15.650522 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:00:15.652523 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:00:15.751421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m11:00:15.779403 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:00:15.779403 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:00:15.780397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:16.228481 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:00:16.232477 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:00:16.320560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m11:00:16.339541 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:00:16.340540 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:00:16.341541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:16.669745 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:00:16.672745 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:00:16.765212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m11:00:16.775256 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:00:16.777258 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:00:16.778259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:17.125159 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeea-0001-429b-0008-435e0001dada
[0m11:00:17.126159 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:00:17.128160 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:00:17.129161 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:00:17.130149 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:00:17.294571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m11:00:17.297572 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:00:17.297572 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:00:17.297572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:17.755752 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:00:17.760750 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:00:17.901708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8324fa-787f-4df6-9b1a-b218f7b52a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2EE0E9F0>]}
[0m11:00:17.902709 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:17.903675 [info ] [MainThread]: 
[0m11:00:17.907676 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:00:17.907676 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:00:17.909682 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:00:17.909682 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:00:17.918682 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:00:17.920684 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:00:17.909682 => 11:00:17.919683
[0m11:00:17.920684 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:00:17.951289 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:00:17.953259 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:00:17.954292 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase,
        MAX(DATE_TRUNC('MONTH',PAYMENT_MONTH)) as pay_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
    pay_month
FROM customer_activity
        );
[0m11:00:17.954292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:00:19.707704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:00:19.729779 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:00:17.920684 => 11:00:19.729779
[0m11:00:19.730779 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:00:19.829821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8324fa-787f-4df6-9b1a-b218f7b52a38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC3069CE90>]}
[0m11:00:19.832822 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 1.92s]
[0m11:00:19.837192 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:00:19.847883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:19.848884 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:00:19.850883 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m11:00:19.851883 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:00:19.852869 [info ] [MainThread]: 
[0m11:00:19.852869 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m11:00:19.853870 [debug] [MainThread]: Command end result
[0m11:00:19.866903 [info ] [MainThread]: 
[0m11:00:19.867869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:19.868870 [info ] [MainThread]: 
[0m11:00:19.869667 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:00:19.870706 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:19.870706 after 6.49 seconds
[0m11:00:19.871704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2EC58680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC300DFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC23681C10>]}
[0m11:00:19.871704 [debug] [MainThread]: Flushing usage events
[0m11:04:12.848515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234DD92AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234DDA26EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234DDE580E0>]}


============================== 11:04:12.861158 | 0549ad67-2083-477d-ad28-00a09e990f10 ==============================
[0m11:04:12.861158 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:04:12.862172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m11:04:19.672018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0549ad67-2083-477d-ad28-00a09e990f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EA4EA2D0>]}
[0m11:04:19.761024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0549ad67-2083-477d-ad28-00a09e990f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EA3C1FA0>]}
[0m11:04:19.769763 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:04:19.786769 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:04:20.963789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:20.964788 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:04:21.099818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:04:21.106007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0549ad67-2083-477d-ad28-00a09e990f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EAAF79E0>]}
[0m11:04:21.128958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0549ad67-2083-477d-ad28-00a09e990f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EA6E7800>]}
[0m11:04:21.129958 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:04:21.131959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0549ad67-2083-477d-ad28-00a09e990f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EA6207A0>]}
[0m11:04:21.133957 [info ] [MainThread]: 
[0m11:04:21.134590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:04:21.136627 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:04:21.150628 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:04:21.150628 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:04:21.151637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:22.144054 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:04:22.146054 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:04:22.236381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m11:04:22.247381 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:04:22.247381 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:04:22.248380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:22.733593 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:04:22.734590 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:04:22.828337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m11:04:22.833338 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:04:22.834338 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:04:22.834338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:23.146457 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:04:23.149456 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:04:23.243551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m11:04:23.256551 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:04:23.257549 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:04:23.258550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:23.571737 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:04:23.575745 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:04:23.673746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m11:04:23.680713 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:04:23.682337 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:04:23.683336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:24.260809 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeee-0001-429b-0008-435e0001daee
[0m11:04:24.261809 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:04:24.261809 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:04:24.262809 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:04:24.262809 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:04:24.360620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0549ad67-2083-477d-ad28-00a09e990f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EA8EB140>]}
[0m11:04:24.361563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:24.362564 [info ] [MainThread]: 
[0m11:04:24.367405 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:04:24.368410 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:04:24.369410 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:04:24.370412 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:04:24.377479 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:04:24.379448 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:04:24.370412 => 11:04:24.378479
[0m11:04:24.379448 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:04:24.410056 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:04:24.412025 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:04:24.413063 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        DATE_TRUNC('MONTH',PAYMENT_MONTH) AS PAY_MONTH,
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    
)


SELECT 
    CUSTOMER_ID,
    MIN(PAYMENT_MONTH) AS first_purchase,
    MAX(PAYMENT_MONTH) AS last_purchase,
    MAX(DATE_TRUNC('MONTH',PAYMENT_MONTH)) as pay_month
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
    
FROM customer_activity
GROUP BY CUSTOMER_ID
        );
[0m11:04:24.414065 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:24.768684 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeee-0001-429e-0008-435e0001e61e
[0m11:04:24.768684 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 4 unexpected '('.
[0m11:04:24.769685 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:04:24.380451 => 11:04:24.769685
[0m11:04:24.769685 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:04:24.861073 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:04:24.861073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0549ad67-2083-477d-ad28-00a09e990f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EAA3E2A0>]}
[0m11:04:24.862072 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.49s]
[0m11:04:24.862785 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:04:24.865826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:24.865826 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:04:24.865826 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m11:04:24.866823 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:04:24.866823 [info ] [MainThread]: 
[0m11:04:24.867835 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m11:04:24.868842 [debug] [MainThread]: Command end result
[0m11:04:24.878868 [info ] [MainThread]: 
[0m11:04:24.879874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:04:24.880900 [info ] [MainThread]: 
[0m11:04:24.881899 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:04:24.882888 [info ] [MainThread]: 
[0m11:04:24.883867 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:04:24.884868 [debug] [MainThread]: Command `dbt run` failed at 11:04:24.884868 after 12.12 seconds
[0m11:04:24.885903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234DD92AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234DDAB7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234DDD81880>]}
[0m11:04:24.885903 [debug] [MainThread]: Flushing usage events
[0m11:05:01.325081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EA2F7CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EA6544A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EA654320>]}


============================== 11:05:01.329080 | b6c908be-2bc2-4f1c-9109-5a1fad60f1d9 ==============================
[0m11:05:01.329080 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:05:01.330080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m11:05:02.207378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c908be-2bc2-4f1c-9109-5a1fad60f1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F58028D0>]}
[0m11:05:02.293953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6c908be-2bc2-4f1c-9109-5a1fad60f1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EA686870>]}
[0m11:05:02.294958 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:05:02.303952 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:05:02.413571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:05:02.414604 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:05:02.550686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:05:02.556699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c908be-2bc2-4f1c-9109-5a1fad60f1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F7392A80>]}
[0m11:05:02.567702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c908be-2bc2-4f1c-9109-5a1fad60f1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F7079C10>]}
[0m11:05:02.568668 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:05:02.569669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c908be-2bc2-4f1c-9109-5a1fad60f1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F5ECD640>]}
[0m11:05:02.571668 [info ] [MainThread]: 
[0m11:05:02.572667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:05:02.574668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:05:02.589668 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:05:02.589668 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:05:02.590668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:03.399572 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:05:03.402562 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:05:03.498432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m11:05:03.510388 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:05:03.510388 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:05:03.511389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:03.982418 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:05:03.987412 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:05:04.084346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m11:05:04.092346 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:05:04.094336 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:05:04.095336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:05:04.423178 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:05:04.426182 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:05:04.512368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m11:05:04.516370 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:05:04.517368 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:05:04.517368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:05:04.850326 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:05:04.852325 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:05:04.947150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m11:05:04.952050 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:05:04.952050 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:05:04.952050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:05:05.284391 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafeef-0001-429e-0008-435e0001e62e
[0m11:05:05.285392 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:05:05.286390 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:05:05.287390 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:05:05.287390 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:05:05.385748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c908be-2bc2-4f1c-9109-5a1fad60f1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F733CC20>]}
[0m11:05:05.389746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:05:05.390745 [info ] [MainThread]: 
[0m11:05:05.395272 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:05:05.395272 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:05:05.397273 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:05:05.397273 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:05:05.406272 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:05:05.408273 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:05:05.397273 => 11:05:05.407272
[0m11:05:05.408273 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:05:05.438341 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:05:05.440310 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:05:05.440310 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        DATE_TRUNC('MONTH',PAYMENT_MONTH) AS PAY_MONTH
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    
)


SELECT 
    CUSTOMER_ID,
    MIN(PAYMENT_MONTH) AS first_purchase,
    MAX(PAYMENT_MONTH) AS last_purchase,
    MAX(DATE_TRUNC('MONTH',PAY_MONTH)) as pay_month
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
    
FROM customer_activity
GROUP BY CUSTOMER_ID
        );
[0m11:05:05.441310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:05:05.855884 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeef-0001-429b-0008-435e0001daf2
[0m11:05:05.855884 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 4 unexpected '('.
[0m11:05:05.857884 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:05:05.408273 => 11:05:05.856884
[0m11:05:05.857884 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:05:05.960743 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:05:05.961742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c908be-2bc2-4f1c-9109-5a1fad60f1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F75C1C40>]}
[0m11:05:05.963697 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.57s]
[0m11:05:05.965699 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:05:05.970696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:05.971696 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:05:05.971696 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m11:05:05.972696 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:05:05.973695 [info ] [MainThread]: 
[0m11:05:05.974519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m11:05:05.976567 [debug] [MainThread]: Command end result
[0m11:05:05.991528 [info ] [MainThread]: 
[0m11:05:05.992527 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:05:05.993532 [info ] [MainThread]: 
[0m11:05:05.994536 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:05:05.994536 [info ] [MainThread]: 
[0m11:05:05.995557 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:05:05.997528 [debug] [MainThread]: Command `dbt run` failed at 11:05:05.997528 after 4.74 seconds
[0m11:05:05.997528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E8949880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E8829220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3EA378680>]}
[0m11:05:05.998561 [debug] [MainThread]: Flushing usage events
[0m11:09:12.530595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984F45B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984F45B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984F45B500>]}


============================== 11:09:12.536068 | 3b033d91-f3be-4831-a66f-1dc1ec27c3d1 ==============================
[0m11:09:12.536068 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:09:12.536796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:09:13.434945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985B804B00>]}
[0m11:09:13.525957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985BBB0470>]}
[0m11:09:13.526956 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:09:13.535234 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:09:13.654835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:09:13.654835 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:09:13.655830 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m11:09:13.793413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:09:13.799444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985B917F80>]}
[0m11:09:13.810413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984F458350>]}
[0m11:09:13.811415 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:09:13.812414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985C033D70>]}
[0m11:09:13.814414 [info ] [MainThread]: 
[0m11:09:13.816424 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:13.819400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:09:13.833436 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:09:13.833436 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:09:13.833436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:14.641008 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:09:14.641982 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:09:14.743960 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:09:14.745475 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:09:14.747496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:15.069053 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m11:09:15.071053 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:09:15.160584 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:09:15.161585 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:09:15.161585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:15.592421 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m11:09:15.594417 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:09:15.696452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB, now create_RIDE_SHARING_DB_MART)
[0m11:09:15.700453 [debug] [ThreadPool]: Creating schema "database: "RIDE_SHARING_DB"
schema: "MART"
"
[0m11:09:15.711448 [debug] [ThreadPool]: Using snowflake connection "create_RIDE_SHARING_DB_MART"
[0m11:09:15.711448 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "create_RIDE_SHARING_DB_MART"} */
create schema if not exists RIDE_SHARING_DB.MART
[0m11:09:15.712448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:16.164056 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:16.165047 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_MART: Close
[0m11:09:16.264701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m11:09:16.292673 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:09:16.293674 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:09:16.294668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:16.628961 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:09:16.630957 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:09:16.722794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m11:09:16.728745 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:09:16.728745 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:09:16.729746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:17.023714 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:09:17.026714 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:09:17.118267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m11:09:17.123310 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:09:17.124309 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:09:17.125310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:17.435605 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:17.437600 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:09:17.529217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m11:09:17.537182 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:09:17.537182 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:09:17.538148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:17.863288 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:09:17.866893 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:09:17.958620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985C030CE0>]}
[0m11:09:17.959618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:17.960632 [info ] [MainThread]: 
[0m11:09:17.964723 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m11:09:17.965722 [info ] [Thread-1 (]: 1 of 5 START sql view model STAGING.stg_country ................................ [RUN]
[0m11:09:17.966724 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m11:09:17.967724 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m11:09:17.976724 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m11:09:17.980129 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 11:09:17.967724 => 11:09:17.980129
[0m11:09:17.981159 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m11:09:18.013157 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m11:09:18.016127 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m11:09:18.016127 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m11:09:18.017126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:18.437094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:18.458056 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 11:09:17.981159 => 11:09:18.458056
[0m11:09:18.459056 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m11:09:18.547294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985C304920>]}
[0m11:09:18.549291 [info ] [Thread-1 (]: 1 of 5 OK created sql view model STAGING.stg_country ........................... [[32mSUCCESS 1[0m in 0.58s]
[0m11:09:18.552249 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m11:09:18.554246 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m11:09:18.556291 [info ] [Thread-1 (]: 2 of 5 START sql view model STAGING.stg_customers .............................. [RUN]
[0m11:09:18.559249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m11:09:18.560291 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m11:09:18.565309 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m11:09:18.567275 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 11:09:18.561292 => 11:09:18.567275
[0m11:09:18.568276 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m11:09:18.571306 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m11:09:18.573737 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m11:09:18.573737 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m11:09:18.574760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:18.988549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:18.991478 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 11:09:18.568276 => 11:09:18.991478
[0m11:09:18.992510 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m11:09:19.082277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985C2E6C30>]}
[0m11:09:19.083277 [info ] [Thread-1 (]: 2 of 5 OK created sql view model STAGING.stg_customers ......................... [[32mSUCCESS 1[0m in 0.52s]
[0m11:09:19.084157 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m11:09:19.085203 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m11:09:19.086207 [info ] [Thread-1 (]: 3 of 5 START sql table model MART.stg_product .................................. [RUN]
[0m11:09:19.088201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m11:09:19.088201 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m11:09:19.094204 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m11:09:19.096168 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 11:09:19.089204 => 11:09:19.095205
[0m11:09:19.096168 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m11:09:19.123166 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m11:09:19.124165 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m11:09:19.125166 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace transient table RIDE_SHARING_DB.MART.stg_product
         as
        (

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS



        );
[0m11:09:19.125166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:20.136180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:09:20.139177 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 11:09:19.097204 => 11:09:20.138212
[0m11:09:20.139177 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m11:09:20.224347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985BC225D0>]}
[0m11:09:20.224347 [info ] [Thread-1 (]: 3 of 5 OK created sql table model MART.stg_product ............................. [[32mSUCCESS 1[0m in 1.14s]
[0m11:09:20.225365 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m11:09:20.226345 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m11:09:20.226345 [info ] [Thread-1 (]: 4 of 5 START sql view model STAGING.stg_transaction ............................ [RUN]
[0m11:09:20.227378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m11:09:20.228347 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m11:09:20.232347 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m11:09:20.233346 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 11:09:20.228347 => 11:09:20.233346
[0m11:09:20.233346 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m11:09:20.237377 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m11:09:20.239347 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m11:09:20.239347 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'DD-MM-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m11:09:20.239347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:20.675332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:20.687419 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 11:09:20.234346 => 11:09:20.686403
[0m11:09:20.689420 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m11:09:20.794986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985C2E6C30>]}
[0m11:09:20.795973 [info ] [Thread-1 (]: 4 of 5 OK created sql view model STAGING.stg_transaction ....................... [[32mSUCCESS 1[0m in 0.57s]
[0m11:09:20.796952 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m11:09:20.798400 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:09:20.798400 [info ] [Thread-1 (]: 5 of 5 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:09:20.800408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_transaction, now model.practice.prod_transaction)
[0m11:09:20.800408 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:09:20.804408 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:09:20.805406 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:09:20.800408 => 11:09:20.805406
[0m11:09:20.806423 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:09:20.810407 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:09:20.813410 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:09:20.813410 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        DATE_TRUNC('MONTH',PAYMENT_MONTH) AS PAY_MONTH
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
)


SELECT 
    CUSTOMER_ID,
    MIN(PAYMENT_MONTH) AS first_purchase,
    MAX(PAYMENT_MONTH) AS last_purchase,
    MAX(DATE_TRUNC('MONTH',PAY_MONTH)) as pay_month
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
    
FROM customer_activity
GROUP BY CUSTOMER_ID
        );
[0m11:09:20.814409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:21.095890 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef3-0001-429b-0008-435e0001db1a
[0m11:09:21.096891 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected '('.
[0m11:09:21.096891 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:09:20.806423 => 11:09:21.096891
[0m11:09:21.097891 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:09:21.197910 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:09:21.198911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b033d91-f3be-4831-a66f-1dc1ec27c3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001985C389640>]}
[0m11:09:21.200860 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.40s]
[0m11:09:21.203090 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:09:21.208084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:21.208084 [debug] [MainThread]: Connection 'create_RIDE_SHARING_DB_MART' was properly closed.
[0m11:09:21.209084 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m11:09:21.210083 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:09:21.210083 [info ] [MainThread]: 
[0m11:09:21.211085 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m11:09:21.213075 [debug] [MainThread]: Command end result
[0m11:09:21.223042 [info ] [MainThread]: 
[0m11:09:21.224043 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:21.225044 [info ] [MainThread]: 
[0m11:09:21.226114 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:09:21.227122 [info ] [MainThread]: 
[0m11:09:21.227122 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:09:21.229153 [debug] [MainThread]: Command `dbt run` failed at 11:09:21.228152 after 8.77 seconds
[0m11:09:21.229153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984F48B830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984F0F4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984F45B500>]}
[0m11:09:21.229153 [debug] [MainThread]: Flushing usage events
[0m11:09:52.877405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F66655310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62798B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F666552B0>]}


============================== 11:09:52.881437 | 225f4f1a-f612-4968-a815-dd905b327aff ==============================
[0m11:09:52.881437 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:09:52.882416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:09:53.749376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F71DE0710>]}
[0m11:09:53.836927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F70CC0500>]}
[0m11:09:53.837926 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:09:53.845500 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:09:53.949051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:09:53.949051 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:09:54.088632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:09:54.093666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7333DD60>]}
[0m11:09:54.106632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F732F3890>]}
[0m11:09:54.106632 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:09:54.107631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F71A186E0>]}
[0m11:09:54.109666 [info ] [MainThread]: 
[0m11:09:54.110633 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:54.111663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:09:54.125638 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:09:54.125638 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:09:54.126638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:54.938430 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:09:54.940429 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:09:55.029080 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:09:55.030079 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:09:55.030079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:55.320691 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:09:55.322691 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:09:55.404759 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:09:55.405758 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:09:55.405758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:55.819219 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:09:55.821220 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:09:55.924620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m11:09:55.935616 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:09:55.935616 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:09:55.935616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:56.231571 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:09:56.233614 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:09:56.321026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m11:09:56.329025 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:09:56.331033 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:09:56.332075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:56.648789 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:09:56.652826 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:09:56.737040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m11:09:56.741071 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:09:56.742072 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:09:56.742072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:57.148153 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:57.150269 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:09:57.234699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m11:09:57.237647 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:09:57.237647 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:09:57.238677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:57.563577 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:57.566574 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:09:57.665841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F71B50980>]}
[0m11:09:57.667846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:57.668845 [info ] [MainThread]: 
[0m11:09:57.677839 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m11:09:57.679843 [info ] [Thread-1 (]: 1 of 5 START sql view model STAGING.stg_country ................................ [RUN]
[0m11:09:57.682820 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m11:09:57.683846 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m11:09:57.692792 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m11:09:57.693792 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 11:09:57.683846 => 11:09:57.693792
[0m11:09:57.694796 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m11:09:57.731794 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m11:09:57.733792 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m11:09:57.733792 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m11:09:57.734824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:58.163649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:58.200683 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 11:09:57.694796 => 11:09:58.200683
[0m11:09:58.201645 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m11:09:58.299416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F735FA630>]}
[0m11:09:58.301420 [info ] [Thread-1 (]: 1 of 5 OK created sql view model STAGING.stg_country ........................... [[32mSUCCESS 1[0m in 0.62s]
[0m11:09:58.305416 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m11:09:58.308417 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m11:09:58.310418 [info ] [Thread-1 (]: 2 of 5 START sql view model STAGING.stg_customers .............................. [RUN]
[0m11:09:58.313392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m11:09:58.314391 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m11:09:58.321380 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m11:09:58.323346 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 11:09:58.315392 => 11:09:58.323346
[0m11:09:58.324380 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m11:09:58.329341 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m11:09:58.331339 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m11:09:58.332373 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m11:09:58.332373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:58.758791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:09:58.764379 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 11:09:58.324380 => 11:09:58.763354
[0m11:09:58.764379 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m11:09:58.862382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F735FA120>]}
[0m11:09:58.865425 [info ] [Thread-1 (]: 2 of 5 OK created sql view model STAGING.stg_customers ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m11:09:58.867368 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m11:09:58.868356 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m11:09:58.868356 [info ] [Thread-1 (]: 3 of 5 START sql table model MART.stg_product .................................. [RUN]
[0m11:09:58.870358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m11:09:58.870358 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m11:09:58.874387 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m11:09:58.876359 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 11:09:58.870358 => 11:09:58.875374
[0m11:09:58.876359 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m11:09:58.900390 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m11:09:58.902356 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m11:09:58.902356 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace transient table RIDE_SHARING_DB.MART.stg_product
         as
        (

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS



        );
[0m11:09:58.903387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:00.208478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:10:00.220477 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 11:09:58.876359 => 11:10:00.219480
[0m11:10:00.222479 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m11:10:00.332504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F735FA6F0>]}
[0m11:10:00.335499 [info ] [Thread-1 (]: 3 of 5 OK created sql table model MART.stg_product ............................. [[32mSUCCESS 1[0m in 1.46s]
[0m11:10:00.339175 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m11:10:00.342175 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m11:10:00.343138 [info ] [Thread-1 (]: 4 of 5 START sql view model STAGING.stg_transaction ............................ [RUN]
[0m11:10:00.344129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m11:10:00.344129 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m11:10:00.348138 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m11:10:00.350111 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 11:10:00.345138 => 11:10:00.349106
[0m11:10:00.351120 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m11:10:00.354140 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m11:10:00.356177 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m11:10:00.356177 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'DD-MM-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m11:10:00.356177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:00.780273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:00.788273 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 11:10:00.351120 => 11:10:00.788273
[0m11:10:00.790325 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m11:10:00.875506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F735FA540>]}
[0m11:10:00.876505 [info ] [Thread-1 (]: 4 of 5 OK created sql view model STAGING.stg_transaction ....................... [[32mSUCCESS 1[0m in 0.53s]
[0m11:10:00.877505 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m11:10:00.878504 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:10:00.878504 [info ] [Thread-1 (]: 5 of 5 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:10:00.879504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_transaction, now model.practice.prod_transaction)
[0m11:10:00.880506 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:10:00.884506 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:10:00.885505 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:10:00.880506 => 11:10:00.884506
[0m11:10:00.885505 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:10:00.889508 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:10:00.891505 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:10:00.891505 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    MIN(PAYMENT_MONTH) AS first_purchase,
    MAX(PAYMENT_MONTH) AS last_purchase,
    MAX(DATE_TRUNC('MONTH',PAYMENT_MONTH)) as pay_month
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
    pay_month
FROM customer_activity
        );
[0m11:10:00.892507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:01.171835 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef4-0001-429b-0008-435e0001db36
[0m11:10:01.172834 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 4 unexpected '('.
[0m11:10:01.172834 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:10:00.885505 => 11:10:01.172834
[0m11:10:01.173834 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:10:01.261836 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:10:01.261836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '225f4f1a-f612-4968-a815-dd905b327aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F73632000>]}
[0m11:10:01.262836 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.38s]
[0m11:10:01.263837 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:10:01.265838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:01.266836 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:10:01.266836 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m11:10:01.266836 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:10:01.267838 [info ] [MainThread]: 
[0m11:10:01.267838 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m11:10:01.269839 [debug] [MainThread]: Command end result
[0m11:10:01.280348 [info ] [MainThread]: 
[0m11:10:01.281346 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:10:01.281346 [info ] [MainThread]: 
[0m11:10:01.282349 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected '('.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:10:01.283347 [info ] [MainThread]: 
[0m11:10:01.283347 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:10:01.285352 [debug] [MainThread]: Command `dbt run` failed at 11:10:01.285352 after 8.47 seconds
[0m11:10:01.286355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F66550260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F666552B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F66655310>]}
[0m11:10:01.287357 [debug] [MainThread]: Flushing usage events
[0m11:10:32.858245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8907ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A853E8B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A89356DE0>]}


============================== 11:10:32.863219 | bdc3ceb3-c033-4c4b-80cb-09f9893d6b28 ==============================
[0m11:10:32.863219 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:10:32.864220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:33.746749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A95D4FA10>]}
[0m11:10:33.843267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A95CBDAC0>]}
[0m11:10:33.845266 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:10:33.854266 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:10:33.979793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:10:33.980800 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:10:34.127832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:10:34.133864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A95E16CF0>]}
[0m11:10:34.145832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A95DBB710>]}
[0m11:10:34.146835 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:10:34.147832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A96041CD0>]}
[0m11:10:34.149864 [info ] [MainThread]: 
[0m11:10:34.150833 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:34.152836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:10:34.168771 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:10:34.169805 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:10:34.169805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:35.067139 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:10:35.068136 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:10:35.171784 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:10:35.172784 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:10:35.173786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:35.484362 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:10:35.486357 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:10:35.579948 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:10:35.580915 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:10:35.580915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:35.993445 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:10:35.995441 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:10:36.087147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m11:10:36.097136 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:10:36.097136 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:10:36.098175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:36.530460 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:10:36.533456 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:10:36.633912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m11:10:36.647908 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:10:36.649914 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:10:36.650894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:36.949133 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:36.952133 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:10:37.045634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m11:10:37.049671 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:10:37.050676 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:10:37.050676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:37.363803 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:37.365836 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:10:37.446915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m11:10:37.449916 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:10:37.450945 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:10:37.450945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:37.761410 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:10:37.763368 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:10:37.857999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9591CF50>]}
[0m11:10:37.859998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:37.860997 [info ] [MainThread]: 
[0m11:10:37.867999 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m11:10:37.869029 [info ] [Thread-1 (]: 1 of 5 START sql view model STAGING.stg_country ................................ [RUN]
[0m11:10:37.869995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m11:10:37.870998 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m11:10:37.881995 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m11:10:37.883997 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 11:10:37.870998 => 11:10:37.883997
[0m11:10:37.884996 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m11:10:37.933518 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m11:10:37.937519 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m11:10:37.938519 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m11:10:37.938519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:38.406855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:38.451524 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 11:10:37.884996 => 11:10:38.451524
[0m11:10:38.452524 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m11:10:38.551563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A962FDBE0>]}
[0m11:10:38.554563 [info ] [Thread-1 (]: 1 of 5 OK created sql view model STAGING.stg_country ........................... [[32mSUCCESS 1[0m in 0.68s]
[0m11:10:38.558563 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m11:10:38.560563 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m11:10:38.561561 [info ] [Thread-1 (]: 2 of 5 START sql view model STAGING.stg_customers .............................. [RUN]
[0m11:10:38.562516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m11:10:38.563568 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m11:10:38.566555 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m11:10:38.567555 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 11:10:38.563568 => 11:10:38.567555
[0m11:10:38.568527 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m11:10:38.572555 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m11:10:38.573554 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m11:10:38.574524 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m11:10:38.574524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:38.990316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:38.993316 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 11:10:38.568527 => 11:10:38.993316
[0m11:10:38.993316 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m11:10:39.078825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A962FE3C0>]}
[0m11:10:39.079824 [info ] [Thread-1 (]: 2 of 5 OK created sql view model STAGING.stg_customers ......................... [[32mSUCCESS 1[0m in 0.52s]
[0m11:10:39.081823 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m11:10:39.082823 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m11:10:39.082823 [info ] [Thread-1 (]: 3 of 5 START sql table model MART.stg_product .................................. [RUN]
[0m11:10:39.084824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m11:10:39.085823 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m11:10:39.089822 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m11:10:39.090821 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 11:10:39.085823 => 11:10:39.090821
[0m11:10:39.091824 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m11:10:39.117828 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m11:10:39.118829 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m11:10:39.119829 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace transient table RIDE_SHARING_DB.MART.stg_product
         as
        (

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS



        );
[0m11:10:39.119829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:39.816850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:10:39.818881 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 11:10:39.091824 => 11:10:39.818881
[0m11:10:39.819881 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m11:10:39.905162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A962FEE40>]}
[0m11:10:39.908163 [info ] [Thread-1 (]: 3 of 5 OK created sql table model MART.stg_product ............................. [[32mSUCCESS 1[0m in 0.82s]
[0m11:10:39.912205 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m11:10:39.915304 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m11:10:39.916255 [info ] [Thread-1 (]: 4 of 5 START sql view model STAGING.stg_transaction ............................ [RUN]
[0m11:10:39.917260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m11:10:39.918255 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m11:10:39.921255 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m11:10:39.922258 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 11:10:39.918255 => 11:10:39.922258
[0m11:10:39.922258 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m11:10:39.926255 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m11:10:39.927224 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m11:10:39.927224 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'DD-MM-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m11:10:39.928255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:40.373314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:40.377311 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 11:10:39.923255 => 11:10:40.377311
[0m11:10:40.378311 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m11:10:40.480267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A96336CF0>]}
[0m11:10:40.481269 [info ] [Thread-1 (]: 4 of 5 OK created sql view model STAGING.stg_transaction ....................... [[32mSUCCESS 1[0m in 0.56s]
[0m11:10:40.482236 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m11:10:40.482763 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:10:40.482763 [info ] [Thread-1 (]: 5 of 5 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:10:40.484800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_transaction, now model.practice.prod_transaction)
[0m11:10:40.484800 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:10:40.487801 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:10:40.489769 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:10:40.484800 => 11:10:40.488800
[0m11:10:40.489769 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:10:40.493800 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:10:40.495771 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:10:40.496769 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase,
        MAX(DATE_TRUNC('MONTH',PAYMENT_MONTH)) as pay_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('month', first_purchase, last_purchase))
 AS days_active,
    PAY_MONTH
FROM customer_activity
        );
[0m11:10:40.496769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:41.238731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:10:41.249730 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:10:40.489769 => 11:10:41.248728
[0m11:10:41.252730 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:10:41.336748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc3ceb3-c033-4c4b-80cb-09f9893d6b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A963363F0>]}
[0m11:10:41.337750 [info ] [Thread-1 (]: 5 of 5 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 0.85s]
[0m11:10:41.338748 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:10:41.340717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:41.340717 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:10:41.340717 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m11:10:41.341717 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:10:41.341717 [info ] [MainThread]: 
[0m11:10:41.342717 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m11:10:41.344753 [debug] [MainThread]: Command end result
[0m11:10:41.355717 [info ] [MainThread]: 
[0m11:10:41.356555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:41.357564 [info ] [MainThread]: 
[0m11:10:41.357564 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:10:41.359595 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:41.359595 after 8.57 seconds
[0m11:10:41.359595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A89281B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A8907ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A87F3D760>]}
[0m11:10:41.360592 [debug] [MainThread]: Flushing usage events
[0m11:13:00.553785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501A0551F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501A055070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501A055610>]}


============================== 11:13:00.557816 | 17e0d800-7121-4f48-932f-fb17032ff728 ==============================
[0m11:13:00.557816 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:13:00.559199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_tranaction', 'send_anonymous_usage_stats': 'True'}
[0m11:13:01.446571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e0d800-7121-4f48-932f-fb17032ff728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015026A1B920>]}
[0m11:13:01.533608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e0d800-7121-4f48-932f-fb17032ff728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001501A08B920>]}
[0m11:13:01.534607 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:13:01.543171 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:13:01.651678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:13:01.652674 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:13:01.789270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:13:01.795294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17e0d800-7121-4f48-932f-fb17032ff728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015026DFB7A0>]}
[0m11:13:01.807262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17e0d800-7121-4f48-932f-fb17032ff728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150269BDC10>]}
[0m11:13:01.807262 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:13:01.808270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e0d800-7121-4f48-932f-fb17032ff728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150264D0FB0>]}
[0m11:13:01.809291 [warn ] [MainThread]: The selection criterion 'prod_tranaction' does not match any nodes
[0m11:13:01.811294 [info ] [MainThread]: 
[0m11:13:01.811853 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:13:01.812863 [debug] [MainThread]: Command end result
[0m11:13:01.823861 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:01.822861 after 1.33 seconds
[0m11:13:01.823861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015018DDCCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015018C79880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015018CF7FB0>]}
[0m11:13:01.824863 [debug] [MainThread]: Flushing usage events
[0m11:13:11.232148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B05359220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B05358050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B053595E0>]}


============================== 11:13:11.236181 | 6494b424-3d4b-4fcd-88b2-c6094d00d053 ==============================
[0m11:13:11.236181 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:13:11.237186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:13:12.103880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6494b424-3d4b-4fcd-88b2-c6094d00d053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AFF329970>]}
[0m11:13:12.190917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6494b424-3d4b-4fcd-88b2-c6094d00d053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B1188BDD0>]}
[0m11:13:12.191458 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:13:12.199496 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:13:12.301575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:12.302575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:12.302575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:13:12.308578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6494b424-3d4b-4fcd-88b2-c6094d00d053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B11A53890>]}
[0m11:13:12.320545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6494b424-3d4b-4fcd-88b2-c6094d00d053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B11D51F70>]}
[0m11:13:12.321577 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:13:12.322544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6494b424-3d4b-4fcd-88b2-c6094d00d053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B05359670>]}
[0m11:13:12.323575 [info ] [MainThread]: 
[0m11:13:12.324588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:13:12.326628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:13:12.340594 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:13:12.341594 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:13:12.341594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:13.315425 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:13:13.318390 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:13:13.414822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m11:13:13.426822 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:13:13.427823 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:13:13.427823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:13.739692 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:13:13.745688 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:13:13.852514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m11:13:13.862482 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:13:13.864514 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:13:13.866515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:14.338500 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:13:14.341498 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:13:14.434463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m11:13:14.439422 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:13:14.439422 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:13:14.439422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:14.892177 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:13:14.894174 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:13:14.984326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m11:13:14.989279 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:13:14.989279 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:13:14.990279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:15.309723 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:13:15.310710 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:13:15.402047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6494b424-3d4b-4fcd-88b2-c6094d00d053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B03CFC4A0>]}
[0m11:13:15.404051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:15.406012 [info ] [MainThread]: 
[0m11:13:15.412968 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:13:15.415539 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:13:15.417537 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:13:15.418532 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:13:15.429493 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:13:15.432508 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:13:15.419537 => 11:13:15.431503
[0m11:13:15.433497 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:13:15.465544 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:13:15.467523 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:13:15.467523 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase,
        MAX(DATE_TRUNC('MONTH',PAYMENT_MONTH)) as pay_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('month', first_purchase, last_purchase))
 AS months_active,
    pay_month
FROM customer_activity
        );
[0m11:13:15.468524 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:13:16.227801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:13:16.254350 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:13:15.433497 => 11:13:16.254350
[0m11:13:16.255350 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:13:16.333715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6494b424-3d4b-4fcd-88b2-c6094d00d053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B11B8B830>]}
[0m11:13:16.334714 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 0.92s]
[0m11:13:16.336677 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:13:16.340681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:16.341674 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:13:16.341674 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m11:13:16.342676 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:13:16.343714 [info ] [MainThread]: 
[0m11:13:16.344721 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m11:13:16.347731 [debug] [MainThread]: Command end result
[0m11:13:16.364733 [info ] [MainThread]: 
[0m11:13:16.365731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:16.367764 [info ] [MainThread]: 
[0m11:13:16.368730 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:16.369729 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:16.369729 after 5.20 seconds
[0m11:13:16.370766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B0518B560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B03FF4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B05387EC0>]}
[0m11:13:16.371733 [debug] [MainThread]: Flushing usage events
[0m11:19:57.662949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503BE59370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503BE580E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503BE58380>]}


============================== 11:19:57.674980 | 74542f59-6e71-469d-9c9c-ae5d82d398da ==============================
[0m11:19:57.674980 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:19:57.675949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:20:04.770823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74542f59-6e71-469d-9c9c-ae5d82d398da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015046F4A8D0>]}
[0m11:20:04.856439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74542f59-6e71-469d-9c9c-ae5d82d398da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001504835A4B0>]}
[0m11:20:04.865011 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:20:04.881817 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:20:06.064322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:06.064322 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:20:06.198840 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:20:06.205316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74542f59-6e71-469d-9c9c-ae5d82d398da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015048AF7890>]}
[0m11:20:06.230520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74542f59-6e71-469d-9c9c-ae5d82d398da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015048A12360>]}
[0m11:20:06.231555 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:20:06.232525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74542f59-6e71-469d-9c9c-ae5d82d398da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150486E7A40>]}
[0m11:20:06.233548 [info ] [MainThread]: 
[0m11:20:06.234516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:06.236547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:20:06.249547 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:20:06.250530 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:20:06.250530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:07.545854 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:20:07.552850 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:20:07.667624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m11:20:07.684625 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:20:07.685622 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:20:07.686617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:08.073198 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:20:08.077199 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:20:08.161013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m11:20:08.175013 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:20:08.175988 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:20:08.176989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:08.602703 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:20:08.606705 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:20:08.694676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m11:20:08.704632 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:20:08.704632 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:20:08.705629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:09.037141 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:20:09.041087 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:20:09.134142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m11:20:09.144145 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:20:09.147077 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:20:09.148083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:09.469901 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:20:09.472904 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:20:09.560526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74542f59-6e71-469d-9c9c-ae5d82d398da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015048B97710>]}
[0m11:20:09.561536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:09.562505 [info ] [MainThread]: 
[0m11:20:09.566504 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:20:09.567529 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:20:09.568516 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:20:09.569532 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:20:09.577536 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:20:09.578504 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:20:09.569532 => 11:20:09.578504
[0m11:20:09.579506 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:20:09.610535 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:20:09.612512 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:20:09.613506 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase,
        MAX(DATE_TRUNC('MONTH',PAYMENT_MONTH)) as pay_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('month', first_purchase, last_purchase))
 AS months_active,
    DATEADD('Month',-1, pay_month) AS last_month
    last_month
FROM customer_activity
        );
[0m11:20:09.613506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:20:10.176817 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafefe-0001-429b-0008-435e0001dbe2
[0m11:20:10.177849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 4 unexpected 'last_month'.
[0m11:20:10.177849 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:20:09.579506 => 11:20:10.177849
[0m11:20:10.178850 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:20:10.270238 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 4 unexpected 'last_month'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:20:10.272243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74542f59-6e71-469d-9c9c-ae5d82d398da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150488149B0>]}
[0m11:20:10.273284 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.70s]
[0m11:20:10.276238 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:20:10.280278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:10.281239 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:20:10.282240 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m11:20:10.282240 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:20:10.283238 [info ] [MainThread]: 
[0m11:20:10.284238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m11:20:10.286273 [debug] [MainThread]: Command end result
[0m11:20:10.301233 [info ] [MainThread]: 
[0m11:20:10.302234 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:10.303221 [info ] [MainThread]: 
[0m11:20:10.304229 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 4 unexpected 'last_month'.
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:20:10.304229 [info ] [MainThread]: 
[0m11:20:10.305259 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:20:10.306176 [debug] [MainThread]: Command `dbt run` failed at 11:20:10.306176 after 12.73 seconds
[0m11:20:10.307270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503BD81C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503BE3FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001503BAB7FB0>]}
[0m11:20:10.307270 [debug] [MainThread]: Flushing usage events
[0m11:20:35.879744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BC54380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BC543E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BC55550>]}


============================== 11:20:35.883742 | 77d8a6fb-b096-4cb6-813a-c78b85802571 ==============================
[0m11:20:35.883742 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:20:35.884892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m11:20:36.760023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77d8a6fb-b096-4cb6-813a-c78b85802571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77825A810>]}
[0m11:20:36.847646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77d8a6fb-b096-4cb6-813a-c78b85802571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7785EEF00>]}
[0m11:20:36.848648 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:20:36.857614 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:20:36.969521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:36.970518 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:20:37.106040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:20:37.112072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77d8a6fb-b096-4cb6-813a-c78b85802571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7789F7590>]}
[0m11:20:37.124622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77d8a6fb-b096-4cb6-813a-c78b85802571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7788F18B0>]}
[0m11:20:37.125620 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:20:37.126660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77d8a6fb-b096-4cb6-813a-c78b85802571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7785BE3F0>]}
[0m11:20:37.128620 [info ] [MainThread]: 
[0m11:20:37.130621 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:37.132650 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:20:37.146654 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:20:37.146654 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:20:37.146654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:38.274324 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:20:38.277324 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:20:38.377461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m11:20:38.386460 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:20:38.386460 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:20:38.387460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:38.819213 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:20:38.821212 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:20:38.911741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m11:20:38.915736 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:20:38.915736 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:20:38.916736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:39.326576 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:20:39.328537 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:20:39.424113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m11:20:39.429083 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:20:39.430083 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:20:39.430083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:39.768117 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:20:39.769105 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:20:39.857002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m11:20:39.858999 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:20:39.859999 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:20:39.859999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:40.297722 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:20:40.299722 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:20:40.387045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77d8a6fb-b096-4cb6-813a-c78b85802571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7789EC6B0>]}
[0m11:20:40.388047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:40.389049 [info ] [MainThread]: 
[0m11:20:40.393046 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:20:40.393046 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:20:40.395046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:20:40.396047 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:20:40.403073 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:20:40.405047 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:20:40.396047 => 11:20:40.404078
[0m11:20:40.406078 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:20:40.436050 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:20:40.439078 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:20:40.439078 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (


WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase,
        MAX(PAYMENT_MONTH) AS last_purchase,
        MAX(DATE_TRUNC('MONTH',PAYMENT_MONTH)) as pay_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY CUSTOMER_ID
)


SELECT 
    CUSTOMER_ID,
    first_purchase,
    last_purchase,
    
    (datediff('month', first_purchase, last_purchase))
 AS months_active,
    DATEADD('Month',-1, pay_month) AS last_month,
    pay_month
FROM customer_activity
        );
[0m11:20:40.439078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:20:42.444177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:20:42.467190 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:20:40.406078 => 11:20:42.467190
[0m11:20:42.468192 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:20:42.556479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77d8a6fb-b096-4cb6-813a-c78b85802571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B778BC6600>]}
[0m11:20:42.557481 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 2.16s]
[0m11:20:42.559473 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:20:42.563497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:42.564511 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:20:42.564511 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m11:20:42.565471 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:20:42.566467 [info ] [MainThread]: 
[0m11:20:42.566467 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m11:20:42.568467 [debug] [MainThread]: Command end result
[0m11:20:42.582735 [info ] [MainThread]: 
[0m11:20:42.583739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:42.583739 [info ] [MainThread]: 
[0m11:20:42.584727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:20:42.586739 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:42.585756 after 6.77 seconds
[0m11:20:42.586739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BA33590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BA091F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76BAC9070>]}
[0m11:20:42.587756 [debug] [MainThread]: Flushing usage events
[0m11:48:12.793748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868C4CAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868C124F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868C657D10>]}


============================== 11:48:12.824590 | cc8c1de5-5f07-4c9d-b331-4c30022cea18 ==============================
[0m11:48:12.824590 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:48:12.825590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m11:48:21.080990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc8c1de5-5f07-4c9d-b331-4c30022cea18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018697B31C10>]}
[0m11:48:21.168576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc8c1de5-5f07-4c9d-b331-4c30022cea18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018697BFFF20>]}
[0m11:48:21.177367 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:48:21.197687 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:48:22.507528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:22.507528 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:48:22.648396 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.prod_transaction' (models\marts\prod_transaction.sql) depends on a node named 'stg_transactions' which was not found
[0m11:48:22.649396 [debug] [MainThread]: Command `dbt run` failed at 11:48:22.649396 after 9.95 seconds
[0m11:48:22.650396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001868C55A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001869901B9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186990B3BF0>]}
[0m11:48:22.650396 [debug] [MainThread]: Flushing usage events
[0m11:48:34.066160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF17AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF555850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF557E90>]}


============================== 11:48:34.071159 | d4de689e-7feb-4d72-9178-1b5b7590b38f ==============================
[0m11:48:34.071159 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:48:34.072128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:48:34.954045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4de689e-7feb-4d72-9178-1b5b7590b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF5B8830>]}
[0m11:48:35.040659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4de689e-7feb-4d72-9178-1b5b7590b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF5810D0>]}
[0m11:48:35.041657 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:48:35.050657 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:48:35.154145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:35.154145 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:48:35.289391 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:48:35.294421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4de689e-7feb-4d72-9178-1b5b7590b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CCBEB2210>]}
[0m11:48:35.321651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4de689e-7feb-4d72-9178-1b5b7590b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CCBF52150>]}
[0m11:48:35.321651 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:48:35.322605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4de689e-7feb-4d72-9178-1b5b7590b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CCC140EC0>]}
[0m11:48:35.324605 [info ] [MainThread]: 
[0m11:48:35.325347 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:35.327386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:48:35.340385 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:48:35.340385 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:48:35.341387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:36.564834 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:48:36.566834 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:48:36.669483 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m11:48:36.700021 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:48:36.701021 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:48:36.702019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.195935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:48:37.198889 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:48:37.289501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m11:48:37.291498 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:48:37.292499 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:48:37.292499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:37.597127 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:48:37.599123 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:48:37.686016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m11:48:37.689051 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:48:37.690051 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:48:37.690051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:38.002657 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:48:38.005241 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:48:38.108834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4de689e-7feb-4d72-9178-1b5b7590b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CCC1F4380>]}
[0m11:48:38.112857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:38.115788 [info ] [MainThread]: 
[0m11:48:38.131193 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:48:38.132190 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.prod_transaction ........................... [RUN]
[0m11:48:38.134187 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:48:38.135188 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:48:38.144220 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:48:38.146446 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:48:38.135188 => 11:48:38.146446
[0m11:48:38.147453 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:48:38.182485 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:48:38.184454 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:48:38.184454 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.prod_transaction
  
   as (
    WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS txn_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(txn_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.txn_month) AS last_transaction_month,
        m.latest_month,
        
        CASE
            WHEN MAX(t.txn_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id, m.latest_month
)
 
SELECT * FROM churn_status
  );
[0m11:48:38.185451 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:48:38.619648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:48:38.639664 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:48:38.147453 => 11:48:38.638665
[0m11:48:38.639664 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:48:38.721367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4de689e-7feb-4d72-9178-1b5b7590b38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CCC3CBC80>]}
[0m11:48:38.723367 [info ] [Thread-1 (]: 1 of 1 OK created sql view model STAGING.prod_transaction ...................... [[32mSUCCESS 1[0m in 0.59s]
[0m11:48:38.724366 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:48:38.728364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:38.728364 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:48:38.729369 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m11:48:38.729369 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:48:38.730361 [info ] [MainThread]: 
[0m11:48:38.730361 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m11:48:38.732396 [debug] [MainThread]: Command end result
[0m11:48:38.744364 [info ] [MainThread]: 
[0m11:48:38.745365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:38.746520 [info ] [MainThread]: 
[0m11:48:38.747557 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:48:38.748560 [debug] [MainThread]: Command `dbt run` succeeded at 11:48:38.748560 after 4.74 seconds
[0m11:48:38.748560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF481E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF1F4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBF17AC00>]}
[0m11:48:38.749557 [debug] [MainThread]: Flushing usage events
[0m11:54:50.023517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196770CAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196756F4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019675F0FCB0>]}


============================== 11:54:50.035517 | 314c2ae4-2ac1-479a-97d7-fa97fc210cc7 ==============================
[0m11:54:50.035517 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:54:50.036793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:54:57.691371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '314c2ae4-2ac1-479a-97d7-fa97fc210cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960444C6B0>]}
[0m11:54:57.779884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '314c2ae4-2ac1-479a-97d7-fa97fc210cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019602038530>]}
[0m11:54:57.788085 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:54:57.809123 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:54:59.033299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:54:59.034300 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:54:59.173724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:54:59.178763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '314c2ae4-2ac1-479a-97d7-fa97fc210cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196044DA210>]}
[0m11:54:59.204733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '314c2ae4-2ac1-479a-97d7-fa97fc210cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960454E2D0>]}
[0m11:54:59.205732 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:54:59.205732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '314c2ae4-2ac1-479a-97d7-fa97fc210cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019602038EC0>]}
[0m11:54:59.207766 [info ] [MainThread]: 
[0m11:54:59.208744 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:59.210782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:54:59.223774 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:54:59.224785 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:54:59.224785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:00.386678 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:55:00.388678 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:55:00.483410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m11:55:00.493927 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:55:00.494928 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:55:00.494928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:00.957988 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:00.960985 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:55:01.049905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m11:55:01.054904 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:55:01.056945 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:55:01.057906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:01.479847 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:55:01.482846 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:55:01.569199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m11:55:01.575196 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:55:01.576198 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:55:01.576198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:01.878461 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:55:01.880454 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:55:01.963575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m11:55:01.967575 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:55:01.968577 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:55:01.968577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:02.253514 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:02.255509 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:55:02.336391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '314c2ae4-2ac1-479a-97d7-fa97fc210cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196047F2B10>]}
[0m11:55:02.337332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:02.338332 [info ] [MainThread]: 
[0m11:55:02.342334 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:55:02.343333 [info ] [Thread-1 (]: 1 of 1 START sql TABLE model MARTS.prod_transaction ............................ [RUN]
[0m11:55:02.344332 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:55:02.345334 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:55:02.353335 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:55:02.355338 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:55:02.345334 => 11:55:02.354334
[0m11:55:02.355338 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:55:02.357331 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:55:02.355338 => 11:55:02.357331
[0m11:55:02.392398 [debug] [Thread-1 (]: Compilation Error in model prod_transaction (models\marts\prod_transaction.sql)
  No materialization 'TABLE' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m11:55:02.392398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '314c2ae4-2ac1-479a-97d7-fa97fc210cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196049B1520>]}
[0m11:55:02.393395 [error] [Thread-1 (]: 1 of 1 ERROR creating sql TABLE model MARTS.prod_transaction ................... [[31mERROR[0m in 0.05s]
[0m11:55:02.394364 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:55:02.397395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:02.397395 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:55:02.397395 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m11:55:02.398395 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:55:02.398395 [info ] [MainThread]: 
[0m11:55:02.399362 [info ] [MainThread]: Finished running 1 TABLE model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m11:55:02.400363 [debug] [MainThread]: Command end result
[0m11:55:02.410882 [info ] [MainThread]: 
[0m11:55:02.411884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:02.412882 [info ] [MainThread]: 
[0m11:55:02.413883 [error] [MainThread]:   Compilation Error in model prod_transaction (models\marts\prod_transaction.sql)
  No materialization 'TABLE' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m11:55:02.414885 [info ] [MainThread]: 
[0m11:55:02.415883 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:02.416882 [debug] [MainThread]: Command `dbt run` failed at 11:55:02.416882 after 12.49 seconds
[0m11:55:02.417882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196771591F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001966ECA5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196770CAC00>]}
[0m11:55:02.418883 [debug] [MainThread]: Flushing usage events
[0m11:57:01.889777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A675AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A68581D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A6859070>]}


============================== 11:57:01.893764 | c403b3c2-b087-45d7-9574-e8b2d5a4ceea ==============================
[0m11:57:01.893764 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:57:01.894765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_transaction', 'send_anonymous_usage_stats': 'True'}
[0m11:57:02.795653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c403b3c2-b087-45d7-9574-e8b2d5a4ceea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B19F8F80>]}
[0m11:57:02.881691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c403b3c2-b087-45d7-9574-e8b2d5a4ceea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B19FA150>]}
[0m11:57:02.882692 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:57:02.891064 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:57:02.998685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:57:02.999680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:57:03.000683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:57:03.006681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c403b3c2-b087-45d7-9574-e8b2d5a4ceea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B32111F0>]}
[0m11:57:03.017681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c403b3c2-b087-45d7-9574-e8b2d5a4ceea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B3239F70>]}
[0m11:57:03.017681 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:57:03.018681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c403b3c2-b087-45d7-9574-e8b2d5a4ceea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B30EDA00>]}
[0m11:57:03.020681 [info ] [MainThread]: 
[0m11:57:03.021652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:03.023681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:57:03.038680 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:57:03.038680 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:57:03.039681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:03.845625 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:57:03.848624 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:57:03.936624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m11:57:03.946632 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:57:03.947632 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:57:03.947632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:04.364169 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:57:04.370167 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:57:04.466450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m11:57:04.473449 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:57:04.474446 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:57:04.475446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:04.798189 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:57:04.801792 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:57:04.882914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m11:57:04.885855 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:57:04.886855 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:57:04.886855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:05.221631 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:57:05.225647 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:57:05.326427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m11:57:05.346421 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:57:05.348421 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:57:05.349397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:05.691250 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:57:05.696252 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:57:05.801840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c403b3c2-b087-45d7-9574-e8b2d5a4ceea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B3455F70>]}
[0m11:57:05.803024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:57:05.803990 [info ] [MainThread]: 
[0m11:57:05.807656 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:57:05.808697 [info ] [Thread-1 (]: 1 of 1 START sql TABLE model MARTS.prod_transaction ............................ [RUN]
[0m11:57:05.809663 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:57:05.810694 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:57:05.817695 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:57:05.819663 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:57:05.810694 => 11:57:05.818663
[0m11:57:05.819663 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:57:05.821695 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:57:05.820694 => 11:57:05.821695
[0m11:57:05.824663 [debug] [Thread-1 (]: Compilation Error in model prod_transaction (models\marts\prod_transaction.sql)
  No materialization 'TABLE' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m11:57:05.824663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c403b3c2-b087-45d7-9574-e8b2d5a4ceea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B3213710>]}
[0m11:57:05.825694 [error] [Thread-1 (]: 1 of 1 ERROR creating sql TABLE model MARTS.prod_transaction ................... [[31mERROR[0m in 0.02s]
[0m11:57:05.826640 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:57:05.829930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:05.829930 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:57:05.830925 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m11:57:05.830925 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:57:05.830925 [info ] [MainThread]: 
[0m11:57:05.831893 [info ] [MainThread]: Finished running 1 TABLE model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m11:57:05.832894 [debug] [MainThread]: Command end result
[0m11:57:05.842935 [info ] [MainThread]: 
[0m11:57:05.843894 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:57:05.844895 [info ] [MainThread]: 
[0m11:57:05.845894 [error] [MainThread]:   Compilation Error in model prod_transaction (models\marts\prod_transaction.sql)
  No materialization 'TABLE' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m11:57:05.845894 [info ] [MainThread]: 
[0m11:57:05.846928 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:57:05.847895 [debug] [MainThread]: Command `dbt run` failed at 11:57:05.847895 after 4.02 seconds
[0m11:57:05.848923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A6090680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B35A3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A6324E30>]}
[0m11:57:05.848923 [debug] [MainThread]: Flushing usage events
[0m11:58:18.433949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ACD55250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ACD54140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ACD555B0>]}


============================== 11:58:18.437994 | 51c41d50-f299-4836-af69-83031f209869 ==============================
[0m11:58:18.437994 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:58:18.439155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:58:19.329657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51c41d50-f299-4836-af69-83031f209869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ACC81970>]}
[0m11:58:19.420240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51c41d50-f299-4836-af69-83031f209869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B7C13F80>]}
[0m11:58:19.421237 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:58:19.430206 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:58:19.533834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:19.534802 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:58:19.665999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m11:58:19.672030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c41d50-f299-4836-af69-83031f209869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B992C050>]}
[0m11:58:19.684000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51c41d50-f299-4836-af69-83031f209869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B974E360>]}
[0m11:58:19.685000 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:58:19.686001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c41d50-f299-4836-af69-83031f209869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B9218440>]}
[0m11:58:19.688033 [info ] [MainThread]: 
[0m11:58:19.689048 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:58:19.691051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:58:19.705001 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:58:19.706000 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:58:19.706000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:20.847728 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:58:20.849729 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:58:20.943251 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m11:58:20.955257 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:58:20.956257 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:58:20.956257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:21.441659 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:58:21.448669 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:58:21.551255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m11:58:21.558263 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:58:21.559263 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:58:21.559263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:22.070352 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:58:22.075361 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:58:22.179790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m11:58:22.190728 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:58:22.191775 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:58:22.192773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:22.489712 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:58:22.491701 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:58:22.581132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m11:58:22.584630 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:58:22.584630 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:58:22.585632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:22.936802 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:58:22.938802 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:58:23.026290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c41d50-f299-4836-af69-83031f209869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B9383620>]}
[0m11:58:23.027293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:23.028283 [info ] [MainThread]: 
[0m11:58:23.032172 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:58:23.033172 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:58:23.034174 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:58:23.035175 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:58:23.043172 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:58:23.045173 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:58:23.035175 => 11:58:23.044173
[0m11:58:23.045173 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:58:23.076258 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:58:23.078245 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:58:23.079254 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.txn_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.txn_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m11:58:23.079254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:23.713340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff24-0001-429b-0008-435e0001dcc2
[0m11:58:23.713340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 12
invalid identifier 'T.TXN_MONTH'
[0m11:58:23.714339 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:58:23.045173 => 11:58:23.714339
[0m11:58:23.714339 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:58:23.808738 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000904 (42000): SQL compilation error: error line 21 at position 12
  invalid identifier 'T.TXN_MONTH'
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:58:23.808738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c41d50-f299-4836-af69-83031f209869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2B9BB26F0>]}
[0m11:58:23.809737 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.78s]
[0m11:58:23.810705 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:58:23.812705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:23.813706 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:58:23.813706 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m11:58:23.813706 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:58:23.814706 [info ] [MainThread]: 
[0m11:58:23.815707 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m11:58:23.816738 [debug] [MainThread]: Command end result
[0m11:58:23.828735 [info ] [MainThread]: 
[0m11:58:23.829707 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:58:23.829707 [info ] [MainThread]: 
[0m11:58:23.830741 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000904 (42000): SQL compilation error: error line 21 at position 12
  invalid identifier 'T.TXN_MONTH'
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:58:23.831707 [info ] [MainThread]: 
[0m11:58:23.832707 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:58:23.833708 [debug] [MainThread]: Command `dbt run` failed at 11:58:23.833708 after 5.47 seconds
[0m11:58:23.834706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ACC81880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ACBC9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ACBCA660>]}
[0m11:58:23.835728 [debug] [MainThread]: Flushing usage events
[0m11:58:43.302985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E8512C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E8864F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E8B5B620>]}


============================== 11:58:43.306984 | a1297b49-ec52-40dc-8b46-15ac165690a9 ==============================
[0m11:58:43.306984 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:58:43.307964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:44.202381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1297b49-ec52-40dc-8b46-15ac165690a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F5382360>]}
[0m11:58:44.290023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1297b49-ec52-40dc-8b46-15ac165690a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F5383350>]}
[0m11:58:44.291023 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:58:44.300158 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:58:44.413746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:44.413746 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:58:44.549323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:58:44.555361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1297b49-ec52-40dc-8b46-15ac165690a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F55134D0>]}
[0m11:58:44.566872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1297b49-ec52-40dc-8b46-15ac165690a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F554A330>]}
[0m11:58:44.567880 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:58:44.568879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1297b49-ec52-40dc-8b46-15ac165690a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F573FA70>]}
[0m11:58:44.570913 [info ] [MainThread]: 
[0m11:58:44.571880 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:58:44.573881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:58:44.588880 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:58:44.588880 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:58:44.589881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:45.538795 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:58:45.542795 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:58:45.642030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m11:58:45.673051 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:58:45.674053 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:58:45.675051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:46.125351 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:58:46.130352 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:58:46.221296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m11:58:46.224263 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:58:46.225263 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:58:46.225263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:46.648680 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:58:46.654678 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:58:46.743832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m11:58:46.746833 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:58:46.746833 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:58:46.747835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:47.056530 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:58:47.060521 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:58:47.145851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m11:58:47.149850 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:58:47.150851 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:58:47.150851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:47.576425 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:58:47.577384 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:58:47.659637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1297b49-ec52-40dc-8b46-15ac165690a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F501CF50>]}
[0m11:58:47.660637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:47.662637 [info ] [MainThread]: 
[0m11:58:47.668636 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:58:47.670638 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:58:47.672635 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:58:47.673675 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:58:47.682664 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:58:47.684633 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:58:47.674675 => 11:58:47.683663
[0m11:58:47.685635 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:58:47.716193 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:58:47.720167 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:58:47.720167 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.txn_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m11:58:47.721163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:48.103741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff24-0001-429e-0008-435e0001e7ce
[0m11:58:48.103741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 12
invalid identifier 'T.TXN_MONTH'
[0m11:58:48.104733 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:58:47.685635 => 11:58:48.104733
[0m11:58:48.104733 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:58:48.197807 [debug] [Thread-1 (]: Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000904 (42000): SQL compilation error: error line 21 at position 12
  invalid identifier 'T.TXN_MONTH'
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:58:48.198805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1297b49-ec52-40dc-8b46-15ac165690a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204F59FE690>]}
[0m11:58:48.200806 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_transaction ................... [[31mERROR[0m in 0.53s]
[0m11:58:48.202842 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:58:48.207025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:48.207025 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:58:48.208023 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m11:58:48.208023 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:58:48.208986 [info ] [MainThread]: 
[0m11:58:48.209983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m11:58:48.211070 [debug] [MainThread]: Command end result
[0m11:58:48.226077 [info ] [MainThread]: 
[0m11:58:48.227083 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:58:48.228079 [info ] [MainThread]: 
[0m11:58:48.229080 [error] [MainThread]:   Database Error in model prod_transaction (models\marts\prod_transaction.sql)
  000904 (42000): SQL compilation error: error line 21 at position 12
  invalid identifier 'T.TXN_MONTH'
  compiled Code at target\run\practice\models\marts\prod_transaction.sql
[0m11:58:48.230078 [info ] [MainThread]: 
[0m11:58:48.230078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:58:48.232075 [debug] [MainThread]: Command `dbt run` failed at 11:58:48.231075 after 4.99 seconds
[0m11:58:48.232075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E8A03620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E8B3FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204E8510B30>]}
[0m11:58:48.233075 [debug] [MainThread]: Flushing usage events
[0m11:59:17.949884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF996F2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF9729C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF99C54A40>]}


============================== 11:59:17.953903 | c963273f-267d-4196-b5db-f3a91e4f1830 ==============================
[0m11:59:17.953903 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:59:17.954872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_transaction', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:59:18.822454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c963273f-267d-4196-b5db-f3a91e4f1830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFA62C3EC0>]}
[0m11:59:18.907461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c963273f-267d-4196-b5db-f3a91e4f1830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFA4DFAA50>]}
[0m11:59:18.909461 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:59:18.916968 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:59:19.028042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:19.028042 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_transaction.sql
[0m11:59:19.159625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m11:59:19.165625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c963273f-267d-4196-b5db-f3a91e4f1830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFA6830050>]}
[0m11:59:19.177626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c963273f-267d-4196-b5db-f3a91e4f1830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFA6646510>]}
[0m11:59:19.178630 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m11:59:19.179644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c963273f-267d-4196-b5db-f3a91e4f1830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF99E00560>]}
[0m11:59:19.181626 [info ] [MainThread]: 
[0m11:59:19.182460 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:59:19.184498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m11:59:19.198497 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m11:59:19.198497 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m11:59:19.198497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:20.095055 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:59:20.097059 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m11:59:20.191096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m11:59:20.200102 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m11:59:20.200102 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m11:59:20.200102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:20.497609 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:59:20.504688 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m11:59:20.605382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m11:59:20.611276 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m11:59:20.612278 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m11:59:20.612278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:21.035260 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:59:21.037279 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m11:59:21.123692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m11:59:21.129693 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m11:59:21.130692 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m11:59:21.131692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:21.475521 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m11:59:21.477513 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m11:59:21.578288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m11:59:21.587243 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m11:59:21.588243 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m11:59:21.588243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:21.891037 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:59:21.893028 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m11:59:21.981074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c963273f-267d-4196-b5db-f3a91e4f1830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFA683CFB0>]}
[0m11:59:21.982102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:59:21.982910 [info ] [MainThread]: 
[0m11:59:21.987307 [debug] [Thread-1 (]: Began running node model.practice.prod_transaction
[0m11:59:21.988308 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_transaction ............................ [RUN]
[0m11:59:21.990308 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_transaction'
[0m11:59:21.990308 [debug] [Thread-1 (]: Began compiling node model.practice.prod_transaction
[0m11:59:22.000349 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_transaction"
[0m11:59:22.002313 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (compile): 11:59:21.991341 => 11:59:22.001322
[0m11:59:22.003316 [debug] [Thread-1 (]: Began executing node model.practice.prod_transaction
[0m11:59:22.034822 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_transaction"
[0m11:59:22.036822 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_transaction"
[0m11:59:22.036822 [debug] [Thread-1 (]: On model.practice.prod_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_transaction"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_transaction
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m11:59:22.037821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:59:23.895023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:59:23.917962 [debug] [Thread-1 (]: Timing info for model.practice.prod_transaction (execute): 11:59:22.004324 => 11:59:23.917962
[0m11:59:23.918990 [debug] [Thread-1 (]: On model.practice.prod_transaction: Close
[0m11:59:24.374293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c963273f-267d-4196-b5db-f3a91e4f1830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFA6AFEC90>]}
[0m11:59:24.375269 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_transaction ....................... [[32mSUCCESS 1[0m in 2.38s]
[0m11:59:24.376239 [debug] [Thread-1 (]: Finished running node model.practice.prod_transaction
[0m11:59:24.378268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:24.378268 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m11:59:24.378268 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m11:59:24.379269 [debug] [MainThread]: Connection 'model.practice.prod_transaction' was properly closed.
[0m11:59:24.379269 [info ] [MainThread]: 
[0m11:59:24.380258 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m11:59:24.381264 [debug] [MainThread]: Command end result
[0m11:59:24.393265 [info ] [MainThread]: 
[0m11:59:24.394264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:24.395264 [info ] [MainThread]: 
[0m11:59:24.396264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:59:24.397295 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:24.397295 after 6.51 seconds
[0m11:59:24.397295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF990F8BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF99967BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF996F2C00>]}
[0m11:59:24.398295 [debug] [MainThread]: Flushing usage events
[0m12:08:49.122527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016964954290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016964954350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016964954050>]}


============================== 12:08:49.135787 | bf2301d8-9808-4d47-8249-973f64f80573 ==============================
[0m12:08:49.135787 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:08:49.136756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_churnstatus', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:56.354135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2301d8-9808-4d47-8249-973f64f80573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016964383230>]}
[0m12:08:56.441653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2301d8-9808-4d47-8249-973f64f80573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001696FE18CB0>]}
[0m12:08:56.450407 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:08:56.467868 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:08:57.699145 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m12:08:57.700143 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_churnstatus.sql
[0m12:08:57.700143 [debug] [MainThread]: Partial parsing: deleted file: practice://models\marts\prod_transaction.sql
[0m12:08:57.700143 [debug] [MainThread]: Partial parsing: updated file: practice://models\staging\stg_transaction.sql
[0m12:08:57.832700 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.stg_transaction' (models\staging\stg_transaction.sql) depends on a node named 'stg_ride_sharing_data' which was not found
[0m12:08:57.834665 [debug] [MainThread]: Command `dbt run` failed at 12:08:57.834665 after 8.79 seconds
[0m12:08:57.834665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016964957DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016964955F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016964954B30>]}
[0m12:08:57.835665 [debug] [MainThread]: Flushing usage events
[0m12:09:57.389734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E166455340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E166454110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E166455700>]}


============================== 12:09:57.393766 | a7824df6-e67a-4d05-af7f-39d82e5ffd29 ==============================
[0m12:09:57.393766 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:09:57.394621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_churnstatus', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:09:58.289835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7824df6-e67a-4d05-af7f-39d82e5ffd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170F0C6B0>]}
[0m12:09:58.380025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7824df6-e67a-4d05-af7f-39d82e5ffd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170B58AD0>]}
[0m12:09:58.381025 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:09:58.389024 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:09:58.491542 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:09:58.491542 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_churnstatus.sql
[0m12:09:58.492542 [debug] [MainThread]: Partial parsing: deleted file: practice://models\marts\prod_transaction.sql
[0m12:09:58.622203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:09:58.628191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7824df6-e67a-4d05-af7f-39d82e5ffd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1730ABF20>]}
[0m12:09:58.654604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7824df6-e67a-4d05-af7f-39d82e5ffd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E172E4E330>]}
[0m12:09:58.654604 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:09:58.655605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7824df6-e67a-4d05-af7f-39d82e5ffd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170A4F200>]}
[0m12:09:58.656634 [info ] [MainThread]: 
[0m12:09:58.658636 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:58.659603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:09:58.673635 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:09:58.673635 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:09:58.673635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:00.058057 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:10:00.064074 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:10:00.162937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m12:10:00.171934 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:10:00.171934 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:10:00.172934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:00.626112 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:10:00.629073 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:10:00.727324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m12:10:00.746379 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:10:00.747377 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:10:00.749371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:01.193511 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:10:01.196519 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:10:01.283120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m12:10:01.294122 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:10:01.295097 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:10:01.296053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:01.751611 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:10:01.755654 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:10:01.845868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:10:01.855850 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:10:01.855850 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:10:01.856819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:02.332919 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:10:02.339869 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:10:02.446769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7824df6-e67a-4d05-af7f-39d82e5ffd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E172FD6600>]}
[0m12:10:02.448765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:02.449725 [info ] [MainThread]: 
[0m12:10:02.459485 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m12:10:02.461444 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m12:10:02.463442 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m12:10:02.464443 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m12:10:02.475049 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m12:10:02.477016 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 12:10:02.465487 => 12:10:02.476045
[0m12:10:02.477016 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m12:10:02.508046 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m12:10:02.510015 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m12:10:02.511015 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m12:10:02.511015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:10:03.398031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:03.418021 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 12:10:02.477016 => 12:10:03.418021
[0m12:10:03.419021 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m12:10:03.514358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7824df6-e67a-4d05-af7f-39d82e5ffd29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1732C1160>]}
[0m12:10:03.515357 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_churnstatus ....................... [[32mSUCCESS 1[0m in 1.05s]
[0m12:10:03.516358 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m12:10:03.518390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:03.518390 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:10:03.519389 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m12:10:03.519389 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m12:10:03.519389 [info ] [MainThread]: 
[0m12:10:03.520390 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m12:10:03.522359 [debug] [MainThread]: Command end result
[0m12:10:03.533357 [info ] [MainThread]: 
[0m12:10:03.534363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:03.536360 [info ] [MainThread]: 
[0m12:10:03.536360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:10:03.538391 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:03.537385 after 6.21 seconds
[0m12:10:03.538391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E166359100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16643FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1662C9880>]}
[0m12:10:03.539389 [debug] [MainThread]: Flushing usage events
[0m12:15:35.139371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB97C4AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB97E99460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB97E9BCB0>]}


============================== 12:15:35.144394 | a0f2cef6-7146-45bb-a188-73c09b729e47 ==============================
[0m12:15:35.144394 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:15:35.145372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:15:36.027357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f2cef6-7146-45bb-a188-73c09b729e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBA57BCFE0>]}
[0m12:15:36.113940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0f2cef6-7146-45bb-a188-73c09b729e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB99038CB0>]}
[0m12:15:36.114938 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:15:36.122938 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:15:36.233447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:36.234449 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:15:36.361061 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.prod_customers' (models\marts\prod_customers.sql) depends on a node named 'stg_tansaction' which was not found
[0m12:15:36.363514 [debug] [MainThread]: Command `dbt run` failed at 12:15:36.362476 after 1.28 seconds
[0m12:15:36.363514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB97EC39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBA57BC650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBA5B0F410>]}
[0m12:15:36.363514 [debug] [MainThread]: Flushing usage events
[0m12:23:47.393025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C895A55A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C895A55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C895A57D40>]}


============================== 12:23:47.406026 | 00aa5e54-9a5c-473a-9319-a5b67f32aecf ==============================
[0m12:23:47.406026 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:23:47.407026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_churnstatus', 'send_anonymous_usage_stats': 'True'}
[0m12:23:54.466500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00aa5e54-9a5c-473a-9319-a5b67f32aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C895AB9970>]}
[0m12:23:54.555046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00aa5e54-9a5c-473a-9319-a5b67f32aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A20EDEE0>]}
[0m12:23:54.563316 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:23:54.582767 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:23:55.765209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:23:55.765209 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m12:23:55.766214 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:23:55.894372 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.prod_customers' (models\marts\prod_customers.sql) depends on a node named 'stg_tansaction' which was not found
[0m12:23:55.896402 [debug] [MainThread]: Command `dbt run` failed at 12:23:55.896402 after 8.59 seconds
[0m12:23:55.896402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8956B7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A0018AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A21D6660>]}
[0m12:23:55.897402 [debug] [MainThread]: Flushing usage events
[0m12:24:17.017680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C51D59100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C51D58170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C51D59430>]}


============================== 12:24:17.022686 | ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0 ==============================
[0m12:24:17.022686 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:24:17.023654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_churnstatus', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:24:17.925799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5E6E5070>]}
[0m12:24:18.016352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5E56C9B0>]}
[0m12:24:18.017353 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:24:18.025353 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:24:18.119882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:18.120881 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m12:24:18.255478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:24:18.260153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5EAFC4A0>]}
[0m12:24:18.285516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5E852000>]}
[0m12:24:18.286506 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:24:18.287502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5C7A7BC0>]}
[0m12:24:18.288504 [info ] [MainThread]: 
[0m12:24:18.289873 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:18.291910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:24:18.305911 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:24:18.305911 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:24:18.306910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:19.350842 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:24:19.353877 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:24:19.451037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m12:24:19.460043 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:24:19.460043 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:24:19.461043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:19.920704 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:24:19.925750 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:24:20.026164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m12:24:20.031134 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:24:20.031134 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:24:20.032169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:20.518237 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:24:20.524257 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:24:20.627322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m12:24:20.641317 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:24:20.642318 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:24:20.644297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:20.958018 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:24:20.960007 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:24:21.057660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m12:24:21.060688 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:24:21.060688 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:24:21.061657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:21.350265 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:24:21.352292 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:24:21.447289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5CDCD340>]}
[0m12:24:21.448289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:21.449288 [info ] [MainThread]: 
[0m12:24:21.456288 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m12:24:21.456288 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m12:24:21.457493 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m12:24:21.458504 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m12:24:21.467501 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m12:24:21.469503 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 12:24:21.458504 => 12:24:21.468499
[0m12:24:21.470501 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m12:24:21.504071 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m12:24:21.506102 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m12:24:21.506102 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status
        CASE
            WHEN MAX(t.tran_month) <> m.latest_month THEN 'Churned'
            ELSE 'Active'
        END AS nc
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m12:24:21.507102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:22.131955 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff3e-0001-429b-0008-435e0001dd2e
[0m12:24:22.131955 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 8 unexpected 'CASE'.
syntax error line 27 at position 21 unexpected 't'.
syntax error line 27 at position 35 unexpected '<>'.
[0m12:24:22.132958 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 12:24:21.470501 => 12:24:22.132958
[0m12:24:22.132958 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m12:24:22.226705 [debug] [Thread-1 (]: Database Error in model mart_churnstatus (models\marts\mart_churnstatus.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 8 unexpected 'CASE'.
  syntax error line 27 at position 21 unexpected 't'.
  syntax error line 27 at position 35 unexpected '<>'.
  compiled Code at target\run\practice\models\marts\mart_churnstatus.sql
[0m12:24:22.227664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb8f39c-6a3c-44d5-8d3c-098b9177c0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C5ECB25D0>]}
[0m12:24:22.228667 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_churnstatus ................... [[31mERROR[0m in 0.77s]
[0m12:24:22.230666 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m12:24:22.235033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:22.236033 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:24:22.236033 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m12:24:22.237033 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m12:24:22.238033 [info ] [MainThread]: 
[0m12:24:22.238996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m12:24:22.240996 [debug] [MainThread]: Command end result
[0m12:24:22.260995 [info ] [MainThread]: 
[0m12:24:22.263003 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:22.264996 [info ] [MainThread]: 
[0m12:24:22.266028 [error] [MainThread]:   Database Error in model mart_churnstatus (models\marts\mart_churnstatus.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 8 unexpected 'CASE'.
  syntax error line 27 at position 21 unexpected 't'.
  syntax error line 27 at position 35 unexpected '<>'.
  compiled Code at target\run\practice\models\marts\mart_churnstatus.sql
[0m12:24:22.267023 [info ] [MainThread]: 
[0m12:24:22.267995 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:24:22.270025 [debug] [MainThread]: Command `dbt run` failed at 12:24:22.270025 after 5.31 seconds
[0m12:24:22.270993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C51D87830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C517F2DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C51D59100>]}
[0m12:24:22.270993 [debug] [MainThread]: Flushing usage events
[0m12:24:51.992842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259F3E54050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259F3E542F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259F3E55640>]}


============================== 12:24:51.997799 | a583fea9-a6e2-4890-9e02-36a5a396fa3f ==============================
[0m12:24:51.997799 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:24:51.998800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_churnstatus', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:52.874751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a583fea9-a6e2-4890-9e02-36a5a396fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259823B8B90>]}
[0m12:24:52.960362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a583fea9-a6e2-4890-9e02-36a5a396fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259823E4E60>]}
[0m12:24:52.961362 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:24:52.969259 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:24:53.082874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:53.083876 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m12:24:53.216456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:24:53.222486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a583fea9-a6e2-4890-9e02-36a5a396fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259827FC140>]}
[0m12:24:53.233525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a583fea9-a6e2-4890-9e02-36a5a396fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025982546720>]}
[0m12:24:53.234494 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:24:53.235495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a583fea9-a6e2-4890-9e02-36a5a396fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259800E0440>]}
[0m12:24:53.236495 [info ] [MainThread]: 
[0m12:24:53.238525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:53.239546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:24:53.254119 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:24:53.255119 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:24:53.255119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:54.054690 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:24:54.056687 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:24:54.146062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m12:24:54.156669 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:24:54.156669 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:24:54.156669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:54.634552 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:24:54.636545 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:24:54.740398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:24:54.750361 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:24:54.752415 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:24:54.754393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:55.053114 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:24:55.056123 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:24:55.136355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m12:24:55.141356 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:24:55.141356 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:24:55.142356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:55.582985 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:24:55.586994 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:24:55.694832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m12:24:55.696831 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:24:55.697831 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:24:55.697831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:56.001664 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:24:56.005669 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:24:56.094728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a583fea9-a6e2-4890-9e02-36a5a396fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025982307C50>]}
[0m12:24:56.096692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:56.097693 [info ] [MainThread]: 
[0m12:24:56.102215 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m12:24:56.103259 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m12:24:56.104224 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m12:24:56.105223 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m12:24:56.113227 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m12:24:56.115251 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 12:24:56.105223 => 12:24:56.115251
[0m12:24:56.115251 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m12:24:56.147229 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m12:24:56.150236 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m12:24:56.151235 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status
        CASE
            WHEN MAX(t.tran_month) = m.latest_month THEN 'Churned'
            ELSE 'Active'
        END AS nc
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m12:24:56.151235 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:56.458565 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff3e-0001-42d7-0008-435e0002116e
[0m12:24:56.459566 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 8 unexpected 'CASE'.
syntax error line 27 at position 21 unexpected 't'.
syntax error line 27 at position 35 unexpected '='.
[0m12:24:56.460565 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 12:24:56.116254 => 12:24:56.460565
[0m12:24:56.461549 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m12:24:56.571947 [debug] [Thread-1 (]: Database Error in model mart_churnstatus (models\marts\mart_churnstatus.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 8 unexpected 'CASE'.
  syntax error line 27 at position 21 unexpected 't'.
  syntax error line 27 at position 35 unexpected '='.
  compiled Code at target\run\practice\models\marts\mart_churnstatus.sql
[0m12:24:56.572908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a583fea9-a6e2-4890-9e02-36a5a396fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002598298F230>]}
[0m12:24:56.574897 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_churnstatus ................... [[31mERROR[0m in 0.47s]
[0m12:24:56.576900 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m12:24:56.581935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:56.582936 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:24:56.582936 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m12:24:56.583900 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m12:24:56.584928 [info ] [MainThread]: 
[0m12:24:56.585506 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m12:24:56.587551 [debug] [MainThread]: Command end result
[0m12:24:56.599516 [info ] [MainThread]: 
[0m12:24:56.600516 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:56.601529 [info ] [MainThread]: 
[0m12:24:56.602522 [error] [MainThread]:   Database Error in model mart_churnstatus (models\marts\mart_churnstatus.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 8 unexpected 'CASE'.
  syntax error line 27 at position 21 unexpected 't'.
  syntax error line 27 at position 35 unexpected '='.
  compiled Code at target\run\practice\models\marts\mart_churnstatus.sql
[0m12:24:56.603515 [info ] [MainThread]: 
[0m12:24:56.604538 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:24:56.605515 [debug] [MainThread]: Command `dbt run` failed at 12:24:56.605515 after 4.67 seconds
[0m12:24:56.606545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259F3E83980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259F3E56F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259F3E54050>]}
[0m12:24:56.606545 [debug] [MainThread]: Flushing usage events
[0m12:25:17.930826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D120A55310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D120A540B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D120A57E90>]}


============================== 12:25:17.935825 | c1b7557f-522f-4fbe-9bab-44fd6871277a ==============================
[0m12:25:17.935825 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:25:17.935825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_churnstatus', 'send_anonymous_usage_stats': 'True'}
[0m12:25:18.813163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b7557f-522f-4fbe-9bab-44fd6871277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12B287740>]}
[0m12:25:18.898780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b7557f-522f-4fbe-9bab-44fd6871277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12B15B620>]}
[0m12:25:18.899780 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:25:18.907678 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:25:19.018282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:19.019282 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m12:25:19.151906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:25:19.156935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b7557f-522f-4fbe-9bab-44fd6871277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D283350>]}
[0m12:25:19.169479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b7557f-522f-4fbe-9bab-44fd6871277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D4467E0>]}
[0m12:25:19.169479 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:25:19.170511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b7557f-522f-4fbe-9bab-44fd6871277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D62F560>]}
[0m12:25:19.172511 [info ] [MainThread]: 
[0m12:25:19.173478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:19.175511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:25:19.189479 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:25:19.190479 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:25:19.190479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:20.628763 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:25:20.630763 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:25:20.709730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m12:25:20.720698 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:25:20.720698 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:25:20.721698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:21.154720 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:25:21.156711 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:25:21.256744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m12:25:21.267393 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:25:21.268390 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:25:21.270389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:21.736560 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:25:21.740559 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:25:21.832599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:25:21.843574 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:25:21.844579 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:25:21.845574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:22.256043 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:25:22.260041 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:25:22.351118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m12:25:22.365201 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:25:22.366796 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:25:22.368876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:22.685658 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:25:22.688636 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:25:22.784030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b7557f-522f-4fbe-9bab-44fd6871277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D37FBC0>]}
[0m12:25:22.785029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:22.786002 [info ] [MainThread]: 
[0m12:25:22.789602 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m12:25:22.789602 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m12:25:22.791831 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m12:25:22.791831 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m12:25:22.800817 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m12:25:22.802804 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 12:25:22.791831 => 12:25:22.801805
[0m12:25:22.802804 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m12:25:22.833800 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m12:25:22.835832 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m12:25:22.835832 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status,
        CASE
            WHEN MAX(t.tran_month) = m.latest_month THEN 'Churned'
            ELSE 'Active'
        END AS nc
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m12:25:22.836832 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:24.670702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:25:24.692669 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 12:25:22.802804 => 12:25:24.692669
[0m12:25:24.692669 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m12:25:24.775326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b7557f-522f-4fbe-9bab-44fd6871277a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D8BCE00>]}
[0m12:25:24.776327 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_churnstatus ....................... [[32mSUCCESS 1[0m in 1.98s]
[0m12:25:24.778287 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m12:25:24.782375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:24.782375 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:25:24.783375 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m12:25:24.783375 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m12:25:24.784378 [info ] [MainThread]: 
[0m12:25:24.785553 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m12:25:24.787563 [debug] [MainThread]: Command end result
[0m12:25:24.801139 [info ] [MainThread]: 
[0m12:25:24.802152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:24.803191 [info ] [MainThread]: 
[0m12:25:24.803191 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:25:24.805171 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:24.805171 after 6.94 seconds
[0m12:25:24.805171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D120A56D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D120A54EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D120A55310>]}
[0m12:25:24.806172 [debug] [MainThread]: Flushing usage events
[0m12:32:44.326957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BB1581D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B9A0C8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BB1591C0>]}


============================== 12:32:44.332988 | ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f ==============================
[0m12:32:44.332988 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:32:44.333958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_churnstatus', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:32:45.236620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C72F6510>]}
[0m12:32:45.322194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C784FFE0>]}
[0m12:32:45.349767 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:32:45.358313 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:32:45.472592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:45.472592 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m12:32:45.603174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:32:45.609207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7DABF50>]}
[0m12:32:45.621066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7B4E3F0>]}
[0m12:32:45.621066 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:32:45.622098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7D0FA40>]}
[0m12:32:45.624065 [info ] [MainThread]: 
[0m12:32:45.625068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:45.627065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:32:45.641134 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:32:45.641134 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:32:45.642135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:46.465031 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:32:46.466997 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:32:46.553864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m12:32:46.572474 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:32:46.573474 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:32:46.574477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:47.016827 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:32:47.022886 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:32:47.118265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m12:32:47.128263 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:32:47.130265 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:32:47.131266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:47.409332 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:32:47.412287 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:32:47.497683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m12:32:47.509686 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:32:47.510645 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:32:47.511683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:47.861781 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:32:47.863776 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:32:47.958105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m12:32:47.963678 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:32:47.964678 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:32:47.964678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:48.404877 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:32:48.405870 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:32:48.491101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C7D0FF50>]}
[0m12:32:48.492131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:48.493228 [info ] [MainThread]: 
[0m12:32:48.499384 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m12:32:48.500384 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m12:32:48.501420 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m12:32:48.502417 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m12:32:48.513414 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m12:32:48.514414 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 12:32:48.503419 => 12:32:48.514414
[0m12:32:48.515382 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m12:32:48.547400 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m12:32:48.550435 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m12:32:48.550435 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS nc
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m12:32:48.550435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:50.962597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:32:50.984209 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 12:32:48.515382 => 12:32:50.984209
[0m12:32:50.985210 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m12:32:51.069637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccea2bc7-cd8f-4b8b-9e06-dc5d0e7d576f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C78D7AA0>]}
[0m12:32:51.070637 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_churnstatus ....................... [[32mSUCCESS 1[0m in 2.57s]
[0m12:32:51.071602 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m12:32:51.074601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:51.075601 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:32:51.075601 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:32:51.076601 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m12:32:51.076601 [info ] [MainThread]: 
[0m12:32:51.078601 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m12:32:51.080108 [debug] [MainThread]: Command end result
[0m12:32:51.093070 [info ] [MainThread]: 
[0m12:32:51.094071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:51.095072 [info ] [MainThread]: 
[0m12:32:51.096079 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:32:51.097071 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:51.097071 after 6.96 seconds
[0m12:32:51.098071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B9A0C8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BB05A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BB05ADE0>]}
[0m12:32:51.098071 [debug] [MainThread]: Flushing usage events
[0m12:36:14.467505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5957556A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A595755460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A595756300>]}


============================== 12:36:14.480506 | d7c77560-366c-48c1-a7ec-ec45a5f85db0 ==============================
[0m12:36:14.480506 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:36:14.481471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_churnstatus', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:36:21.780968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7c77560-366c-48c1-a7ec-ec45a5f85db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A204B7A0>]}
[0m12:36:21.867974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7c77560-366c-48c1-a7ec-ec45a5f85db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A020E9F0>]}
[0m12:36:21.875437 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:36:21.894971 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:36:23.082879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:23.083879 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m12:36:23.215220 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:36:23.221474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7c77560-366c-48c1-a7ec-ec45a5f85db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A207D760>]}
[0m12:36:23.244455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7c77560-366c-48c1-a7ec-ec45a5f85db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A2151D90>]}
[0m12:36:23.244455 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:36:23.245453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c77560-366c-48c1-a7ec-ec45a5f85db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A22E7530>]}
[0m12:36:23.247466 [info ] [MainThread]: 
[0m12:36:23.249453 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:23.251452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:36:23.265522 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:36:23.265522 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:36:23.266520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:24.404226 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:36:24.406225 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:36:24.494743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m12:36:24.503742 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:36:24.504740 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:36:24.504740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:24.963252 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:36:24.966233 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:36:25.056323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m12:36:25.061318 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:36:25.061318 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:36:25.061318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:25.499782 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:36:25.502787 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:36:25.591663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m12:36:25.601296 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:36:25.602294 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:36:25.604295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:25.912718 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:25.915714 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:36:26.008264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m12:36:26.011296 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:36:26.011296 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:36:26.012263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:26.320832 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:26.323833 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:36:26.425426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c77560-366c-48c1-a7ec-ec45a5f85db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59501A690>]}
[0m12:36:26.428474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:26.431425 [info ] [MainThread]: 
[0m12:36:26.445918 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m12:36:26.446959 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m12:36:26.449914 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m12:36:26.450957 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m12:36:26.464910 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m12:36:26.466907 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 12:36:26.451950 => 12:36:26.465909
[0m12:36:26.466907 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m12:36:26.500976 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m12:36:26.502521 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m12:36:26.503552 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m12:36:26.503552 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:27.575369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:36:27.598392 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 12:36:26.467909 => 12:36:27.598392
[0m12:36:27.599392 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m12:36:27.684980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c77560-366c-48c1-a7ec-ec45a5f85db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A25B2660>]}
[0m12:36:27.686014 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_churnstatus ....................... [[32mSUCCESS 1[0m in 1.24s]
[0m12:36:27.688013 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m12:36:27.690022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:27.691022 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:36:27.691022 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:36:27.691022 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m12:36:27.692022 [info ] [MainThread]: 
[0m12:36:27.693008 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m12:36:27.694037 [debug] [MainThread]: Command end result
[0m12:36:27.707594 [info ] [MainThread]: 
[0m12:36:27.708594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:27.709595 [info ] [MainThread]: 
[0m12:36:27.710596 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:27.712625 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:27.712625 after 13.33 seconds
[0m12:36:27.712625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A591E0C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A595756300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A595755460>]}
[0m12:36:27.713645 [debug] [MainThread]: Flushing usage events
[0m12:37:02.979495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019254FCA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019254062C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192561540B0>]}


============================== 12:37:02.984006 | 6c44ad32-6789-4c32-b777-83babfa9d9dc ==============================
[0m12:37:02.984006 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:37:02.985007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m prod_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:37:03.853505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c44ad32-6789-4c32-b777-83babfa9d9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019262AECB00>]}
[0m12:37:03.938511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c44ad32-6789-4c32-b777-83babfa9d9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192621F00B0>]}
[0m12:37:03.939511 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:37:03.947751 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:37:04.058941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:04.059941 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:37:04.185557 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.prod_customers' (models\marts\prod_customers.sql) depends on a node named 'stg_tansaction' which was not found
[0m12:37:04.186524 [debug] [MainThread]: Command `dbt run` failed at 12:37:04.186524 after 1.27 seconds
[0m12:37:04.187557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019256021880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192628ECB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019262BB8C80>]}
[0m12:37:04.187557 [debug] [MainThread]: Flushing usage events
[0m12:39:23.597983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC41654050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC416541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC41655670>]}


============================== 12:39:23.602015 | 7f450d7c-c120-46e8-ab29-2b95b920a0e2 ==============================
[0m12:39:23.602015 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:39:23.602984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:24.530089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f450d7c-c120-46e8-ab29-2b95b920a0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC3F47EAE0>]}
[0m12:39:24.619704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f450d7c-c120-46e8-ab29-2b95b920a0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4DC37C80>]}
[0m12:39:24.620703 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:39:24.629461 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:39:24.734047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:24.735050 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:39:24.868629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:39:24.874661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f450d7c-c120-46e8-ab29-2b95b920a0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4E2404A0>]}
[0m12:39:24.886630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f450d7c-c120-46e8-ab29-2b95b920a0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4E04E240>]}
[0m12:39:24.886630 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:39:24.887631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f450d7c-c120-46e8-ab29-2b95b920a0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4D5F0980>]}
[0m12:39:24.889662 [info ] [MainThread]: 
[0m12:39:24.890661 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:24.891661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:39:24.906701 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:39:24.906701 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:39:24.907705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:25.750989 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:39:25.751989 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:39:25.868569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m12:39:25.896538 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:39:25.897534 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:39:25.897534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:26.424444 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m12:39:26.428445 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:39:26.535549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m12:39:26.545503 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:39:26.545503 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:39:26.546501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:27.045815 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:39:27.048816 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:39:27.147110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:39:27.157093 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:39:27.159091 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:39:27.160087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:27.583961 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:39:27.587969 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:39:27.676268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m12:39:27.684248 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:39:27.685249 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:39:27.686249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:28.006180 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:39:28.010175 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:39:28.099858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f450d7c-c120-46e8-ab29-2b95b920a0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4E2C7440>]}
[0m12:39:28.100860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:28.101493 [info ] [MainThread]: 
[0m12:39:28.105211 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:39:28.106211 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:39:28.107212 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:39:28.107212 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:39:28.116214 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:39:28.118214 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:39:28.107212 => 12:39:28.117216
[0m12:39:28.118214 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:39:28.149827 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:39:28.151856 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:39:28.151856 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUBFAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY, p.PRODUCT_SUBFAMILY;
[0m12:39:28.152856 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:28.563932 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4d-0001-429b-0008-435e0001dd6a
[0m12:39:28.564932 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 60 unexpected ';'.
[0m12:39:28.564932 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:39:28.119213 => 12:39:28.564932
[0m12:39:28.565931 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:39:28.663099 [debug] [Thread-1 (]: Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 60 unexpected ';'.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:39:28.663099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f450d7c-c120-46e8-ab29-2b95b920a0e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4E130F80>]}
[0m12:39:28.664099 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_customers ..................... [[31mERROR[0m in 0.56s]
[0m12:39:28.665099 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:39:28.668131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:28.668131 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:39:28.668131 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:39:28.669133 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:39:28.669133 [info ] [MainThread]: 
[0m12:39:28.670101 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m12:39:28.671101 [debug] [MainThread]: Command end result
[0m12:39:28.684099 [info ] [MainThread]: 
[0m12:39:28.684099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:39:28.685102 [info ] [MainThread]: 
[0m12:39:28.686101 [error] [MainThread]:   Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 60 unexpected ';'.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:39:28.687099 [info ] [MainThread]: 
[0m12:39:28.688100 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:39:28.689100 [debug] [MainThread]: Command `dbt run` failed at 12:39:28.689100 after 5.15 seconds
[0m12:39:28.689100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC410F0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC412391F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC413DFFB0>]}
[0m12:39:28.690133 [debug] [MainThread]: Flushing usage events
[0m12:39:37.213083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D37541A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D3755250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D37556A0>]}


============================== 12:39:37.217117 | b24e561b-8f1f-4e16-81b7-52f632d5849e ==============================
[0m12:39:37.217117 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:39:37.218284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:38.086350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b24e561b-8f1f-4e16-81b7-52f632d5849e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2DE403E00>]}
[0m12:39:38.173387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b24e561b-8f1f-4e16-81b7-52f632d5849e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2DE267650>]}
[0m12:39:38.174390 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:39:38.182966 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:39:38.291603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:38.292605 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:39:38.422187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:39:38.427217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b24e561b-8f1f-4e16-81b7-52f632d5849e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E02EDEB0>]}
[0m12:39:38.438365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b24e561b-8f1f-4e16-81b7-52f632d5849e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E014E780>]}
[0m12:39:38.439335 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:39:38.440336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b24e561b-8f1f-4e16-81b7-52f632d5849e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E032C170>]}
[0m12:39:38.441364 [info ] [MainThread]: 
[0m12:39:38.443335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:38.444374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:39:38.460335 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:39:38.461379 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:39:38.461379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:38.967827 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:39:38.972837 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:39:39.068360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m12:39:39.083924 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:39:39.084923 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:39:39.085928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:39.501600 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:39:39.504597 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:39:39.597645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m12:39:39.599645 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:39:39.600647 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:39:39.600647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:39.902697 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:39:39.905697 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:39:40.006030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m12:39:40.008064 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:39:40.009061 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:39:40.009061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:40.353192 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:39:40.357192 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:39:40.462488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m12:39:40.472441 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:39:40.472441 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:39:40.473442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:40.792034 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:39:40.794988 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:39:40.892721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b24e561b-8f1f-4e16-81b7-52f632d5849e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E0404B30>]}
[0m12:39:40.896768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:40.897767 [info ] [MainThread]: 
[0m12:39:40.902235 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:39:40.903267 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:39:40.905235 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:39:40.905235 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:39:40.914235 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:39:40.917236 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:39:40.905235 => 12:39:40.916237
[0m12:39:40.917236 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:39:40.949236 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:39:40.953238 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:39:40.955236 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUBFAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY, p.PRODUCT_SUBFAMILY
        );
[0m12:39:40.955236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:41.308433 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4d-0001-429b-0008-435e0001dd72
[0m12:39:41.308433 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 4
invalid identifier 'P.PRODUCT_SUBFAMILY'
[0m12:39:41.309468 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:39:40.918236 => 12:39:41.309468
[0m12:39:41.309468 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:39:41.415700 [debug] [Thread-1 (]: Database Error in model prod_customers (models\marts\prod_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'P.PRODUCT_SUBFAMILY'
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:39:41.416691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24e561b-8f1f-4e16-81b7-52f632d5849e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E0113500>]}
[0m12:39:41.418686 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_customers ..................... [[31mERROR[0m in 0.51s]
[0m12:39:41.420647 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:39:41.425680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:41.425680 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:39:41.426642 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m12:39:41.427644 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:39:41.427644 [info ] [MainThread]: 
[0m12:39:41.428678 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m12:39:41.430644 [debug] [MainThread]: Command end result
[0m12:39:41.445642 [info ] [MainThread]: 
[0m12:39:41.447644 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:39:41.448642 [info ] [MainThread]: 
[0m12:39:41.449642 [error] [MainThread]:   Database Error in model prod_customers (models\marts\prod_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 4
  invalid identifier 'P.PRODUCT_SUBFAMILY'
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:39:41.450642 [info ] [MainThread]: 
[0m12:39:41.451645 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:39:41.453642 [debug] [MainThread]: Command `dbt run` failed at 12:39:41.452653 after 4.30 seconds
[0m12:39:41.453642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D350AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D1F911F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D33B7FB0>]}
[0m12:39:41.454642 [debug] [MainThread]: Flushing usage events
[0m12:40:03.294436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E3422630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E3554170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E35550D0>]}


============================== 12:40:03.298434 | 4db06a16-2859-4568-8aa1-1349230fcc99 ==============================
[0m12:40:03.298434 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:40:03.299437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:40:04.190850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4db06a16-2859-4568-8aa1-1349230fcc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135EFE4BEC0>]}
[0m12:40:04.282104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4db06a16-2859-4568-8aa1-1349230fcc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135EFAB61B0>]}
[0m12:40:04.283101 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:40:04.291106 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:40:04.407655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:04.408655 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:40:04.542759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:40:04.548797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4db06a16-2859-4568-8aa1-1349230fcc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F00D68D0>]}
[0m12:40:04.562799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4db06a16-2859-4568-8aa1-1349230fcc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135EFF4E510>]}
[0m12:40:04.563770 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:40:04.564765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db06a16-2859-4568-8aa1-1349230fcc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F0143CB0>]}
[0m12:40:04.566783 [info ] [MainThread]: 
[0m12:40:04.567800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:04.568797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:40:04.584765 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:40:04.584765 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:40:04.585797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:05.468877 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:40:05.470873 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:40:05.556708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m12:40:05.565740 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:40:05.566708 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:40:05.566708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:05.981078 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:40:05.983078 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:40:06.063704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m12:40:06.073714 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:40:06.075715 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:40:06.077711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:06.419467 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:40:06.420469 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:40:06.505475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m12:40:06.510475 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:40:06.510475 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:40:06.511475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:06.942507 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:40:06.943510 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:40:07.072723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:40:07.074722 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:40:07.075723 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:40:07.075723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:07.529303 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:40:07.530303 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:40:07.628203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4db06a16-2859-4568-8aa1-1349230fcc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F026FFB0>]}
[0m12:40:07.631254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:07.634200 [info ] [MainThread]: 
[0m12:40:07.642199 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:40:07.642199 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:40:07.644190 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:40:07.645197 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:40:07.654218 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:40:07.656191 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:40:07.645197 => 12:40:07.655218
[0m12:40:07.656191 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:40:07.692191 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:40:07.694213 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:40:07.695192 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUB_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY, p.PRODUCT_SUB_FAMILY
        );
[0m12:40:07.696191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:08.729002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:40:08.750534 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:40:07.656191 => 12:40:08.749534
[0m12:40:08.750534 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:40:08.870236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4db06a16-2859-4568-8aa1-1349230fcc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135F03B1910>]}
[0m12:40:08.872236 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_customers ......................... [[32mSUCCESS 1[0m in 1.23s]
[0m12:40:08.876864 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:40:08.884880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:08.886880 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:40:08.886880 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m12:40:08.886880 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:40:08.887833 [info ] [MainThread]: 
[0m12:40:08.887833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m12:40:08.889836 [debug] [MainThread]: Command end result
[0m12:40:08.900814 [info ] [MainThread]: 
[0m12:40:08.901809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:08.902803 [info ] [MainThread]: 
[0m12:40:08.903826 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:08.905834 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:08.904806 after 5.67 seconds
[0m12:40:08.905834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E3587770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E3422630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E34217F0>]}
[0m12:40:08.905834 [debug] [MainThread]: Flushing usage events
[0m12:43:39.782512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077A9553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077A955F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077A954200>]}


============================== 12:43:39.787544 | 27bba189-5ab3-496d-9951-2f5c4020249c ==============================
[0m12:43:39.787544 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:43:39.788513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:40.682479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27bba189-5ab3-496d-9951-2f5c4020249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077EF71A90>]}
[0m12:43:40.770058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27bba189-5ab3-496d-9951-2f5c4020249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020781047F50>]}
[0m12:43:40.771057 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:43:40.779268 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:43:40.891384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:43:40.892384 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:43:41.025975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:43:41.032001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27bba189-5ab3-496d-9951-2f5c4020249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207815FC620>]}
[0m12:43:41.044976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27bba189-5ab3-496d-9951-2f5c4020249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078134E5D0>]}
[0m12:43:41.045983 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:43:41.046984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27bba189-5ab3-496d-9951-2f5c4020249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002078134E570>]}
[0m12:43:41.047982 [info ] [MainThread]: 
[0m12:43:41.049983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:43:41.050983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:43:41.068560 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:43:41.069531 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:43:41.069531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:41.928991 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:43:41.930991 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:43:42.012437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m12:43:42.021439 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:43:42.021439 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:43:42.021439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:42.321309 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:43:42.323305 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:43:42.414341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m12:43:42.424354 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:43:42.427289 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:43:42.428283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:42.946536 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m12:43:42.950533 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:43:43.054695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m12:43:43.073693 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:43:43.075692 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:43:43.076650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:43.502000 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:43.505000 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:43:43.604043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:43:43.610000 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:43:43.611039 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:43:43.612039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:44.088016 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:43:44.091644 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:43:44.194483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27bba189-5ab3-496d-9951-2f5c4020249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020781614B90>]}
[0m12:43:44.198533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:44.201482 [info ] [MainThread]: 
[0m12:43:44.215102 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:43:44.218110 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:43:44.222109 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:43:44.224110 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:43:44.244050 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:43:44.247046 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:43:44.225109 => 12:43:44.246084
[0m12:43:44.247046 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:43:44.281049 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:43:44.283049 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:43:44.283049 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUB_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON  p.PRODUCT_ID = r.PRODUCT_ID,
    p.PRODUCT_NAME = r.PRODUCT_NAME,
    p.PRODUCT_SUB_FAMILY = r.PRODUCT_SUB_FAMILY
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY, p.PRODUCT_SUB_FAMILY
        );
[0m12:43:44.284050 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:44.581140 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff51-0001-429e-0008-435e0001e91e
[0m12:43:44.582140 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 19 unexpected '='.
syntax error line 14 at position 25 unexpected '='.
[0m12:43:44.582140 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:43:44.248082 => 12:43:44.582140
[0m12:43:44.583140 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:43:44.690743 [debug] [Thread-1 (]: Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 19 unexpected '='.
  syntax error line 14 at position 25 unexpected '='.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:43:44.691810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27bba189-5ab3-496d-9951-2f5c4020249c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207817E9190>]}
[0m12:43:44.693761 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_customers ..................... [[31mERROR[0m in 0.47s]
[0m12:43:44.695800 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:43:44.700757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:44.701757 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:43:44.701757 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m12:43:44.702757 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:43:44.703757 [info ] [MainThread]: 
[0m12:43:44.704337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m12:43:44.706385 [debug] [MainThread]: Command end result
[0m12:43:44.720346 [info ] [MainThread]: 
[0m12:43:44.721344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:43:44.722348 [info ] [MainThread]: 
[0m12:43:44.722348 [error] [MainThread]:   Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 19 unexpected '='.
  syntax error line 14 at position 25 unexpected '='.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:43:44.723376 [info ] [MainThread]: 
[0m12:43:44.724269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:43:44.726336 [debug] [MainThread]: Command `dbt run` failed at 12:43:44.725296 after 5.00 seconds
[0m12:43:44.726336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020781407BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077FE15820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207811098E0>]}
[0m12:43:44.727306 [debug] [MainThread]: Flushing usage events
[0m12:44:11.197700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E390550A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E390542F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E390555E0>]}


============================== 12:44:11.202708 | 2f90f869-bbb7-4827-9c1f-46dce180464b ==============================
[0m12:44:11.202708 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:44:11.203671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:12.077206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f90f869-bbb7-4827-9c1f-46dce180464b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E456EE600>]}
[0m12:44:12.163784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f90f869-bbb7-4827-9c1f-46dce180464b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E43D36B40>]}
[0m12:44:12.164784 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:44:12.172784 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:44:12.281369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:12.281369 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:44:12.412471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:44:12.418429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f90f869-bbb7-4827-9c1f-46dce180464b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E45CA8560>]}
[0m12:44:12.430431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f90f869-bbb7-4827-9c1f-46dce180464b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E45A4E540>]}
[0m12:44:12.431431 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:44:12.432433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f90f869-bbb7-4827-9c1f-46dce180464b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E45C2FB00>]}
[0m12:44:12.434465 [info ] [MainThread]: 
[0m12:44:12.436430 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:12.437430 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:44:12.452464 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:44:12.453463 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:44:12.453463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:13.290834 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:44:13.292835 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:44:13.385622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m12:44:13.395133 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:44:13.395133 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:44:13.395133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:13.815029 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:44:13.821032 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:44:13.915441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m12:44:13.918440 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:44:13.919441 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:44:13.919441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:14.258002 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:44:14.261000 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:44:14.347390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m12:44:14.352390 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:44:14.352390 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:44:14.353389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:14.674469 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:44:14.677487 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:44:14.765166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m12:44:14.775166 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:44:14.777145 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:44:14.778141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:15.080135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:44:15.082133 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:44:15.181980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f90f869-bbb7-4827-9c1f-46dce180464b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E459DFBC0>]}
[0m12:44:15.185978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:15.186699 [info ] [MainThread]: 
[0m12:44:15.190704 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:44:15.190704 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:44:15.192919 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:44:15.192919 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:44:15.200919 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:44:15.202920 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:44:15.192919 => 12:44:15.201934
[0m12:44:15.203951 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:44:15.233566 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:44:15.235534 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:44:15.236566 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUB_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON  p.PRODUCT_ID = r.PRODUCT_ID
    p.PRODUCT_NAME = r.PRODUCT_NAME
    p.PRODUCT_SUB_FAMILY = r.PRODUCT_SUB_FAMILY
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY, p.PRODUCT_SUB_FAMILY
        );
[0m12:44:15.236566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:15.800801 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff52-0001-429b-0008-435e0001ddb6
[0m12:44:15.801825 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 4 unexpected 'p'.
[0m12:44:15.801825 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:44:15.203951 => 12:44:15.801825
[0m12:44:15.802825 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:44:15.896618 [debug] [Thread-1 (]: Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 4 unexpected 'p'.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:44:15.897619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f90f869-bbb7-4827-9c1f-46dce180464b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E45C3D2B0>]}
[0m12:44:15.897619 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_customers ..................... [[31mERROR[0m in 0.71s]
[0m12:44:15.898910 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:44:15.901948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:15.901948 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:44:15.901948 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m12:44:15.902951 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:44:15.902951 [info ] [MainThread]: 
[0m12:44:15.903986 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m12:44:15.904993 [debug] [MainThread]: Command end result
[0m12:44:15.916035 [info ] [MainThread]: 
[0m12:44:15.917037 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:44:15.918033 [info ] [MainThread]: 
[0m12:44:15.919033 [error] [MainThread]:   Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 4 unexpected 'p'.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:44:15.920032 [info ] [MainThread]: 
[0m12:44:15.920032 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:44:15.922066 [debug] [MainThread]: Command `dbt run` failed at 12:44:15.921032 after 4.79 seconds
[0m12:44:15.922066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E37EB1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E32EB5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E390550A0>]}
[0m12:44:15.922066 [debug] [MainThread]: Flushing usage events
[0m12:44:44.918964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C21F2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C26815E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C2754050>]}


============================== 12:44:44.923000 | 17e80a42-b818-4143-98a0-dfa4f54f4d43 ==============================
[0m12:44:44.923000 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:44:44.924001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:45.832196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e80a42-b818-4143-98a0-dfa4f54f4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197CF0E4110>]}
[0m12:44:45.918770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e80a42-b818-4143-98a0-dfa4f54f4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197CDD3DEE0>]}
[0m12:44:45.920741 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:44:45.928133 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:44:46.040319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:46.040319 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:44:46.174898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:44:46.179930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17e80a42-b818-4143-98a0-dfa4f54f4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197CF40C920>]}
[0m12:44:46.193345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17e80a42-b818-4143-98a0-dfa4f54f4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197CF252210>]}
[0m12:44:46.193345 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:44:46.194345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e80a42-b818-4143-98a0-dfa4f54f4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197CF440EC0>]}
[0m12:44:46.196346 [info ] [MainThread]: 
[0m12:44:46.197356 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:46.199368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:44:46.215345 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:44:46.216345 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:44:46.216345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:47.188158 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:44:47.190154 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:44:47.277935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m12:44:47.288942 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:44:47.288942 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:44:47.289941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:47.728006 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:44:47.730007 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:44:47.826480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m12:44:47.840439 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:44:47.842470 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:44:47.843437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:48.146667 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:44:48.148664 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:44:48.230402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m12:44:48.233403 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:44:48.233403 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:44:48.233403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:48.574732 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:44:48.578305 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:44:48.681665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m12:44:48.683666 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:44:48.684666 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:44:48.684666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:48.963633 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:44:48.966628 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:44:49.051912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e80a42-b818-4143-98a0-dfa4f54f4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197CF4E89B0>]}
[0m12:44:49.052911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:49.053912 [info ] [MainThread]: 
[0m12:44:49.058074 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:44:49.059115 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:44:49.061129 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:44:49.061129 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:44:49.071152 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:44:49.072118 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:44:49.062114 => 12:44:49.072118
[0m12:44:49.072118 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:44:49.103728 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:44:49.105699 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:44:49.105699 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUB_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON  p.PRODUCT_ID = r.PRODUCT_ID AND
    p.PRODUCT_NAME = r.PRODUCT_NAME AND
    p.PRODUCT_SUB_FAMILY = r.PRODUCT_SUB_FAMILY
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY, p.PRODUCT_SUB_FAMILY
        );
[0m12:44:49.106727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:49.564853 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff52-0001-429b-0008-435e0001ddba
[0m12:44:49.564853 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'P.PRODUCT_NAME'
[0m12:44:49.565891 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:44:49.073152 => 12:44:49.564853
[0m12:44:49.565891 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:44:49.669169 [debug] [Thread-1 (]: Database Error in model prod_customers (models\marts\prod_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'P.PRODUCT_NAME'
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:44:49.671168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e80a42-b818-4143-98a0-dfa4f54f4d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197CF6D2510>]}
[0m12:44:49.673157 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_customers ..................... [[31mERROR[0m in 0.61s]
[0m12:44:49.675098 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:44:49.680099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:49.681099 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:44:49.682099 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m12:44:49.682099 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:44:49.682099 [info ] [MainThread]: 
[0m12:44:49.683643 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m12:44:49.685692 [debug] [MainThread]: Command end result
[0m12:44:49.700656 [info ] [MainThread]: 
[0m12:44:49.701657 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:44:49.702652 [info ] [MainThread]: 
[0m12:44:49.703674 [error] [MainThread]:   Database Error in model prod_customers (models\marts\prod_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'P.PRODUCT_NAME'
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:44:49.704653 [info ] [MainThread]: 
[0m12:44:49.704653 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:44:49.706682 [debug] [MainThread]: Command `dbt run` failed at 12:44:49.706682 after 4.85 seconds
[0m12:44:49.706682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C25C91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C22C1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C26815E0>]}
[0m12:44:49.707682 [debug] [MainThread]: Flushing usage events
[0m12:45:58.413664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D27D9552E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D27D955190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D27D9555E0>]}


============================== 12:45:58.418662 | 82b83416-4165-4fc9-b5fe-9af09beda220 ==============================
[0m12:45:58.418662 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:45:58.419639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:59.308576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82b83416-4165-4fc9-b5fe-9af09beda220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D27FF06E40>]}
[0m12:45:59.395587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82b83416-4165-4fc9-b5fe-9af09beda220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D20A00CB30>]}
[0m12:45:59.396587 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:45:59.405468 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:45:59.510521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:59.510521 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:45:59.642076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:45:59.648076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82b83416-4165-4fc9-b5fe-9af09beda220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D20A2DD220>]}
[0m12:45:59.659987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82b83416-4165-4fc9-b5fe-9af09beda220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D20A34E1B0>]}
[0m12:45:59.659987 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:45:59.660959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82b83416-4165-4fc9-b5fe-9af09beda220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D208E58980>]}
[0m12:45:59.662959 [info ] [MainThread]: 
[0m12:45:59.663958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:59.665958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:45:59.679959 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:45:59.680962 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:45:59.680962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:00.582952 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:46:00.584953 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:46:00.679647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m12:46:00.698714 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:46:00.699701 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:46:00.700701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:01.186500 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:46:01.187498 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:46:01.277498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m12:46:01.281497 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:46:01.282498 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:46:01.282498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:01.582628 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:46:01.584621 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:46:01.667852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m12:46:01.677811 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:46:01.678852 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:46:01.678852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:01.974873 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:01.977871 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:46:02.061758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m12:46:02.064753 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:46:02.064753 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:46:02.065753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:02.335601 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:46:02.337597 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:46:02.429165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82b83416-4165-4fc9-b5fe-9af09beda220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D20A2ACCE0>]}
[0m12:46:02.433212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:02.435147 [info ] [MainThread]: 
[0m12:46:02.444647 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:46:02.444647 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:46:02.446654 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:46:02.446654 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:46:02.455659 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:46:02.457659 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:46:02.446654 => 12:46:02.456653
[0m12:46:02.457659 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:46:02.490683 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:46:02.492654 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:46:02.493657 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUB_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY, p.PRODUCT_SUB_FAMILY
        );
[0m12:46:02.493657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:03.228937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:03.253969 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:46:02.458686 => 12:46:03.253969
[0m12:46:03.254969 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:46:03.338792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82b83416-4165-4fc9-b5fe-9af09beda220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D20A24ADB0>]}
[0m12:46:03.338792 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_customers ......................... [[32mSUCCESS 1[0m in 0.89s]
[0m12:46:03.339946 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:46:03.341983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:03.342955 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:46:03.342955 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:46:03.342955 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:46:03.343952 [info ] [MainThread]: 
[0m12:46:03.382085 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m12:46:03.384086 [debug] [MainThread]: Command end result
[0m12:46:03.399081 [info ] [MainThread]: 
[0m12:46:03.400081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:03.401081 [info ] [MainThread]: 
[0m12:46:03.402081 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:46:03.404090 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:03.403081 after 5.05 seconds
[0m12:46:03.404090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D20A407AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D20A5C56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D208E3F770>]}
[0m12:46:03.405097 [debug] [MainThread]: Flushing usage events
[0m12:47:07.575551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012102E0C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001210405AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001210415BF80>]}


============================== 12:47:07.580584 | b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37 ==============================
[0m12:47:07.580584 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:47:07.581551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:08.557848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001210E71BF80>]}
[0m12:47:08.649398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012101F910D0>]}
[0m12:47:08.650399 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:47:08.657974 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:47:08.776762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:08.776762 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:47:08.914860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:47:08.919899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001210E718FE0>]}
[0m12:47:08.932868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012110B4E0F0>]}
[0m12:47:08.932868 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:47:08.933867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012110568440>]}
[0m12:47:08.935868 [info ] [MainThread]: 
[0m12:47:08.936892 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:08.938869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:47:08.953898 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:47:08.954868 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:47:08.954868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:09.887931 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:47:09.889931 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:47:09.980989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m12:47:09.989995 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:47:09.990996 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:47:09.990996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:10.535327 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:47:10.537330 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:47:10.618453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m12:47:10.621453 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:47:10.622454 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:47:10.623454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:11.038398 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:47:11.046392 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:47:11.139389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m12:47:11.147388 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:47:11.147388 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:47:11.148388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:11.466537 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:47:11.468558 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:47:11.571574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m12:47:11.574575 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:47:11.575574 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:47:11.576580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:11.902985 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:11.904987 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:47:11.989102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012110DEACC0>]}
[0m12:47:11.990102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:11.991103 [info ] [MainThread]: 
[0m12:47:11.997101 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:47:11.998103 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:47:11.999103 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:47:12.000137 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:47:12.011101 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:47:12.013103 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:47:12.000137 => 12:47:12.013103
[0m12:47:12.014101 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:47:12.050654 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:47:12.052668 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:47:12.052668 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    p.PRODUCT_SUB_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
        );
[0m12:47:12.053655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:12.500555 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff55-0001-429b-0008-435e0001ddf6
[0m12:47:12.501555 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 7 at position 4
'P.PRODUCT_SUB_FAMILY' in select clause is neither an aggregate nor in the group by clause.
[0m12:47:12.501555 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:47:12.014101 => 12:47:12.501555
[0m12:47:12.502556 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:47:12.593859 [debug] [Thread-1 (]: Database Error in model prod_customers (models\marts\prod_customers.sql)
  001104 (42601): SQL compilation error: error line 7 at position 4
  'P.PRODUCT_SUB_FAMILY' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:47:12.594860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b51af7a1-bd2b-41e9-ac32-30a4d2fd2f37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012110E3FAA0>]}
[0m12:47:12.596860 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_customers ..................... [[31mERROR[0m in 0.60s]
[0m12:47:12.599273 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:47:12.604276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:12.605269 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:47:12.606268 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m12:47:12.606268 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:47:12.607267 [info ] [MainThread]: 
[0m12:47:12.608273 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m12:47:12.611271 [debug] [MainThread]: Command end result
[0m12:47:12.623262 [info ] [MainThread]: 
[0m12:47:12.624228 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:12.625228 [info ] [MainThread]: 
[0m12:47:12.626228 [error] [MainThread]:   Database Error in model prod_customers (models\marts\prod_customers.sql)
  001104 (42601): SQL compilation error: error line 7 at position 4
  'P.PRODUCT_SUB_FAMILY' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:47:12.627237 [info ] [MainThread]: 
[0m12:47:12.628278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:47:12.629276 [debug] [MainThread]: Command `dbt run` failed at 12:47:12.629276 after 5.12 seconds
[0m12:47:12.629276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012101F910D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121107390D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012102F29070>]}
[0m12:47:12.630278 [debug] [MainThread]: Flushing usage events
[0m12:47:18.261802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8E680E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8E68140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8E69280>]}


============================== 12:47:18.266844 | 4e1c3dde-8209-4052-8b2a-889b0f149a7d ==============================
[0m12:47:18.266844 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:47:18.267657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:19.177490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e1c3dde-8209-4052-8b2a-889b0f149a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8E940E0>]}
[0m12:47:19.264102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e1c3dde-8209-4052-8b2a-889b0f149a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8EC84D0>]}
[0m12:47:19.265101 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:47:19.272930 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:47:19.384428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:19.385424 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:47:19.516013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:47:19.522010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e1c3dde-8209-4052-8b2a-889b0f149a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC681B350>]}
[0m12:47:19.534011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e1c3dde-8209-4052-8b2a-889b0f149a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC694E540>]}
[0m12:47:19.535016 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:47:19.537019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1c3dde-8209-4052-8b2a-889b0f149a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC6781F40>]}
[0m12:47:19.539041 [info ] [MainThread]: 
[0m12:47:19.539844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:19.541886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:47:19.553881 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:47:19.555417 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:47:19.556428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:19.929104 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:47:19.936165 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:47:20.031978 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m12:47:20.040962 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:47:20.041932 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:47:20.041932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:20.354880 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:47:20.356913 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:47:20.435509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m12:47:20.439508 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:47:20.440509 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:47:20.441510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:20.753033 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:47:20.757033 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:47:20.840504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m12:47:20.850556 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:47:20.851556 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:47:20.851556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:21.274421 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:21.276418 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:47:21.353698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:47:21.357013 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:47:21.358016 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:47:21.358016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:21.664367 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:21.666365 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:47:21.765378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1c3dde-8209-4052-8b2a-889b0f149a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB872A900>]}
[0m12:47:21.766418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:21.766906 [info ] [MainThread]: 
[0m12:47:21.770913 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:47:21.771913 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:47:21.772913 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:47:21.772913 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:47:21.787913 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:47:21.789912 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:47:21.773914 => 12:47:21.788915
[0m12:47:21.789912 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:47:21.833955 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:47:21.835939 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:47:21.835939 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
        );
[0m12:47:21.836944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:22.687759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:47:22.712707 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:47:21.790918 => 12:47:22.712707
[0m12:47:22.712707 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:47:22.804573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1c3dde-8209-4052-8b2a-889b0f149a7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC6CC1820>]}
[0m12:47:22.805573 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_customers ......................... [[32mSUCCESS 1[0m in 1.03s]
[0m12:47:22.807575 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:47:22.810612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:22.811614 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:47:22.812612 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m12:47:22.813611 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:47:22.813611 [info ] [MainThread]: 
[0m12:47:22.814611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m12:47:22.816572 [debug] [MainThread]: Command end result
[0m12:47:22.874128 [info ] [MainThread]: 
[0m12:47:22.874128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:22.875128 [info ] [MainThread]: 
[0m12:47:22.876129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:47:22.878127 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:22.878127 after 4.68 seconds
[0m12:47:22.878127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8891AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8B05AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB8A91880>]}
[0m12:47:22.879128 [debug] [MainThread]: Flushing usage events
[0m12:48:57.754409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D04864890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D04A55370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D04A555E0>]}


============================== 12:48:57.759448 | 10c1898d-1e33-4acb-a4c3-7affded0be3e ==============================
[0m12:48:57.759448 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:48:57.760415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:48:58.650472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10c1898d-1e33-4acb-a4c3-7affded0be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D11281970>]}
[0m12:48:58.737048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10c1898d-1e33-4acb-a4c3-7affded0be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D0F6200B0>]}
[0m12:48:58.738048 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:48:58.746023 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:48:58.858678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:48:58.858678 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:48:59.014580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:48:59.020572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10c1898d-1e33-4acb-a4c3-7affded0be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D0FEC29C0>]}
[0m12:48:59.032552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10c1898d-1e33-4acb-a4c3-7affded0be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1143A690>]}
[0m12:48:59.032552 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:48:59.033573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10c1898d-1e33-4acb-a4c3-7affded0be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1160FB00>]}
[0m12:48:59.035542 [info ] [MainThread]: 
[0m12:48:59.036574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:59.038551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:48:59.054565 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:48:59.054565 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:48:59.055564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:59.916216 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:48:59.917195 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:49:00.009132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m12:49:00.039164 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:49:00.039164 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:49:00.040128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:00.503634 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:49:00.510628 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:49:00.613528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m12:49:00.633594 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:49:00.634595 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:49:00.636534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:00.953678 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:49:00.956685 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:49:01.040379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m12:49:01.054469 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:49:01.055470 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:49:01.056441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:01.552502 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:49:01.554508 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:49:01.635680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m12:49:01.638679 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:49:01.639680 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:49:01.639680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:01.971682 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:49:01.973682 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:49:02.051192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10c1898d-1e33-4acb-a4c3-7affded0be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D0FF15580>]}
[0m12:49:02.052191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:02.052191 [info ] [MainThread]: 
[0m12:49:02.056581 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:49:02.056581 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:49:02.058582 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:49:02.058582 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:49:02.067582 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:49:02.068598 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:49:02.058582 => 12:49:02.068598
[0m12:49:02.069582 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:49:02.103093 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:49:02.105094 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:49:02.105094 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS
    RANK() OVER (PARTITION BY p.PRODUCT_ID ORDER BY SUM(r.REVENUE) DESC) AS RANK
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
        );
[0m12:49:02.106093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:02.394832 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff57-0001-429e-0008-435e0001e982
[0m12:49:02.395832 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 4 unexpected 'RANK'.
syntax error line 9 at position 71 unexpected ')'.
[0m12:49:02.395832 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:49:02.069582 => 12:49:02.395832
[0m12:49:02.396832 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:49:02.510823 [debug] [Thread-1 (]: Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'RANK'.
  syntax error line 9 at position 71 unexpected ')'.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:49:02.511866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10c1898d-1e33-4acb-a4c3-7affded0be3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D118F5160>]}
[0m12:49:02.513826 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.prod_customers ..................... [[31mERROR[0m in 0.45s]
[0m12:49:02.515821 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:49:02.520857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:02.521861 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:49:02.522857 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:49:02.522857 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:49:02.523858 [info ] [MainThread]: 
[0m12:49:02.524861 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m12:49:02.526875 [debug] [MainThread]: Command end result
[0m12:49:02.539870 [info ] [MainThread]: 
[0m12:49:02.540871 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:49:02.541872 [info ] [MainThread]: 
[0m12:49:02.542909 [error] [MainThread]:   Database Error in model prod_customers (models\marts\prod_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'RANK'.
  syntax error line 9 at position 71 unexpected ')'.
  compiled Code at target\run\practice\models\marts\prod_customers.sql
[0m12:49:02.543873 [info ] [MainThread]: 
[0m12:49:02.544870 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:49:02.545871 [debug] [MainThread]: Command `dbt run` failed at 12:49:02.545871 after 4.85 seconds
[0m12:49:02.546872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D04959100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D049817F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D04A3FBF0>]}
[0m12:49:02.546872 [debug] [MainThread]: Flushing usage events
[0m12:49:15.039840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB75A54FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB758CBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB75A54200>]}


============================== 12:49:15.104434 | 2ae74247-9eaf-4992-ae7a-656a2a796329 ==============================
[0m12:49:15.104434 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:49:15.108433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:49:15.997158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ae74247-9eaf-4992-ae7a-656a2a796329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB0224A630>]}
[0m12:49:16.083709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ae74247-9eaf-4992-ae7a-656a2a796329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB00D47830>]}
[0m12:49:16.084709 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:49:16.092712 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:49:16.202323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:16.202323 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:49:16.335492 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:49:16.340525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ae74247-9eaf-4992-ae7a-656a2a796329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB023DEC60>]}
[0m12:49:16.352491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ae74247-9eaf-4992-ae7a-656a2a796329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB0244E570>]}
[0m12:49:16.352491 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:49:16.353490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ae74247-9eaf-4992-ae7a-656a2a796329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB00A50EC0>]}
[0m12:49:16.355523 [info ] [MainThread]: 
[0m12:49:16.356491 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:16.357491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:49:16.371522 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:49:16.372522 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:49:16.373492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:17.193404 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:49:17.195405 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:49:17.286304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m12:49:17.295305 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:49:17.295305 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:49:17.296304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:17.803545 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:49:17.809544 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:49:17.898752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m12:49:17.902752 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:49:17.903753 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:49:17.903753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:18.328215 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:49:18.332214 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:49:18.796298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m12:49:18.804294 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:49:18.805296 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:49:18.806294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:19.157549 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:49:19.159545 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:49:19.259805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m12:49:19.269865 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:49:19.272864 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:49:19.273841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:19.583071 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:49:19.584063 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:49:19.675043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ae74247-9eaf-4992-ae7a-656a2a796329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB0001BF80>]}
[0m12:49:19.676043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:19.677042 [info ] [MainThread]: 
[0m12:49:19.681225 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:49:19.681225 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:49:19.683258 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:49:19.683258 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:49:19.691227 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:49:19.693229 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:49:19.683258 => 12:49:19.692274
[0m12:49:19.693229 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:49:19.724258 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:49:19.727231 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:49:19.728226 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS,
    RANK() OVER (PARTITION BY p.PRODUCT_ID ORDER BY SUM(r.REVENUE) DESC) AS RANK
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
        );
[0m12:49:19.728226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:20.490733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:49:20.516766 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:49:19.694227 => 12:49:20.516766
[0m12:49:20.517762 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:49:20.603063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ae74247-9eaf-4992-ae7a-656a2a796329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB027977D0>]}
[0m12:49:20.604064 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_customers ......................... [[32mSUCCESS 1[0m in 0.92s]
[0m12:49:20.607060 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:49:20.612063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:20.613019 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:49:20.614061 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m12:49:20.615064 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:49:20.616067 [info ] [MainThread]: 
[0m12:49:20.618019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m12:49:20.620059 [debug] [MainThread]: Command end result
[0m12:49:20.641013 [info ] [MainThread]: 
[0m12:49:20.642014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:20.644012 [info ] [MainThread]: 
[0m12:49:20.645049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:20.647012 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:20.646011 after 5.67 seconds
[0m12:49:20.647012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB75981910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB756B7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB75959880>]}
[0m12:49:20.648012 [debug] [MainThread]: Flushing usage events
[0m12:50:36.161858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D695BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D695B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D695B740>]}


============================== 12:50:36.174267 | 0e64af54-8660-4455-a99d-755eefea35ed ==============================
[0m12:50:36.174267 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:50:36.175237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m prod_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:50:48.111679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e64af54-8660-4455-a99d-755eefea35ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E1074680>]}
[0m12:50:48.198259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e64af54-8660-4455-a99d-755eefea35ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E3221010>]}
[0m12:50:48.208227 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:50:48.228080 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:50:49.483391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:49.484392 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:50:49.615974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:50:49.620923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e64af54-8660-4455-a99d-755eefea35ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E36319A0>]}
[0m12:50:49.647036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e64af54-8660-4455-a99d-755eefea35ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E3451F10>]}
[0m12:50:49.648036 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:50:49.648036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e64af54-8660-4455-a99d-755eefea35ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E363D760>]}
[0m12:50:49.650036 [info ] [MainThread]: 
[0m12:50:49.651035 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:49.652432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:50:49.667474 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:50:49.667474 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:50:49.667474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:50.821691 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:50:50.823657 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:50:50.913176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m12:50:50.923176 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:50:50.923176 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:50:50.923176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:51.347720 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:50:51.349706 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:50:51.646468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m12:50:51.649466 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:50:51.649466 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:50:51.650467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:51.943909 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:50:51.945907 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:50:52.046517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:50:52.048520 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:50:52.049517 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:50:52.049517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:52.364941 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:50:52.368939 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:50:52.457278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m12:50:52.460794 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:50:52.461793 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:50:52.461793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:52.896054 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:50:52.901053 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:50:53.008095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e64af54-8660-4455-a99d-755eefea35ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E3613290>]}
[0m12:50:53.009061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:53.010060 [info ] [MainThread]: 
[0m12:50:53.014124 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:50:53.015149 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:50:53.016127 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:50:53.017151 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:50:53.025158 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:50:53.026126 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:50:53.017151 => 12:50:53.026126
[0m12:50:53.027126 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:50:53.058194 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:50:53.060724 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:50:53.060724 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS,
    RANK() OVER (PARTITION BY p.PRODUCT_ID ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
        );
[0m12:50:53.061720 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:50:53.975678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:50:53.997664 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:50:53.027126 => 12:50:53.997664
[0m12:50:53.998664 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:50:54.085649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e64af54-8660-4455-a99d-755eefea35ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E3893290>]}
[0m12:50:54.087646 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_customers ......................... [[32mSUCCESS 1[0m in 1.07s]
[0m12:50:54.089652 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:50:54.094699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:54.095693 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:50:54.095693 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m12:50:54.096692 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:50:54.097694 [info ] [MainThread]: 
[0m12:50:54.099653 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m12:50:54.101654 [debug] [MainThread]: Command end result
[0m12:50:54.117648 [info ] [MainThread]: 
[0m12:50:54.118646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:54.119532 [info ] [MainThread]: 
[0m12:50:54.120565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:54.121545 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:54.121545 after 18.05 seconds
[0m12:50:54.121545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D693FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D693FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D6881C10>]}
[0m12:50:54.122573 [debug] [MainThread]: Flushing usage events
[0m12:51:37.182978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6017AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6013CF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD604594C0>]}


============================== 12:51:37.187979 | 40e452d4-4a2c-4e34-a819-82b814415a92 ==============================
[0m12:51:37.187979 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:51:37.188979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prod_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:38.108799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40e452d4-4a2c-4e34-a819-82b814415a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6C454B00>]}
[0m12:51:38.228037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40e452d4-4a2c-4e34-a819-82b814415a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD604B8AD0>]}
[0m12:51:38.229040 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:51:38.238040 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:51:38.349046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:51:38.350010 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:51:38.481157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:51:38.487177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40e452d4-4a2c-4e34-a819-82b814415a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6D0104A0>]}
[0m12:51:38.499146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40e452d4-4a2c-4e34-a819-82b814415a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6CE4E480>]}
[0m12:51:38.499146 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:51:38.500150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e452d4-4a2c-4e34-a819-82b814415a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD604B8A70>]}
[0m12:51:38.502198 [info ] [MainThread]: 
[0m12:51:38.503181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:51:38.505148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:51:38.520177 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:51:38.521179 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:51:38.521179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:39.342714 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:51:39.344747 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:51:39.431923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m12:51:39.440923 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:51:39.453547 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:51:39.453547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:39.878286 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:51:39.884384 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:51:39.979840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:51:39.981840 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:51:39.982840 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:51:39.982840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:40.290612 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:51:40.293610 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:51:40.390494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m12:51:40.393527 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:51:40.394528 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:51:40.394528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:40.706396 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:51:40.710014 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:51:40.801748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m12:51:40.805748 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:51:40.827359 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:51:40.828252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:41.376557 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:51:41.379516 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:51:41.498182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e452d4-4a2c-4e34-a819-82b814415a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6D1207D0>]}
[0m12:51:41.502180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:41.503396 [info ] [MainThread]: 
[0m12:51:41.507225 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:51:41.508225 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:51:41.509734 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:51:41.509734 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:51:41.517773 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:51:41.519742 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:51:41.510742 => 12:51:41.518772
[0m12:51:41.519742 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:51:41.550774 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:51:41.552775 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:51:41.552775 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS,
    RANK() OVER (PARTITION BY p.PRODUCT_ID ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
ORDER BY TOTAL_REVENUE DESC
        );
[0m12:51:41.552775 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:42.321582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:51:42.344550 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:51:41.519742 => 12:51:42.344550
[0m12:51:42.345548 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:51:42.427352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e452d4-4a2c-4e34-a819-82b814415a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6D2B2FF0>]}
[0m12:51:42.428389 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_customers ......................... [[32mSUCCESS 1[0m in 0.92s]
[0m12:51:42.431355 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:51:42.434390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:42.435392 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:51:42.436390 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:51:42.437389 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:51:42.437389 [info ] [MainThread]: 
[0m12:51:42.438497 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m12:51:42.439528 [debug] [MainThread]: Command end result
[0m12:51:42.450503 [info ] [MainThread]: 
[0m12:51:42.451505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:42.452609 [info ] [MainThread]: 
[0m12:51:42.453616 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:42.454651 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:42.454651 after 5.33 seconds
[0m12:51:42.454651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6003FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6043EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6043FBF0>]}
[0m12:51:42.455647 [debug] [MainThread]: Flushing usage events
[0m12:52:34.655299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9205AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92157D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92157CB0>]}


============================== 12:52:34.660296 | ebed9094-d5a9-4429-a48e-f7c20754ea78 ==============================
[0m12:52:34.660296 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:52:34.661266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prod_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:35.570832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebed9094-d5a9-4429-a48e-f7c20754ea78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9C7B4740>]}
[0m12:52:35.656444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebed9094-d5a9-4429-a48e-f7c20754ea78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92185490>]}
[0m12:52:35.657445 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:52:35.665446 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:52:35.778469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:35.778469 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\prod_customers.sql
[0m12:52:35.912568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:52:35.917567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebed9094-d5a9-4429-a48e-f7c20754ea78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EEFC440>]}
[0m12:52:35.929567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebed9094-d5a9-4429-a48e-f7c20754ea78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EC52000>]}
[0m12:52:35.929567 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:52:35.930568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebed9094-d5a9-4429-a48e-f7c20754ea78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9CC779B0>]}
[0m12:52:35.932599 [info ] [MainThread]: 
[0m12:52:35.933569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:52:35.934598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:52:35.949598 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:52:35.950598 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:52:35.950598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:36.894194 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:52:36.896196 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:52:36.982808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m12:52:36.991808 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:52:36.992817 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:52:36.992817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:37.399693 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:52:37.401693 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:52:37.489409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m12:52:37.506392 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:52:37.507386 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:52:37.508388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:37.812303 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:37.813306 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:52:37.905824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m12:52:37.909844 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:52:37.910863 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:52:37.911855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:38.313025 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:52:38.315025 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:52:38.409675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m12:52:38.412710 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:52:38.412710 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:52:38.413713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:38.737692 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:52:38.740687 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:52:38.826410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebed9094-d5a9-4429-a48e-f7c20754ea78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EEC1BE0>]}
[0m12:52:38.827828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:38.827828 [info ] [MainThread]: 
[0m12:52:38.831827 [debug] [Thread-1 (]: Began running node model.practice.prod_customers
[0m12:52:38.838015 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.prod_customers .............................. [RUN]
[0m12:52:38.844951 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.prod_customers'
[0m12:52:38.847956 [debug] [Thread-1 (]: Began compiling node model.practice.prod_customers
[0m12:52:38.868942 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.prod_customers"
[0m12:52:38.870946 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (compile): 12:52:38.848970 => 12:52:38.869981
[0m12:52:38.872944 [debug] [Thread-1 (]: Began executing node model.practice.prod_customers
[0m12:52:38.905973 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.prod_customers"
[0m12:52:38.906995 [debug] [Thread-1 (]: Using snowflake connection "model.practice.prod_customers"
[0m12:52:38.907972 [debug] [Thread-1 (]: On model.practice.prod_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.prod_customers"} */
create or replace transient table RIDE_SHARING_DB.MARTS.prod_customers
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
ORDER BY TOTAL_REVENUE DESC
        );
[0m12:52:38.908942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:52:39.826700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:52:39.848280 [debug] [Thread-1 (]: Timing info for model.practice.prod_customers (execute): 12:52:38.872944 => 12:52:39.848280
[0m12:52:39.848280 [debug] [Thread-1 (]: On model.practice.prod_customers: Close
[0m12:52:39.933833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebed9094-d5a9-4429-a48e-f7c20754ea78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9F0AE8D0>]}
[0m12:52:39.933833 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.prod_customers ......................... [[32mSUCCESS 1[0m in 1.09s]
[0m12:52:39.934823 [debug] [Thread-1 (]: Finished running node model.practice.prod_customers
[0m12:52:39.936799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:39.937831 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:52:39.937831 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:52:39.937831 [debug] [MainThread]: Connection 'model.practice.prod_customers' was properly closed.
[0m12:52:39.938833 [info ] [MainThread]: 
[0m12:52:39.938833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m12:52:39.940800 [debug] [MainThread]: Command end result
[0m12:52:39.953800 [info ] [MainThread]: 
[0m12:52:39.953800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:39.954832 [info ] [MainThread]: 
[0m12:52:39.955798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:39.956608 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:39.956608 after 5.36 seconds
[0m12:52:39.957648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9205B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90F09880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9213FC80>]}
[0m12:52:39.957648 [debug] [MainThread]: Flushing usage events
[0m12:54:17.297006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EA354110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EA3540B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EA3555B0>]}


============================== 12:54:17.301989 | 3e2bbc94-af02-479a-9bd5-c0a83668bc7d ==============================
[0m12:54:17.301989 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:54:17.302910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m prod_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:18.206028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e2bbc94-af02-479a-9bd5-c0a83668bc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0F4A8C0B0>]}
[0m12:54:18.291609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e2bbc94-af02-479a-9bd5-c0a83668bc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0F6704380>]}
[0m12:54:18.292609 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:54:18.300611 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:54:18.410715 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:54:18.411717 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_product_revenue.sql
[0m12:54:18.411717 [debug] [MainThread]: Partial parsing: deleted file: practice://models\marts\prod_customers.sql
[0m12:54:18.543236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:54:18.549267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e2bbc94-af02-479a-9bd5-c0a83668bc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0F6C49D90>]}
[0m12:54:18.559866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e2bbc94-af02-479a-9bd5-c0a83668bc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0F6D4E690>]}
[0m12:54:18.560867 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:54:18.561866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e2bbc94-af02-479a-9bd5-c0a83668bc7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0F6C17410>]}
[0m12:54:18.562867 [warn ] [MainThread]: The selection criterion 'prod_customers' does not match any nodes
[0m12:54:18.563866 [info ] [MainThread]: 
[0m12:54:18.564897 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:54:18.565866 [debug] [MainThread]: Command end result
[0m12:54:18.575906 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:18.575906 after 1.34 seconds
[0m12:54:18.576909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EA25B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0EA33FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0F49E6F90>]}
[0m12:54:18.577906 [debug] [MainThread]: Flushing usage events
[0m12:54:37.562610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8182C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8D3B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8DDFCB0>]}


============================== 12:54:37.567611 | fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90 ==============================
[0m12:54:37.567611 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:54:37.568580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_product_revenue', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:38.494467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4B5CB00>]}
[0m12:54:38.584016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCA080740>]}
[0m12:54:38.585019 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:54:38.594020 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:54:38.701412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:38.701412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:38.702408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m12:54:38.708482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6AB0920>]}
[0m12:54:38.720481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6B4E360>]}
[0m12:54:38.721513 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:54:38.721513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6988EC0>]}
[0m12:54:38.723512 [info ] [MainThread]: 
[0m12:54:38.724482 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:54:38.726485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m12:54:38.740549 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m12:54:38.741550 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m12:54:38.742522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:39.635919 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m12:54:39.639919 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m12:54:39.736044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m12:54:39.749121 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m12:54:39.749121 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m12:54:39.750116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:40.079097 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:54:40.086100 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m12:54:40.192714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m12:54:40.205775 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m12:54:40.207775 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m12:54:40.209728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:40.527337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:54:40.529335 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m12:54:40.627438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m12:54:40.641414 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m12:54:40.642422 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m12:54:40.643413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:40.964030 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m12:54:40.969038 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m12:54:41.068817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m12:54:41.078382 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m12:54:41.078382 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m12:54:41.079383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:41.533530 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:54:41.536488 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m12:54:41.627421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6A4D100>]}
[0m12:54:41.628420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:41.629508 [info ] [MainThread]: 
[0m12:54:41.688266 [debug] [Thread-1 (]: Began running node model.practice.mart_product_revenue
[0m12:54:41.689305 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_product_revenue ........................ [RUN]
[0m12:54:41.690272 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_product_revenue'
[0m12:54:41.690272 [debug] [Thread-1 (]: Began compiling node model.practice.mart_product_revenue
[0m12:54:41.699304 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_product_revenue"
[0m12:54:41.700308 [debug] [Thread-1 (]: Timing info for model.practice.mart_product_revenue (compile): 12:54:41.691309 => 12:54:41.700308
[0m12:54:41.701274 [debug] [Thread-1 (]: Began executing node model.practice.mart_product_revenue
[0m12:54:41.731276 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_product_revenue"
[0m12:54:41.733274 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_product_revenue"
[0m12:54:41.734305 [debug] [Thread-1 (]: On model.practice.mart_product_revenue: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_product_revenue"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_product_revenue
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
ORDER BY TOTAL_REVENUE DESC
        );
[0m12:54:41.734305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:43.036509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:54:43.062539 [debug] [Thread-1 (]: Timing info for model.practice.mart_product_revenue (execute): 12:54:41.701274 => 12:54:43.061541
[0m12:54:43.062539 [debug] [Thread-1 (]: On model.practice.mart_product_revenue: Close
[0m12:54:43.146448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa38050a-1b8c-453a-ac0a-ae8c0f0b3d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6AB2690>]}
[0m12:54:43.147450 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_product_revenue ................... [[32mSUCCESS 1[0m in 1.46s]
[0m12:54:43.148416 [debug] [Thread-1 (]: Finished running node model.practice.mart_product_revenue
[0m12:54:43.150449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:43.151448 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m12:54:43.151448 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m12:54:43.151448 [debug] [MainThread]: Connection 'model.practice.mart_product_revenue' was properly closed.
[0m12:54:43.152449 [info ] [MainThread]: 
[0m12:54:43.153416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m12:54:43.154449 [debug] [MainThread]: Command end result
[0m12:54:43.166415 [info ] [MainThread]: 
[0m12:54:43.234857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:43.236867 [info ] [MainThread]: 
[0m12:54:43.237868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:54:43.239903 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:43.239903 after 5.74 seconds
[0m12:54:43.240906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCA03FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6E75B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC8A81AF0>]}
[0m12:54:43.240906 [debug] [MainThread]: Flushing usage events
[0m12:59:56.682189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E483A92C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4858F4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E485C5BF50>]}


============================== 12:59:56.686211 | c9f93423-ade4-47d3-ae93-8d07e65058d3 ==============================
[0m12:59:56.686211 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:59:56.687188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m customer_rank', 'send_anonymous_usage_stats': 'True'}
[0m12:59:57.711038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9f93423-ade4-47d3-ae93-8d07e65058d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E492481970>]}
[0m12:59:57.799649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9f93423-ade4-47d3-ae93-8d07e65058d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E485B23F20>]}
[0m12:59:57.800649 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:59:57.808794 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:59:57.913819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:59:57.913819 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\customers_rank.sql
[0m12:59:58.051541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m12:59:58.057578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9f93423-ade4-47d3-ae93-8d07e65058d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E485CB86E0>]}
[0m12:59:58.069548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9f93423-ade4-47d3-ae93-8d07e65058d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E492651C40>]}
[0m12:59:58.070550 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m12:59:58.071549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9f93423-ade4-47d3-ae93-8d07e65058d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4927E7AA0>]}
[0m12:59:58.071549 [warn ] [MainThread]: The selection criterion 'customer_rank' does not match any nodes
[0m12:59:58.073547 [info ] [MainThread]: 
[0m12:59:58.074547 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:59:58.075549 [debug] [MainThread]: Command end result
[0m12:59:58.086558 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:58.086558 after 1.47 seconds
[0m12:59:58.086558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E485B81A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E485B50680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E485B50200>]}
[0m12:59:58.087579 [debug] [MainThread]: Flushing usage events
[0m13:00:15.059849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7080AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE708300E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE70A575F0>]}


============================== 13:00:15.064879 | eadde999-c39a-47d9-8f8a-241f6d7ca2d4 ==============================
[0m13:00:15.064879 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:00:15.065885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m customers_rank', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:15.977349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eadde999-c39a-47d9-8f8a-241f6d7ca2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7D44F140>]}
[0m13:00:16.063891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eadde999-c39a-47d9-8f8a-241f6d7ca2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7B12B2C0>]}
[0m13:00:16.064892 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:00:16.075749 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:00:16.220013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:16.221013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:16.222016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:00:16.228012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eadde999-c39a-47d9-8f8a-241f6d7ca2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7D4ADA90>]}
[0m13:00:16.239981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eadde999-c39a-47d9-8f8a-241f6d7ca2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7D53A600>]}
[0m13:00:16.240982 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:00:16.241996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eadde999-c39a-47d9-8f8a-241f6d7ca2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7D479670>]}
[0m13:00:16.243995 [info ] [MainThread]: 
[0m13:00:16.244982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:16.248016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:00:16.262020 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:00:16.263013 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:00:16.263013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:17.133648 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:00:17.136648 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:00:17.222968 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m13:00:17.237958 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:00:17.238959 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:00:17.238959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:17.697892 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:00:17.703891 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:00:17.806733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m13:00:17.812733 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:00:17.814733 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:00:17.814733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:18.153157 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:00:18.155155 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:00:18.263325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m13:00:18.274281 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:00:18.274281 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:00:18.274281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:18.601654 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:00:18.604162 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:00:18.704023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m13:00:18.707031 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:00:18.708032 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:00:18.708032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:19.007282 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:00:19.010281 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:00:19.096661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eadde999-c39a-47d9-8f8a-241f6d7ca2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7D059610>]}
[0m13:00:19.097704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:19.098998 [info ] [MainThread]: 
[0m13:00:19.104524 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:00:19.105569 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:00:19.107535 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:00:19.108537 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:00:19.121536 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:00:19.125537 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:00:19.109571 => 13:00:19.124548
[0m13:00:19.125537 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:00:19.157562 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:00:19.160532 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:00:19.160532 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.PRODUCT_ID
GROUP BY CUSTOMER_ID, CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:00:19.160532 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:19.639124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff62-0001-429e-0008-435e0001e9f2
[0m13:00:19.640124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_ID'
[0m13:00:19.640124 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:00:19.126534 => 13:00:19.640124
[0m13:00:19.641125 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:00:19.745179 [debug] [Thread-1 (]: Database Error in model customers_rank (models\marts\customers_rank.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:00:19.746166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eadde999-c39a-47d9-8f8a-241f6d7ca2d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7D8B30E0>]}
[0m13:00:19.748160 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.customers_rank ..................... [[31mERROR[0m in 0.64s]
[0m13:00:19.750119 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:00:19.755156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:19.755156 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:00:19.756156 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m13:00:19.757149 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:00:19.757149 [info ] [MainThread]: 
[0m13:00:19.758112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m13:00:19.760159 [debug] [MainThread]: Command end result
[0m13:00:19.774111 [info ] [MainThread]: 
[0m13:00:19.775116 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:00:19.776113 [info ] [MainThread]: 
[0m13:00:19.776113 [error] [MainThread]:   Database Error in model customers_rank (models\marts\customers_rank.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:00:19.777399 [info ] [MainThread]: 
[0m13:00:19.778437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:00:19.779437 [debug] [MainThread]: Command `dbt run` failed at 13:00:19.779437 after 4.78 seconds
[0m13:00:19.779437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE70A3FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7080AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7052AD20>]}
[0m13:00:19.780437 [debug] [MainThread]: Flushing usage events
[0m13:01:51.163963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57735B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57735BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57735AC90>]}


============================== 13:01:51.168931 | 950e786a-6438-4457-8c51-3725aa061111 ==============================
[0m13:01:51.168931 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:01:51.169948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m customers_rank', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:52.036600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '950e786a-6438-4457-8c51-3725aa061111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B575FF6630>]}
[0m13:01:52.123216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '950e786a-6438-4457-8c51-3725aa061111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57F94BF80>]}
[0m13:01:52.124217 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:01:52.132216 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:01:52.226796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:52.226796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:52.227797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:01:52.233777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '950e786a-6438-4457-8c51-3725aa061111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581C8B230>]}
[0m13:01:52.244781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '950e786a-6438-4457-8c51-3725aa061111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581E52660>]}
[0m13:01:52.245746 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:01:52.246749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950e786a-6438-4457-8c51-3725aa061111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581E52480>]}
[0m13:01:52.247777 [info ] [MainThread]: 
[0m13:01:52.253777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:52.254778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:01:52.269777 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:01:52.270777 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:01:52.270777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:53.130718 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:01:53.132720 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:01:53.235248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m13:01:53.256172 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:01:53.257178 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:01:53.257178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:53.552151 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:01:53.558210 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:01:53.655829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m13:01:53.670832 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:01:53.671833 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:01:53.673892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:54.120818 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:01:54.122811 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:01:54.209988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m13:01:54.213983 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:01:54.213983 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:01:54.214986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:54.553694 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:01:54.555688 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:01:54.643020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m13:01:54.651978 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:01:54.651978 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:01:54.652977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:54.959043 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:01:54.963044 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:01:55.060183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950e786a-6438-4457-8c51-3725aa061111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581D4D160>]}
[0m13:01:55.062171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:55.064131 [info ] [MainThread]: 
[0m13:01:55.073129 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:01:55.074132 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:01:55.077141 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:01:55.077141 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:01:55.086126 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:01:55.088127 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:01:55.077141 => 13:01:55.087126
[0m13:01:55.088127 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:01:55.121156 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:01:55.123126 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:01:55.123126 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.PRODUCT_ID
GROUP BY CUSTOMER_ID, CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:01:55.124156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:01:55.494829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff63-0001-429e-0008-435e0001e9fa
[0m13:01:55.495829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_ID'
[0m13:01:55.495829 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:01:55.089126 => 13:01:55.495829
[0m13:01:55.496829 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:01:55.596833 [debug] [Thread-1 (]: Database Error in model customers_rank (models\marts\customers_rank.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:01:55.641040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '950e786a-6438-4457-8c51-3725aa061111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5821911F0>]}
[0m13:01:55.642552 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.customers_rank ..................... [[31mERROR[0m in 0.56s]
[0m13:01:55.644565 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:01:55.648602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:55.649605 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:01:55.649605 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m13:01:55.650605 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:01:55.651602 [info ] [MainThread]: 
[0m13:01:55.652560 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m13:01:55.653561 [debug] [MainThread]: Command end result
[0m13:01:55.663561 [info ] [MainThread]: 
[0m13:01:55.664561 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:01:55.665566 [info ] [MainThread]: 
[0m13:01:55.666560 [error] [MainThread]:   Database Error in model customers_rank (models\marts\customers_rank.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:01:55.667561 [info ] [MainThread]: 
[0m13:01:55.719110 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:01:55.721148 [debug] [MainThread]: Command `dbt run` failed at 13:01:55.721148 after 4.62 seconds
[0m13:01:55.721148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B575F3BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581DB1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581F4B620>]}
[0m13:01:55.722148 [debug] [MainThread]: Flushing usage events
[0m13:03:13.764653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA0C02CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA082AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA0B64890>]}


============================== 13:03:13.769683 | 4afe09b6-507e-4e66-8cef-b5dcefbeb263 ==============================
[0m13:03:13.769683 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:03:13.770654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m customers_rank', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:03:14.653833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afe09b6-507e-4e66-8cef-b5dcefbeb263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAD3ED1C0>]}
[0m13:03:14.740449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afe09b6-507e-4e66-8cef-b5dcefbeb263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA0D85580>]}
[0m13:03:14.741417 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:03:14.750454 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:03:14.850967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:03:14.852001 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m13:03:14.984583 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:03:14.990619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afe09b6-507e-4e66-8cef-b5dcefbeb263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAD64C110>]}
[0m13:03:15.002584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afe09b6-507e-4e66-8cef-b5dcefbeb263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAD73A5D0>]}
[0m13:03:15.003614 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:03:15.004582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afe09b6-507e-4e66-8cef-b5dcefbeb263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAD930440>]}
[0m13:03:15.005613 [info ] [MainThread]: 
[0m13:03:15.007651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:15.008651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:03:15.023212 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:03:15.023212 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:03:15.023212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:15.959570 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:03:15.961566 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:03:16.054255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m13:03:16.063246 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:03:16.064255 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:03:16.064255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:16.513064 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:03:16.514065 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:03:16.602656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m13:03:16.605653 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:03:16.606653 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:03:16.607653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:16.892449 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:03:16.898445 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:03:16.999725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m13:03:17.014661 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:03:17.015662 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:03:17.017713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:17.331414 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:03:17.334414 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:03:17.419445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m13:03:17.429508 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:03:17.430510 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:03:17.432468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:17.854882 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:03:17.857846 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:03:17.941759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afe09b6-507e-4e66-8cef-b5dcefbeb263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAD6AEC60>]}
[0m13:03:17.943803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:03:17.944768 [info ] [MainThread]: 
[0m13:03:17.948767 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:03:17.949767 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:03:17.950768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:03:17.951768 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:03:17.961768 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:03:17.962770 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:03:17.951768 => 13:03:17.962770
[0m13:03:17.963773 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:03:18.000767 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:03:18.002767 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:03:18.003770 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.PRODUCT_ID
GROUP BY c.CUSTOMER_ID, c.CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:03:18.003770 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:18.787095 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff65-0001-429e-0008-435e0001ea02
[0m13:03:18.788092 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'eBarreau' is not recognized
[0m13:03:18.789091 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:03:17.963773 => 13:03:18.788092
[0m13:03:18.789091 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:03:19.160362 [debug] [Thread-1 (]: Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:03:19.161365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afe09b6-507e-4e66-8cef-b5dcefbeb263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAD9BB080>]}
[0m13:03:19.161365 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.customers_rank ..................... [[31mERROR[0m in 1.21s]
[0m13:03:19.162495 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:03:19.165533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:19.165533 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:03:19.165533 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m13:03:19.166533 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:03:19.166533 [info ] [MainThread]: 
[0m13:03:19.167551 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m13:03:19.175559 [debug] [MainThread]: Command end result
[0m13:03:19.187559 [info ] [MainThread]: 
[0m13:03:19.187559 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:03:19.188559 [info ] [MainThread]: 
[0m13:03:19.189566 [error] [MainThread]:   Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:03:19.189566 [info ] [MainThread]: 
[0m13:03:19.190607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:03:19.192606 [debug] [MainThread]: Command `dbt run` failed at 13:03:19.192606 after 5.49 seconds
[0m13:03:19.192606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA0098BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA0B091F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA0C02CF0>]}
[0m13:03:19.193574 [debug] [MainThread]: Flushing usage events
[0m13:05:27.813537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B26B4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B2954050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B2954170>]}


============================== 13:05:27.825873 | 35308a07-ecee-4815-bd0a-bbad803245a8 ==============================
[0m13:05:27.825873 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:05:27.826874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m customers_rank', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:05:38.417557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35308a07-ecee-4815-bd0a-bbad803245a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BDDD2900>]}
[0m13:05:38.504074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35308a07-ecee-4815-bd0a-bbad803245a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF152E40>]}
[0m13:05:38.512128 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:05:38.531143 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:05:39.818710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:39.818710 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m13:05:39.953844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m13:05:39.958875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35308a07-ecee-4815-bd0a-bbad803245a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF3B71D0>]}
[0m13:05:39.983845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35308a07-ecee-4815-bd0a-bbad803245a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF446A20>]}
[0m13:05:39.984846 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:05:39.985845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35308a07-ecee-4815-bd0a-bbad803245a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF5F0680>]}
[0m13:05:39.986876 [info ] [MainThread]: 
[0m13:05:39.987861 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:05:39.989414 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:05:40.003452 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:05:40.004423 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:05:40.004423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:41.089158 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:05:41.092146 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:05:41.188688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m13:05:41.200687 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:05:41.200687 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:05:41.200687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:41.632333 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:05:41.634329 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:05:41.723557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m13:05:41.726557 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:05:41.727559 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:05:41.727559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:42.154449 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:42.158413 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:05:42.257153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m13:05:42.267697 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:05:42.268698 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:05:42.269699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:42.583038 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:05:42.584030 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:05:42.680276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m13:05:42.690265 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:05:42.693275 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:05:42.695279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:43.000710 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:05:43.004668 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:05:43.152608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35308a07-ecee-4815-bd0a-bbad803245a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF76F590>]}
[0m13:05:43.154648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:43.156599 [info ] [MainThread]: 
[0m13:05:43.186708 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:05:43.188707 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:05:43.191676 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:05:43.193635 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:05:43.213620 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:05:43.214618 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:05:43.194671 => 13:05:43.214618
[0m13:05:43.215621 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:05:43.247649 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:05:43.275570 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:05:43.276578 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.PRODUCT_ID
GROUP BY c.CUSTOMER_ID, c.CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:05:43.276578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:45.496629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff67-0001-429b-0008-435e0001dec2
[0m13:05:45.497629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'eBarreau' is not recognized
[0m13:05:45.497629 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:05:43.215621 => 13:05:45.497629
[0m13:05:45.498629 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:05:45.603943 [debug] [Thread-1 (]: Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:05:45.604487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35308a07-ecee-4815-bd0a-bbad803245a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BF8CD7F0>]}
[0m13:05:45.604487 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.customers_rank ..................... [[31mERROR[0m in 2.41s]
[0m13:05:45.605524 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:05:45.608524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:45.608524 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:05:45.609526 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m13:05:45.609526 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:05:45.610493 [info ] [MainThread]: 
[0m13:05:45.611070 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m13:05:45.612077 [debug] [MainThread]: Command end result
[0m13:05:45.624080 [info ] [MainThread]: 
[0m13:05:45.625078 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:05:45.627077 [info ] [MainThread]: 
[0m13:05:45.628102 [error] [MainThread]:   Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:05:45.629079 [info ] [MainThread]: 
[0m13:05:45.629079 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:05:45.631111 [debug] [MainThread]: Command `dbt run` failed at 13:05:45.631111 after 17.91 seconds
[0m13:05:45.631111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B0A82ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B2429070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208B0B291F0>]}
[0m13:05:45.632108 [debug] [MainThread]: Flushing usage events
[0m13:06:52.043112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A247955700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A247955490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A247957C20>]}


============================== 13:06:52.047112 | 5d6fdf6a-04cf-4806-9b02-bc5457c4571e ==============================
[0m13:06:52.047112 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:06:52.048105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m customers_rank', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:06:52.929210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d6fdf6a-04cf-4806-9b02-bc5457c4571e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A254149970>]}
[0m13:06:53.015827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d6fdf6a-04cf-4806-9b02-bc5457c4571e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A252E18440>]}
[0m13:06:53.016828 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:06:53.024828 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:06:53.135311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:06:53.136312 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m13:06:53.267834 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m13:06:53.273867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d6fdf6a-04cf-4806-9b02-bc5457c4571e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A254540320>]}
[0m13:06:53.286835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d6fdf6a-04cf-4806-9b02-bc5457c4571e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A254346B10>]}
[0m13:06:53.287834 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:06:53.288835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6fdf6a-04cf-4806-9b02-bc5457c4571e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2545306E0>]}
[0m13:06:53.291836 [info ] [MainThread]: 
[0m13:06:53.293839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:06:53.294838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:06:53.308871 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:06:53.308871 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:06:53.309901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:54.197398 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:06:54.199402 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:06:54.288147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m13:06:54.297181 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:06:54.297181 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:06:54.298179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:54.744775 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:06:54.751786 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:06:54.848359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m13:06:54.861298 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:06:54.862360 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:06:54.863337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:55.308405 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:06:55.312411 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:06:55.401108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m13:06:55.410064 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:06:55.410064 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:06:55.411064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:55.754812 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:06:55.761807 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:06:55.872494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m13:06:55.877490 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:06:55.877490 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:06:55.878489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:56.169847 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:06:56.172380 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:06:56.264993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6fdf6a-04cf-4806-9b02-bc5457c4571e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25438E6C0>]}
[0m13:06:56.264993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:06:56.266388 [info ] [MainThread]: 
[0m13:06:56.270269 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:06:56.271269 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:06:56.272286 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:06:56.272286 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:06:56.281269 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:06:56.282268 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:06:56.273306 => 13:06:56.282268
[0m13:06:56.283270 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:06:56.313311 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:06:56.315270 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:06:56.316300 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.PRODUCT_ID
GROUP BY c.CUSTOMER_ID
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:06:56.316300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:06:56.680773 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff68-0001-429a-0008-435e00020626
[0m13:06:56.681774 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 6 at position 4
'C.CUSTOMERNAME' in select clause is neither an aggregate nor in the group by clause.
[0m13:06:56.681774 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:06:56.283270 => 13:06:56.681774
[0m13:06:56.682773 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:06:56.771222 [debug] [Thread-1 (]: Database Error in model customers_rank (models\marts\customers_rank.sql)
  001104 (42601): SQL compilation error: error line 6 at position 4
  'C.CUSTOMERNAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:06:56.772218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdf6a-04cf-4806-9b02-bc5457c4571e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25427EEA0>]}
[0m13:06:56.774175 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.customers_rank ..................... [[31mERROR[0m in 0.50s]
[0m13:06:56.776179 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:06:56.782220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:56.783221 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:06:56.784221 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m13:06:56.785223 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:06:56.786215 [info ] [MainThread]: 
[0m13:06:56.788215 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m13:06:56.791179 [debug] [MainThread]: Command end result
[0m13:06:56.807171 [info ] [MainThread]: 
[0m13:06:56.809173 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:06:56.809173 [info ] [MainThread]: 
[0m13:06:56.810171 [error] [MainThread]:   Database Error in model customers_rank (models\marts\customers_rank.sql)
  001104 (42601): SQL compilation error: error line 6 at position 4
  'C.CUSTOMERNAME' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:06:56.811171 [info ] [MainThread]: 
[0m13:06:56.812171 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:06:56.814173 [debug] [MainThread]: Command `dbt run` failed at 13:06:56.813171 after 4.83 seconds
[0m13:06:56.814173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2475C9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2479B88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2546E0800>]}
[0m13:06:56.815171 [debug] [MainThread]: Flushing usage events
[0m13:07:08.484362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9CD2AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9EC57650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9EC57B90>]}


============================== 13:07:08.489391 | 48ed6548-6c01-4bf3-9236-43474c27efef ==============================
[0m13:07:08.489391 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:07:08.490359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m customers_rank', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:07:09.363350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48ed6548-6c01-4bf3-9236-43474c27efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAB54CB00>]}
[0m13:07:09.449937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48ed6548-6c01-4bf3-9236-43474c27efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9EB22840>]}
[0m13:07:09.450937 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:07:09.458865 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:07:09.568456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:07:09.569458 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m13:07:09.702079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:07:09.708114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48ed6548-6c01-4bf3-9236-43474c27efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAB5DD760>]}
[0m13:07:09.719658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48ed6548-6c01-4bf3-9236-43474c27efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAB64E240>]}
[0m13:07:09.719658 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:07:09.720689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ed6548-6c01-4bf3-9236-43474c27efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BA9DCFBC0>]}
[0m13:07:09.722692 [info ] [MainThread]: 
[0m13:07:09.723657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:07:09.725660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:07:09.739657 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:07:09.739657 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:07:09.740657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:10.609128 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:07:10.612128 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:07:10.707174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m13:07:10.716210 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:07:10.717210 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:07:10.717210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:11.030006 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:07:11.031003 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:07:11.129088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m13:07:11.142080 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:07:11.144082 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:07:11.145074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:11.597693 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:07:11.600671 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:07:11.687918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m13:07:11.692918 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:07:11.693918 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:07:11.693918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:12.000972 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:07:12.002972 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:07:12.094054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m13:07:12.102206 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:07:12.103208 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:07:12.104207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:12.430421 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:07:12.433458 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:07:12.534476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ed6548-6c01-4bf3-9236-43474c27efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAB119160>]}
[0m13:07:12.537471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:12.539459 [info ] [MainThread]: 
[0m13:07:12.542978 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:07:12.543979 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:07:12.544980 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:07:12.544980 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:07:12.553982 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:07:12.555985 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:07:12.545981 => 13:07:12.554982
[0m13:07:12.555985 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:07:12.587013 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:07:12.588981 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:07:12.588981 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.PRODUCT_ID
GROUP BY c.CUSTOMER_ID
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:07:12.590012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:07:13.313691 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff69-0001-429a-0008-435e0002063a
[0m13:07:13.313691 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'eBarreau' is not recognized
[0m13:07:13.314696 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:07:12.557014 => 13:07:13.313691
[0m13:07:13.314696 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:07:13.412916 [debug] [Thread-1 (]: Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:07:13.413915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed6548-6c01-4bf3-9236-43474c27efef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BABADAF00>]}
[0m13:07:13.413915 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.customers_rank ..................... [[31mERROR[0m in 0.87s]
[0m13:07:13.415212 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:07:13.418251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:13.418251 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:07:13.418251 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m13:07:13.419251 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:07:13.419251 [info ] [MainThread]: 
[0m13:07:13.420209 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m13:07:13.421216 [debug] [MainThread]: Command end result
[0m13:07:13.434224 [info ] [MainThread]: 
[0m13:07:13.435225 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:07:13.436170 [info ] [MainThread]: 
[0m13:07:13.482849 [error] [MainThread]:   Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:07:13.483846 [info ] [MainThread]: 
[0m13:07:13.484843 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:07:13.486877 [debug] [MainThread]: Command `dbt run` failed at 13:07:13.485844 after 5.06 seconds
[0m13:07:13.486877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B98AF5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9E839880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9EB22840>]}
[0m13:07:13.487877 [debug] [MainThread]: Flushing usage events
[0m13:07:36.723029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42CB0AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42CD59460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42CD596A0>]}


============================== 13:07:36.728027 | d555e718-a4f6-47e6-9fad-dce941f5a1bc ==============================
[0m13:07:36.728027 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:07:36.729032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m customers_rank', 'send_anonymous_usage_stats': 'True'}
[0m13:07:37.615681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd555e718-a4f6-47e6-9fad-dce941f5a1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A43974BB30>]}
[0m13:07:37.704200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd555e718-a4f6-47e6-9fad-dce941f5a1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A437368CB0>]}
[0m13:07:37.705201 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:07:37.715202 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:07:37.829796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:07:37.829796 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m13:07:37.963896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m13:07:37.969895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd555e718-a4f6-47e6-9fad-dce941f5a1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A439AFCD40>]}
[0m13:07:37.981895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd555e718-a4f6-47e6-9fad-dce941f5a1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A439852360>]}
[0m13:07:37.982895 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:07:37.983895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd555e718-a4f6-47e6-9fad-dce941f5a1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A439A10980>]}
[0m13:07:37.985897 [info ] [MainThread]: 
[0m13:07:37.986896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:07:37.987898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:07:38.005894 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:07:38.005894 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:07:38.006894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:39.307828 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:07:39.309823 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:07:39.398891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m13:07:39.430814 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:07:39.430814 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:07:39.431844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:39.769403 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:07:39.772407 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:07:39.858163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m13:07:39.869836 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:07:39.871782 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:07:39.873815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:40.600306 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m13:07:40.602354 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:07:40.686897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m13:07:40.691896 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:07:40.691896 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:07:40.691896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:41.008926 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:07:41.010890 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:07:41.100197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m13:07:41.105196 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:07:41.106200 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:07:41.107197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:41.438168 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:07:41.440167 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:07:41.519615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd555e718-a4f6-47e6-9fad-dce941f5a1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42C61A7E0>]}
[0m13:07:41.519615 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:41.520615 [info ] [MainThread]: 
[0m13:07:41.524585 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:07:41.525585 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:07:41.526585 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:07:41.527586 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:07:41.535586 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:07:41.536584 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:07:41.527586 => 13:07:41.535586
[0m13:07:41.537616 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:07:41.567623 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:07:41.570169 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:07:41.570169 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.PRODUCT_ID
GROUP BY c.CUSTOMER_ID,c.CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:07:41.570169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:07:42.323130 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff69-0001-429e-0008-435e0001ea36
[0m13:07:42.324152 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'eBarreau' is not recognized
[0m13:07:42.324152 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:07:41.537616 => 13:07:42.324152
[0m13:07:42.325152 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:07:42.419730 [debug] [Thread-1 (]: Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:07:42.419730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd555e718-a4f6-47e6-9fad-dce941f5a1bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A439A452B0>]}
[0m13:07:42.420731 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.customers_rank ..................... [[31mERROR[0m in 0.89s]
[0m13:07:42.421611 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:07:42.424990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:42.424990 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:07:42.424990 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m13:07:42.425990 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:07:42.425990 [info ] [MainThread]: 
[0m13:07:42.426974 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m13:07:42.427960 [debug] [MainThread]: Command end result
[0m13:07:42.439959 [info ] [MainThread]: 
[0m13:07:42.440961 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:07:42.441962 [info ] [MainThread]: 
[0m13:07:42.442961 [error] [MainThread]:   Database Error in model customers_rank (models\marts\customers_rank.sql)
  100038 (22018): Numeric value 'eBarreau' is not recognized
  compiled Code at target\run\practice\models\marts\customers_rank.sql
[0m13:07:42.443990 [info ] [MainThread]: 
[0m13:07:42.444967 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:07:42.445960 [debug] [MainThread]: Command `dbt run` failed at 13:07:42.445960 after 5.78 seconds
[0m13:07:42.446990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42CD3FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42CADFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42CB0AC00>]}
[0m13:07:42.446990 [debug] [MainThread]: Flushing usage events
[0m13:11:15.455303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E651055190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E651054050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E651055790>]}


============================== 13:11:15.459304 | 0e721eda-71ef-4bea-95fc-4b544d2f6432 ==============================
[0m13:11:15.459304 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:11:15.460448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m customers_rank', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:16.419339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e721eda-71ef-4bea-95fc-4b544d2f6432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65D1FAF60>]}
[0m13:11:16.515898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e721eda-71ef-4bea-95fc-4b544d2f6432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65D74FC80>]}
[0m13:11:16.516899 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:11:16.526931 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:11:16.646588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:16.647620 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m13:11:16.795136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:11:16.800206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e721eda-71ef-4bea-95fc-4b544d2f6432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65DCFC950>]}
[0m13:11:16.812747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e721eda-71ef-4bea-95fc-4b544d2f6432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65DA4E780>]}
[0m13:11:16.813757 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:11:16.814753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e721eda-71ef-4bea-95fc-4b544d2f6432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65D8BDBE0>]}
[0m13:11:16.815754 [info ] [MainThread]: 
[0m13:11:16.817790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:11:16.818756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:11:16.834754 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:11:16.834754 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:11:16.834754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:17.895983 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:11:17.898982 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:11:17.987505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m13:11:18.003514 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:11:18.004513 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:11:18.004513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:18.409664 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:11:18.416266 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:11:18.512062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m13:11:18.515062 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:11:18.516061 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:11:18.516600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:18.985848 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:11:18.987847 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:11:19.124241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m13:11:19.129240 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:11:19.129240 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:11:19.129240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.597457 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:11:19.603396 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:11:19.829327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m13:11:19.831359 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:11:19.832360 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:11:19.833359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:20.187620 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:11:20.189613 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:11:20.279796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e721eda-71ef-4bea-95fc-4b544d2f6432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65D9AEDB0>]}
[0m13:11:20.281814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:20.282739 [info ] [MainThread]: 
[0m13:11:20.286844 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:11:20.286844 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:11:20.288845 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:11:20.288845 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:11:20.296843 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:11:20.297844 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:11:20.288845 => 13:11:20.297844
[0m13:11:20.298844 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:11:20.332383 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:11:20.333382 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:11:20.334415 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (


WITH customer_revenue AS (
    SELECT
        customer_id,
        SUM(revenue) AS total_revenue
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY customer_id
)
 
SELECT
    customer_id,
    total_revenue,
    RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
FROM customer_revenue
        );
[0m13:11:20.334415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:21.282110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:11:21.302072 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:11:20.298844 => 13:11:21.302072
[0m13:11:21.302072 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:11:21.381386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e721eda-71ef-4bea-95fc-4b544d2f6432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65DF1FAD0>]}
[0m13:11:21.389032 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.customers_rank ......................... [[32mSUCCESS 1[0m in 1.09s]
[0m13:11:21.391110 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:11:21.394107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:21.395146 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:11:21.396148 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m13:11:21.396148 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:11:21.397150 [info ] [MainThread]: 
[0m13:11:21.398079 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m13:11:21.399087 [debug] [MainThread]: Command end result
[0m13:11:21.412088 [info ] [MainThread]: 
[0m13:11:21.413086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:21.414087 [info ] [MainThread]: 
[0m13:11:21.414087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:21.416116 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:21.416116 after 6.02 seconds
[0m13:11:21.416116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E64FF21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E64F2D8BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E65B887A10>]}
[0m13:11:21.417119 [debug] [MainThread]: Flushing usage events
[0m13:13:13.338994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7AF359700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7AF133590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7AF35BA70>]}


============================== 13:13:13.343574 | f94d20d7-fe12-4daf-aba2-3c0e6e40a80c ==============================
[0m13:13:13.343574 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:13:13.344572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m customers_rank', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:13:14.309618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f94d20d7-fe12-4daf-aba2-3c0e6e40a80c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BBB07AA0>]}
[0m13:13:14.396136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f94d20d7-fe12-4daf-aba2-3c0e6e40a80c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BBBE5880>]}
[0m13:13:14.397136 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:13:14.405492 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:13:14.517194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:14.517194 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m13:13:14.650672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:13:14.656711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f94d20d7-fe12-4daf-aba2-3c0e6e40a80c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7AF3B8A10>]}
[0m13:13:14.668793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f94d20d7-fe12-4daf-aba2-3c0e6e40a80c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BBD51FD0>]}
[0m13:13:14.668793 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:13:14.669794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f94d20d7-fe12-4daf-aba2-3c0e6e40a80c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BBEF3590>]}
[0m13:13:14.671791 [info ] [MainThread]: 
[0m13:13:14.672759 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:13:14.674790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:13:14.689790 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:13:14.690760 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:13:14.690760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:15.582259 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:13:15.584256 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:13:15.675762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m13:13:15.685794 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:13:15.685794 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:13:15.686793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:16.003741 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:13:16.005739 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:13:16.090737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m13:13:16.094767 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:13:16.095767 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:13:16.095767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:16.516998 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:13:16.518005 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:13:16.597236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m13:13:16.600231 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:13:16.601231 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:13:16.601231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:16.892075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:13:16.893075 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:13:16.969551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m13:13:16.972553 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:13:16.973552 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:13:16.973552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:17.285539 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:13:17.286536 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:13:17.376992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f94d20d7-fe12-4daf-aba2-3c0e6e40a80c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BBEE99A0>]}
[0m13:13:17.377991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:13:17.378993 [info ] [MainThread]: 
[0m13:13:17.381992 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m13:13:17.382992 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m13:13:17.383994 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m13:13:17.384993 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m13:13:17.393992 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m13:13:17.397002 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 13:13:17.384993 => 13:13:17.395994
[0m13:13:17.397002 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m13:13:17.434000 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m13:13:17.435000 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m13:13:17.436002 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.CUSTOMER_ID
GROUP BY c.CUSTOMER_ID,CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
        );
[0m13:13:17.436002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:13:18.275557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:13:18.299524 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 13:13:17.397993 => 13:13:18.298524
[0m13:13:18.299524 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m13:13:18.385246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f94d20d7-fe12-4daf-aba2-3c0e6e40a80c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BBF42030>]}
[0m13:13:18.385246 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.customers_rank ......................... [[32mSUCCESS 1[0m in 1.00s]
[0m13:13:18.386246 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m13:13:18.388247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:18.389278 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:13:18.389278 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m13:13:18.389278 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m13:13:18.390277 [info ] [MainThread]: 
[0m13:13:18.390277 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m13:13:18.391248 [debug] [MainThread]: Command end result
[0m13:13:18.402279 [info ] [MainThread]: 
[0m13:13:18.403247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:18.404248 [info ] [MainThread]: 
[0m13:13:18.405281 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:13:18.406247 [debug] [MainThread]: Command `dbt run` succeeded at 13:13:18.406247 after 5.13 seconds
[0m13:13:18.407247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7AF133590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BB249820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7BB6916A0>]}
[0m13:13:18.407247 [debug] [MainThread]: Flushing usage events
[0m13:15:21.621364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A2B6AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A4A54260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191A4A55070>]}


============================== 13:15:21.626365 | 4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67 ==============================
[0m13:15:21.626365 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:15:21.627308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_churnstatus', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:15:22.518256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AFDD33B0>]}
[0m13:15:22.604263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B120BB60>]}
[0m13:15:22.605263 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:15:22.613735 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:15:22.725925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:22.726925 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m13:15:22.862507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:15:22.867507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B16A8A40>]}
[0m13:15:22.879540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B1452300>]}
[0m13:15:22.880520 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:15:22.881507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B15F0DA0>]}
[0m13:15:22.882539 [info ] [MainThread]: 
[0m13:15:22.884539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:15:22.885509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:15:22.901576 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:15:22.901576 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:15:22.901576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:24.201920 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:15:24.208992 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:15:24.313573 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m13:15:24.330173 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:15:24.330173 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:15:24.331170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:24.911988 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:15:24.914017 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:15:24.995307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m13:15:25.000305 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:15:25.001304 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:15:25.002304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:25.351133 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:15:25.354090 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:15:25.439915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m13:15:25.451896 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:15:25.452844 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:15:25.453896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:25.791851 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:15:25.794894 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:15:25.893769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m13:15:25.896781 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:15:25.897767 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:15:25.897767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:26.284564 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:15:26.285535 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:15:26.402768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191AF4D8E00>]}
[0m13:15:26.403801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:26.403801 [info ] [MainThread]: 
[0m13:15:26.408802 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m13:15:26.408802 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m13:15:26.410811 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m13:15:26.410811 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m13:15:26.418841 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m13:15:26.419839 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 13:15:26.411810 => 13:15:26.419839
[0m13:15:26.420811 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m13:15:26.453360 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m13:15:26.455361 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m13:15:26.456360 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS LMCustomer_Status
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS LMCustomer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m13:15:26.456360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:26.788056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff71-0001-429a-0008-435e000206e6
[0m13:15:26.788056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 8 unexpected 'CASE'.
syntax error line 31 at position 21 unexpected 't'.
syntax error line 31 at position 35 unexpected '<='.
[0m13:15:26.789056 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 13:15:26.420811 => 13:15:26.788056
[0m13:15:26.789056 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m13:15:26.896788 [debug] [Thread-1 (]: Database Error in model mart_churnstatus (models\marts\mart_churnstatus.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 8 unexpected 'CASE'.
  syntax error line 31 at position 21 unexpected 't'.
  syntax error line 31 at position 35 unexpected '<='.
  compiled Code at target\run\practice\models\marts\mart_churnstatus.sql
[0m13:15:26.898792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d428dc9-db9b-4b5a-b6b2-74db5d2dfe67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B18BBB00>]}
[0m13:15:26.900829 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_churnstatus ................... [[31mERROR[0m in 0.49s]
[0m13:15:26.901781 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m13:15:26.905813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:26.905813 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:15:26.906780 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m13:15:26.906780 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m13:15:26.906780 [info ] [MainThread]: 
[0m13:15:26.907817 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m13:15:26.908781 [debug] [MainThread]: Command end result
[0m13:15:26.922786 [info ] [MainThread]: 
[0m13:15:26.923790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:15:26.924789 [info ] [MainThread]: 
[0m13:15:26.925786 [error] [MainThread]:   Database Error in model mart_churnstatus (models\marts\mart_churnstatus.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 8 unexpected 'CASE'.
  syntax error line 31 at position 21 unexpected 't'.
  syntax error line 31 at position 35 unexpected '<='.
  compiled Code at target\run\practice\models\marts\mart_churnstatus.sql
[0m13:15:26.926787 [info ] [MainThread]: 
[0m13:15:26.926787 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:15:26.928814 [debug] [MainThread]: Command `dbt run` failed at 13:15:26.927822 after 5.37 seconds
[0m13:15:26.928814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B15EB6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B12EDBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191B120BB60>]}
[0m13:15:26.929788 [debug] [MainThread]: Flushing usage events
[0m13:16:04.394604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03D54260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03D56BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03D554C0>]}


============================== 13:16:04.399612 | c71f00a5-6243-47e3-9757-32338242a4e7 ==============================
[0m13:16:04.399612 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:16:04.400589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_churnstatus', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:16:05.324662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c71f00a5-6243-47e3-9757-32338242a4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E10618530>]}
[0m13:16:05.412273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c71f00a5-6243-47e3-9757-32338242a4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1071B620>]}
[0m13:16:05.413275 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:16:05.421566 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:16:05.534145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:05.534145 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m13:16:05.666886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:16:05.672942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c71f00a5-6243-47e3-9757-32338242a4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E10AF48C0>]}
[0m13:16:05.684960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c71f00a5-6243-47e3-9757-32338242a4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E1084E750>]}
[0m13:16:05.684960 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:16:05.685978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c71f00a5-6243-47e3-9757-32338242a4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E10A41370>]}
[0m13:16:05.687959 [info ] [MainThread]: 
[0m13:16:05.689463 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:05.690471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:16:05.705502 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:16:05.705502 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:16:05.706501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:06.555764 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:16:06.556762 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:16:06.660192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m13:16:06.675118 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:16:06.676154 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:16:06.676154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:07.122579 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:16:07.129578 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:16:07.234376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m13:16:07.246370 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:16:07.247362 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:16:07.248358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:07.590228 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:07.594225 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:16:07.697359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m13:16:07.708032 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:16:07.710009 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:16:07.711017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:08.341040 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m13:16:08.343005 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:16:08.459750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m13:16:08.464747 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:16:08.464747 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:16:08.465748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:08.830347 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:16:08.837335 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:16:08.938603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c71f00a5-6243-47e3-9757-32338242a4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E10315310>]}
[0m13:16:08.941563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:08.943552 [info ] [MainThread]: 
[0m13:16:08.949544 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m13:16:08.949544 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m13:16:08.950545 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m13:16:08.951576 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m13:16:08.959582 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m13:16:08.961546 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 13:16:08.951576 => 13:16:08.960580
[0m13:16:08.961546 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m13:16:08.996581 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m13:16:08.998583 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m13:16:08.999613 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS LMCustomer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m13:16:08.999613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:10.719849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:16:10.741860 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 13:16:08.961546 => 13:16:10.741860
[0m13:16:10.741860 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m13:16:10.850437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71f00a5-6243-47e3-9757-32338242a4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E10CB3830>]}
[0m13:16:10.850437 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_churnstatus ....................... [[32mSUCCESS 1[0m in 1.90s]
[0m13:16:10.852439 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m13:16:10.853789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:10.853789 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:16:10.854789 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m13:16:10.854789 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m13:16:10.854789 [info ] [MainThread]: 
[0m13:16:10.855789 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m13:16:10.856822 [debug] [MainThread]: Command end result
[0m13:16:10.868791 [info ] [MainThread]: 
[0m13:16:10.869797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:10.870637 [info ] [MainThread]: 
[0m13:16:10.871675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:10.872675 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:10.872675 after 6.54 seconds
[0m13:16:10.872675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03D575C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03D554C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03D56BA0>]}
[0m13:16:10.873677 [debug] [MainThread]: Flushing usage events
[0m13:18:56.062809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CCE7AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CCE78590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CCE78A40>]}


============================== 13:18:56.066839 | fe372fd0-200f-4a64-9843-b116cf660802 ==============================
[0m13:18:56.066839 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:18:56.067841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_churnstatus', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:18:56.958928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe372fd0-200f-4a64-9843-b116cf660802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206DA7874A0>]}
[0m13:18:57.046440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe372fd0-200f-4a64-9843-b116cf660802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D854F650>]}
[0m13:18:57.047474 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:18:57.055379 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:18:57.168869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:57.168869 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_churnstatus.sql
[0m13:18:57.300455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m13:18:57.307034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe372fd0-200f-4a64-9843-b116cf660802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206D854F4D0>]}
[0m13:18:57.319004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe372fd0-200f-4a64-9843-b116cf660802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206DA952090>]}
[0m13:18:57.320005 [info ] [MainThread]: Found 7 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m13:18:57.320005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe372fd0-200f-4a64-9843-b116cf660802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206DAB30980>]}
[0m13:18:57.322005 [info ] [MainThread]: 
[0m13:18:57.324007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:18:57.325005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m13:18:57.340004 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m13:18:57.340004 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m13:18:57.341006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:58.144414 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:18:58.146414 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m13:18:58.246497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m13:18:58.270462 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m13:18:58.270462 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m13:18:58.271457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:58.710093 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:18:58.716763 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m13:18:58.809107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m13:18:58.819652 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m13:18:58.820648 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m13:18:58.822648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:59.277908 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:18:59.282910 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m13:18:59.373872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m13:18:59.387940 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m13:18:59.388939 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m13:18:59.389917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:59.699297 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:18:59.702303 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m13:18:59.793798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m13:18:59.805881 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m13:18:59.807886 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m13:18:59.808882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:00.129808 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m13:19:00.132762 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m13:19:00.221902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe372fd0-200f-4a64-9843-b116cf660802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CC73A8D0>]}
[0m13:19:00.222931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:00.223900 [info ] [MainThread]: 
[0m13:19:00.228158 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m13:19:00.229192 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_churnstatus ............................ [RUN]
[0m13:19:00.230159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_churnstatus'
[0m13:19:00.230159 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m13:19:00.238189 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m13:19:00.240160 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 13:19:00.231190 => 13:19:00.240160
[0m13:19:00.241213 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m13:19:00.273157 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m13:19:00.276159 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m13:19:00.277157 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS LM_Customer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS Ltm_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS Ltm_Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m13:19:00.278158 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:19:01.661661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:19:01.682622 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 13:19:00.242192 => 13:19:01.682622
[0m13:19:01.683622 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m13:19:01.763869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe372fd0-200f-4a64-9843-b116cf660802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206DAD9F230>]}
[0m13:19:01.765850 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_churnstatus ....................... [[32mSUCCESS 1[0m in 1.53s]
[0m13:19:01.766819 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m13:19:01.768704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:01.768704 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m13:19:01.769703 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m13:19:01.769703 [debug] [MainThread]: Connection 'model.practice.mart_churnstatus' was properly closed.
[0m13:19:01.769703 [info ] [MainThread]: 
[0m13:19:01.770756 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m13:19:01.771763 [debug] [MainThread]: Command end result
[0m13:19:01.783763 [info ] [MainThread]: 
[0m13:19:01.784762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:01.785762 [info ] [MainThread]: 
[0m13:19:01.786763 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:01.787763 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:01.787763 after 5.79 seconds
[0m13:19:01.788795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CCD7B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CB066DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206CCDA1A30>]}
[0m13:19:01.788795 [debug] [MainThread]: Flushing usage events
[0m14:14:21.633435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6BF555310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6BF5553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6BF5564B0>]}


============================== 14:14:21.678280 | 1f4d0373-77a3-4114-bb14-cc791b72745b ==============================
[0m14:14:21.678280 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:14:21.682373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_CUST_CHURN_COUNT', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:35.430913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f4d0373-77a3-4114-bb14-cc791b72745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6CB891970>]}
[0m14:14:35.517267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f4d0373-77a3-4114-bb14-cc791b72745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6C9C3BE00>]}
[0m14:14:35.526696 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:14:35.583881 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:14:37.490338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:14:37.491338 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_cust_churn_count.sql
[0m14:14:37.678771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:14:37.685766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f4d0373-77a3-4114-bb14-cc791b72745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6CBF14110>]}
[0m14:14:37.727767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f4d0373-77a3-4114-bb14-cc791b72745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6CBF3A5A0>]}
[0m14:14:37.728766 [info ] [MainThread]: Found 8 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:14:37.729769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f4d0373-77a3-4114-bb14-cc791b72745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6CC133B90>]}
[0m14:14:37.731767 [warn ] [MainThread]: The selection criterion 'mart_CUST_CHURN_COUNT' does not match any nodes
[0m14:14:37.732768 [info ] [MainThread]: 
[0m14:14:37.733766 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:14:37.734780 [debug] [MainThread]: Command end result
[0m14:14:37.744774 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:37.744774 after 16.28 seconds
[0m14:14:37.745776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6BF1F6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6CB6FBBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6CC0EB6B0>]}
[0m14:14:37.746776 [debug] [MainThread]: Flushing usage events
[0m14:15:07.115011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349FE626F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A0E23E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A0912C00>]}


============================== 14:15:07.119044 | 114b27f9-4668-47fb-a7ff-3d846c42ee6d ==============================
[0m14:15:07.119044 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:15:07.120011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_cust_churn_count', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:08.049387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '114b27f9-4668-47fb-a7ff-3d846c42ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AE88B4A0>]}
[0m14:15:08.137996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '114b27f9-4668-47fb-a7ff-3d846c42ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A0FB4680>]}
[0m14:15:08.138965 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:15:08.147997 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:15:08.255325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:08.256326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:08.257326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:15:08.263333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '114b27f9-4668-47fb-a7ff-3d846c42ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AC9A7C20>]}
[0m14:15:08.274832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '114b27f9-4668-47fb-a7ff-3d846c42ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AEA525D0>]}
[0m14:15:08.274832 [info ] [MainThread]: Found 8 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:15:08.275815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '114b27f9-4668-47fb-a7ff-3d846c42ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AE8898E0>]}
[0m14:15:08.277814 [info ] [MainThread]: 
[0m14:15:08.278817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:08.280815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:15:08.295816 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:15:08.295816 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:15:08.296848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:09.637958 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:15:09.639982 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:15:09.737563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m14:15:09.747525 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:15:09.747525 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:15:09.747525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:10.221866 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:15:10.223821 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:15:10.312767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m14:15:10.316769 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:15:10.316769 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:15:10.317767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:10.873186 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m14:15:10.880251 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:15:10.983389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m14:15:10.992972 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:15:10.993973 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:15:10.993973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:11.313447 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:15:11.317477 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:15:11.407139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m14:15:11.413141 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:15:11.414140 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:15:11.414140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:11.757841 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:11.759871 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:15:11.848073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '114b27f9-4668-47fb-a7ff-3d846c42ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AEBCCBC0>]}
[0m14:15:11.849112 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:11.849594 [info ] [MainThread]: 
[0m14:15:11.859602 [debug] [Thread-1 (]: Began running node model.practice.mart_cust_churn_count
[0m14:15:11.859602 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_cust_churn_count ....................... [RUN]
[0m14:15:11.861632 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_cust_churn_count'
[0m14:15:11.861632 [debug] [Thread-1 (]: Began compiling node model.practice.mart_cust_churn_count
[0m14:15:11.870632 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_cust_churn_count"
[0m14:15:11.873867 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (compile): 14:15:11.862635 => 14:15:11.872552
[0m14:15:11.873867 [debug] [Thread-1 (]: Began executing node model.practice.mart_cust_churn_count
[0m14:15:11.904540 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_cust_churn_count"
[0m14:15:11.915171 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_cust_churn_count"
[0m14:15:11.916169 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_cust_churn_count"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_cust_churn_count
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 1
            ELSE 0
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 1 
            ELSE 0
        END AS LM_Customer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m14:15:11.916169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:14.869236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m14:15:14.891236 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (execute): 14:15:11.874907 => 14:15:14.891236
[0m14:15:14.892235 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: Close
[0m14:15:14.970763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114b27f9-4668-47fb-a7ff-3d846c42ee6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AED83A10>]}
[0m14:15:14.971763 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_cust_churn_count .................. [[32mSUCCESS 1[0m in 3.11s]
[0m14:15:14.972765 [debug] [Thread-1 (]: Finished running node model.practice.mart_cust_churn_count
[0m14:15:14.974765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:14.975765 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:15:14.975765 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m14:15:14.975765 [debug] [MainThread]: Connection 'model.practice.mart_cust_churn_count' was properly closed.
[0m14:15:14.976764 [info ] [MainThread]: 
[0m14:15:14.977765 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m14:15:14.978766 [debug] [MainThread]: Command end result
[0m14:15:14.990765 [info ] [MainThread]: 
[0m14:15:14.991765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:14.992766 [info ] [MainThread]: 
[0m14:15:14.993765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:14.994764 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:14.994764 after 7.94 seconds
[0m14:15:14.996773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A0912C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A0F3FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234A0DC91F0>]}
[0m14:15:14.996773 [debug] [MainThread]: Flushing usage events
[0m14:18:37.298865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023300EDFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233000315E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233021593D0>]}


============================== 14:18:37.303864 | 6182c509-c4ae-4d0a-85e2-03a23f091eeb ==============================
[0m14:18:37.303864 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:18:37.304878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_cust_churn_count', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:18:38.206843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6182c509-c4ae-4d0a-85e2-03a23f091eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330C5EB710>]}
[0m14:18:38.295361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6182c509-c4ae-4d0a-85e2-03a23f091eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330E788650>]}
[0m14:18:38.296362 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:18:38.303921 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:18:38.402437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:38.403438 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_cust_churn_count.sql
[0m14:18:38.535957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:18:38.540988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6182c509-c4ae-4d0a-85e2-03a23f091eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EDDB800>]}
[0m14:18:38.552991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6182c509-c4ae-4d0a-85e2-03a23f091eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EC522A0>]}
[0m14:18:38.553957 [info ] [MainThread]: Found 8 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:18:38.554960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6182c509-c4ae-4d0a-85e2-03a23f091eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EE30980>]}
[0m14:18:38.555990 [info ] [MainThread]: 
[0m14:18:38.557988 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:38.558987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:18:38.573995 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:18:38.575006 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:18:38.575006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:39.427441 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:18:39.428424 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:18:39.523468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m14:18:39.532469 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:18:39.532469 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:18:39.532469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:39.991169 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:18:39.998170 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:18:40.090407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m14:18:40.094407 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:18:40.094407 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:18:40.095407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:40.401035 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:18:40.407034 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:18:40.513438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m14:18:40.523395 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:18:40.523395 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:18:40.524396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:40.843506 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:18:40.845601 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:18:40.938559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m14:18:40.947559 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:18:40.949505 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:18:40.951544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:41.283112 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:18:41.285112 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:18:41.369677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6182c509-c4ae-4d0a-85e2-03a23f091eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EABC2C0>]}
[0m14:18:41.370688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:41.371661 [info ] [MainThread]: 
[0m14:18:41.375687 [debug] [Thread-1 (]: Began running node model.practice.mart_cust_churn_count
[0m14:18:41.375687 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_cust_churn_count ....................... [RUN]
[0m14:18:41.377655 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_cust_churn_count'
[0m14:18:41.377655 [debug] [Thread-1 (]: Began compiling node model.practice.mart_cust_churn_count
[0m14:18:41.386661 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_cust_churn_count"
[0m14:18:41.389665 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (compile): 14:18:41.378655 => 14:18:41.388662
[0m14:18:41.389665 [debug] [Thread-1 (]: Began executing node model.practice.mart_cust_churn_count
[0m14:18:41.421937 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_cust_churn_count"
[0m14:18:41.424935 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_cust_churn_count"
[0m14:18:41.425937 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_cust_churn_count"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_cust_churn_count
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 1
            ELSE 0
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 1 
            ELSE 0
        END AS LM_Customer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT sum(LM_churn_status) as churned_last_month,
sum(L3m_churn_status) as churned_last_3_months,
sum(Ltm_churn_status) as churned_last_12_months,
sum(LM_Customer_Status) as new_customers_last_month,
sum(L3MCustomer_Status) as new_customers_last_3_months,
sum(Ltm_Customer_Status) as new_customers_last_12_months
 FROM 
churn_status
        );
[0m14:18:41.425937 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:44.315019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m14:18:44.339019 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (execute): 14:18:41.390662 => 14:18:44.338018
[0m14:18:44.339019 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: Close
[0m14:18:44.424605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6182c509-c4ae-4d0a-85e2-03a23f091eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330F0EBFB0>]}
[0m14:18:44.425604 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_cust_churn_count .................. [[32mSUCCESS 1[0m in 3.05s]
[0m14:18:44.426608 [debug] [Thread-1 (]: Finished running node model.practice.mart_cust_churn_count
[0m14:18:44.428608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:44.428608 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:18:44.429609 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m14:18:44.429609 [debug] [MainThread]: Connection 'model.practice.mart_cust_churn_count' was properly closed.
[0m14:18:44.429609 [info ] [MainThread]: 
[0m14:18:44.430606 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m14:18:44.431606 [debug] [MainThread]: Command end result
[0m14:18:44.442608 [info ] [MainThread]: 
[0m14:18:44.443609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:44.443609 [info ] [MainThread]: 
[0m14:18:44.444638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:18:44.446609 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:44.445610 after 7.21 seconds
[0m14:18:44.446609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330218B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023300DB7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330E8E8E30>]}
[0m14:18:44.447608 [debug] [MainThread]: Flushing usage events
[0m14:34:16.507868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595FD94200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595FC63E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595FD94FE0>]}


============================== 14:34:16.529265 | 5e8cc47b-26a7-4052-ba11-58e00a67e3a9 ==============================
[0m14:34:16.529265 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:34:16.531264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m revenue_loss', 'send_anonymous_usage_stats': 'True'}
[0m14:34:24.675991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e8cc47b-26a7-4052-ba11-58e00a67e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002596D74FFE0>]}
[0m14:34:24.764464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e8cc47b-26a7-4052-ba11-58e00a67e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002596D4E8470>]}
[0m14:34:24.772522 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:34:24.790411 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:34:26.063008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:34:26.064009 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\revenue_loss.sql
[0m14:34:26.197527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:34:26.203739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e8cc47b-26a7-4052-ba11-58e00a67e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002596DAF5670>]}
[0m14:34:26.228742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e8cc47b-26a7-4052-ba11-58e00a67e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002596D84E7E0>]}
[0m14:34:26.229748 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:34:26.231264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8cc47b-26a7-4052-ba11-58e00a67e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002596D268740>]}
[0m14:34:26.233306 [info ] [MainThread]: 
[0m14:34:26.234306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:26.235292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:34:26.249334 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:34:26.249334 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:34:26.250331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:27.629771 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:34:27.636293 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:34:27.736378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m14:34:27.746383 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:34:27.747383 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:34:27.747383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:28.062761 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:34:28.064757 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:34:28.158188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m14:34:28.162187 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:34:28.163188 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:34:28.163188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:28.595472 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:34:28.599469 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:34:28.694755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m14:34:28.697785 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:34:28.697785 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:34:28.698786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:28.979425 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:34:28.980418 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:34:29.072053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m14:34:29.082049 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:34:29.083991 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:34:29.085025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:29.414988 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:34:29.417986 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:34:29.508527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8cc47b-26a7-4052-ba11-58e00a67e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002596DA430B0>]}
[0m14:34:29.509527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:29.510526 [info ] [MainThread]: 
[0m14:34:29.516525 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:34:29.516525 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.revenue_loss ............................... [RUN]
[0m14:34:29.518528 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:34:29.518528 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:34:29.526527 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:34:29.527526 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:34:29.518528 => 14:34:29.527526
[0m14:34:29.528526 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:34:29.564083 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:34:29.565083 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:34:29.566084 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace   view RIDE_SHARING_DB.STAGING.revenue_loss
  
   as (
    SELECT
        CUSTOMER_ID,
        REVENUE,
        LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
  );
[0m14:34:29.566084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:30.207626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:34:30.228611 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:34:29.528526 => 14:34:30.228611
[0m14:34:30.229608 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:34:30.315667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8cc47b-26a7-4052-ba11-58e00a67e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002596DCAA810>]}
[0m14:34:30.316674 [info ] [Thread-1 (]: 1 of 1 OK created sql view model STAGING.revenue_loss .......................... [[32mSUCCESS 1[0m in 0.80s]
[0m14:34:30.319627 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:34:30.323978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:30.324978 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:34:30.325982 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m14:34:30.326990 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:34:30.326990 [info ] [MainThread]: 
[0m14:34:30.327969 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m14:34:30.329970 [debug] [MainThread]: Command end result
[0m14:34:30.342988 [info ] [MainThread]: 
[0m14:34:30.343978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:30.345490 [info ] [MainThread]: 
[0m14:34:30.346499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:34:30.347511 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:30.347511 after 13.93 seconds
[0m14:34:30.348498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595FD7FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595FA34B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595FA0B320>]}
[0m14:34:30.348498 [debug] [MainThread]: Flushing usage events
[0m14:36:27.043039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0668575F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D066855580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D066857B00>]}


============================== 14:36:27.047111 | c5538ac3-6e93-473e-bebd-4542a100dd19 ==============================
[0m14:36:27.047111 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:36:27.048131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m revenue_loss', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:27.931009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5538ac3-6e93-473e-bebd-4542a100dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07324CB30>]}
[0m14:36:28.019496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5538ac3-6e93-473e-bebd-4542a100dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07306C9B0>]}
[0m14:36:28.020497 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:36:28.028851 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:36:28.142443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:28.142443 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:36:28.274545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:36:28.279573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5538ac3-6e93-473e-bebd-4542a100dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0734568D0>]}
[0m14:36:28.292543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5538ac3-6e93-473e-bebd-4542a100dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D073352660>]}
[0m14:36:28.292543 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:36:28.293545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5538ac3-6e93-473e-bebd-4542a100dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0735429C0>]}
[0m14:36:28.295573 [info ] [MainThread]: 
[0m14:36:28.296569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:28.298573 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:36:28.314576 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:36:28.314576 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:36:28.314576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:29.340470 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:36:29.342523 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:36:29.433363 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m14:36:29.446363 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:36:29.447363 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:36:29.447363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:29.879666 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:36:29.882660 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:36:29.972967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m14:36:29.976970 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:36:29.976970 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:36:29.976970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:30.245972 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:36:30.247972 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:36:30.335770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m14:36:30.340770 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:36:30.340770 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:36:30.341770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:30.772558 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:36:30.776618 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:36:30.864671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m14:36:30.868702 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:36:30.869701 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:36:30.869701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:31.292301 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffc2-0001-429b-0008-435e0002210a
[0m14:36:31.293301 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:36:31.293301 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:36:31.294304 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:36:31.294304 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:36:31.387231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5538ac3-6e93-473e-bebd-4542a100dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07374B830>]}
[0m14:36:31.391224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:31.394717 [info ] [MainThread]: 
[0m14:36:31.408741 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:36:31.411744 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:36:31.416791 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:36:31.417779 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:36:31.434766 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:36:31.436731 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:36:31.418778 => 14:36:31.435732
[0m14:36:31.437731 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:36:31.470762 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:36:31.472728 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:36:31.472728 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (
    
    
SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
        );
[0m14:36:31.472728 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:36:33.198934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:36:33.219431 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:36:31.437731 => 14:36:33.219431
[0m14:36:33.219431 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:36:33.302001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5538ac3-6e93-473e-bebd-4542a100dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07387D130>]}
[0m14:36:33.304025 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.89s]
[0m14:36:33.306632 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:36:33.311223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:33.312279 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:36:33.312279 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m14:36:33.313240 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:36:33.314264 [info ] [MainThread]: 
[0m14:36:33.314264 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m14:36:33.316234 [debug] [MainThread]: Command end result
[0m14:36:33.329237 [info ] [MainThread]: 
[0m14:36:33.330238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:33.331265 [info ] [MainThread]: 
[0m14:36:33.332233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:36:33.333233 [debug] [MainThread]: Command `dbt run` succeeded at 14:36:33.333233 after 6.35 seconds
[0m14:36:33.334234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06683FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06688BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D06688B7A0>]}
[0m14:36:33.334234 [debug] [MainThread]: Flushing usage events
[0m14:36:49.497148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172C555280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172C555160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172C5555E0>]}


============================== 14:36:49.501179 | 390045db-1297-4bdd-9c7f-325f627db723 ==============================
[0m14:36:49.501179 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:36:49.502164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:50.375311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '390045db-1297-4bdd-9c7f-325f627db723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738E4FEF0>]}
[0m14:36:50.461961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '390045db-1297-4bdd-9c7f-325f627db723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738143140>]}
[0m14:36:50.462965 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:36:50.470598 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:36:50.575213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:36:50.576213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:36:50.577213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:36:50.583213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390045db-1297-4bdd-9c7f-325f627db723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738F11040>]}
[0m14:36:50.595183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390045db-1297-4bdd-9c7f-325f627db723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738F4EC90>]}
[0m14:36:50.595183 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:36:50.596204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390045db-1297-4bdd-9c7f-325f627db723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172C589880>]}
[0m14:36:50.598218 [info ] [MainThread]: 
[0m14:36:50.599182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:50.600213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:36:50.617183 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:36:50.618180 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:36:50.618180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:51.539370 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:36:51.543368 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:36:51.628816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m14:36:51.636785 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:36:51.636785 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:36:51.637816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:52.164363 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:36:52.166359 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:36:52.251675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m14:36:52.266766 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:36:52.267764 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:36:52.269766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:52.572988 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:36:52.574945 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:36:52.655922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m14:36:52.662931 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:36:52.662931 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:36:52.663931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:52.958646 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:36:52.962704 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:36:53.053843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m14:36:53.058878 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:36:53.058878 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:36:53.059879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:53.437952 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffc2-0001-429b-0008-435e0002211a
[0m14:36:53.437952 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:36:53.438952 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:36:53.438952 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:36:53.439951 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:36:53.525278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390045db-1297-4bdd-9c7f-325f627db723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738D80590>]}
[0m14:36:53.529280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:53.532281 [info ] [MainThread]: 
[0m14:36:53.545220 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:36:53.547254 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:36:53.549255 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:36:53.550256 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:36:53.563243 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:36:53.565252 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:36:53.551262 => 14:36:53.564244
[0m14:36:53.565252 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:36:53.599796 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:36:53.600797 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:36:53.601828 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (
    
    
SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
        );
[0m14:36:53.601828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:36:54.930306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:36:54.952267 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:36:53.565252 => 14:36:54.952267
[0m14:36:54.953268 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:36:55.061253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390045db-1297-4bdd-9c7f-325f627db723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738F13950>]}
[0m14:36:55.064259 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.51s]
[0m14:36:55.068256 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:36:55.074258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:55.076258 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:36:55.076258 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m14:36:55.077235 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:36:55.077235 [info ] [MainThread]: 
[0m14:36:55.078207 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m14:36:55.079214 [debug] [MainThread]: Command end result
[0m14:36:55.090472 [info ] [MainThread]: 
[0m14:36:55.091473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:55.092505 [info ] [MainThread]: 
[0m14:36:55.093472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:36:55.094483 [debug] [MainThread]: Command `dbt run` succeeded at 14:36:55.094483 after 5.66 seconds
[0m14:36:55.095504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002172C45B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021736BE7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021736C5A1E0>]}
[0m14:36:55.095504 [debug] [MainThread]: Flushing usage events
[0m14:42:26.092488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1666D2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B16258AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1685544A0>]}


============================== 14:42:26.097521 | 0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2 ==============================
[0m14:42:26.097521 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:42:26.098488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:27.031748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B174F4BF20>]}
[0m14:42:27.137247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B17453D970>]}
[0m14:42:27.140250 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:42:27.154244 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:42:27.260828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:27.261857 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:42:27.397375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:42:27.403383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B174FADD60>]}
[0m14:42:27.415899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B175052930>]}
[0m14:42:27.416898 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:42:27.416898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B174EC1550>]}
[0m14:42:27.418900 [info ] [MainThread]: 
[0m14:42:27.419899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:27.421901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:42:27.436897 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:42:27.437900 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:42:27.437900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:28.858368 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:42:28.861334 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:42:28.958481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m14:42:28.968514 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:42:28.968514 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:42:28.969482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:29.453938 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:42:29.457937 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:42:29.563673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m14:42:29.582680 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:42:29.584679 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:42:29.585682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:29.903756 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:42:29.905746 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:42:29.995299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m14:42:29.999297 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:42:29.999297 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:42:30.000298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:30.442636 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:42:30.447653 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:42:30.544629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m14:42:30.547621 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:42:30.547621 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:42:30.548622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:30.843060 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffc8-0001-429b-0008-435e0002215e
[0m14:42:30.844066 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:42:30.845110 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:42:30.845110 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:42:30.846110 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:42:30.927706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1753929C0>]}
[0m14:42:30.928742 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:30.929741 [info ] [MainThread]: 
[0m14:42:30.935601 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:42:30.936639 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.revenue_loss ............................... [RUN]
[0m14:42:30.938603 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:42:30.939638 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:42:30.948617 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:42:30.950615 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:42:30.939638 => 14:42:30.949619
[0m14:42:30.950615 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:42:30.981190 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:42:30.983158 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:42:30.983158 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace   view RIDE_SHARING_DB.STAGING.revenue_loss
  
   as (
    WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
)
SELECT ISNULL(PREV_REVENUE,0 ) FROM revenue_drop
  );
[0m14:42:30.984190 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:31.372022 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc8-0001-429a-0008-435e00020982
[0m14:42:31.372022 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function ISNULL
[0m14:42:31.373021 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:42:30.950615 => 14:42:31.372022
[0m14:42:31.373021 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:42:31.459332 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  002140 (42601): SQL compilation error:
  Unknown function ISNULL
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:42:31.460328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9dbe82-2181-49fb-9d66-c0b3ba1d24f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B175592E70>]}
[0m14:42:31.460867 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model STAGING.revenue_loss ...................... [[31mERROR[0m in 0.52s]
[0m14:42:31.461903 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:42:31.463873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:31.463873 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:42:31.464904 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m14:42:31.464904 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:42:31.465896 [info ] [MainThread]: 
[0m14:42:31.465896 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m14:42:31.466887 [debug] [MainThread]: Command end result
[0m14:42:31.480873 [info ] [MainThread]: 
[0m14:42:31.481875 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:42:31.482469 [info ] [MainThread]: 
[0m14:42:31.483199 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  002140 (42601): SQL compilation error:
  Unknown function ISNULL
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:42:31.484210 [info ] [MainThread]: 
[0m14:42:31.484210 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:31.486236 [debug] [MainThread]: Command `dbt run` failed at 14:42:31.486236 after 5.46 seconds
[0m14:42:31.486236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B168481AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B168267A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1682B0BC0>]}
[0m14:42:31.487239 [debug] [MainThread]: Flushing usage events
[0m14:42:56.786713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026285A5AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026285B55370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026285B55610>]}


============================== 14:42:56.790714 | 858e7582-489d-4ec1-a107-6d38d8a5eb10 ==============================
[0m14:42:56.790714 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:42:56.791768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:57.667651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '858e7582-489d-4ec1-a107-6d38d8a5eb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262924ED7F0>]}
[0m14:42:57.753197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '858e7582-489d-4ec1-a107-6d38d8a5eb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026290B308C0>]}
[0m14:42:57.754197 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:42:57.762327 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:42:57.876638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:57.877637 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:42:58.008668 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:42:58.014701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '858e7582-489d-4ec1-a107-6d38d8a5eb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026292619E20>]}
[0m14:42:58.027669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '858e7582-489d-4ec1-a107-6d38d8a5eb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026292652360>]}
[0m14:42:58.027669 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:42:58.028707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858e7582-489d-4ec1-a107-6d38d8a5eb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026290CC0EC0>]}
[0m14:42:58.030700 [info ] [MainThread]: 
[0m14:42:58.031669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:58.032700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:42:58.048670 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:42:58.048670 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:42:58.049668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:59.004296 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:42:59.006296 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:42:59.102423 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m14:42:59.125350 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:42:59.125350 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:42:59.126360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:59.571384 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:42:59.578383 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:42:59.674425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m14:42:59.679431 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:42:59.679431 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:42:59.679431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:00.153623 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:43:00.155610 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:43:00.245708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m14:43:00.248710 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:43:00.249708 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:43:00.249708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:00.572838 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:43:00.575839 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:43:01.315162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m14:43:01.322152 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:43:01.323153 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:43:01.323153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:01.641790 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffc9-0001-429b-0008-435e0002216e
[0m14:43:01.642790 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:43:01.642790 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:43:01.643795 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:43:01.643795 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:43:01.734749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858e7582-489d-4ec1-a107-6d38d8a5eb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262926929F0>]}
[0m14:43:01.737750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:01.739693 [info ] [MainThread]: 
[0m14:43:01.751473 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:43:01.753512 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.revenue_loss ............................... [RUN]
[0m14:43:01.757504 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:43:01.758460 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:43:01.773454 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:43:01.774453 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:43:01.759504 => 14:43:01.774453
[0m14:43:01.775455 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:43:01.807070 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:43:01.808069 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:43:01.809069 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace   view RIDE_SHARING_DB.STAGING.revenue_loss
  
   as (
    WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
)
SELECT COALESCE(PREV_REVENUE,0 ) FROM revenue_drop
  );
[0m14:43:01.809069 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:43:02.155599 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc9-0001-429b-0008-435e00022172
[0m14:43:02.155599 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m14:43:02.156632 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:43:01.775455 => 14:43:02.156632
[0m14:43:02.156632 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:43:02.257406 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:43:02.258402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '858e7582-489d-4ec1-a107-6d38d8a5eb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026292B7D220>]}
[0m14:43:02.260402 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model STAGING.revenue_loss ...................... [[31mERROR[0m in 0.50s]
[0m14:43:02.262366 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:43:02.267400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:02.267400 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:43:02.268397 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m14:43:02.268397 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:43:02.269397 [info ] [MainThread]: 
[0m14:43:02.270361 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m14:43:02.272358 [debug] [MainThread]: Command end result
[0m14:43:02.285359 [info ] [MainThread]: 
[0m14:43:02.286357 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:43:02.287390 [info ] [MainThread]: 
[0m14:43:02.288398 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:43:02.288398 [info ] [MainThread]: 
[0m14:43:02.289430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:43:02.290395 [debug] [MainThread]: Command `dbt run` failed at 14:43:02.290395 after 5.57 seconds
[0m14:43:02.291428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026285A5AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262927D0C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002628541A6C0>]}
[0m14:43:02.291428 [debug] [MainThread]: Flushing usage events
[0m14:45:06.258210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212BC055130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212BAECBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212BC054170>]}


============================== 14:45:06.271216 | 6744e022-3e86-40cb-a434-41a63bc2ebb9 ==============================
[0m14:45:06.271216 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:45:06.272216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:13.387276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6744e022-3e86-40cb-a434-41a63bc2ebb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C89EFF20>]}
[0m14:45:13.474348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6744e022-3e86-40cb-a434-41a63bc2ebb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212BC0B8530>]}
[0m14:45:13.483102 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:45:13.500010 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:45:14.720294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:14.720294 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:45:14.854814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:45:14.860358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6744e022-3e86-40cb-a434-41a63bc2ebb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C8569CD0>]}
[0m14:45:14.884334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6744e022-3e86-40cb-a434-41a63bc2ebb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C8B4E900>]}
[0m14:45:14.885840 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:45:14.886847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6744e022-3e86-40cb-a434-41a63bc2ebb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C8A18980>]}
[0m14:45:14.887847 [info ] [MainThread]: 
[0m14:45:14.888882 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:14.890880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:45:14.904882 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:45:14.905878 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:45:14.905878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:16.031158 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:45:16.033151 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:45:16.127636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m14:45:16.139636 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:45:16.139636 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:45:16.140634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:16.460992 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:45:16.465996 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:45:16.566508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m14:45:16.582506 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:45:16.583464 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:45:16.583464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:16.905230 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:45:16.911912 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:45:17.014374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m14:45:17.018373 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:45:17.018373 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:45:17.018373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:17.464290 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffcb-0001-429e-0008-435e0001ed7e
[0m14:45:17.465290 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:45:17.465290 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:45:17.466290 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:45:17.466290 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:45:17.568269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m14:45:17.570269 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:45:17.571270 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:45:17.571270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:18.110466 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:45:18.116549 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:45:18.224176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6744e022-3e86-40cb-a434-41a63bc2ebb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C8B8E720>]}
[0m14:45:18.228177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:18.230173 [info ] [MainThread]: 
[0m14:45:18.242454 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:45:18.243500 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.revenue_loss ............................... [RUN]
[0m14:45:18.245454 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:45:18.245454 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:45:18.253481 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:45:18.254453 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:45:18.246482 => 14:45:18.254453
[0m14:45:18.254453 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:45:18.286450 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:45:18.287450 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:45:18.288482 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace   view RIDE_SHARING_DB.STAGING.revenue_loss
  
   as (
    WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
)
SELECT COALESCE(PREV_REVENUE,0 ) as cs FROM revenue_drop
  );
[0m14:45:18.288482 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:18.973899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:45:18.995897 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:45:18.255483 => 14:45:18.995897
[0m14:45:18.996864 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:45:19.100422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6744e022-3e86-40cb-a434-41a63bc2ebb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C9079340>]}
[0m14:45:19.100422 [info ] [Thread-1 (]: 1 of 1 OK created sql view model STAGING.revenue_loss .......................... [[32mSUCCESS 1[0m in 0.85s]
[0m14:45:19.102435 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:45:19.104468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:19.104468 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:45:19.104468 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m14:45:19.105463 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:45:19.105463 [info ] [MainThread]: 
[0m14:45:19.106439 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m14:45:19.107433 [debug] [MainThread]: Command end result
[0m14:45:19.119631 [info ] [MainThread]: 
[0m14:45:19.120638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:19.121633 [info ] [MainThread]: 
[0m14:45:19.122638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:19.123632 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:19.123632 after 12.95 seconds
[0m14:45:19.124631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212BC087830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212BACF4C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212BACF7FB0>]}
[0m14:45:19.124631 [debug] [MainThread]: Flushing usage events
[0m14:45:59.779201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E7754290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E7754410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E77553D0>]}


============================== 14:45:59.784231 | 98c84fc0-0adf-4a9b-9326-865a5f765712 ==============================
[0m14:45:59.784231 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:45:59.785161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m revenue_loss', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:46:00.762114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98c84fc0-0adf-4a9b-9326-865a5f765712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2E0CE00>]}
[0m14:46:00.853704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98c84fc0-0adf-4a9b-9326-865a5f765712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2C16B70>]}
[0m14:46:00.855705 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:46:00.864204 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:46:00.978750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:46:00.978750 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:46:01.115925 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:46:01.121958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98c84fc0-0adf-4a9b-9326-865a5f765712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F43F5340>]}
[0m14:46:01.134924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98c84fc0-0adf-4a9b-9326-865a5f765712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F4152630>]}
[0m14:46:01.134924 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:46:01.135927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c84fc0-0adf-4a9b-9326-865a5f765712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F4345A00>]}
[0m14:46:01.137958 [info ] [MainThread]: 
[0m14:46:01.138958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:46:01.139957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:46:01.154959 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:46:01.155955 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:46:01.155955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:02.099494 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:46:02.101476 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:46:02.199266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m14:46:02.216259 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:46:02.217259 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:46:02.218260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:02.682334 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:46:02.689413 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:46:02.780249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m14:46:02.788249 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:46:02.789296 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:46:02.789296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:03.101059 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:46:03.103059 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:46:03.188573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m14:46:03.191581 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:46:03.193581 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:46:03.193581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:03.694661 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffcc-0001-429b-0008-435e00022182
[0m14:46:03.695693 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:46:03.695693 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:46:03.696696 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:46:03.696696 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:46:03.792638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m14:46:03.797651 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:46:03.798652 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:46:03.799651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:04.095074 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:46:04.098073 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:46:04.198718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c84fc0-0adf-4a9b-9326-865a5f765712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F4017170>]}
[0m14:46:04.200718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:04.201773 [info ] [MainThread]: 
[0m14:46:04.209356 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:46:04.210372 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:46:04.213373 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:46:04.214372 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:46:04.230371 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:46:04.232370 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:46:04.215371 => 14:46:04.231370
[0m14:46:04.233420 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:46:04.279369 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:46:04.281368 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:46:04.282370 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
)
SELECT COALESCE(PREV_REVENUE,0 ) as cs FROM revenue_drop
        );
[0m14:46:04.282370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:46:05.851599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:46:05.873596 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:46:04.233420 => 14:46:05.873596
[0m14:46:05.873596 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:46:06.003885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98c84fc0-0adf-4a9b-9326-865a5f765712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F422C830>]}
[0m14:46:06.004886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.79s]
[0m14:46:06.005885 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:46:06.007887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:06.007887 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:46:06.008919 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m14:46:06.008919 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:46:06.008919 [info ] [MainThread]: 
[0m14:46:06.009886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m14:46:06.010886 [debug] [MainThread]: Command end result
[0m14:46:06.023925 [info ] [MainThread]: 
[0m14:46:06.024925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:06.025928 [info ] [MainThread]: 
[0m14:46:06.025928 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:46:06.028519 [debug] [MainThread]: Command `dbt run` succeeded at 14:46:06.028519 after 6.31 seconds
[0m14:46:06.028519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E75660F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E71F0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E199CC50>]}
[0m14:46:06.029527 [debug] [MainThread]: Flushing usage events
[0m14:47:45.417154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5B364890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5B557F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5B555430>]}


============================== 14:47:45.421187 | 95d9ce95-7c44-498c-b4a1-738f6c1859e6 ==============================
[0m14:47:45.421187 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:47:45.422390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:47:46.305825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95d9ce95-7c44-498c-b4a1-738f6c1859e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F67F4BBF0>]}
[0m14:47:46.391437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95d9ce95-7c44-498c-b4a1-738f6c1859e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F65BF6F00>]}
[0m14:47:46.392438 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:47:46.400759 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:47:46.515375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:46.516371 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:47:46.647907 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:47:46.652913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95d9ce95-7c44-498c-b4a1-738f6c1859e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F6820F500>]}
[0m14:47:46.664945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95d9ce95-7c44-498c-b4a1-738f6c1859e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F68036AE0>]}
[0m14:47:46.665887 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:47:46.666889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d9ce95-7c44-498c-b4a1-738f6c1859e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F68240980>]}
[0m14:47:46.668888 [info ] [MainThread]: 
[0m14:47:46.669888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:47:46.670887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:47:46.685918 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:47:46.685918 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:47:46.685918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:47.726665 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:47:47.732727 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:47:47.826183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m14:47:47.838184 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:47:47.838184 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:47:47.839183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:48.230960 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffcd-0001-429a-0008-435e000209ae
[0m14:47:48.231959 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:47:48.231959 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:47:48.232959 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:47:48.232959 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:47:48.352908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m14:47:48.355947 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:47:48.355947 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:47:48.356942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:48.701034 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:47:48.708028 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:47:48.805178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m14:47:48.815330 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:47:48.815330 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:47:48.815330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:49.097733 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:47:49.099734 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:47:49.185932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m14:47:49.188935 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:47:49.189935 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:47:49.189935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:49.491033 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:47:49.493033 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:47:49.588069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d9ce95-7c44-498c-b4a1-738f6c1859e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F67F78590>]}
[0m14:47:49.589071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:49.589071 [info ] [MainThread]: 
[0m14:47:49.594084 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:47:49.595074 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:47:49.596076 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:47:49.597108 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:47:49.605071 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:47:49.606070 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:47:49.597108 => 14:47:49.606070
[0m14:47:49.606070 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:47:49.639104 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:47:49.641102 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:47:49.641102 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
with replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE
     FROM revenue_drop
)
        );
[0m14:47:49.641102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:50.148427 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffcd-0001-429b-0008-435e00022192
[0m14:47:50.149428 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 0 unexpected 'with'.
syntax error line 18 at position 8 unexpected ')'.
[0m14:47:50.150428 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:47:49.607070 => 14:47:50.149428
[0m14:47:50.150428 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:47:50.254132 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'with'.
  syntax error line 18 at position 8 unexpected ')'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:47:50.255132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d9ce95-7c44-498c-b4a1-738f6c1859e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F683386B0>]}
[0m14:47:50.256130 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.66s]
[0m14:47:50.258134 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:47:50.264140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:50.264140 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:47:50.265176 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m14:47:50.266176 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:47:50.266176 [info ] [MainThread]: 
[0m14:47:50.267165 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m14:47:50.268143 [debug] [MainThread]: Command end result
[0m14:47:50.283687 [info ] [MainThread]: 
[0m14:47:50.284661 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:47:50.285658 [info ] [MainThread]: 
[0m14:47:50.286657 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'with'.
  syntax error line 18 at position 8 unexpected ')'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:47:50.286657 [info ] [MainThread]: 
[0m14:47:50.287656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:47:50.288656 [debug] [MainThread]: Command `dbt run` failed at 14:47:50.288656 after 4.93 seconds
[0m14:47:50.289655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5B364890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F67DD7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F6836B6B0>]}
[0m14:47:50.289655 [debug] [MainThread]: Flushing usage events
[0m14:49:13.082967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F5552E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F555220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F555670>]}


============================== 14:49:13.087999 | e825af65-5b9b-4cb4-9fb9-e99781405f7b ==============================
[0m14:49:13.087999 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:49:13.088968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:13.967443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e825af65-5b9b-4cb4-9fb9-e99781405f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89BE1FAA0>]}
[0m14:49:14.056096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e825af65-5b9b-4cb4-9fb9-e99781405f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89B50DEE0>]}
[0m14:49:14.057092 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:49:14.065077 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:49:14.176561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:14.177561 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:49:14.307079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:49:14.312110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e825af65-5b9b-4cb4-9fb9-e99781405f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89BFACAD0>]}
[0m14:49:14.324631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e825af65-5b9b-4cb4-9fb9-e99781405f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89C04EB70>]}
[0m14:49:14.324631 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:49:14.325615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e825af65-5b9b-4cb4-9fb9-e99781405f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89C237440>]}
[0m14:49:14.327652 [info ] [MainThread]: 
[0m14:49:14.328617 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:49:14.330617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:49:14.344684 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:49:14.344684 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:49:14.345683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:15.302028 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:49:15.304030 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:49:15.388575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m14:49:15.397607 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:49:15.397607 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:49:15.398606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:15.680461 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:49:15.682453 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:49:15.763418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m14:49:15.767421 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:49:15.767421 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:49:15.768451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:16.187546 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:49:16.190549 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:49:16.268917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m14:49:16.273950 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:49:16.273950 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:49:16.274949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:16.586611 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffcf-0001-429e-0008-435e0001edb2
[0m14:49:16.586611 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:49:16.587576 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:49:16.587576 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:49:16.587576 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:49:16.677516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m14:49:16.679547 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:49:16.680550 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:49:16.680550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:17.128406 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:49:17.130393 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:49:17.218470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e825af65-5b9b-4cb4-9fb9-e99781405f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89C2458E0>]}
[0m14:49:17.219471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:17.220471 [info ] [MainThread]: 
[0m14:49:17.224842 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:49:17.224842 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:49:17.226850 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:49:17.226850 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:49:17.234879 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:49:17.236848 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:49:17.227880 => 14:49:17.235879
[0m14:49:17.236848 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:49:17.268083 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:49:17.270053 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:49:17.270053 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
with replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH
     FROM revenue_drop
)
SELECT 
    CUSTOMER_ID,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
    REVENUE_MONTH
FROM with replace_null
GROUP BY CUSTOMER_ID,REVENUE_MONTH
        );
[0m14:49:17.271087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:49:17.570875 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffcf-0001-429e-0008-435e0001edb6
[0m14:49:17.570875 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 0 unexpected 'with'.
syntax error line 26 at position 5 unexpected 'with'.
[0m14:49:17.571875 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:49:17.236848 => 14:49:17.571875
[0m14:49:17.571875 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:49:17.669428 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected 'with'.
  syntax error line 26 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:49:17.670434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e825af65-5b9b-4cb4-9fb9-e99781405f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89C1500B0>]}
[0m14:49:17.671428 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.44s]
[0m14:49:17.673390 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:49:17.677802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:17.678799 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:49:17.678799 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m14:49:17.679796 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:49:17.680800 [info ] [MainThread]: 
[0m14:49:17.681764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m14:49:17.682765 [debug] [MainThread]: Command end result
[0m14:49:17.696763 [info ] [MainThread]: 
[0m14:49:17.697767 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:49:17.698765 [info ] [MainThread]: 
[0m14:49:17.699765 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 0 unexpected 'with'.
  syntax error line 26 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:49:17.700765 [info ] [MainThread]: 
[0m14:49:17.701764 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:49:17.702763 [debug] [MainThread]: Command `dbt run` failed at 14:49:17.702763 after 4.68 seconds
[0m14:49:17.702763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F481910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F330200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C88F5552E0>]}
[0m14:49:17.703796 [debug] [MainThread]: Flushing usage events
[0m14:49:30.251474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9254140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9257350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A92540E0>]}


============================== 14:49:30.256449 | a53b1665-100f-4874-97f0-83c14d4b8c29 ==============================
[0m14:49:30.256449 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:49:30.257058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:31.167787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a53b1665-100f-4874-97f0-83c14d4b8c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278B5481370>]}
[0m14:49:31.257369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a53b1665-100f-4874-97f0-83c14d4b8c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278B394B620>]}
[0m14:49:31.258367 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:49:31.267370 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:49:31.381691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:31.382690 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:49:31.524291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:49:31.531290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a53b1665-100f-4874-97f0-83c14d4b8c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278B5FF5970>]}
[0m14:49:31.544806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a53b1665-100f-4874-97f0-83c14d4b8c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278B5D52A50>]}
[0m14:49:31.545807 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:49:31.546808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a53b1665-100f-4874-97f0-83c14d4b8c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278B5D526C0>]}
[0m14:49:31.547804 [info ] [MainThread]: 
[0m14:49:31.549839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:49:31.550806 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:49:31.564832 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:49:31.565836 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:49:31.565836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:32.482942 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:49:32.485942 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:49:32.586575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m14:49:32.615531 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:49:32.615531 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:49:32.615531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:33.054579 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:49:33.057579 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:49:33.153376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m14:49:33.162331 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:49:33.163333 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:49:33.164332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:33.457472 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffcf-0001-429b-0008-435e0002219a
[0m14:49:33.458473 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:49:33.458473 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:49:33.458473 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:49:33.459473 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:49:33.554692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m14:49:33.564674 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:49:33.565675 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:49:33.566676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:33.874631 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:49:33.876624 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:49:33.969946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m14:49:33.973946 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:49:33.974945 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:49:33.974945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:34.294432 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:49:34.296415 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:49:34.383627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a53b1665-100f-4874-97f0-83c14d4b8c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278B6035460>]}
[0m14:49:34.384643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:34.386604 [info ] [MainThread]: 
[0m14:49:34.392606 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:49:34.394605 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:49:34.396605 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:49:34.397606 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:49:34.412645 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:49:34.415605 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:49:34.398605 => 14:49:34.414643
[0m14:49:34.416642 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:49:34.454215 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:49:34.456183 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:49:34.456183 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH
     FROM revenue_drop
)
SELECT 
    CUSTOMER_ID,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
    REVENUE_MONTH
FROM with replace_null
GROUP BY CUSTOMER_ID,REVENUE_MONTH
        );
[0m14:49:34.457215 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:49:34.989365 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffcf-0001-429a-0008-435e000209b6
[0m14:49:34.989365 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 5 unexpected 'with'.
[0m14:49:34.990396 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:49:34.416642 => 14:49:34.989365
[0m14:49:34.990396 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:49:35.082436 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:49:35.082436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a53b1665-100f-4874-97f0-83c14d4b8c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278B6271700>]}
[0m14:49:35.083436 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.69s]
[0m14:49:35.084403 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:49:35.086407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:35.087438 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:49:35.087438 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m14:49:35.087438 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:49:35.088438 [info ] [MainThread]: 
[0m14:49:35.089404 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m14:49:35.090406 [debug] [MainThread]: Command end result
[0m14:49:35.102456 [info ] [MainThread]: 
[0m14:49:35.103405 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:49:35.104404 [info ] [MainThread]: 
[0m14:49:35.105405 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:49:35.106403 [info ] [MainThread]: 
[0m14:49:35.106403 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:49:35.108404 [debug] [MainThread]: Command `dbt run` failed at 14:49:35.108404 after 4.92 seconds
[0m14:49:35.108404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9181910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9257350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9254140>]}
[0m14:49:35.109404 [debug] [MainThread]: Flushing usage events
[0m14:50:18.437439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE30580B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE3058290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE30593D0>]}


============================== 14:50:18.441470 | b0fac58f-0bd8-4d86-98eb-4842dadfe550 ==============================
[0m14:50:18.441470 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:50:18.442482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m revenue_loss', 'send_anonymous_usage_stats': 'True'}
[0m14:50:19.314092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0fac58f-0bd8-4d86-98eb-4842dadfe550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEF2806E0>]}
[0m14:50:19.400743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0fac58f-0bd8-4d86-98eb-4842dadfe550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEF8D7C50>]}
[0m14:50:19.401745 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:50:19.410357 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:50:19.527723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:19.527723 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:50:19.667819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:50:19.673850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0fac58f-0bd8-4d86-98eb-4842dadfe550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEFD45B50>]}
[0m14:50:19.686820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0fac58f-0bd8-4d86-98eb-4842dadfe550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEFB3AC60>]}
[0m14:50:19.687853 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:50:19.688823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0fac58f-0bd8-4d86-98eb-4842dadfe550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FED701820>]}
[0m14:50:19.689855 [info ] [MainThread]: 
[0m14:50:19.691821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:19.693820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:50:19.709820 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:50:19.709820 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:50:19.710861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:20.697682 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:50:20.700721 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:50:20.807444 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m14:50:20.823420 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:50:20.823420 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:50:20.823420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:21.142033 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:50:21.148118 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:50:21.246671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m14:50:21.251668 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:50:21.252681 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:50:21.253668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:21.736625 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:50:21.739583 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:50:21.822237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m14:50:21.828238 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:50:21.828238 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:50:21.829235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:22.153823 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffd0-0001-429e-0008-435e0001edd2
[0m14:50:22.154833 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:50:22.155832 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:50:22.155832 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:50:22.156832 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:50:22.239485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m14:50:22.242485 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:50:22.242485 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:50:22.243486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:22.561425 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:50:22.565447 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:50:22.674497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0fac58f-0bd8-4d86-98eb-4842dadfe550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEFEE13A0>]}
[0m14:50:22.679046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:22.682039 [info ] [MainThread]: 
[0m14:50:22.692450 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:50:22.693451 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:50:22.696485 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:50:22.696485 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:50:22.711454 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:50:22.712446 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:50:22.697487 => 14:50:22.712446
[0m14:50:22.713448 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:50:22.748476 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:50:22.750446 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:50:22.751476 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH
     FROM revenue_drop
)
SELECT 
*
FROM with replace_null
        );
[0m14:50:22.751476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:23.064260 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd0-0001-429b-0008-435e000221aa
[0m14:50:23.065296 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 5 unexpected 'with'.
[0m14:50:23.067297 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:50:22.713448 => 14:50:23.066300
[0m14:50:23.068305 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:50:23.179171 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:50:23.181158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0fac58f-0bd8-4d86-98eb-4842dadfe550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FEFADB500>]}
[0m14:50:23.182158 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.49s]
[0m14:50:23.184116 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:50:23.188521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:23.189522 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:50:23.189522 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m14:50:23.190521 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:50:23.191519 [info ] [MainThread]: 
[0m14:50:23.192519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m14:50:23.194520 [debug] [MainThread]: Command end result
[0m14:50:23.207518 [info ] [MainThread]: 
[0m14:50:23.208522 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:23.210529 [info ] [MainThread]: 
[0m14:50:23.211550 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:50:23.212523 [info ] [MainThread]: 
[0m14:50:23.213526 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:50:23.215550 [debug] [MainThread]: Command `dbt run` failed at 14:50:23.214517 after 4.84 seconds
[0m14:50:23.215550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE1F59070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE1F01CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FE1C39880>]}
[0m14:50:23.216519 [debug] [MainThread]: Flushing usage events
[0m14:51:16.576367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CB6EAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CD4DCF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CD4DFCE0>]}


============================== 14:51:16.580374 | e2f5667f-7dd9-4b0a-8011-59b17529acd0 ==============================
[0m14:51:16.580374 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:51:16.581374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:17.462849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2f5667f-7dd9-4b0a-8011-59b17529acd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161DA14BB00>]}
[0m14:51:17.549466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2f5667f-7dd9-4b0a-8011-59b17529acd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161DA1B0470>]}
[0m14:51:17.550466 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:51:17.558259 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:51:17.670870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:17.671871 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:51:17.803491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:51:17.809491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2f5667f-7dd9-4b0a-8011-59b17529acd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161DA432420>]}
[0m14:51:17.822067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2f5667f-7dd9-4b0a-8011-59b17529acd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161DA24EB70>]}
[0m14:51:17.822067 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:51:17.823065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f5667f-7dd9-4b0a-8011-59b17529acd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161DA080980>]}
[0m14:51:17.824066 [info ] [MainThread]: 
[0m14:51:17.826100 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:17.827081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:51:17.841099 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:51:17.842098 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:51:17.842098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:18.842251 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:51:18.844290 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:51:18.933086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m14:51:18.942092 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:51:18.942092 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:51:18.943093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:19.356952 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffd1-0001-429b-0008-435e000221b2
[0m14:51:19.357952 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:51:19.358951 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:51:19.358951 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:51:19.359951 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:51:19.444148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m14:51:19.447149 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:51:19.447149 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:51:19.448179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:19.782902 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:51:19.789923 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:51:19.897450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m14:51:19.908378 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:51:19.908378 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:51:19.908378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:20.371284 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:51:20.378285 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:51:20.482989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m14:51:20.496989 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:51:20.498989 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:51:20.499931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:20.841132 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:51:20.843089 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:51:20.944501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f5667f-7dd9-4b0a-8011-59b17529acd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161DA17D8E0>]}
[0m14:51:20.946500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:20.947500 [info ] [MainThread]: 
[0m14:51:20.951821 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:51:20.952821 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:51:20.953820 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:51:20.953820 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:51:20.961821 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:51:20.963821 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:51:20.953820 => 14:51:20.962821
[0m14:51:20.964824 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:51:20.994852 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:51:20.996821 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:51:20.997854 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE
     FROM revenue_drop
)
SELECT 
*
FROM with replace_null
        );
[0m14:51:20.997854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:51:21.312181 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd1-0001-429e-0008-435e0001edd6
[0m14:51:21.313215 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 5 unexpected 'with'.
[0m14:51:21.314214 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:51:20.964824 => 14:51:21.313215
[0m14:51:21.314214 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:51:21.406833 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:51:21.407831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f5667f-7dd9-4b0a-8011-59b17529acd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161DA686060>]}
[0m14:51:21.407831 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.45s]
[0m14:51:21.409801 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:51:21.411807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:21.412806 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:51:21.412806 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m14:51:21.412806 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:51:21.413806 [info ] [MainThread]: 
[0m14:51:21.414206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m14:51:21.415215 [debug] [MainThread]: Command end result
[0m14:51:21.425790 [info ] [MainThread]: 
[0m14:51:21.426790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:51:21.427791 [info ] [MainThread]: 
[0m14:51:21.428822 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 5 unexpected 'with'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:51:21.429788 [info ] [MainThread]: 
[0m14:51:21.429788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:51:21.431791 [debug] [MainThread]: Command `dbt run` failed at 14:51:21.431791 after 4.92 seconds
[0m14:51:21.432793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CD479AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CD43CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CD4DFCE0>]}
[0m14:51:21.432793 [debug] [MainThread]: Flushing usage events
[0m14:52:28.073287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002452B155310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024529E199A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002452B1552B0>]}


============================== 14:52:28.077318 | 560c3154-43e5-43b9-ab2f-79d8e4b9798c ==============================
[0m14:52:28.077318 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:52:28.078854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:28.953620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '560c3154-43e5-43b9-ab2f-79d8e4b9798c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245375C9970>]}
[0m14:52:29.041015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '560c3154-43e5-43b9-ab2f-79d8e4b9798c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002452B1845F0>]}
[0m14:52:29.041991 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:52:29.050014 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:52:29.161566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:29.161566 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:52:29.294702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:52:29.300732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '560c3154-43e5-43b9-ab2f-79d8e4b9798c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024537AB04A0>]}
[0m14:52:29.312703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '560c3154-43e5-43b9-ab2f-79d8e4b9798c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024537B4EAB0>]}
[0m14:52:29.313702 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:52:29.314717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '560c3154-43e5-43b9-ab2f-79d8e4b9798c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024537D312B0>]}
[0m14:52:29.315735 [info ] [MainThread]: 
[0m14:52:29.316733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:29.318350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:52:29.332359 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:52:29.333358 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:52:29.333358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:30.274623 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:52:30.276620 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:52:30.365431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m14:52:30.384440 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:52:30.384440 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:52:30.385471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:30.676731 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffd2-0001-429b-0008-435e000221c2
[0m14:52:30.677733 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:52:30.677733 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:52:30.678731 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:52:30.678731 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:52:30.773625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m14:52:30.780562 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:52:30.781562 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:52:30.781562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:31.301393 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:52:31.302386 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:52:31.396322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m14:52:31.400298 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:52:31.400298 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:52:31.401296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:31.705531 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:31.708083 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:52:31.792752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m14:52:31.795758 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:52:31.796758 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:52:31.796758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:32.182024 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:52:32.185020 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:52:32.277664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '560c3154-43e5-43b9-ab2f-79d8e4b9798c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024537A4C9B0>]}
[0m14:52:32.278663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:32.279632 [info ] [MainThread]: 
[0m14:52:32.283632 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:52:32.283632 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:52:32.285632 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:52:32.285632 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:52:32.294640 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:52:32.295639 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:52:32.286633 => 14:52:32.295639
[0m14:52:32.295639 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:52:32.327268 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:52:32.328214 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:52:32.329215 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE
    FROM revenue_drop
)
SELECT 
*
FROM replace_null
        );
[0m14:52:32.329215 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:33.635900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:52:33.657864 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:52:32.296673 => 14:52:33.657864
[0m14:52:33.658862 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:52:33.789210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '560c3154-43e5-43b9-ab2f-79d8e4b9798c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024537F8D9A0>]}
[0m14:52:33.792188 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.50s]
[0m14:52:33.797261 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:52:33.803245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:33.804306 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:52:33.805307 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m14:52:33.806300 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:52:33.807301 [info ] [MainThread]: 
[0m14:52:33.808282 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m14:52:33.811256 [debug] [MainThread]: Command end result
[0m14:52:33.823802 [info ] [MainThread]: 
[0m14:52:33.824833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:33.825804 [info ] [MainThread]: 
[0m14:52:33.825804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:33.827806 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:33.827806 after 5.81 seconds
[0m14:52:33.828800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024529D05AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002452B081AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245377C39E0>]}
[0m14:52:33.828800 [debug] [MainThread]: Flushing usage events
[0m14:52:48.159922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE27C55520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE27C553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE27C55850>]}


============================== 14:52:48.163947 | 982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8 ==============================
[0m14:52:48.163947 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:52:48.165453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:49.049221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE3464CB30>]}
[0m14:52:49.139703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE322EB6B0>]}
[0m14:52:49.140737 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:52:49.149878 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:52:49.263414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:49.264412 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:52:49.400581 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m14:52:49.406582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE34218680>]}
[0m14:52:49.418704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE3473A900>]}
[0m14:52:49.418704 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:52:49.419705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE323ABE00>]}
[0m14:52:49.421736 [info ] [MainThread]: 
[0m14:52:49.422703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:49.423703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:52:49.443737 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:52:49.443737 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:52:49.444735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:50.493003 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:52:50.494002 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:52:50.587423 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m14:52:50.596424 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:52:50.597425 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:52:50.597425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:51.060987 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:51.064967 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:52:51.159999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m14:52:51.174066 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:52:51.176052 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:52:51.177064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:51.619352 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:52:51.621351 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:52:51.705667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m14:52:51.710634 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:52:51.710634 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:52:51.711636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:51.997053 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffd2-0001-429a-0008-435e000209d2
[0m14:52:51.997053 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:52:51.998053 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:52:51.998053 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:52:51.999053 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:52:52.094249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m14:52:52.103270 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:52:52.104273 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:52:52.105272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:52.421433 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:52.425435 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:52:52.515287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE344D55B0>]}
[0m14:52:52.515287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:52.516319 [info ] [MainThread]: 
[0m14:52:52.520401 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:52:52.520401 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:52:52.522408 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:52:52.522408 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:52:52.531401 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:52:52.532402 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:52:52.523402 => 14:52:52.532402
[0m14:52:52.533406 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:52:52.565403 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:52:52.566403 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:52:52.567433 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE,
    REVENUE_MONTH
     FROM revenue_drop
)
SELECT 
    CUSTOMER_ID,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
    REVENUE_MONTH
FROM replace_null
        );
[0m14:52:52.567433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:52.910227 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd2-0001-429a-0008-435e000209d6
[0m14:52:52.911244 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'REVENUE_MONTH'
[0m14:52:52.912244 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:52:52.533406 => 14:52:52.911244
[0m14:52:52.912244 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:52:53.005349 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'REVENUE_MONTH'
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:52:53.005349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '982ddcb3-d0ca-4aca-ae7b-9b67082bd5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE27CB9340>]}
[0m14:52:53.006348 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.48s]
[0m14:52:53.007319 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:52:53.010349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:53.010349 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:52:53.010349 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m14:52:53.011348 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:52:53.011348 [info ] [MainThread]: 
[0m14:52:53.012441 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m14:52:53.013448 [debug] [MainThread]: Command end result
[0m14:52:53.023995 [info ] [MainThread]: 
[0m14:52:53.025997 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:53.026996 [info ] [MainThread]: 
[0m14:52:53.026996 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'REVENUE_MONTH'
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:52:53.028026 [info ] [MainThread]: 
[0m14:52:53.028994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:52:53.029995 [debug] [MainThread]: Command `dbt run` failed at 14:52:53.029995 after 4.93 seconds
[0m14:52:53.030994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE27C87800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE27C553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE27C55520>]}
[0m14:52:53.030994 [debug] [MainThread]: Flushing usage events
[0m14:53:18.516842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39AB55340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39AA23E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39AB55220>]}


============================== 14:53:18.521874 | 6b143013-f907-45d4-a6d1-415ffc47aa4d ==============================
[0m14:53:18.521874 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:53:18.522843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:19.538618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b143013-f907-45d4-a6d1-415ffc47aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A5FC9970>]}
[0m14:53:19.681136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b143013-f907-45d4-a6d1-415ffc47aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A74B0470>]}
[0m14:53:19.682136 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:53:19.691135 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:53:19.814176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:19.815177 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:53:19.973223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:53:19.980224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b143013-f907-45d4-a6d1-415ffc47aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A77F5850>]}
[0m14:53:19.996222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b143013-f907-45d4-a6d1-415ffc47aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A754EF90>]}
[0m14:53:19.997221 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:53:19.997221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b143013-f907-45d4-a6d1-415ffc47aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A7380EC0>]}
[0m14:53:20.000224 [info ] [MainThread]: 
[0m14:53:20.003224 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:20.005224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:53:20.023234 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:53:20.023234 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:53:20.024233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:21.016460 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:53:21.018497 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:53:21.122059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m14:53:21.132597 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:53:21.132597 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:53:21.133635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:21.565824 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:53:21.568821 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:53:21.652898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m14:53:21.656898 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:53:21.656898 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:53:21.657898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:21.956017 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffd3-0001-429a-0008-435e000209ea
[0m14:53:21.957018 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:53:21.957018 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:53:21.958018 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:53:21.958018 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:53:22.045863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m14:53:22.055863 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:53:22.056865 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:53:22.057847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:22.366451 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:53:22.369410 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:53:22.451269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m14:53:22.454255 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:53:22.455258 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:53:22.455258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:22.738927 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:53:22.740920 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:53:22.829917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b143013-f907-45d4-a6d1-415ffc47aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A7837FB0>]}
[0m14:53:22.831880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:22.832450 [info ] [MainThread]: 
[0m14:53:22.839184 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:53:22.840226 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:53:22.842182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:53:22.843185 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:53:22.856334 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:53:22.858335 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:53:22.844376 => 14:53:22.857373
[0m14:53:22.859335 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:53:22.892332 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:53:22.895335 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:53:22.895335 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    CUSTOMER_ID,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
        );
[0m14:53:22.896366 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:23.365115 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd3-0001-429b-0008-435e000221f6
[0m14:53:23.366098 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[REPLACE_NULL.CUSTOMER_ID] is not a valid group by expression
[0m14:53:23.366098 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:53:22.859335 => 14:53:23.366098
[0m14:53:23.367099 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:53:23.453436 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000979 (42601): SQL compilation error:
  [REPLACE_NULL.CUSTOMER_ID] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:53:23.454436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b143013-f907-45d4-a6d1-415ffc47aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A7A93680>]}
[0m14:53:23.455436 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.61s]
[0m14:53:23.457424 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:53:23.460402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:23.461400 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:53:23.461400 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m14:53:23.462397 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:53:23.462397 [info ] [MainThread]: 
[0m14:53:23.463397 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m14:53:23.464399 [debug] [MainThread]: Command end result
[0m14:53:23.474829 [info ] [MainThread]: 
[0m14:53:23.476831 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:23.477830 [info ] [MainThread]: 
[0m14:53:23.477830 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000979 (42601): SQL compilation error:
  [REPLACE_NULL.CUSTOMER_ID] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m14:53:23.478830 [info ] [MainThread]: 
[0m14:53:23.479830 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:23.480831 [debug] [MainThread]: Command `dbt run` failed at 14:53:23.480831 after 5.03 seconds
[0m14:53:23.481833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39AA59070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39AB3FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39AA23E90>]}
[0m14:53:23.482831 [debug] [MainThread]: Flushing usage events
[0m14:57:20.312260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FA12AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FAE87B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FAE87590>]}


============================== 14:57:20.316266 | be0a5508-cda7-4f53-bb77-3b11fbd42680 ==============================
[0m14:57:20.316266 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:57:20.317349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m revenue_loss', 'send_anonymous_usage_stats': 'True'}
[0m14:57:21.212331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be0a5508-cda7-4f53-bb77-3b11fbd42680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001928874A630>]}
[0m14:57:21.298946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be0a5508-cda7-4f53-bb77-3b11fbd42680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019288080230>]}
[0m14:57:21.300916 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:57:21.308915 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:57:21.424536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:21.425537 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m14:57:21.556056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m14:57:21.562088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be0a5508-cda7-4f53-bb77-3b11fbd42680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019288BF5430>]}
[0m14:57:21.574056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be0a5508-cda7-4f53-bb77-3b11fbd42680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192889528D0>]}
[0m14:57:21.575059 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m14:57:21.576058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0a5508-cda7-4f53-bb77-3b11fbd42680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019288B40B30>]}
[0m14:57:21.578054 [info ] [MainThread]: 
[0m14:57:21.579056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:21.580057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m14:57:21.597606 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m14:57:21.598608 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m14:57:21.598608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:22.447713 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m14:57:22.450747 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m14:57:22.527959 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m14:57:22.538996 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m14:57:22.538996 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m14:57:22.539992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:22.964711 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:57:22.967717 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m14:57:23.066746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m14:57:23.080680 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m14:57:23.082747 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m14:57:23.083747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:23.392421 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:57:23.394450 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m14:57:23.477288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m14:57:23.486284 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m14:57:23.487285 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m14:57:23.488287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:23.796568 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffd7-0001-429a-0008-435e00020a02
[0m14:57:23.796568 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:57:23.797569 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:57:23.797569 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:57:23.797569 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m14:57:23.871025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m14:57:23.873025 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m14:57:23.874026 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m14:57:23.874026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:24.155190 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m14:57:24.157191 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m14:57:24.257484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0a5508-cda7-4f53-bb77-3b11fbd42680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019288BF26F0>]}
[0m14:57:24.260503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:24.263440 [info ] [MainThread]: 
[0m14:57:24.276891 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m14:57:24.279939 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m14:57:24.283885 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m14:57:24.285887 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m14:57:24.314936 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m14:57:24.317902 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 14:57:24.286888 => 14:57:24.316935
[0m14:57:24.317902 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m14:57:24.355490 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m14:57:24.357459 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m14:57:24.358491 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    CUSTOMER_ID,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    CUSTOMER_ID,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    CUSTOMER_ID,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY CUSTOMER_ID
        );
[0m14:57:24.359461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:26.365591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:57:26.387592 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 14:57:24.319450 => 14:57:26.386591
[0m14:57:26.387592 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m14:57:26.473871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0a5508-cda7-4f53-bb77-3b11fbd42680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019288E797C0>]}
[0m14:57:26.475828 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 2.19s]
[0m14:57:26.478282 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m14:57:26.482286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:26.483283 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m14:57:26.484287 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m14:57:26.485255 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m14:57:26.486250 [info ] [MainThread]: 
[0m14:57:26.488243 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m14:57:26.490268 [debug] [MainThread]: Command end result
[0m14:57:26.502252 [info ] [MainThread]: 
[0m14:57:26.503237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:26.504239 [info ] [MainThread]: 
[0m14:57:26.504239 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:57:26.506268 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:26.506268 after 6.26 seconds
[0m14:57:26.506268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FAD51910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FA954350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FAE87590>]}
[0m14:57:26.507272 [debug] [MainThread]: Flushing usage events
[0m15:13:00.008465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74D64890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74DCBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74F55250>]}


============================== 15:13:00.024450 | 4d76cb45-419c-4848-94c4-b7b3d8a76ede ==============================
[0m15:13:00.024450 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:13:00.025450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m revenue_loss', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:07.247114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d76cb45-419c-4848-94c4-b7b3d8a76ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB02D92E40>]}
[0m15:13:07.333632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d76cb45-419c-4848-94c4-b7b3d8a76ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB02F11D00>]}
[0m15:13:07.341655 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:13:07.358668 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:13:08.608226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:08.609227 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:13:08.743192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:13:08.749229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d76cb45-419c-4848-94c4-b7b3d8a76ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB047F54C0>]}
[0m15:13:08.777753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d76cb45-419c-4848-94c4-b7b3d8a76ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB04552630>]}
[0m15:13:08.777753 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:13:08.778753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d76cb45-419c-4848-94c4-b7b3d8a76ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB047379E0>]}
[0m15:13:08.780786 [info ] [MainThread]: 
[0m15:13:08.781784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:08.782786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:13:08.797784 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:13:08.797784 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:13:08.798788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:09.957514 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:13:09.959513 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:13:10.050033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:13:10.066039 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:13:10.067041 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:13:10.067041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:10.437555 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffe7-0001-429e-0008-435e0001ee42
[0m15:13:10.438555 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:13:10.438555 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:13:10.438555 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:13:10.439555 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:13:10.516705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:13:10.520706 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:13:10.520706 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:13:10.521706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.823208 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:13:10.826207 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:13:10.901575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m15:13:10.907562 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:13:10.908574 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:13:10.908574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:11.358248 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:13:11.361244 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:13:11.451578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m15:13:11.456574 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:13:11.457575 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:13:11.457575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:11.780369 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:13:11.781368 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:13:11.861387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d76cb45-419c-4848-94c4-b7b3d8a76ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74F844D0>]}
[0m15:13:11.862387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:11.862387 [info ] [MainThread]: 
[0m15:13:11.867386 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:13:11.867386 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:13:11.869386 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:13:11.869386 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:13:11.877419 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:13:11.879394 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:13:11.869386 => 15:13:11.879394
[0m15:13:11.880394 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:13:11.912644 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:13:11.914647 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:13:11.915678 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PRODUCT_FAMILY,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    PRODUCT_ID
    PRODUCT_FAMILY,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID
    PRODUCT_FAMILY,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID, PRODUCT_FAMILY
        );
[0m15:13:11.915678 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:12.322321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe7-0001-429e-0008-435e0001ee4a
[0m15:13:12.322321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'PRODUCT_FAMILY'
[0m15:13:12.323321 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:13:11.880394 => 15:13:12.323321
[0m15:13:12.323321 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:13:12.411631 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:13:12.411631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d76cb45-419c-4848-94c4-b7b3d8a76ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB04744680>]}
[0m15:13:12.412632 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.54s]
[0m15:13:12.414598 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:13:12.417597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:12.418597 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:13:12.418597 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m15:13:12.419597 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:13:12.419597 [info ] [MainThread]: 
[0m15:13:12.420849 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m15:13:12.421859 [debug] [MainThread]: Command end result
[0m15:13:12.436859 [info ] [MainThread]: 
[0m15:13:12.437858 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:13:12.438862 [info ] [MainThread]: 
[0m15:13:12.439899 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:13:12.440891 [info ] [MainThread]: 
[0m15:13:12.441918 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:13:12.442929 [debug] [MainThread]: Command `dbt run` failed at 15:13:12.442929 after 12.52 seconds
[0m15:13:12.443961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74C79220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74BC8BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74BF5AF0>]}
[0m15:13:12.443961 [debug] [MainThread]: Flushing usage events
[0m15:13:36.478476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BE4540B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BE454110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BE455550>]}


============================== 15:13:36.482508 | 74e133a3-c053-4d8e-a367-3fbcf07cbd8b ==============================
[0m15:13:36.482508 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:13:36.483394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m revenue_loss', 'send_anonymous_usage_stats': 'True'}
[0m15:13:37.361034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74e133a3-c053-4d8e-a367-3fbcf07cbd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BC848F20>]}
[0m15:13:37.447552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74e133a3-c053-4d8e-a367-3fbcf07cbd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CAB4F140>]}
[0m15:13:37.448553 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:13:37.457552 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:13:37.570096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:37.570096 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:13:37.700714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:13:37.706746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74e133a3-c053-4d8e-a367-3fbcf07cbd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CB0F5520>]}
[0m15:13:37.719292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74e133a3-c053-4d8e-a367-3fbcf07cbd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CAE52690>]}
[0m15:13:37.720291 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:13:37.720291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e133a3-c053-4d8e-a367-3fbcf07cbd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CAD18EC0>]}
[0m15:13:37.722299 [info ] [MainThread]: 
[0m15:13:37.725345 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:37.727291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:13:37.740321 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:13:37.741323 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:13:37.741323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:38.769208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:13:38.770208 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:13:38.860899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:13:38.874899 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:13:38.874899 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:13:38.875898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:39.285099 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffe7-0001-429a-0008-435e00020a46
[0m15:13:39.285099 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:13:39.286133 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:13:39.286133 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:13:39.286133 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:13:39.365047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:13:39.371048 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:13:39.372048 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:13:39.373048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:39.678554 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:13:39.682552 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:13:39.775628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m15:13:39.784578 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:13:39.785581 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:13:39.785581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:40.615331 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m15:13:40.618322 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:13:40.714760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m15:13:40.718760 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:13:40.719760 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:13:40.719760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:41.033351 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:13:41.037328 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:13:41.126300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e133a3-c053-4d8e-a367-3fbcf07cbd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CAFD0BF0>]}
[0m15:13:41.127341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:41.128311 [info ] [MainThread]: 
[0m15:13:41.132309 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:13:41.133309 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:13:41.134310 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:13:41.135344 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:13:41.146307 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:13:41.148309 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:13:41.135344 => 15:13:41.148309
[0m15:13:41.149338 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:13:41.179308 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:13:41.181313 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:13:41.182339 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,

    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0 ) as Previous_Revenue,
    PRODUCT_ID
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID, PRODUCT_FAMILY
        );
[0m15:13:41.182339 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:41.509893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe7-0001-429e-0008-435e0001ee52
[0m15:13:41.509893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 7 unexpected '('.
[0m15:13:41.510888 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:13:41.149338 => 15:13:41.510888
[0m15:13:41.510888 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:13:41.603740 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 7 unexpected '('.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:13:41.603740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e133a3-c053-4d8e-a367-3fbcf07cbd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CB3C7A10>]}
[0m15:13:41.604741 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.47s]
[0m15:13:41.605625 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:13:41.608712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:41.608712 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:13:41.608712 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m15:13:41.609713 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:13:41.609713 [info ] [MainThread]: 
[0m15:13:41.610519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m15:13:41.611527 [debug] [MainThread]: Command end result
[0m15:13:41.623563 [info ] [MainThread]: 
[0m15:13:41.624569 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:13:41.625566 [info ] [MainThread]: 
[0m15:13:41.626566 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 7 unexpected '('.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:13:41.627563 [info ] [MainThread]: 
[0m15:13:41.628571 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:13:41.629597 [debug] [MainThread]: Command `dbt run` failed at 15:13:41.629597 after 5.21 seconds
[0m15:13:41.630597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BE13A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BE381A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207BE359220>]}
[0m15:13:41.630597 [debug] [MainThread]: Flushing usage events
[0m15:15:39.856992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002904E812C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002904EE55610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002904EE552E0>]}


============================== 15:15:39.868995 | c93c1a84-645e-44e0-8d1d-04699c67169d ==============================
[0m15:15:39.868995 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:15:39.869959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:47.297783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c93c1a84-645e-44e0-8d1d-04699c67169d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002905B489970>]}
[0m15:15:47.384398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c93c1a84-645e-44e0-8d1d-04699c67169d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002905B04EB70>]}
[0m15:15:47.392666 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:15:47.409516 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:15:48.664272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:15:48.664272 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:15:48.808269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:15:48.814532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c93c1a84-645e-44e0-8d1d-04699c67169d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002905B7ED970>]}
[0m15:15:48.838503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c93c1a84-645e-44e0-8d1d-04699c67169d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002905B952690>]}
[0m15:15:48.839501 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:15:48.840504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c93c1a84-645e-44e0-8d1d-04699c67169d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002905BAD0980>]}
[0m15:15:48.842540 [info ] [MainThread]: 
[0m15:15:48.843501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:15:48.844536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:15:48.858574 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:15:48.858574 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:15:48.860117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:49.979674 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:15:49.980673 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:15:50.063648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:15:50.077166 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:15:50.078163 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:15:50.078163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:50.434529 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:15:50.436529 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:15:50.536274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:15:50.551366 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:15:50.553367 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:15:50.554364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:51.001107 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffe9-0001-429e-0008-435e0001ee62
[0m15:15:51.001107 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:15:51.002106 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:15:51.002106 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:15:51.003107 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:15:51.101005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:15:51.109997 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:15:51.110998 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:15:51.111992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:51.439067 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:15:51.443067 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:15:51.539999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m15:15:51.543997 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:15:51.545000 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:15:51.545000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:51.842015 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:15:51.849068 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:15:51.955776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c93c1a84-645e-44e0-8d1d-04699c67169d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002905BB6B200>]}
[0m15:15:51.958728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:51.960788 [info ] [MainThread]: 
[0m15:15:51.969307 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:15:51.970349 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:15:51.972312 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:15:51.973827 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:15:51.984835 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:15:51.985835 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:15:51.973827 => 15:15:51.985835
[0m15:15:51.985835 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:15:52.017834 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:15:52.019834 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:15:52.019834 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,

    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID, PRODUCT_FAMILY
        );
[0m15:15:52.020834 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:52.557622 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe9-0001-429a-0008-435e00020a56
[0m15:15:52.558619 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 21
invalid identifier 'PRODUCT_FAMILY'
[0m15:15:52.558619 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:15:51.986836 => 15:15:52.558619
[0m15:15:52.559621 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:15:52.654700 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 25 at position 21
  invalid identifier 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:15:52.655702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93c1a84-645e-44e0-8d1d-04699c67169d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002905BC6B5F0>]}
[0m15:15:52.657668 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.68s]
[0m15:15:52.659664 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:15:52.664826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:52.665826 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:15:52.666826 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:15:52.666826 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:15:52.667833 [info ] [MainThread]: 
[0m15:15:52.669792 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m15:15:52.671793 [debug] [MainThread]: Command end result
[0m15:15:52.690313 [info ] [MainThread]: 
[0m15:15:52.692332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:15:52.693316 [info ] [MainThread]: 
[0m15:15:52.694321 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  000904 (42000): SQL compilation error: error line 25 at position 21
  invalid identifier 'PRODUCT_FAMILY'
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:15:52.695315 [info ] [MainThread]: 
[0m15:15:52.696317 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:15:52.699318 [debug] [MainThread]: Command `dbt run` failed at 15:15:52.699318 after 12.93 seconds
[0m15:15:52.699318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002904EE877A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002904EB39070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002904E7FC6E0>]}
[0m15:15:52.700315 [debug] [MainThread]: Flushing usage events
[0m15:16:05.087572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF051540B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF051541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF051552B0>]}


============================== 15:16:05.091574 | 0d2760ea-525a-429d-a840-dfe0e49ea6c2 ==============================
[0m15:16:05.091574 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:16:05.092572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:16:05.963136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d2760ea-525a-429d-a840-dfe0e49ea6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF05154050>]}
[0m15:16:06.048654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d2760ea-525a-429d-a840-dfe0e49ea6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0FBE7D70>]}
[0m15:16:06.049655 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:16:06.057800 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:16:06.170929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:06.170929 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:16:06.302510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:16:06.307540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d2760ea-525a-429d-a840-dfe0e49ea6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF11E41970>]}
[0m15:16:06.320511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d2760ea-525a-429d-a840-dfe0e49ea6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF11C529C0>]}
[0m15:16:06.321513 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:16:06.322512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2760ea-525a-429d-a840-dfe0e49ea6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF11C52600>]}
[0m15:16:06.323549 [info ] [MainThread]: 
[0m15:16:06.325858 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:16:06.327860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:16:06.342868 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:16:06.342868 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:16:06.342868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:07.355176 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:16:07.356175 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:16:07.452418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:16:07.466947 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:16:07.467945 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:16:07.467945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:07.948938 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:16:07.951939 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:16:08.043477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m15:16:08.048484 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:16:08.049486 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:16:08.049486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:08.507800 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:16:08.509839 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:16:08.600663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m15:16:08.603659 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:16:08.604659 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:16:08.604659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:08.924986 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:16:08.928008 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:16:09.010861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m15:16:09.020863 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:16:09.021863 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:16:09.021863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:09.341827 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffea-0001-429a-0008-435e00020a66
[0m15:16:09.342826 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:16:09.343826 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:16:09.343826 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:16:09.344826 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:16:09.424820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2760ea-525a-429d-a840-dfe0e49ea6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF11DEBAD0>]}
[0m15:16:09.425824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:09.427427 [info ] [MainThread]: 
[0m15:16:09.434342 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:16:09.435382 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:16:09.437380 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:16:09.438383 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:16:09.453339 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:16:09.455341 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:16:09.439379 => 15:16:09.455341
[0m15:16:09.456340 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:16:09.487893 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:16:09.489863 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:16:09.490869 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,

    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID
        );
[0m15:16:09.491862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:16:12.184751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:16:12.207295 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:16:09.457347 => 15:16:12.207295
[0m15:16:12.208314 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:16:12.289474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2760ea-525a-429d-a840-dfe0e49ea6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF120AB770>]}
[0m15:16:12.291434 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 2.85s]
[0m15:16:12.292429 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:16:12.294601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:12.294601 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:16:12.295601 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m15:16:12.295601 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:16:12.295601 [info ] [MainThread]: 
[0m15:16:12.296582 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m15:16:12.297569 [debug] [MainThread]: Command end result
[0m15:16:12.309571 [info ] [MainThread]: 
[0m15:16:12.310573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:12.310573 [info ] [MainThread]: 
[0m15:16:12.311570 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:12.313572 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:12.313572 after 7.29 seconds
[0m15:16:12.314584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF0518B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF051540B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF05154290>]}
[0m15:16:12.315575 [debug] [MainThread]: Flushing usage events
[0m15:18:10.549224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFABD64890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFABF55190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFABF55610>]}


============================== 15:18:10.554258 | 697a8bf6-426d-4e72-9595-4f23a04dfb75 ==============================
[0m15:18:10.554258 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:18:10.555223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m revenue_loss', 'send_anonymous_usage_stats': 'True'}
[0m15:18:11.463221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '697a8bf6-426d-4e72-9595-4f23a04dfb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB98ECBF0>]}
[0m15:18:11.549869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '697a8bf6-426d-4e72-9595-4f23a04dfb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB96C01D0>]}
[0m15:18:11.550869 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:18:11.560161 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:18:11.673347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:11.673347 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:18:11.806968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:18:11.813545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '697a8bf6-426d-4e72-9595-4f23a04dfb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB9915E50>]}
[0m15:18:11.826530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '697a8bf6-426d-4e72-9595-4f23a04dfb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB9A4E990>]}
[0m15:18:11.826530 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:18:11.827513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '697a8bf6-426d-4e72-9595-4f23a04dfb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB9C30980>]}
[0m15:18:11.829513 [info ] [MainThread]: 
[0m15:18:11.830513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:11.831514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:18:11.846545 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:18:11.847556 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:18:11.847556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:12.767402 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:18:12.769426 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:18:12.859918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m15:18:12.869919 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:18:12.869919 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:18:12.869919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:13.186686 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:18:13.194685 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:18:13.299352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:18:13.312944 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:18:13.314962 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:18:13.316008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:13.607631 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:18:13.609584 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:18:13.695244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:18:13.699267 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:18:13.699267 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:18:13.699267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:14.131511 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:18:14.135472 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:18:14.222309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m15:18:14.238859 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:18:14.239859 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:18:14.241860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:14.540396 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffec-0001-429e-0008-435e0001eeba
[0m15:18:14.541407 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:18:14.541407 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:18:14.542392 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:18:14.542392 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:18:14.631447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '697a8bf6-426d-4e72-9595-4f23a04dfb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB97D13D0>]}
[0m15:18:14.634452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:14.636404 [info ] [MainThread]: 
[0m15:18:14.649442 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:18:14.650429 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:18:14.653429 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:18:14.654437 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:18:14.669386 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:18:14.671385 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:18:14.654437 => 15:18:14.670385
[0m15:18:14.671385 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:18:14.703383 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:18:14.705384 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:18:14.706384 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH
        );
[0m15:18:14.706384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:16.319851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:18:16.352472 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:18:14.671385 => 15:18:16.352472
[0m15:18:16.353472 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:18:16.442894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '697a8bf6-426d-4e72-9595-4f23a04dfb75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB99DA060>]}
[0m15:18:16.443893 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.79s]
[0m15:18:16.445924 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:18:16.447921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:16.448921 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:18:16.448921 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m15:18:16.449925 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:18:16.450926 [info ] [MainThread]: 
[0m15:18:16.451886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m15:18:16.453929 [debug] [MainThread]: Command end result
[0m15:18:16.466890 [info ] [MainThread]: 
[0m15:18:16.467887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:16.468931 [info ] [MainThread]: 
[0m15:18:16.468931 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:16.470916 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:16.470916 after 5.98 seconds
[0m15:18:16.470916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFABC3CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFABDC91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFB987D250>]}
[0m15:18:16.471915 [debug] [MainThread]: Flushing usage events
[0m15:18:53.905828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F7B55670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F7B54110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F7B57EF0>]}


============================== 15:18:53.910382 | dc70a973-2f48-4745-be40-195f9cae0f83 ==============================
[0m15:18:53.910382 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:18:53.911350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m revenue_loss', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:54.785586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc70a973-2f48-4745-be40-195f9cae0f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002428454F140>]}
[0m15:18:54.871202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc70a973-2f48-4745-be40-195f9cae0f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242840686B0>]}
[0m15:18:54.872197 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:18:54.880297 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:18:54.993025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:54.994026 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:18:55.128128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:18:55.133093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc70a973-2f48-4745-be40-195f9cae0f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024284841970>]}
[0m15:18:55.145093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc70a973-2f48-4745-be40-195f9cae0f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002428464E930>]}
[0m15:18:55.146092 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:18:55.147095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc70a973-2f48-4745-be40-195f9cae0f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024282138EC0>]}
[0m15:18:55.148129 [info ] [MainThread]: 
[0m15:18:55.150096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:55.151093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:18:55.166095 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:18:55.166095 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:18:55.166095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:56.033113 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:18:56.035113 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:18:56.251045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:18:56.264048 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:18:56.264048 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:18:56.265045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:56.679980 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffec-0001-429e-0008-435e0001eeca
[0m15:18:56.680980 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:18:56.680980 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:18:56.681980 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:18:56.681980 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:18:56.773319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:18:56.783341 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:18:56.784311 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:18:56.785313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:57.092032 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:18:57.093997 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:18:57.183204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:18:57.187204 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:18:57.187204 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:18:57.187204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:57.482532 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:18:57.485534 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:18:57.572316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:18:57.586317 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:18:57.588317 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:18:57.589292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:58.057581 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:18:58.060616 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:18:58.149152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc70a973-2f48-4745-be40-195f9cae0f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024284A43A10>]}
[0m15:18:58.150152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:58.151120 [info ] [MainThread]: 
[0m15:18:58.155121 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:18:58.155121 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:18:58.157127 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:18:58.157127 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:18:58.165123 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:18:58.166123 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:18:58.158125 => 15:18:58.166123
[0m15:18:58.167125 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:18:58.197165 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:18:58.200155 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:18:58.200155 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PAYMENT_MONTH
        );
[0m15:18:58.201154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:58.884361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:58.908347 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:18:58.167125 => 15:18:58.908347
[0m15:18:58.909345 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:18:58.986719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc70a973-2f48-4745-be40-195f9cae0f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024284B797C0>]}
[0m15:18:58.987715 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 0.83s]
[0m15:18:58.988715 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:18:58.990717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:58.991750 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:18:58.991750 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:18:58.991750 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:18:58.992747 [info ] [MainThread]: 
[0m15:18:58.992747 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m15:18:58.993731 [debug] [MainThread]: Command end result
[0m15:18:59.006717 [info ] [MainThread]: 
[0m15:18:59.007733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:59.008719 [info ] [MainThread]: 
[0m15:18:59.009723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:59.011717 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:59.010716 after 5.17 seconds
[0m15:18:59.011717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F79CB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F7B83890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F7839070>]}
[0m15:18:59.012718 [debug] [MainThread]: Flushing usage events
[0m15:21:07.101471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D361B55340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D361B54080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D361B577D0>]}


============================== 15:21:07.106471 | c3783f5a-0ba5-40eb-bab5-05e808e02d3e ==============================
[0m15:21:07.106471 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:21:07.107438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:21:08.052793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3783f5a-0ba5-40eb-bab5-05e808e02d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36E519970>]}
[0m15:21:08.141416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3783f5a-0ba5-40eb-bab5-05e808e02d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36E423920>]}
[0m15:21:08.142416 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:21:08.150670 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:21:08.261121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:08.261121 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:21:08.397836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:21:08.403836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3783f5a-0ba5-40eb-bab5-05e808e02d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36E7EC140>]}
[0m15:21:08.416392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3783f5a-0ba5-40eb-bab5-05e808e02d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36E6529F0>]}
[0m15:21:08.416392 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:21:08.417390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3783f5a-0ba5-40eb-bab5-05e808e02d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36E6527E0>]}
[0m15:21:08.419427 [info ] [MainThread]: 
[0m15:21:08.420423 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:08.421422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:21:08.437422 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:21:08.437422 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:21:08.437422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:09.374535 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:21:09.376530 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:21:09.461755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m15:21:09.470787 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:21:09.470787 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:21:09.471787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:09.783591 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:21:09.784630 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:21:09.871284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m15:21:09.881327 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:21:09.882325 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:21:09.883327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:10.315464 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffef-0001-429a-0008-435e00020aaa
[0m15:21:10.315464 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:21:10.316499 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:21:10.317499 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:21:10.317499 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:21:10.408234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:21:10.411242 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:21:10.411242 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:21:10.412242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:10.725077 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:21:10.749859 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:21:10.839786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m15:21:10.847786 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:21:10.847786 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:21:10.848787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:11.212622 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:21:11.215621 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:21:11.304887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3783f5a-0ba5-40eb-bab5-05e808e02d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36141A720>]}
[0m15:21:11.305924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:11.306894 [info ] [MainThread]: 
[0m15:21:11.311414 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:21:11.311414 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:21:11.313413 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:21:11.313413 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:21:11.322019 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:21:11.323041 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:21:11.313413 => 15:21:11.323041
[0m15:21:11.323991 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:21:11.354988 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:21:11.357023 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:21:11.357023 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH
        );
[0m15:21:11.357987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:12.093340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:21:12.165605 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:21:11.323991 => 15:21:12.165605
[0m15:21:12.166600 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:21:12.248651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3783f5a-0ba5-40eb-bab5-05e808e02d3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36EB6BEF0>]}
[0m15:21:12.250653 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 0.94s]
[0m15:21:12.252713 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:21:12.255713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:12.256717 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:21:12.257712 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m15:21:12.258713 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:21:12.258713 [info ] [MainThread]: 
[0m15:21:12.260702 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m15:21:12.261705 [debug] [MainThread]: Command end result
[0m15:21:12.272681 [info ] [MainThread]: 
[0m15:21:12.291107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:12.292101 [info ] [MainThread]: 
[0m15:21:12.293100 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:12.294101 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:12.294101 after 5.26 seconds
[0m15:21:12.295131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D361B878F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3617F7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3614FC6E0>]}
[0m15:21:12.295131 [debug] [MainThread]: Flushing usage events
[0m15:21:53.806320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8EC57C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8EC54CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8EC57560>]}


============================== 15:21:53.811328 | 5396f1c2-bf60-4384-8f6f-20eadd98a28d ==============================
[0m15:21:53.811328 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:21:53.812294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:54.711032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5396f1c2-bf60-4384-8f6f-20eadd98a28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9B15A810>]}
[0m15:21:54.801543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5396f1c2-bf60-4384-8f6f-20eadd98a28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9B15A810>]}
[0m15:21:54.802544 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:21:54.811550 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:21:54.922736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:54.923736 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:21:55.059252 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:21:55.065252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5396f1c2-bf60-4384-8f6f-20eadd98a28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9B835760>]}
[0m15:21:55.078253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5396f1c2-bf60-4384-8f6f-20eadd98a28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9B652840>]}
[0m15:21:55.079285 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:21:55.080252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5396f1c2-bf60-4384-8f6f-20eadd98a28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9B480EC0>]}
[0m15:21:55.081251 [info ] [MainThread]: 
[0m15:21:55.083253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:55.085284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:21:55.099284 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:21:55.100285 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:21:55.100285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:56.326777 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:21:56.328784 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:21:57.542884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m15:21:57.551916 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:21:57.552916 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:21:57.552916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:57.993026 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:21:57.994026 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:21:58.080342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m15:21:58.097339 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:21:58.098375 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:21:58.099381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:58.523171 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:21:58.525197 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:21:58.608753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:21:58.612779 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:21:58.612779 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:21:58.613778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:58.904502 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01baffef-0001-429e-0008-435e0001ef0e
[0m15:21:58.905501 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:21:58.905501 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:21:58.906469 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:21:58.906469 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:21:58.994066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:21:58.996070 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:21:58.997066 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:21:58.997066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:00.516049 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:22:00.520048 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:22:00.609581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5396f1c2-bf60-4384-8f6f-20eadd98a28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9B9348C0>]}
[0m15:22:00.610582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:00.611566 [info ] [MainThread]: 
[0m15:22:00.615297 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:22:00.615297 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:22:00.617305 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:22:00.617305 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:22:00.625304 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:22:00.628305 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:22:00.617305 => 15:22:00.627321
[0m15:22:00.628305 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:22:00.658382 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:22:00.660345 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:22:00.660345 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

 SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
        );
[0m15:22:00.661347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:02.008204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:22:02.031203 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:22:00.629307 => 15:22:02.031203
[0m15:22:02.032201 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:22:02.120660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5396f1c2-bf60-4384-8f6f-20eadd98a28d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9B845A60>]}
[0m15:22:02.122665 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.50s]
[0m15:22:02.126665 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:22:02.131694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:02.132705 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:22:02.132705 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m15:22:02.133701 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:22:02.134696 [info ] [MainThread]: 
[0m15:22:02.135667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m15:22:02.137696 [debug] [MainThread]: Command end result
[0m15:22:02.156659 [info ] [MainThread]: 
[0m15:22:02.159661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:02.160659 [info ] [MainThread]: 
[0m15:22:02.161692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:02.163733 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:02.163733 after 8.42 seconds
[0m15:22:02.164735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8EB81B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8EB21880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B8E93CCE0>]}
[0m15:22:02.164735 [debug] [MainThread]: Flushing usage events
[0m15:23:06.135573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F1E62C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F2F541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F2F54050>]}


============================== 15:23:06.140575 | ae3aede3-311c-4712-bb2f-10eb8a42b6bc ==============================
[0m15:23:06.140575 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:23:06.141575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:07.065494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae3aede3-311c-4712-bb2f-10eb8a42b6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E480721970>]}
[0m15:23:07.156039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae3aede3-311c-4712-bb2f-10eb8a42b6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48066CE90>]}
[0m15:23:07.158041 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:23:07.166112 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:23:07.271727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:07.272726 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:23:07.408857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:23:07.414889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae3aede3-311c-4712-bb2f-10eb8a42b6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48081B320>]}
[0m15:23:07.426857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae3aede3-311c-4712-bb2f-10eb8a42b6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48094E690>]}
[0m15:23:07.426857 [info ] [MainThread]: Found 9 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:23:07.427857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae3aede3-311c-4712-bb2f-10eb8a42b6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E480B47B30>]}
[0m15:23:07.429858 [info ] [MainThread]: 
[0m15:23:07.430860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:07.432891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:23:07.446889 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:23:07.447889 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:23:07.447889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:08.493449 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:23:08.496452 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:23:08.587219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m15:23:08.596219 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:23:08.596219 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:23:08.596219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:08.956887 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:23:08.957917 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:23:09.069966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m15:23:09.074004 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:23:09.075004 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:23:09.075004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:09.515823 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:23:09.518813 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:23:09.593497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:23:09.598499 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:23:09.598499 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:23:09.599499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:09.896393 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff1-0001-429e-0008-435e0001ef22
[0m15:23:09.896393 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:23:09.897393 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:23:09.897393 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:23:09.897393 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:23:09.978612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:23:09.988612 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:23:09.989551 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:23:09.991547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:10.274839 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:23:10.276870 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:23:10.355676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae3aede3-311c-4712-bb2f-10eb8a42b6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4809925A0>]}
[0m15:23:10.357683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:10.359676 [info ] [MainThread]: 
[0m15:23:10.365040 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:23:10.366040 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:23:10.367041 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:23:10.367041 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:23:10.376040 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:23:10.377040 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:23:10.368074 => 15:23:10.377040
[0m15:23:10.378043 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:23:10.408685 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:23:10.410652 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:23:10.410652 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH
        );
[0m15:23:10.411657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:11.148925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:23:11.172904 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:23:10.378043 => 15:23:11.172904
[0m15:23:11.173883 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:23:11.248988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae3aede3-311c-4712-bb2f-10eb8a42b6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E480DE7830>]}
[0m15:23:11.249985 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 0.88s]
[0m15:23:11.250952 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:23:11.252953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:11.253988 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:23:11.253988 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m15:23:11.254986 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:23:11.254986 [info ] [MainThread]: 
[0m15:23:11.255954 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m15:23:11.256954 [debug] [MainThread]: Command end result
[0m15:23:11.269955 [info ] [MainThread]: 
[0m15:23:11.270954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:11.271953 [info ] [MainThread]: 
[0m15:23:11.272951 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:23:11.273953 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:11.273953 after 5.20 seconds
[0m15:23:11.274953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F2CDEB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F2DC99A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F27911F0>]}
[0m15:23:11.274953 [debug] [MainThread]: Flushing usage events
[0m15:25:26.781730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D0212C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D0857560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D0857B00>]}


============================== 15:25:26.786762 | ac532ef6-dfab-4cc4-b22e-0c8e91069e02 ==============================
[0m15:25:26.786762 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:25:26.787762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m fiscal_year', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:25:27.708991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac532ef6-dfab-4cc4-b22e-0c8e91069e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DB097AA0>]}
[0m15:25:27.798308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac532ef6-dfab-4cc4-b22e-0c8e91069e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DD1056D0>]}
[0m15:25:27.799309 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:25:27.808569 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:25:27.924293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:25:27.924293 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\fiscal_year.sql
[0m15:25:28.061423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:25:28.067456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac532ef6-dfab-4cc4-b22e-0c8e91069e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DD1E73E0>]}
[0m15:25:28.080425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac532ef6-dfab-4cc4-b22e-0c8e91069e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DD34EA50>]}
[0m15:25:28.081425 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:25:28.081425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac532ef6-dfab-4cc4-b22e-0c8e91069e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DD547B00>]}
[0m15:25:28.083425 [info ] [MainThread]: 
[0m15:25:28.084425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:28.086426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:25:28.102423 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:25:28.102423 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:25:28.102423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:29.162028 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:25:29.165025 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:25:29.271983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m15:25:29.286984 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:25:29.286984 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:25:29.289983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:30.038483 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m15:25:30.045481 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:25:30.138911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:25:30.148871 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:25:30.148871 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:25:30.149865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:30.460585 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:25:30.464588 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:25:30.551254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:25:30.559879 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:25:30.559879 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:25:30.560879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:30.980709 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:25:30.982702 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:25:31.073193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:25:31.077247 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:25:31.077247 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:25:31.077247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:31.500015 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff3-0001-429a-0008-435e00020ae2
[0m15:25:31.501016 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:25:31.502016 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:25:31.502016 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:25:31.503015 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:25:31.583466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac532ef6-dfab-4cc4-b22e-0c8e91069e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DD545E50>]}
[0m15:25:31.584465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:31.584465 [info ] [MainThread]: 
[0m15:25:31.588464 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:25:31.589437 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.fiscal_year ................................ [RUN]
[0m15:25:31.590438 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:25:31.591477 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:25:31.599470 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:25:31.600439 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:25:31.591477 => 15:25:31.600439
[0m15:25:31.601439 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:25:31.632473 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:25:31.634440 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:25:31.635471 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace   view RIDE_SHARING_DB.STAGING.fiscal_year
  
   as (
    WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year;
[0m15:25:31.635471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:31.941168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff3-0001-429e-0008-435e0001ef3e
[0m15:25:31.942169 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 15 unexpected ';'.
[0m15:25:31.943216 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:25:31.601439 => 15:25:31.943216
[0m15:25:31.944217 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:25:32.028102 [debug] [Thread-1 (]: Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 15 unexpected ';'.
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:25:32.029106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac532ef6-dfab-4cc4-b22e-0c8e91069e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DD7B9D30>]}
[0m15:25:32.029106 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model STAGING.fiscal_year ....................... [[31mERROR[0m in 0.44s]
[0m15:25:32.031071 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:25:32.033071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:32.034102 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:25:32.034102 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m15:25:32.034102 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:25:32.035102 [info ] [MainThread]: 
[0m15:25:32.035102 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m15:25:32.037102 [debug] [MainThread]: Command end result
[0m15:25:32.048109 [info ] [MainThread]: 
[0m15:25:32.049108 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:32.050112 [info ] [MainThread]: 
[0m15:25:32.051110 [error] [MainThread]:   Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 15 unexpected ';'.
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:25:32.051110 [info ] [MainThread]: 
[0m15:25:32.052153 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:25:32.053109 [debug] [MainThread]: Command `dbt run` failed at 15:25:32.053109 after 5.34 seconds
[0m15:25:32.054140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CA725AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285DD107B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D0324CE0>]}
[0m15:25:32.054140 [debug] [MainThread]: Flushing usage events
[0m15:25:39.586220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D656F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D655430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D657FE0>]}


============================== 15:25:39.591221 | b243884c-422d-4233-8e33-374f70e1aad2 ==============================
[0m15:25:39.591221 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:25:39.592221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m fiscal_year', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:40.565142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b243884c-422d-4233-8e33-374f70e1aad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0A38A270>]}
[0m15:25:40.657456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b243884c-422d-4233-8e33-374f70e1aad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0A2D7FB0>]}
[0m15:25:40.658459 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:25:40.667494 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:25:40.781591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:40.782590 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:25:40.918107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:25:40.924107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b243884c-422d-4233-8e33-374f70e1aad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0A7F5BE0>]}
[0m15:25:40.936107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b243884c-422d-4233-8e33-374f70e1aad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0A54EB10>]}
[0m15:25:40.937108 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:25:40.938107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b243884c-422d-4233-8e33-374f70e1aad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0A7409B0>]}
[0m15:25:40.940106 [info ] [MainThread]: 
[0m15:25:40.941106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:40.942108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:25:40.957109 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:25:40.957109 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:25:40.958108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:41.584936 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:25:41.586936 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:25:41.685405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:25:41.695407 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:25:41.695407 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:25:41.696437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:42.141414 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:25:42.143444 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:25:42.243526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:25:42.247524 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:25:42.248523 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:25:42.249523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:42.542090 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff3-0001-429b-0008-435e00022222
[0m15:25:42.542090 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:25:42.543062 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:25:42.543062 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:25:42.544088 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:25:42.630647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:25:42.633648 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:25:42.633648 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:25:42.633648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:42.959912 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:25:42.961912 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:25:43.048856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:25:43.052853 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:25:43.053853 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:25:43.053853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:43.858349 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:25:43.859346 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:25:43.944164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b243884c-422d-4233-8e33-374f70e1aad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0A86CB30>]}
[0m15:25:43.945161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:43.946149 [info ] [MainThread]: 
[0m15:25:43.950161 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:25:43.950161 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.fiscal_year ................................ [RUN]
[0m15:25:43.951159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:25:43.952132 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:25:43.960131 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:25:43.962131 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:25:43.952132 => 15:25:43.961131
[0m15:25:43.962131 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:25:43.994718 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:25:43.996751 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:25:43.996751 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace   view RIDE_SHARING_DB.STAGING.fiscal_year
  
   as (
    WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
  );
[0m15:25:43.997753 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:44.476697 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff3-0001-429a-0008-435e00020ae6
[0m15:25:44.477698 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 12
invalid identifier 'PAYMENT_DATE'
[0m15:25:44.477698 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:25:43.963132 => 15:25:44.477698
[0m15:25:44.477698 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:25:44.569600 [debug] [Thread-1 (]: Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:25:44.569600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b243884c-422d-4233-8e33-374f70e1aad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0A03C9B0>]}
[0m15:25:44.570600 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model STAGING.fiscal_year ....................... [[31mERROR[0m in 0.62s]
[0m15:25:44.571602 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:25:44.574636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:44.575635 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:25:44.575635 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m15:25:44.575635 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:25:44.576631 [info ] [MainThread]: 
[0m15:25:44.577600 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m15:25:44.577600 [debug] [MainThread]: Command end result
[0m15:25:44.590143 [info ] [MainThread]: 
[0m15:25:44.591141 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:44.592176 [info ] [MainThread]: 
[0m15:25:44.593140 [error] [MainThread]:   Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:25:44.594142 [info ] [MainThread]: 
[0m15:25:44.594142 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:25:44.596143 [debug] [MainThread]: Command `dbt run` failed at 15:25:44.596143 after 5.09 seconds
[0m15:25:44.597174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D0F0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D3DFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D2CB5C0>]}
[0m15:25:44.597174 [debug] [MainThread]: Flushing usage events
[0m15:26:23.195062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018951C55850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018951C55610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018951C57440>]}


============================== 15:26:23.200095 | 4605f753-ed75-453c-884d-e08d6e119515 ==============================
[0m15:26:23.200095 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:26:23.201063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m fiscal_year', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:26:24.108726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4605f753-ed75-453c-884d-e08d6e119515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895E215760>]}
[0m15:26:24.196340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4605f753-ed75-453c-884d-e08d6e119515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895CDF0200>]}
[0m15:26:24.198340 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:26:24.206309 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:26:24.317925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:24.318926 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:26:24.454447 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:26:24.460446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4605f753-ed75-453c-884d-e08d6e119515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895E9F5DF0>]}
[0m15:26:24.473447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4605f753-ed75-453c-884d-e08d6e119515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895E74EE40>]}
[0m15:26:24.473447 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:26:24.474447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4605f753-ed75-453c-884d-e08d6e119515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895C5908F0>]}
[0m15:26:24.476477 [info ] [MainThread]: 
[0m15:26:24.477446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:24.478448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:26:24.493455 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:26:24.493455 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:26:24.494453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:25.910921 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:26:25.911922 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:26:26.024443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m15:26:26.034442 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:26:26.035444 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:26:26.035444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:26.328257 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:26:26.330256 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:26:26.411514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:26:26.422516 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:26:26.423526 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:26:26.424556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:26.884853 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:26:26.890873 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:26:26.984620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:26:26.988620 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:26:26.989622 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:26:26.989622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:27.400043 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:26:27.401036 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:26:27.483755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:26:27.487752 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:26:27.487752 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:26:27.488752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:27.764201 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff4-0001-429e-0008-435e0001ef56
[0m15:26:27.765201 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:26:27.765201 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:26:27.766204 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:26:27.767201 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:26:27.863632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4605f753-ed75-453c-884d-e08d6e119515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895EA393A0>]}
[0m15:26:27.866643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:27.869582 [info ] [MainThread]: 
[0m15:26:27.883794 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:26:27.885800 [info ] [Thread-1 (]: 1 of 1 START sql view model STAGING.fiscal_year ................................ [RUN]
[0m15:26:27.889752 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:26:27.891782 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:26:27.905774 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:26:27.907738 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:26:27.891782 => 15:26:27.907738
[0m15:26:27.908738 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:26:27.942365 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:26:27.944354 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:26:27.944354 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace   view RIDE_SHARING_DB.STAGING.fiscal_year
  
   as (
    WITH first_payment AS (
    SELECT
        customer_id,
        MIN(PAYMENT_MONTH) AS first_payment_date
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
  );
[0m15:26:27.945386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:28.377282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:26:28.419236 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:26:27.908738 => 15:26:28.418234
[0m15:26:28.419236 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:26:28.505174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4605f753-ed75-453c-884d-e08d6e119515', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895EC93920>]}
[0m15:26:28.506175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model STAGING.fiscal_year ........................... [[32mSUCCESS 1[0m in 0.62s]
[0m15:26:28.507171 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:26:28.509199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:28.509199 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:26:28.510203 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m15:26:28.510203 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:26:28.510203 [info ] [MainThread]: 
[0m15:26:28.511198 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m15:26:28.512169 [debug] [MainThread]: Command end result
[0m15:26:28.525172 [info ] [MainThread]: 
[0m15:26:28.526181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:28.527179 [info ] [MainThread]: 
[0m15:26:28.528063 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:28.529069 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:28.529069 after 5.40 seconds
[0m15:26:28.530101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018951C83890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895CC58260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895E93E9F0>]}
[0m15:26:28.530101 [debug] [MainThread]: Flushing usage events
[0m15:26:53.109221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022787CEFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227890552E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022789055730>]}


============================== 15:26:53.114213 | c050cae7-baa3-4d8c-a672-56a1a448b249 ==============================
[0m15:26:53.114213 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:26:53.115188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m fiscal_year', 'send_anonymous_usage_stats': 'True'}
[0m15:26:54.029849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c050cae7-baa3-4d8c-a672-56a1a448b249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227956ED5B0>]}
[0m15:26:54.119294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c050cae7-baa3-4d8c-a672-56a1a448b249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227952D70B0>]}
[0m15:26:54.121262 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:26:54.129302 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:26:54.244292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:54.244292 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:26:54.487458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:26:54.493445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c050cae7-baa3-4d8c-a672-56a1a448b249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022795CFDAF0>]}
[0m15:26:54.505196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c050cae7-baa3-4d8c-a672-56a1a448b249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022795A52690>]}
[0m15:26:54.505196 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:26:54.506195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c050cae7-baa3-4d8c-a672-56a1a448b249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022793AD8EC0>]}
[0m15:26:54.508235 [info ] [MainThread]: 
[0m15:26:54.510196 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:54.511195 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:26:54.525261 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:26:54.526292 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:26:54.526292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:55.606593 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:26:55.611624 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:26:55.722122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m15:26:55.733713 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:26:55.733713 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:26:55.733713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:56.050562 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:26:56.052550 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:26:56.148788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:26:56.157725 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:26:56.158757 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:26:56.158757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:56.814765 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:26:56.818800 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:26:56.958818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:26:56.968848 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:26:56.969848 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:26:56.970853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:57.266604 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff4-0001-429a-0008-435e00020b62
[0m15:26:57.266604 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:26:57.267601 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:26:57.267601 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:26:57.268569 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:26:57.366806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:26:57.368806 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:26:57.369806 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:26:57.369806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:57.661252 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:26:57.663248 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:26:57.752024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c050cae7-baa3-4d8c-a672-56a1a448b249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022795D93F50>]}
[0m15:26:57.755023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:57.756969 [info ] [MainThread]: 
[0m15:26:57.766961 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:26:57.767961 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:26:57.768960 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:26:57.769992 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:26:57.777959 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:26:57.779962 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:26:57.769992 => 15:26:57.779962
[0m15:26:57.780959 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:26:57.810995 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:26:57.812958 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:26:57.813988 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        MIN(PAYMENT_MONTH) AS first_payment_date
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m15:26:57.813988 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:58.634011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:26:58.654044 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:26:57.780959 => 15:26:58.653044
[0m15:26:58.654044 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:26:58.760870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c050cae7-baa3-4d8c-a672-56a1a448b249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022795F97B00>]}
[0m15:26:58.760870 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.fiscal_year ............................ [[32mSUCCESS 1[0m in 0.99s]
[0m15:26:58.761870 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:26:58.778871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:58.779870 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:26:58.779870 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:26:58.779870 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:26:58.784871 [info ] [MainThread]: 
[0m15:26:58.791875 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m15:26:58.794877 [debug] [MainThread]: Command end result
[0m15:26:58.821873 [info ] [MainThread]: 
[0m15:26:58.825874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:58.827871 [info ] [MainThread]: 
[0m15:26:58.827871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:58.829873 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:58.829873 after 5.78 seconds
[0m15:26:58.830904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022787AD0BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022787DD9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278903FF80>]}
[0m15:26:58.830904 [debug] [MainThread]: Flushing usage events
[0m15:29:41.524929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152A2EC2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152A4B551F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152A4B55520>]}


============================== 15:29:41.528964 | dd887029-bd19-42a8-b94a-ac72b8191892 ==============================
[0m15:29:41.528964 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:29:41.530107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fiscal_year', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:42.443973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd887029-bd19-42a8-b94a-ac72b8191892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B1381970>]}
[0m15:29:42.533997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd887029-bd19-42a8-b94a-ac72b8191892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B13EEF30>]}
[0m15:29:42.545248 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:29:42.575546 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:29:43.899652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:43.899652 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:29:44.032400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:29:44.038890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd887029-bd19-42a8-b94a-ac72b8191892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B16EB200>]}
[0m15:29:44.066372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd887029-bd19-42a8-b94a-ac72b8191892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B1536BD0>]}
[0m15:29:44.066372 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:29:44.067372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd887029-bd19-42a8-b94a-ac72b8191892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B1320EC0>]}
[0m15:29:44.069372 [info ] [MainThread]: 
[0m15:29:44.070373 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:44.072378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:29:44.087373 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:29:44.088371 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:29:44.088371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:45.766555 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:29:45.772545 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:29:45.873898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m15:29:45.893928 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:29:45.894888 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:29:45.894888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:46.346375 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:29:46.348374 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:29:46.429275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m15:29:46.433275 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:29:46.433275 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:29:46.433275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:46.872310 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff7-0001-429e-0008-435e0001effa
[0m15:29:46.873309 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:29:46.873309 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:29:46.873309 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:29:46.874308 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:29:46.965643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:29:46.972582 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:29:46.972582 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:29:46.973613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:47.270189 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:29:47.273166 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:29:47.363538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m15:29:47.373560 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:29:47.373560 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:29:47.374559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:47.679330 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:29:47.681331 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:29:47.766259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd887029-bd19-42a8-b94a-ac72b8191892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B18CAAE0>]}
[0m15:29:47.767229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:47.768262 [info ] [MainThread]: 
[0m15:29:47.773086 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:29:47.774086 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:29:47.775115 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:29:47.775115 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:29:47.784114 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:29:47.785082 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:29:47.776084 => 15:29:47.785082
[0m15:29:47.785082 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:29:47.816114 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:29:47.818082 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:29:47.819115 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        MIN(PAYMENT_MONTH) AS first_payment_date
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        YEAR(first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m15:29:47.819115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:48.637585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:29:48.659557 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:29:47.786114 => 15:29:48.659557
[0m15:29:48.660556 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:29:48.745387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd887029-bd19-42a8-b94a-ac72b8191892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B1A774A0>]}
[0m15:29:48.746388 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.fiscal_year ............................ [[32mSUCCESS 1[0m in 0.97s]
[0m15:29:48.747355 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:29:48.749387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:48.749387 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:29:48.750387 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m15:29:48.750387 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:29:48.751390 [info ] [MainThread]: 
[0m15:29:48.751390 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m15:29:48.753357 [debug] [MainThread]: Command end result
[0m15:29:48.765360 [info ] [MainThread]: 
[0m15:29:48.766358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:48.767360 [info ] [MainThread]: 
[0m15:29:48.767360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:29:48.768524 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:48.768524 after 7.31 seconds
[0m15:29:48.769562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001529ED3CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152A4819910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152A4B8B740>]}
[0m15:29:48.769562 [debug] [MainThread]: Flushing usage events
[0m15:30:32.380255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108E6654050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108E6654290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108E66576E0>]}


============================== 15:30:32.393258 | afa54f7a-6d51-47ca-9abc-6ce0addfde17 ==============================
[0m15:30:32.393258 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:30:32.394226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m fiscal_year', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:30:39.662256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afa54f7a-6d51-47ca-9abc-6ce0addfde17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F1DD3E90>]}
[0m15:30:39.751864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afa54f7a-6d51-47ca-9abc-6ce0addfde17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F171F0E0>]}
[0m15:30:39.752864 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:30:39.761898 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:30:39.875480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:39.876480 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:30:40.013063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:30:40.019068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afa54f7a-6d51-47ca-9abc-6ce0addfde17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F33FDB80>]}
[0m15:30:40.030070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afa54f7a-6d51-47ca-9abc-6ce0addfde17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F3152960>]}
[0m15:30:40.031579 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:30:40.032589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afa54f7a-6d51-47ca-9abc-6ce0addfde17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108E66B8980>]}
[0m15:30:40.034600 [info ] [MainThread]: 
[0m15:30:40.035587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:30:40.036589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:30:40.051618 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:30:40.051618 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:30:40.052620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:41.062199 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:30:41.064199 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:30:41.152438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:30:41.164438 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:30:41.165438 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:30:41.166439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:41.470162 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff8-0001-429e-0008-435e0001f002
[0m15:30:41.471215 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:30:41.473160 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:30:41.474203 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:30:41.475203 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:30:41.576268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:30:41.586273 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:30:41.587247 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:30:41.589242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:42.049523 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:30:42.051531 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:30:42.139776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:30:42.150419 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:30:42.150419 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:30:42.150419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:42.733697 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:30:42.737758 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:30:42.831591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:30:42.838646 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:30:42.839645 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:30:42.839645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:43.177725 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:30:43.180724 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:30:43.274468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afa54f7a-6d51-47ca-9abc-6ce0addfde17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F3492E10>]}
[0m15:30:43.275506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:43.276505 [info ] [MainThread]: 
[0m15:30:43.282568 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:30:43.283608 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:30:43.285580 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:30:43.286606 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:30:43.299604 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:30:43.301584 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:30:43.287608 => 15:30:43.301584
[0m15:30:43.302568 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:30:43.334597 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:30:43.336567 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:30:43.336567 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        MIN(PAYMENT_MONTH) AS first_payment_date
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        YEAR(first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m15:30:43.337606 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:44.893212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:30:44.938163 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:30:43.302568 => 15:30:44.938163
[0m15:30:44.938163 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:30:45.024668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afa54f7a-6d51-47ca-9abc-6ce0addfde17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F30B9100>]}
[0m15:30:45.024668 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.fiscal_year ............................ [[32mSUCCESS 1[0m in 1.74s]
[0m15:30:45.025668 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:30:45.027637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:45.028667 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:30:45.028667 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m15:30:45.028667 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:30:45.029668 [info ] [MainThread]: 
[0m15:30:45.030642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m15:30:45.031638 [debug] [MainThread]: Command end result
[0m15:30:45.044644 [info ] [MainThread]: 
[0m15:30:45.045644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:45.046655 [info ] [MainThread]: 
[0m15:30:45.047643 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:30:45.048643 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:45.048643 after 12.74 seconds
[0m15:30:45.048643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108E62F7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108F19F0DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000108E6128BC0>]}
[0m15:30:45.049644 [debug] [MainThread]: Flushing usage events
[0m15:31:40.358098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA957AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA954350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA955400>]}


============================== 15:31:40.362640 | 380dc42f-96af-469f-923a-65d7551e30b6 ==============================
[0m15:31:40.362640 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:31:40.363646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m fiscal_year', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:41.269149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '380dc42f-96af-469f-923a-65d7551e30b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0134BD10>]}
[0m15:31:41.357185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '380dc42f-96af-469f-923a-65d7551e30b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFFBBBA10>]}
[0m15:31:41.358188 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:31:41.366667 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:31:41.482732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:41.483734 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:31:41.625255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:31:41.630251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '380dc42f-96af-469f-923a-65d7551e30b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF014144D0>]}
[0m15:31:41.642251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '380dc42f-96af-469f-923a-65d7551e30b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF01452600>]}
[0m15:31:41.642251 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:31:41.643252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380dc42f-96af-469f-923a-65d7551e30b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0131B6B0>]}
[0m15:31:41.645251 [info ] [MainThread]: 
[0m15:31:41.646250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:31:41.648257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:31:41.662760 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:31:41.662760 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:31:41.663766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:42.575163 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:31:42.582162 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:31:42.675218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:31:42.684249 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:31:42.684249 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:31:42.685251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:43.092006 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafff9-0001-429e-0008-435e0002300e
[0m15:31:43.093002 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:31:43.094001 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:31:43.094001 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:31:43.094001 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:31:43.174936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:31:43.176936 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:31:43.177936 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:31:43.177936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:43.620157 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:31:43.622206 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:31:43.702742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:31:43.705742 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:31:43.706773 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:31:43.706773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:44.000344 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:31:44.003298 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:31:44.208919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:31:44.216923 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:31:44.217882 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:31:44.218881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:44.536757 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:31:44.538757 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:31:44.696758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380dc42f-96af-469f-923a-65d7551e30b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF014F42C0>]}
[0m15:31:44.697797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:44.698224 [info ] [MainThread]: 
[0m15:31:44.702403 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:31:44.702403 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:31:44.704444 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:31:44.704444 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:31:44.712441 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:31:44.714416 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:31:44.704444 => 15:31:44.713444
[0m15:31:44.714416 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:31:44.746411 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:31:44.748410 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:31:44.748410 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        MIN(PAYMENT_MONTH) AS first_payment_date,
        YEAR(first_payment_date) AS fiscal_year
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
)
SELECT
    fiscal_year,
    COUNT(customer_id) AS first_payment
FROM
    new_customers_by_fy
GROUP BY fiscal_year
        );
[0m15:31:44.749410 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:45.113859 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff9-0001-429a-0008-435e00020bfe
[0m15:31:45.114860 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'NEW_CUSTOMERS_BY_FY' does not exist or not authorized.
[0m15:31:45.115859 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:31:44.714416 => 15:31:45.114860
[0m15:31:45.115859 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:31:45.200125 [debug] [Thread-1 (]: Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  002003 (42S02): SQL compilation error:
  Object 'NEW_CUSTOMERS_BY_FY' does not exist or not authorized.
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:31:45.201125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '380dc42f-96af-469f-923a-65d7551e30b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF01979C70>]}
[0m15:31:45.201125 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.fiscal_year ........................ [[31mERROR[0m in 0.50s]
[0m15:31:45.202125 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:31:45.205125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:45.205125 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:31:45.206131 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:31:45.207126 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:31:45.207126 [info ] [MainThread]: 
[0m15:31:45.208124 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m15:31:45.209125 [debug] [MainThread]: Command end result
[0m15:31:45.220124 [info ] [MainThread]: 
[0m15:31:45.221125 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:31:45.221125 [info ] [MainThread]: 
[0m15:31:45.223126 [error] [MainThread]:   Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  002003 (42S02): SQL compilation error:
  Object 'NEW_CUSTOMERS_BY_FY' does not exist or not authorized.
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:31:45.224124 [info ] [MainThread]: 
[0m15:31:45.224124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:31:45.226124 [debug] [MainThread]: Command `dbt run` failed at 15:31:45.226124 after 4.93 seconds
[0m15:31:45.226124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF017395B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA880200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0198C170>]}
[0m15:31:45.227123 [debug] [MainThread]: Flushing usage events
[0m15:32:00.993820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023933C55430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023933C56BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023933C54050>]}


============================== 15:32:00.997816 | 535f5eff-4948-40a2-b634-4d52552985c4 ==============================
[0m15:32:00.997816 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:32:00.998816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m fiscal_year', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:32:01.885493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '535f5eff-4948-40a2-b634-4d52552985c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239401422D0>]}
[0m15:32:01.973102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '535f5eff-4948-40a2-b634-4d52552985c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002393E297AD0>]}
[0m15:32:01.974103 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:32:01.981899 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:32:02.098379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:32:02.099379 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:32:02.233996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:32:02.239994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '535f5eff-4948-40a2-b634-4d52552985c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239408FD970>]}
[0m15:32:02.252000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '535f5eff-4948-40a2-b634-4d52552985c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394064EB40>]}
[0m15:32:02.252000 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:32:02.253001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535f5eff-4948-40a2-b634-4d52552985c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023940840980>]}
[0m15:32:02.255000 [info ] [MainThread]: 
[0m15:32:02.257002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:32:02.258000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:32:02.273511 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:32:02.273511 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:32:02.274511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:03.438910 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:32:03.441909 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:32:03.539934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m15:32:03.554930 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:32:03.554930 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:32:03.555930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:03.842815 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:32:03.849815 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:32:03.943468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m15:32:03.958343 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:32:03.959342 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:32:03.961340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:04.266254 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafffa-0001-429a-0008-435e00020c0e
[0m15:32:04.267281 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:32:04.267281 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:32:04.267281 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:32:04.268278 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:32:04.355850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m15:32:04.358856 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:32:04.358856 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:32:04.358856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:04.634869 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:32:04.637868 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:32:04.730328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:32:04.739292 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:32:04.739292 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:32:04.739292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:05.028411 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:32:05.032411 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:32:05.137674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '535f5eff-4948-40a2-b634-4d52552985c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023940831370>]}
[0m15:32:05.138674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:32:05.139676 [info ] [MainThread]: 
[0m15:32:05.143937 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:32:05.143937 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:32:05.145938 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:32:05.145938 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:32:05.153939 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:32:05.156942 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:32:05.145938 => 15:32:05.155955
[0m15:32:05.157939 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:32:05.187585 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:32:05.189553 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:32:05.189553 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        MIN(PAYMENT_MONTH) AS first_payment_date,
        YEAR(first_payment_date) AS fiscal_year
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
)
SELECT
    fiscal_year,
    COUNT(customer_id) AS first_payment
FROM
    find_date_diff
GROUP BY fiscal_year
        );
[0m15:32:05.190584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:32:05.671283 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafffa-0001-429e-0008-435e00023016
[0m15:32:05.673273 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FIND_DATE_DIFF' does not exist or not authorized.
[0m15:32:05.676254 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:32:05.157939 => 15:32:05.674222
[0m15:32:05.677306 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:32:05.777185 [debug] [Thread-1 (]: Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIND_DATE_DIFF' does not exist or not authorized.
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:32:05.777185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '535f5eff-4948-40a2-b634-4d52552985c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023940B81EB0>]}
[0m15:32:05.778187 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.fiscal_year ........................ [[31mERROR[0m in 0.63s]
[0m15:32:05.779155 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:32:05.782155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:05.782155 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:32:05.782155 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:32:05.783155 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:32:05.783155 [info ] [MainThread]: 
[0m15:32:05.784157 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m15:32:05.785174 [debug] [MainThread]: Command end result
[0m15:32:05.798748 [info ] [MainThread]: 
[0m15:32:05.799752 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:32:05.800750 [info ] [MainThread]: 
[0m15:32:05.800750 [error] [MainThread]:   Database Error in model fiscal_year (models\marts\fiscal_year.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIND_DATE_DIFF' does not exist or not authorized.
  compiled Code at target\run\practice\models\marts\fiscal_year.sql
[0m15:32:05.801750 [info ] [MainThread]: 
[0m15:32:05.801750 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:32:05.803749 [debug] [MainThread]: Command `dbt run` failed at 15:32:05.802751 after 4.87 seconds
[0m15:32:05.803749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023933B5B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023933ACA3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023933C55430>]}
[0m15:32:05.804750 [debug] [MainThread]: Flushing usage events
[0m15:32:36.192156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B5591C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B558290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B559430>]}


============================== 15:32:36.196162 | cc850a67-87cd-491d-901f-18e10fe9bed2 ==============================
[0m15:32:36.196162 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:32:36.197240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m fiscal_year', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:32:37.090382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc850a67-87cd-491d-901f-18e10fe9bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019327942E70>]}
[0m15:32:37.180474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc850a67-87cd-491d-901f-18e10fe9bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019327DD55B0>]}
[0m15:32:37.181474 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:32:37.189474 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:32:37.306988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:32:37.307989 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:32:37.452152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:32:37.458152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc850a67-87cd-491d-901f-18e10fe9bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001932823E510>]}
[0m15:32:37.473153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc850a67-87cd-491d-901f-18e10fe9bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001932808B5C0>]}
[0m15:32:37.474156 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:32:37.475154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc850a67-87cd-491d-901f-18e10fe9bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019325C00560>]}
[0m15:32:37.478194 [info ] [MainThread]: 
[0m15:32:37.479154 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:32:37.480184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:32:37.495185 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:32:37.496184 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:32:37.496184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:38.341166 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:32:38.343164 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:32:38.436194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:32:38.453194 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:32:38.453194 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:32:38.454162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:38.882473 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:32:38.884471 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:32:38.967970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:32:38.970971 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:32:38.971971 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:32:38.971971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:39.278371 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafffa-0001-429e-0008-435e0002301e
[0m15:32:39.278371 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:32:39.279370 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:32:39.279370 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:32:39.279370 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:32:39.367017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:32:39.369017 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:32:39.370019 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:32:39.370019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:39.834705 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:32:39.836723 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:32:39.934638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m15:32:39.947651 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:32:39.949651 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:32:39.950648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:40.298747 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:32:40.302746 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:32:40.399301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc850a67-87cd-491d-901f-18e10fe9bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193282EADE0>]}
[0m15:32:40.400305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:32:40.401301 [info ] [MainThread]: 
[0m15:32:40.405379 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:32:40.406382 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:32:40.408380 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:32:40.408380 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:32:40.416411 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:32:40.417447 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:32:40.408380 => 15:32:40.417447
[0m15:32:40.418416 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:32:40.450927 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:32:40.452929 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:32:40.452929 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        MIN(PAYMENT_MONTH) AS first_payment_date,
        YEAR(first_payment_date) AS fiscal_year
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY
        customer_id
)
SELECT
    fiscal_year,
    COUNT(customer_id) AS first_payment
FROM
    first_payment
GROUP BY fiscal_year
        );
[0m15:32:40.453960 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:32:41.226822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:32:41.248327 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:32:40.418416 => 15:32:41.248327
[0m15:32:41.249327 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:32:41.341367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc850a67-87cd-491d-901f-18e10fe9bed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001932856FE60>]}
[0m15:32:41.343364 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.fiscal_year ............................ [[32mSUCCESS 1[0m in 0.93s]
[0m15:32:41.345326 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:32:41.350364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:41.351364 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:32:41.352364 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:32:41.353329 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:32:41.353329 [info ] [MainThread]: 
[0m15:32:41.354313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m15:32:41.355346 [debug] [MainThread]: Command end result
[0m15:32:41.367312 [info ] [MainThread]: 
[0m15:32:41.368314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:41.369362 [info ] [MainThread]: 
[0m15:32:41.369362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:32:41.371313 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:41.371313 after 5.24 seconds
[0m15:32:41.371313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B587830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B421460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931B5591C0>]}
[0m15:32:41.372328 [debug] [MainThread]: Flushing usage events
[0m15:38:01.348928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8F185F620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8F185F500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8F185E750>]}


============================== 15:38:01.353464 | b258001b-03a6-43d6-a716-0f6625b9a732 ==============================
[0m15:38:01.353464 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:38:01.354401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m fiscal_year', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:02.238849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b258001b-03a6-43d6-a716-0f6625b9a732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FE149970>]}
[0m15:38:02.325367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b258001b-03a6-43d6-a716-0f6625b9a732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8F1329010>]}
[0m15:38:02.326367 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:38:02.335365 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:38:02.447972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:02.448969 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:38:02.580130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:38:02.586135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b258001b-03a6-43d6-a716-0f6625b9a732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FE541970>]}
[0m15:38:02.598098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b258001b-03a6-43d6-a716-0f6625b9a732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FE352CC0>]}
[0m15:38:02.598098 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:38:02.599140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b258001b-03a6-43d6-a716-0f6625b9a732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FC4CFB30>]}
[0m15:38:02.601100 [info ] [MainThread]: 
[0m15:38:02.602098 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:02.603132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:38:02.618131 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:38:02.619130 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:38:02.619130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:03.568834 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:38:03.570837 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:38:03.657397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:38:03.667971 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:38:03.667971 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:38:03.667971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:03.967522 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:38:03.974568 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:38:04.070418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:38:04.085419 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:38:04.086423 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:38:04.087395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:04.380632 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:38:04.383628 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:38:04.465807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:38:04.469810 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:38:04.471349 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:38:04.471349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:04.937000 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:38:04.938999 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:38:05.035145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m15:38:05.038144 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:38:05.039146 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:38:05.039146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:05.460646 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0000-0001-429b-0008-435e000222ba
[0m15:38:05.460646 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:38:05.461647 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:38:05.461647 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:38:05.462647 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:38:05.553985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b258001b-03a6-43d6-a716-0f6625b9a732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FE5E29C0>]}
[0m15:38:05.558061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:05.561061 [info ] [MainThread]: 
[0m15:38:05.574163 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:38:05.577162 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:38:05.581211 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:38:05.583222 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:38:05.609189 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:38:05.611149 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:38:05.585222 => 15:38:05.611149
[0m15:38:05.612152 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:38:05.645179 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:38:05.647147 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:38:05.648178 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        YEAR(MIN(PAYMENT_MONTH)) AS fiscal_Year,
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY customer_id
)
SELECT
    fiscal_Year,
    COUNT(customer_id) AS first_payment
FROM
    first_payment
GROUP BY fiscal_Year
        );
[0m15:38:05.648178 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:06.396660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:06.419645 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:38:05.612152 => 15:38:06.418644
[0m15:38:06.419645 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:38:06.505327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b258001b-03a6-43d6-a716-0f6625b9a732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FE83D7C0>]}
[0m15:38:06.506319 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.fiscal_year ............................ [[32mSUCCESS 1[0m in 0.93s]
[0m15:38:06.506820 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:38:06.508857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:06.508857 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:38:06.509857 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m15:38:06.509857 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:38:06.509857 [info ] [MainThread]: 
[0m15:38:06.510858 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m15:38:06.511827 [debug] [MainThread]: Command end result
[0m15:38:06.524827 [info ] [MainThread]: 
[0m15:38:06.525830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:06.525830 [info ] [MainThread]: 
[0m15:38:06.526827 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:38:06.528827 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:06.528827 after 5.24 seconds
[0m15:38:06.528827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8F17253A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8F14C8BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8F1759220>]}
[0m15:38:06.529859 [debug] [MainThread]: Flushing usage events
[0m15:38:36.839311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539EB540B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539EB54320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539EB55550>]}


============================== 15:38:36.844311 | 3963d880-23a2-47d3-84fb-ab4fffdc7f9c ==============================
[0m15:38:36.844311 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:38:36.844311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m fiscal_year', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:38:37.717942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3963d880-23a2-47d3-84fb-ab4fffdc7f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AB421970>]}
[0m15:38:37.805462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3963d880-23a2-47d3-84fb-ab4fffdc7f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539EB83FE0>]}
[0m15:38:37.806494 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:38:37.814493 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:38:37.930627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:37.931624 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\fiscal_year.sql
[0m15:38:38.067207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:38:38.073239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3963d880-23a2-47d3-84fb-ab4fffdc7f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AB47F4A0>]}
[0m15:38:38.085099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3963d880-23a2-47d3-84fb-ab4fffdc7f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AB652720>]}
[0m15:38:38.085099 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:38:38.086133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3963d880-23a2-47d3-84fb-ab4fffdc7f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AB3D0440>]}
[0m15:38:38.088131 [info ] [MainThread]: 
[0m15:38:38.089102 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:38.090130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:38:38.105106 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:38:38.105106 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:38:38.106114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:39.399897 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:38:39.406894 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:38:39.503596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:38:39.517555 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:38:39.517555 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:38:39.518593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:39.928250 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0000-0001-429e-0008-435e00023046
[0m15:38:39.929249 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:38:39.929249 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:38:39.930248 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:38:39.930248 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:38:40.007781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m15:38:40.010780 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:38:40.010780 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:38:40.011783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:40.376115 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:38:40.380111 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:38:40.474043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:38:40.482999 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:38:40.482999 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:38:40.483999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:41.290251 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m15:38:41.293286 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:38:41.383871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:38:41.393863 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:38:41.394863 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:38:41.394863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:41.699323 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:38:41.701308 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:38:41.795912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3963d880-23a2-47d3-84fb-ab4fffdc7f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AB843DD0>]}
[0m15:38:41.799959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:41.801907 [info ] [MainThread]: 
[0m15:38:41.806822 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m15:38:41.806822 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.fiscal_year ................................. [RUN]
[0m15:38:41.808822 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.fiscal_year'
[0m15:38:41.808822 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m15:38:41.817826 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m15:38:41.819823 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 15:38:41.809823 => 15:38:41.818823
[0m15:38:41.819823 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m15:38:41.850829 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.fiscal_year"
[0m15:38:41.851829 [debug] [Thread-1 (]: Using snowflake connection "model.practice.fiscal_year"
[0m15:38:41.852829 [debug] [Thread-1 (]: On model.practice.fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        YEAR(MIN(PAYMENT_MONTH)) AS fiscal_Year,
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY customer_id
)
SELECT
    fiscal_Year,
    COUNT(customer_id) AS new_logos_count
FROM
    first_payment
GROUP BY fiscal_Year
        );
[0m15:38:41.852829 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:42.570127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:38:42.592157 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 15:38:41.820854 => 15:38:42.592157
[0m15:38:42.593158 [debug] [Thread-1 (]: On model.practice.fiscal_year: Close
[0m15:38:42.678353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3963d880-23a2-47d3-84fb-ab4fffdc7f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253ABA90C50>]}
[0m15:38:42.678353 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.fiscal_year ............................ [[32mSUCCESS 1[0m in 0.87s]
[0m15:38:42.679356 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m15:38:42.681322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:42.682322 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:38:42.682322 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m15:38:42.682322 [debug] [MainThread]: Connection 'model.practice.fiscal_year' was properly closed.
[0m15:38:42.683354 [info ] [MainThread]: 
[0m15:38:42.683354 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m15:38:42.685354 [debug] [MainThread]: Command end result
[0m15:38:42.696321 [info ] [MainThread]: 
[0m15:38:42.697323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:42.698324 [info ] [MainThread]: 
[0m15:38:42.698324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:38:42.700354 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:42.699322 after 5.92 seconds
[0m15:38:42.700354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539EA01E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AB4E7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A96E0530>]}
[0m15:38:42.700354 [debug] [MainThread]: Flushing usage events
[0m15:42:16.710220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226794FC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022679657AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022679655730>]}


============================== 15:42:16.714253 | ffac5a8f-f072-4cdd-b189-72b6ba7503a0 ==============================
[0m15:42:16.714253 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:42:16.715232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:17.602187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffac5a8f-f072-4cdd-b189-72b6ba7503a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022604C5A900>]}
[0m15:42:17.688789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffac5a8f-f072-4cdd-b189-72b6ba7503a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022604BC9970>]}
[0m15:42:17.689797 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:42:17.697768 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:42:17.805933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:17.805933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:17.806928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:42:17.812663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffac5a8f-f072-4cdd-b189-72b6ba7503a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226060DD070>]}
[0m15:42:17.824666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffac5a8f-f072-4cdd-b189-72b6ba7503a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226061470E0>]}
[0m15:42:17.825664 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:42:17.826666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffac5a8f-f072-4cdd-b189-72b6ba7503a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022604FB8A70>]}
[0m15:42:17.828664 [info ] [MainThread]: 
[0m15:42:17.829664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:17.830664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:42:17.846724 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:42:17.846724 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:42:17.847722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:18.743809 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:42:18.745816 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:42:18.832754 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:42:18.841756 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:42:18.841756 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:42:18.841756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:19.286688 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:42:19.293690 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:42:19.391711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:42:19.406711 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:42:19.408715 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:42:19.409646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:19.832787 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:42:19.836818 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:42:19.929620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:42:19.942544 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:42:19.944545 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:42:19.944545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:20.232509 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:42:20.233508 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:42:20.314950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m15:42:20.317949 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:42:20.318982 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:42:20.318982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:20.624100 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0004-0001-429a-0008-435e00020c72
[0m15:42:20.625101 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:42:20.625101 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:42:20.625101 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:42:20.626100 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:42:20.714413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffac5a8f-f072-4cdd-b189-72b6ba7503a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226062DAB10>]}
[0m15:42:20.715404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:20.716404 [info ] [MainThread]: 
[0m15:42:20.722369 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:42:20.723412 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:42:20.725371 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:42:20.726404 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:42:20.738370 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:42:20.740368 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:42:20.726404 => 15:42:20.740368
[0m15:42:20.741368 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:42:20.773929 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:42:20.775929 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:42:20.776927 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
)
SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH
        );
[0m15:42:20.776927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:21.659467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:42:21.681017 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:42:20.741368 => 15:42:21.680019
[0m15:42:21.681017 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:42:21.768205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffac5a8f-f072-4cdd-b189-72b6ba7503a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022606544560>]}
[0m15:42:21.770207 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.04s]
[0m15:42:21.771202 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:42:21.773709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:21.773709 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:42:21.773709 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m15:42:21.774717 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:42:21.774717 [info ] [MainThread]: 
[0m15:42:21.775717 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m15:42:21.776717 [debug] [MainThread]: Command end result
[0m15:42:21.789728 [info ] [MainThread]: 
[0m15:42:21.790721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:21.791719 [info ] [MainThread]: 
[0m15:42:21.792718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:21.794751 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:21.794751 after 5.15 seconds
[0m15:42:21.794751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226794FC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022679654260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022679657AD0>]}
[0m15:42:21.795716 [debug] [MainThread]: Flushing usage events
[0m15:44:12.659817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E21941AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E21B056D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E21B057BF0>]}


============================== 15:44:12.663803 | d1041795-14dd-431e-9794-505dc9483e69 ==============================
[0m15:44:12.663803 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:44:12.664800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:44:13.557026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1041795-14dd-431e-9794-505dc9483e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2275C9970>]}
[0m15:44:13.643669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1041795-14dd-431e-9794-505dc9483e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E21B087E60>]}
[0m15:44:13.644672 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:44:13.652670 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:44:13.753252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:44:13.754252 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:44:13.886835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:44:13.891867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1041795-14dd-431e-9794-505dc9483e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E227DF5AC0>]}
[0m15:44:13.904834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1041795-14dd-431e-9794-505dc9483e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E227B4EAE0>]}
[0m15:44:13.905834 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:44:13.905834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1041795-14dd-431e-9794-505dc9483e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E227D42780>]}
[0m15:44:13.907834 [info ] [MainThread]: 
[0m15:44:13.908867 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:44:13.910866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:44:13.925842 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:44:13.925842 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:44:13.926860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:14.835869 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:44:14.839501 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:44:14.921834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:44:14.940402 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:44:14.940402 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:44:14.941401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:15.380354 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:44:15.387406 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:44:15.478501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m15:44:15.493502 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:44:15.495500 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:44:15.496500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:15.786527 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0006-0001-429a-0008-435e00020c7a
[0m15:44:15.787561 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:44:15.788528 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:44:15.788528 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:44:15.789561 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:44:15.882283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:44:15.892287 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:44:15.894285 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:44:15.895260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:16.223681 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:44:16.227683 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:44:16.329530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m15:44:16.348192 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:44:16.350169 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:44:16.351174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:16.652773 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:44:16.655770 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:44:16.746407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1041795-14dd-431e-9794-505dc9483e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E227EC4BC0>]}
[0m15:44:16.747406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:16.747406 [info ] [MainThread]: 
[0m15:44:16.751406 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:44:16.752406 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:44:16.753405 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:44:16.754406 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:44:16.762437 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:44:16.764408 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:44:16.754406 => 15:44:16.763438
[0m15:44:16.764408 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:44:16.796442 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:44:16.799437 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:44:16.799437 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
),
loss_revenue as(
    SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH   
)
SELECT 
    SUM(Revenue_Loss) as Total_Revenue_Loss,
    PRODUCT_ID,
    FROM loss_revenue
GROUP BY PRODUCT_ID
        );
[0m15:44:16.799437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:44:17.645856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:44:17.678842 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:44:16.765410 => 15:44:17.677842
[0m15:44:17.678842 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:44:17.764588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1041795-14dd-431e-9794-505dc9483e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E227C52F90>]}
[0m15:44:17.764588 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.01s]
[0m15:44:17.765646 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:44:17.767653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:17.768683 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:44:17.768683 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m15:44:17.768683 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:44:17.769685 [info ] [MainThread]: 
[0m15:44:17.770230 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m15:44:17.771236 [debug] [MainThread]: Command end result
[0m15:44:17.784239 [info ] [MainThread]: 
[0m15:44:17.785285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:17.786237 [info ] [MainThread]: 
[0m15:44:17.787271 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:44:17.789270 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:17.788249 after 5.19 seconds
[0m15:44:17.789270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E21B087800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E219E09070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E219470680>]}
[0m15:44:17.789270 [debug] [MainThread]: Flushing usage events
[0m15:45:17.250986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF19422C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF195544D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF195543B0>]}


============================== 15:45:17.264017 | 0be95ece-2ffa-4434-b86f-81936d58d438 ==============================
[0m15:45:17.264017 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:45:17.264986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m revenue_loss', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:24.361085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0be95ece-2ffa-4434-b86f-81936d58d438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1921B8F0>]}
[0m15:45:24.448092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0be95ece-2ffa-4434-b86f-81936d58d438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF23F2BB30>]}
[0m15:45:24.456151 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:45:24.472664 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:45:25.666105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:25.667105 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:45:25.799686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:45:25.805260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0be95ece-2ffa-4434-b86f-81936d58d438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF25F16390>]}
[0m15:45:25.831846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0be95ece-2ffa-4434-b86f-81936d58d438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF25F524E0>]}
[0m15:45:25.831846 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:45:25.832848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0be95ece-2ffa-4434-b86f-81936d58d438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF26131EB0>]}
[0m15:45:25.834877 [info ] [MainThread]: 
[0m15:45:25.835261 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:25.837298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:45:25.852304 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:45:25.852304 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:45:25.853305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:27.071067 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:45:27.073116 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:45:27.160038 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:45:27.171562 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:45:27.171562 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:45:27.172606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:27.689380 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0007-0001-429b-0008-435e000222fa
[0m15:45:27.690411 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:45:27.690411 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:45:27.690411 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:45:27.691410 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:45:27.784137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:45:27.793137 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:45:27.795113 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:45:27.796115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:28.170668 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:45:28.174668 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:45:28.284353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m15:45:28.297359 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:45:28.298329 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:45:28.299334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:28.588154 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:45:28.591152 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:45:28.678085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:45:28.681108 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:45:28.682111 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:45:28.682111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:29.008772 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:45:29.011127 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:45:29.096445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0be95ece-2ffa-4434-b86f-81936d58d438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF261433B0>]}
[0m15:45:29.097443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:29.098443 [info ] [MainThread]: 
[0m15:45:29.103440 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:45:29.103440 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:45:29.105418 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:45:29.106415 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:45:29.113411 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:45:29.115412 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:45:29.106415 => 15:45:29.115412
[0m15:45:29.115412 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:45:29.147412 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:45:29.149413 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:45:29.150444 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
),
loss_revenue as(
    SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH   
)
SELECT 
    PRODUCT_ID,
    SUM(Revenue_Loss) as Total_Revenue_Loss
    FROM loss_revenue
GROUP BY PRODUCT_ID
        );
[0m15:45:29.150444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:30.501275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:45:30.527222 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:45:29.116445 => 15:45:30.527222
[0m15:45:30.527222 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:45:30.860822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be95ece-2ffa-4434-b86f-81936d58d438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF26469940>]}
[0m15:45:30.861823 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.76s]
[0m15:45:30.862823 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:45:30.864854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:30.864854 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:45:30.864854 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:45:30.865853 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:45:30.865853 [info ] [MainThread]: 
[0m15:45:30.866825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m15:45:30.867823 [debug] [MainThread]: Command end result
[0m15:45:30.880829 [info ] [MainThread]: 
[0m15:45:30.881830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:30.882831 [info ] [MainThread]: 
[0m15:45:30.883840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:45:30.884828 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:30.884828 after 13.72 seconds
[0m15:45:30.885827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF19587740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF19422C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF17FF11F0>]}
[0m15:45:30.885827 [debug] [MainThread]: Flushing usage events
[0m15:50:18.984942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABA857740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABA856D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABA857620>]}


============================== 15:50:18.988973 | 1b8ae8bb-0350-4c39-8a09-12d21de9582f ==============================
[0m15:50:18.988973 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:50:18.990266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:50:19.871691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b8ae8bb-0350-4c39-8a09-12d21de9582f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC559CB00>]}
[0m15:50:19.958209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b8ae8bb-0350-4c39-8a09-12d21de9582f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABA664980>]}
[0m15:50:19.959209 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:50:19.966909 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:50:20.083563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:20.084564 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:50:20.215725 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:50:20.221753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b8ae8bb-0350-4c39-8a09-12d21de9582f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC72B0470>]}
[0m15:50:20.232758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b8ae8bb-0350-4c39-8a09-12d21de9582f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC7352BA0>]}
[0m15:50:20.233722 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:50:20.234722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8ae8bb-0350-4c39-8a09-12d21de9582f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC755FB00>]}
[0m15:50:20.236754 [info ] [MainThread]: 
[0m15:50:20.237723 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:20.238768 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:50:20.253722 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:50:20.253722 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:50:20.254726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:21.238233 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:50:21.240233 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:50:21.321652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m15:50:21.335663 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:50:21.336661 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:50:21.337662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:21.635600 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:50:21.639563 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:50:21.732913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m15:50:21.746855 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:50:21.747855 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:50:21.748900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:22.048511 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb000c-0001-429b-0008-435e0002230e
[0m15:50:22.048511 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:50:22.049511 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:50:22.049511 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:50:22.049511 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:50:22.132175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m15:50:22.134175 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:50:22.135175 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:50:22.135175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:22.418088 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:50:22.420080 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:50:22.505775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m15:50:22.509848 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:50:22.509848 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:50:22.509848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:22.936708 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:50:22.938669 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:50:23.020594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8ae8bb-0350-4c39-8a09-12d21de9582f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC76E5460>]}
[0m15:50:23.021591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:23.022559 [info ] [MainThread]: 
[0m15:50:23.027653 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:50:23.028191 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:50:23.028701 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:50:23.029742 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:50:23.037741 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:50:23.039706 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:50:23.029742 => 15:50:23.038751
[0m15:50:23.039706 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:50:23.072735 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:50:23.075708 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:50:23.076708 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
     FROM revenue_drop
),
    SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH   


-- SELECT 
--     PRODUCT_ID,
--     SUM(Revenue_Loss) as Total_Revenue_Loss
--     FROM loss_revenue
-- GROUP BY PRODUCT_ID
        );
[0m15:50:23.076708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:23.410184 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb000c-0001-429b-0008-435e00022316
[0m15:50:23.410184 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'SELECT'.
syntax error line 22 at position 17 unexpected ','.
syntax error line 23 at position 29 unexpected 'Previous_Revenue'.
syntax error line 24 at position 20 unexpected 'Current_Revenue'.
syntax error line 25 at position 26 unexpected '-'.
syntax error line 25 at position 32 unexpected 'REVENUE'.
syntax error line 25 at position 41 unexpected 'as'.
[0m15:50:23.411184 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:50:23.040711 => 15:50:23.411184
[0m15:50:23.411184 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:50:23.510419 [debug] [Thread-1 (]: Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'SELECT'.
  syntax error line 22 at position 17 unexpected ','.
  syntax error line 23 at position 29 unexpected 'Previous_Revenue'.
  syntax error line 24 at position 20 unexpected 'Current_Revenue'.
  syntax error line 25 at position 26 unexpected '-'.
  syntax error line 25 at position 32 unexpected 'REVENUE'.
  syntax error line 25 at position 41 unexpected 'as'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:50:23.511422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b8ae8bb-0350-4c39-8a09-12d21de9582f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AC76C4AA0>]}
[0m15:50:23.511422 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.revenue_loss ....................... [[31mERROR[0m in 0.48s]
[0m15:50:23.512386 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:50:23.515457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:23.515457 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:50:23.516456 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:50:23.516456 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:50:23.516456 [info ] [MainThread]: 
[0m15:50:23.517432 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m15:50:23.518427 [debug] [MainThread]: Command end result
[0m15:50:23.530521 [info ] [MainThread]: 
[0m15:50:23.531521 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:23.532551 [info ] [MainThread]: 
[0m15:50:23.533519 [error] [MainThread]:   Database Error in model revenue_loss (models\marts\revenue_loss.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'SELECT'.
  syntax error line 22 at position 17 unexpected ','.
  syntax error line 23 at position 29 unexpected 'Previous_Revenue'.
  syntax error line 24 at position 20 unexpected 'Current_Revenue'.
  syntax error line 25 at position 26 unexpected '-'.
  syntax error line 25 at position 32 unexpected 'REVENUE'.
  syntax error line 25 at position 41 unexpected 'as'.
  compiled Code at target\run\practice\models\marts\revenue_loss.sql
[0m15:50:23.534518 [info ] [MainThread]: 
[0m15:50:23.534518 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:50:23.535705 [debug] [MainThread]: Command `dbt run` failed at 15:50:23.535705 after 4.61 seconds
[0m15:50:23.536743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABA887890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABA51B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024ABA856D20>]}
[0m15:50:23.536743 [debug] [MainThread]: Flushing usage events
[0m15:51:34.644140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022442EDFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022444155640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022444157A70>]}


============================== 15:51:34.648139 | 8c3c27fb-1c43-4637-9c72-a814df3890d9 ==============================
[0m15:51:34.648139 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:51:34.649139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m revenue_loss', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:35.549517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c3c27fb-1c43-4637-9c72-a814df3890d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022450A4A630>]}
[0m15:51:35.639162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c3c27fb-1c43-4637-9c72-a814df3890d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002244297A840>]}
[0m15:51:35.640162 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:51:35.648547 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:51:35.757130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:35.758131 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:51:35.891722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:51:35.896787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c3c27fb-1c43-4637-9c72-a814df3890d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022450EFDAF0>]}
[0m15:51:35.910152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c3c27fb-1c43-4637-9c72-a814df3890d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022450C526C0>]}
[0m15:51:35.911152 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:51:35.912152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c3c27fb-1c43-4637-9c72-a814df3890d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022450E41400>]}
[0m15:51:35.913151 [info ] [MainThread]: 
[0m15:51:35.915150 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:51:35.916200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:51:35.931182 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:51:35.932185 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:51:35.932185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:37.128282 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:51:37.130282 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:51:37.218282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:51:37.228795 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:51:37.228795 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:51:37.228795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:37.700967 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb000d-0001-429a-0008-435e00020ca6
[0m15:51:37.700967 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:51:37.701967 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:51:37.701967 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:51:37.702968 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:51:37.783501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m15:51:37.785500 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:51:37.786501 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:51:37.786501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:38.462106 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:51:38.464105 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:51:38.564461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m15:51:38.572461 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:51:38.573460 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:51:38.574461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:38.874267 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:51:38.876267 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:51:38.961333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m15:51:38.969757 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:51:38.970764 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:51:38.971759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:39.269456 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:51:39.271455 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:51:39.356025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c3c27fb-1c43-4637-9c72-a814df3890d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022450B7BF80>]}
[0m15:51:39.357023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:39.357023 [info ] [MainThread]: 
[0m15:51:39.361022 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:51:39.361022 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:51:39.362027 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:51:39.363025 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:51:39.371027 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:51:39.372026 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:51:39.363025 => 15:51:39.372026
[0m15:51:39.373027 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:51:39.405026 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:51:39.408026 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:51:39.408026 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY CUSTOMER_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH   


-- SELECT 
--     PRODUCT_ID,
--     SUM(Revenue_Loss) as Total_Revenue_Loss
--     FROM loss_revenue
-- GROUP BY PRODUCT_ID
        );
[0m15:51:39.409023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:41.047986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:51:41.072561 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:51:39.373027 => 15:51:41.072561
[0m15:51:41.073529 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:51:41.175794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c3c27fb-1c43-4637-9c72-a814df3890d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022450EDDA30>]}
[0m15:51:41.176750 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 1.81s]
[0m15:51:41.177739 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:51:41.179748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:41.180776 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:51:41.180776 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m15:51:41.180776 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:51:41.181777 [info ] [MainThread]: 
[0m15:51:41.181777 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m15:51:41.183777 [debug] [MainThread]: Command end result
[0m15:51:41.195744 [info ] [MainThread]: 
[0m15:51:41.196748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:41.197778 [info ] [MainThread]: 
[0m15:51:41.198777 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:41.199745 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:41.199745 after 6.62 seconds
[0m15:51:41.200780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022442B547D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022442D81880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022444081A30>]}
[0m15:51:41.200780 [debug] [MainThread]: Flushing usage events
[0m15:53:25.419438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E5D551F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E5D551C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E5D55580>]}


============================== 15:53:25.424469 | 72b489c5-0e3e-4788-afbb-cfdc92e970c2 ==============================
[0m15:53:25.424469 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:53:25.425437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m revenue_loss', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:26.290749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72b489c5-0e3e-4788-afbb-cfdc92e970c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2242210>]}
[0m15:53:26.377365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72b489c5-0e3e-4788-afbb-cfdc92e970c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2218D40>]}
[0m15:53:26.378366 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:53:26.387365 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:53:26.499915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:26.500880 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:53:26.635495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m15:53:26.641528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72b489c5-0e3e-4788-afbb-cfdc92e970c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2931970>]}
[0m15:53:26.653575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72b489c5-0e3e-4788-afbb-cfdc92e970c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2752630>]}
[0m15:53:26.654607 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:53:26.654607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b489c5-0e3e-4788-afbb-cfdc92e970c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2940980>]}
[0m15:53:26.656606 [info ] [MainThread]: 
[0m15:53:26.657610 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:26.659605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:53:26.673613 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:53:26.675122 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:53:26.675122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:27.604175 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:53:27.608216 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:53:27.697584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m15:53:27.707587 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:53:27.707587 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:53:27.708616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:27.997821 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb000f-0001-429a-0008-435e00020cb6
[0m15:53:27.998821 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:53:27.998821 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:53:27.998821 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:53:27.999821 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:53:28.087721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m15:53:28.091719 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:53:28.092719 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:53:28.093719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:28.541732 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:53:28.543762 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:53:28.633548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m15:53:28.646555 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:53:28.647556 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:53:28.649554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:29.090762 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:53:29.093798 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:53:29.187422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m15:53:29.194846 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:53:29.194846 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:53:29.195847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:29.547668 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:53:29.549663 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:53:29.648793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b489c5-0e3e-4788-afbb-cfdc92e970c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2138E00>]}
[0m15:53:29.649793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:29.650793 [info ] [MainThread]: 
[0m15:53:29.654794 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:53:29.655796 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:53:29.656792 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:53:29.656792 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:53:29.664824 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:53:29.666793 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:53:29.657831 => 15:53:29.665824
[0m15:53:29.666793 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:53:29.697429 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:53:29.700398 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:53:29.700398 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH   


-- SELECT 
--     PRODUCT_ID,
--     SUM(Revenue_Loss) as Total_Revenue_Loss
--     FROM loss_revenue
-- GROUP BY PRODUCT_ID
        );
[0m15:53:29.701398 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:53:30.435307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:53:30.457297 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:53:29.666793 => 15:53:30.457297
[0m15:53:30.457297 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:53:30.564525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b489c5-0e3e-4788-afbb-cfdc92e970c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F2CBF650>]}
[0m15:53:30.564525 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 0.91s]
[0m15:53:30.565952 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:53:30.567991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:30.568991 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:53:30.568991 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:53:30.568991 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:53:30.569992 [info ] [MainThread]: 
[0m15:53:30.569992 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m15:53:30.571993 [debug] [MainThread]: Command end result
[0m15:53:30.582960 [info ] [MainThread]: 
[0m15:53:30.583961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:30.584961 [info ] [MainThread]: 
[0m15:53:30.585967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:53:30.587001 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:30.587001 after 5.23 seconds
[0m15:53:30.588002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E5939880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E5C5B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218E5C58710>]}
[0m15:53:30.588002 [debug] [MainThread]: Flushing usage events
[0m15:55:10.016237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E8A02C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E8B58E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E8B59190>]}


============================== 15:55:10.020262 | 010abeb7-8da2-4705-94fd-dfa36ab69538 ==============================
[0m15:55:10.020262 [info ] [MainThread]: Running with dbt=1.7.4
[0m15:55:10.022269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m revenue_loss', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:55:10.914216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '010abeb7-8da2-4705-94fd-dfa36ab69538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E8A50620>]}
[0m15:55:11.000301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '010abeb7-8da2-4705-94fd-dfa36ab69538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F3EC16A0>]}
[0m15:55:11.001301 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:55:11.009582 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m15:55:11.121302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:11.122302 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\revenue_loss.sql
[0m15:55:11.254585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m15:55:11.260585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '010abeb7-8da2-4705-94fd-dfa36ab69538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F5842F60>]}
[0m15:55:11.273584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '010abeb7-8da2-4705-94fd-dfa36ab69538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F563AE40>]}
[0m15:55:11.273584 [info ] [MainThread]: Found 10 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m15:55:11.274585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010abeb7-8da2-4705-94fd-dfa36ab69538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F55D87A0>]}
[0m15:55:11.276586 [info ] [MainThread]: 
[0m15:55:11.277585 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:55:11.279583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m15:55:11.293622 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m15:55:11.294622 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m15:55:11.294622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:12.251613 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m15:55:12.254611 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m15:55:12.344208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m15:55:12.357173 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m15:55:12.357173 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m15:55:12.358173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:12.665672 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:55:12.670677 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m15:55:12.768907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m15:55:12.783884 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m15:55:12.784845 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m15:55:12.785884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:13.080368 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:55:13.081361 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m15:55:13.162483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m15:55:13.165484 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m15:55:13.166483 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m15:55:13.166483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:13.449292 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0011-0001-429a-0008-435e00020cda
[0m15:55:13.449292 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:55:13.450300 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:55:13.450300 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:55:13.450300 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m15:55:13.537969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m15:55:13.547978 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m15:55:13.549955 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m15:55:13.550914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:13.961102 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m15:55:13.965083 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m15:55:14.059965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010abeb7-8da2-4705-94fd-dfa36ab69538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F596E480>]}
[0m15:55:14.059965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:14.060997 [info ] [MainThread]: 
[0m15:55:14.064990 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m15:55:14.065993 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.revenue_loss ................................ [RUN]
[0m15:55:14.066993 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.revenue_loss'
[0m15:55:14.067991 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m15:55:14.077022 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m15:55:14.078991 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 15:55:14.067991 => 15:55:14.077990
[0m15:55:14.078991 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m15:55:14.109990 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.revenue_loss"
[0m15:55:14.113024 [debug] [Thread-1 (]: Using snowflake connection "model.practice.revenue_loss"
[0m15:55:14.113024 [debug] [Thread-1 (]: On model.practice.revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH   
ORDER BY Revenue_Loss DESC


-- SELECT 
--     PRODUCT_ID,
--     SUM(Revenue_Loss) as Total_Revenue_Loss
--     FROM loss_revenue
-- GROUP BY PRODUCT_ID
        );
[0m15:55:14.113990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:14.829640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:55:14.871264 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 15:55:14.078991 => 15:55:14.871264
[0m15:55:14.872264 [debug] [Thread-1 (]: On model.practice.revenue_loss: Close
[0m15:55:14.952119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '010abeb7-8da2-4705-94fd-dfa36ab69538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F5A3A810>]}
[0m15:55:14.953120 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.revenue_loss ........................... [[32mSUCCESS 1[0m in 0.88s]
[0m15:55:14.955155 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m15:55:14.957156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:14.958156 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m15:55:14.959158 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m15:55:14.959158 [debug] [MainThread]: Connection 'model.practice.revenue_loss' was properly closed.
[0m15:55:14.960156 [info ] [MainThread]: 
[0m15:55:14.961119 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m15:55:14.963118 [debug] [MainThread]: Command end result
[0m15:55:14.976117 [info ] [MainThread]: 
[0m15:55:14.977123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:14.978121 [info ] [MainThread]: 
[0m15:55:14.979150 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:55:14.981117 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:14.980149 after 5.03 seconds
[0m15:55:14.981117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E873FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F53D7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F5421D00>]}
[0m15:55:14.981117 [debug] [MainThread]: Flushing usage events
[0m16:36:00.436918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193858540E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019385857080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193858553A0>]}


============================== 16:36:00.457909 | aabba8a2-28d8-41e2-83fb-b2778b0e4048 ==============================
[0m16:36:00.457909 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:36:00.458904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cust_churn_count', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:09.505491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aabba8a2-28d8-41e2-83fb-b2778b0e4048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001939214F140>]}
[0m16:36:09.597060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aabba8a2-28d8-41e2-83fb-b2778b0e4048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193921D8470>]}
[0m16:36:09.605068 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:36:09.627205 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:36:11.078034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:36:11.079036 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_nrr_grr.sql
[0m16:36:11.079036 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_cust_churn_count.sql
[0m16:36:11.226133 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:36:11.232163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aabba8a2-28d8-41e2-83fb-b2778b0e4048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019392467320>]}
[0m16:36:11.267163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aabba8a2-28d8-41e2-83fb-b2778b0e4048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193924A8F50>]}
[0m16:36:11.267163 [info ] [MainThread]: Found 11 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:36:11.268131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aabba8a2-28d8-41e2-83fb-b2778b0e4048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019392179070>]}
[0m16:36:11.270135 [info ] [MainThread]: 
[0m16:36:11.271132 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:36:11.273133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:36:11.288134 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:36:11.288134 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:36:11.288134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:12.659414 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:36:12.661415 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:36:12.774024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m16:36:12.798035 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:36:12.799035 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:36:12.800037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:13.128144 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:36:13.130143 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:36:13.228424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m16:36:13.232447 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:36:13.232447 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:36:13.233418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:14.112296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m16:36:14.114322 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:36:14.213920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m16:36:14.217920 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:36:14.217920 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:36:14.218919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:14.699810 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:36:14.701810 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:36:14.800101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m16:36:14.804101 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:36:14.805102 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:36:14.805102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:15.252120 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb003a-0001-429b-0008-435e0002237e
[0m16:36:15.253120 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:36:15.253120 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:36:15.253120 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:36:15.254121 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:36:15.351636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aabba8a2-28d8-41e2-83fb-b2778b0e4048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193924B8530>]}
[0m16:36:15.352632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:15.353634 [info ] [MainThread]: 
[0m16:36:15.360635 [debug] [Thread-1 (]: Began running node model.practice.mart_cust_churn_count
[0m16:36:15.361635 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_cust_churn_count ....................... [RUN]
[0m16:36:15.362634 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_cust_churn_count'
[0m16:36:15.362634 [debug] [Thread-1 (]: Began compiling node model.practice.mart_cust_churn_count
[0m16:36:15.370635 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_cust_churn_count"
[0m16:36:15.373634 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (compile): 16:36:15.363635 => 16:36:15.372632
[0m16:36:15.373634 [debug] [Thread-1 (]: Began executing node model.practice.mart_cust_churn_count
[0m16:36:15.406636 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_cust_churn_count"
[0m16:36:15.412641 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_cust_churn_count"
[0m16:36:15.413642 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_cust_churn_count"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_cust_churn_count
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) < DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) > DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) < DATEADD('month', -1, m.latest_month) THEN 1
            ELSE 0
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) > DATEADD('month', -1, m.latest_month) THEN 1 
            ELSE 0
        END AS LM_Customer_Status,
        CASE
            WHEN MAX(t.tran_month) < DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_churn_status,
        CASE
            WHEN MIN(t.tran_month) > DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT sum(LM_churn_status) as churned_last_month,
sum(L3m_churn_status) as churned_last_3_months,
sum(Ltm_churn_status) as churned_last_12_months,
sum(LM_Customer_Status) as new_customers_last_month,
sum(L3MCustomer_Status) as new_customers_last_3_months,
sum(Ltm_Customer_Status) as new_customers_last_12_months
 FROM 
churn_status
        );
[0m16:36:15.414643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:18.719700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:36:18.745653 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (execute): 16:36:15.373634 => 16:36:18.745653
[0m16:36:18.746652 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: Close
[0m16:36:18.832144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aabba8a2-28d8-41e2-83fb-b2778b0e4048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193927AFA70>]}
[0m16:36:18.833144 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_cust_churn_count .................. [[32mSUCCESS 1[0m in 3.47s]
[0m16:36:18.835153 [debug] [Thread-1 (]: Finished running node model.practice.mart_cust_churn_count
[0m16:36:18.838186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:18.838186 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:36:18.838186 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m16:36:18.839188 [debug] [MainThread]: Connection 'model.practice.mart_cust_churn_count' was properly closed.
[0m16:36:18.840152 [info ] [MainThread]: 
[0m16:36:18.840152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m16:36:18.842186 [debug] [MainThread]: Command end result
[0m16:36:18.854739 [info ] [MainThread]: 
[0m16:36:18.856739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:18.857741 [info ] [MainThread]: 
[0m16:36:18.858738 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:18.859740 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:18.859740 after 18.52 seconds
[0m16:36:18.860738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019385703620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193856CCDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019390F6F5C0>]}
[0m16:36:18.860738 [debug] [MainThread]: Flushing usage events
[0m16:38:55.031467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020611A12C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020613057860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020613057260>]}


============================== 16:38:55.036478 | e5a54e0a-0352-4980-9449-eda4d50e6b4f ==============================
[0m16:38:55.036478 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:38:55.037308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cust_churn_count', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:55.914510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5a54e0a-0352-4980-9449-eda4d50e6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061FA4BE90>]}
[0m16:38:56.004156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5a54e0a-0352-4980-9449-eda4d50e6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061F0F3680>]}
[0m16:38:56.005155 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:38:56.013185 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:38:56.127797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:56.128799 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_cust_churn_count.sql
[0m16:38:56.261425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m16:38:56.267436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5a54e0a-0352-4980-9449-eda4d50e6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061FD29970>]}
[0m16:38:56.279979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5a54e0a-0352-4980-9449-eda4d50e6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061FB4EB40>]}
[0m16:38:56.280979 [info ] [MainThread]: Found 11 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:38:56.280979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5a54e0a-0352-4980-9449-eda4d50e6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020613080980>]}
[0m16:38:56.284011 [info ] [MainThread]: 
[0m16:38:56.284979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:56.287011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:38:56.302010 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:38:56.302010 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:38:56.303011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:57.369202 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:38:57.373167 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:38:57.469985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m16:38:57.484502 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:38:57.484502 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:38:57.484502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:57.939994 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:38:57.946989 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:38:58.048241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m16:38:58.058197 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:38:58.059197 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:38:58.059197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:58.441754 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:38:58.444707 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:38:58.552735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m16:38:58.566730 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:38:58.568730 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:38:58.569720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:59.007598 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb003c-0001-429b-0008-435e00022386
[0m16:38:59.008599 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:38:59.008599 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:38:59.008599 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:38:59.009599 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:38:59.098224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m16:38:59.101255 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:38:59.101255 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:38:59.102253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:59.445209 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:38:59.448205 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:38:59.554227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5a54e0a-0352-4980-9449-eda4d50e6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061FF3FC50>]}
[0m16:38:59.556229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:59.557223 [info ] [MainThread]: 
[0m16:38:59.561220 [debug] [Thread-1 (]: Began running node model.practice.mart_cust_churn_count
[0m16:38:59.562252 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_cust_churn_count ....................... [RUN]
[0m16:38:59.563219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_cust_churn_count'
[0m16:38:59.564220 [debug] [Thread-1 (]: Began compiling node model.practice.mart_cust_churn_count
[0m16:38:59.571251 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_cust_churn_count"
[0m16:38:59.574222 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (compile): 16:38:59.564220 => 16:38:59.573222
[0m16:38:59.574222 [debug] [Thread-1 (]: Began executing node model.practice.mart_cust_churn_count
[0m16:38:59.604661 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_cust_churn_count"
[0m16:38:59.608628 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_cust_churn_count"
[0m16:38:59.609629 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_cust_churn_count"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_cust_churn_count
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 1
            ELSE 0
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 1 
            ELSE 0
        END AS LM_Customer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT sum(LM_churn_status) as churned_last_month,
sum(L3m_churn_status) as churned_last_3_months,
sum(Ltm_churn_status) as churned_last_12_months,
sum(LM_Customer_Status) as new_customers_last_month,
sum(L3MCustomer_Status) as new_customers_last_3_months,
sum(Ltm_Customer_Status) as new_customers_last_12_months
 FROM 
churn_status
        );
[0m16:38:59.609629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:39:00.543922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:39:00.567877 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (execute): 16:38:59.574222 => 16:39:00.566876
[0m16:39:00.567877 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: Close
[0m16:39:00.671681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5a54e0a-0352-4980-9449-eda4d50e6b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206210792B0>]}
[0m16:39:00.672681 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_cust_churn_count .................. [[32mSUCCESS 1[0m in 1.11s]
[0m16:39:00.673544 [debug] [Thread-1 (]: Finished running node model.practice.mart_cust_churn_count
[0m16:39:00.676589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:00.677589 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:39:00.677589 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m16:39:00.678589 [debug] [MainThread]: Connection 'model.practice.mart_cust_churn_count' was properly closed.
[0m16:39:00.678589 [info ] [MainThread]: 
[0m16:39:00.679589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m16:39:00.681553 [debug] [MainThread]: Command end result
[0m16:39:00.695565 [info ] [MainThread]: 
[0m16:39:00.697565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:00.697565 [info ] [MainThread]: 
[0m16:39:00.698563 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:39:00.701564 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:00.700563 after 5.73 seconds
[0m16:39:00.701564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020611E09910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020611A12C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020611CF69F0>]}
[0m16:39:00.702562 [debug] [MainThread]: Flushing usage events
[0m16:49:57.183142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180BCA54110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180BC6CBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180BCA55130>]}


============================== 16:49:57.188140 | a86e2e6e-81a0-44cb-b92e-63924113f950 ==============================
[0m16:49:57.188140 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:49:57.189140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_high_cross', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:58.836037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a86e2e6e-81a0-44cb-b92e-63924113f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C944FFB0>]}
[0m16:49:58.938442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a86e2e6e-81a0-44cb-b92e-63924113f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C70E2A50>]}
[0m16:49:58.940441 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:49:58.948441 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:49:59.354666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:49:59.356673 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_high_cross.sql
[0m16:49:59.525724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m16:49:59.531718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a86e2e6e-81a0-44cb-b92e-63924113f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C97B6B10>]}
[0m16:49:59.554723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a86e2e6e-81a0-44cb-b92e-63924113f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C954EC30>]}
[0m16:49:59.555724 [info ] [MainThread]: Found 12 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:49:59.556722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86e2e6e-81a0-44cb-b92e-63924113f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C941BDD0>]}
[0m16:49:59.559726 [info ] [MainThread]: 
[0m16:49:59.561722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:59.563721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:49:59.584723 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:49:59.585722 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:49:59.585722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:00.666005 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:50:00.670008 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:50:00.795778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m16:50:00.815296 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:50:00.815296 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:50:00.816310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:01.348706 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:50:01.356759 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:50:01.475310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m16:50:01.480308 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:50:01.480308 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:50:01.481308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:01.871923 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:50:01.874924 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:50:02.370747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m16:50:02.373734 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:50:02.374734 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:50:02.374734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:02.706274 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0048-0001-429e-0008-435e0002313a
[0m16:50:02.707278 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:50:02.708288 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:50:02.708288 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:50:02.709287 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:50:02.800748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m16:50:02.803748 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:50:02.804748 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:50:02.805752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:03.256886 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:50:03.258885 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:50:03.362927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86e2e6e-81a0-44cb-b92e-63924113f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C975E510>]}
[0m16:50:03.363928 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:03.363928 [info ] [MainThread]: 
[0m16:50:03.398959 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m16:50:03.398959 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_high_cross ............................. [RUN]
[0m16:50:03.399979 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_high_cross'
[0m16:50:03.400928 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m16:50:03.409935 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m16:50:03.410935 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 16:50:03.400928 => 16:50:03.410935
[0m16:50:03.411937 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m16:50:03.442195 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m16:50:03.444162 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m16:50:03.445163 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    UNIQUE_PRODUCTS,
    TOTAL_REVENUE
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    GROUP BY CUSTOMER_ID
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m16:50:03.445163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:50:03.960942 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0048-0001-429a-0008-435e00020d2e
[0m16:50:03.960942 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'CROSS_SELL.UNIQUE_PRODUCTS' in select clause is neither an aggregate nor in the group by clause.
[0m16:50:03.961941 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 16:50:03.411937 => 16:50:03.961941
[0m16:50:03.961941 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m16:50:04.064101 [debug] [Thread-1 (]: Database Error in model mart_high_cross (models\marts\mart_high_cross.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'CROSS_SELL.UNIQUE_PRODUCTS' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\mart_high_cross.sql
[0m16:50:04.065101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a86e2e6e-81a0-44cb-b92e-63924113f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180C99880B0>]}
[0m16:50:04.066100 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_high_cross .................... [[31mERROR[0m in 0.67s]
[0m16:50:04.067100 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m16:50:04.069070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:04.070069 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:50:04.070069 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m16:50:04.071069 [debug] [MainThread]: Connection 'model.practice.mart_high_cross' was properly closed.
[0m16:50:04.071069 [info ] [MainThread]: 
[0m16:50:04.072071 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m16:50:04.073071 [debug] [MainThread]: Command end result
[0m16:50:04.090075 [info ] [MainThread]: 
[0m16:50:04.105070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:04.106073 [info ] [MainThread]: 
[0m16:50:04.107082 [error] [MainThread]:   Database Error in model mart_high_cross (models\marts\mart_high_cross.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'CROSS_SELL.UNIQUE_PRODUCTS' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\mart_high_cross.sql
[0m16:50:04.108072 [info ] [MainThread]: 
[0m16:50:04.109071 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:50:04.110071 [debug] [MainThread]: Command `dbt run` failed at 16:50:04.110071 after 6.99 seconds
[0m16:50:04.111072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180BC639220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180BACF91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180BA1B0680>]}
[0m16:50:04.111072 [debug] [MainThread]: Flushing usage events
[0m16:50:41.171913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85FE59520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85FE5BAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85FE5B9B0>]}


============================== 16:50:41.176911 | b2162432-fa75-49f1-bced-7b05f8682d05 ==============================
[0m16:50:41.176911 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:50:41.177877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_high_cross', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:42.066865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2162432-fa75-49f1-bced-7b05f8682d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86C84BF50>]}
[0m16:50:42.155514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2162432-fa75-49f1-bced-7b05f8682d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86C25BBF0>]}
[0m16:50:42.156513 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:50:42.164513 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:50:42.276126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:50:42.277101 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_high_cross.sql
[0m16:50:42.413136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m16:50:42.419166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2162432-fa75-49f1-bced-7b05f8682d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86C8AC410>]}
[0m16:50:42.432139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2162432-fa75-49f1-bced-7b05f8682d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86C94EEA0>]}
[0m16:50:42.433144 [info ] [MainThread]: Found 12 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:50:42.434136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2162432-fa75-49f1-bced-7b05f8682d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86CA710D0>]}
[0m16:50:42.436167 [info ] [MainThread]: 
[0m16:50:42.437167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:42.438125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:50:42.452133 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:50:42.453133 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:50:42.453133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:43.380674 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:50:43.394652 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:50:43.494939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m16:50:43.508907 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:50:43.508907 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:50:43.509905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:44.001404 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:50:44.003405 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:50:44.096992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m16:50:44.101017 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:50:44.101017 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:50:44.101017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:44.436712 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0048-0001-429e-0008-435e0002313e
[0m16:50:44.436712 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:50:44.437711 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:50:44.437711 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:50:44.438678 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:50:44.531603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m16:50:44.536604 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:50:44.537605 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:50:44.538598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:44.883219 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:50:44.885219 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:50:44.980735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m16:50:44.984738 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:50:44.985738 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:50:44.985738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:45.441653 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:50:45.442653 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:50:45.542544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2162432-fa75-49f1-bced-7b05f8682d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86CC905C0>]}
[0m16:50:45.543544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:45.543904 [info ] [MainThread]: 
[0m16:50:45.547666 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m16:50:45.548697 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_high_cross ............................. [RUN]
[0m16:50:45.549692 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_high_cross'
[0m16:50:45.549692 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m16:50:45.558668 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m16:50:45.559704 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 16:50:45.550696 => 16:50:45.559704
[0m16:50:45.560699 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m16:50:45.592667 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m16:50:45.594667 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m16:50:45.594667 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    TOTAL_REVENUE
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    GROUP BY CUSTOMER_ID
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m16:50:45.595668 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:50:45.947935 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0048-0001-429b-0008-435e000223be
[0m16:50:45.948968 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'CROSS_SELL.TOTAL_REVENUE' in select clause is neither an aggregate nor in the group by clause.
[0m16:50:45.949969 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 16:50:45.560699 => 16:50:45.948968
[0m16:50:45.949969 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m16:50:46.054802 [debug] [Thread-1 (]: Database Error in model mart_high_cross (models\marts\mart_high_cross.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'CROSS_SELL.TOTAL_REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\mart_high_cross.sql
[0m16:50:46.055789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2162432-fa75-49f1-bced-7b05f8682d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86CEAB860>]}
[0m16:50:46.056791 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_high_cross .................... [[31mERROR[0m in 0.51s]
[0m16:50:46.058786 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m16:50:46.063380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:46.064378 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:50:46.064378 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m16:50:46.065378 [debug] [MainThread]: Connection 'model.practice.mart_high_cross' was properly closed.
[0m16:50:46.065378 [info ] [MainThread]: 
[0m16:50:46.066549 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m16:50:46.068557 [debug] [MainThread]: Command end result
[0m16:50:46.082556 [info ] [MainThread]: 
[0m16:50:46.083557 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:46.084591 [info ] [MainThread]: 
[0m16:50:46.085528 [error] [MainThread]:   Database Error in model mart_high_cross (models\marts\mart_high_cross.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'CROSS_SELL.TOTAL_REVENUE' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\mart_high_cross.sql
[0m16:50:46.086604 [info ] [MainThread]: 
[0m16:50:46.086604 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:50:46.088613 [debug] [MainThread]: Command `dbt run` failed at 16:50:46.088613 after 4.98 seconds
[0m16:50:46.088613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85FD81910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85FE5AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85FE5B9B0>]}
[0m16:50:46.089612 [debug] [MainThread]: Flushing usage events
[0m16:51:15.987122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002062B83FCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002062B8DCF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002062BB59040>]}


============================== 16:51:16.000213 | 155d3497-6835-49ba-850d-869b76db0f9e ==============================
[0m16:51:16.000213 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:51:16.001212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_high_cross', 'send_anonymous_usage_stats': 'True'}
[0m16:51:23.091010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '155d3497-6835-49ba-850d-869b76db0f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020638247F20>]}
[0m16:51:23.179529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '155d3497-6835-49ba-850d-869b76db0f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206369A4380>]}
[0m16:51:23.187296 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:51:23.204303 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:51:24.428866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:51:24.428866 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_high_cross.sql
[0m16:51:24.562386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:51:24.568605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '155d3497-6835-49ba-850d-869b76db0f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206387FE630>]}
[0m16:51:24.594578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '155d3497-6835-49ba-850d-869b76db0f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020638552D80>]}
[0m16:51:24.595607 [info ] [MainThread]: Found 12 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:51:24.596578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '155d3497-6835-49ba-850d-869b76db0f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020636C80EC0>]}
[0m16:51:24.597607 [info ] [MainThread]: 
[0m16:51:24.598733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:24.600771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:51:24.613811 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:51:24.614811 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:51:24.614811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:25.755295 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:51:25.762281 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:51:25.881787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m16:51:25.892785 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:51:25.893788 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:51:25.893788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:26.390904 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:51:26.391903 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:51:26.497536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m16:51:26.510520 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:51:26.512511 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:51:26.513505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:27.162738 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0049-0001-429e-0008-435e00023146
[0m16:51:27.163737 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:51:27.163737 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:51:27.163737 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:51:27.164738 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:51:27.280209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m16:51:27.284171 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:51:27.285171 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:51:27.285171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:27.650974 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:51:27.652970 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:51:27.756965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m16:51:27.762996 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:51:27.762996 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:51:27.763996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:28.103418 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:51:28.109406 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:51:28.232593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '155d3497-6835-49ba-850d-869b76db0f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206387EE330>]}
[0m16:51:28.235609 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:28.237544 [info ] [MainThread]: 
[0m16:51:28.247352 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m16:51:28.248352 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_high_cross ............................. [RUN]
[0m16:51:28.250344 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_high_cross'
[0m16:51:28.250344 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m16:51:28.262944 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m16:51:28.264915 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 16:51:28.251352 => 16:51:28.263911
[0m16:51:28.264915 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m16:51:28.297939 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m16:51:28.299909 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m16:51:28.300939 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    UNIQUE_PRODUCTS
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    GROUP BY CUSTOMER_ID
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m16:51:28.300939 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:51:28.796886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0049-0001-429e-0008-435e0002314e
[0m16:51:28.796886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'CROSS_SELL.UNIQUE_PRODUCTS' in select clause is neither an aggregate nor in the group by clause.
[0m16:51:28.797887 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 16:51:28.265944 => 16:51:28.797887
[0m16:51:28.797887 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m16:51:28.910541 [debug] [Thread-1 (]: Database Error in model mart_high_cross (models\marts\mart_high_cross.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'CROSS_SELL.UNIQUE_PRODUCTS' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\mart_high_cross.sql
[0m16:51:28.910541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155d3497-6835-49ba-850d-869b76db0f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020638AA9A60>]}
[0m16:51:28.911541 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_high_cross .................... [[31mERROR[0m in 0.66s]
[0m16:51:28.912511 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m16:51:28.914518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:28.915541 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:51:28.915541 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m16:51:28.915541 [debug] [MainThread]: Connection 'model.practice.mart_high_cross' was properly closed.
[0m16:51:28.916542 [info ] [MainThread]: 
[0m16:51:28.917509 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m16:51:28.918512 [debug] [MainThread]: Command end result
[0m16:51:28.930511 [info ] [MainThread]: 
[0m16:51:28.931511 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:51:28.932511 [info ] [MainThread]: 
[0m16:51:28.933543 [error] [MainThread]:   Database Error in model mart_high_cross (models\marts\mart_high_cross.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'CROSS_SELL.UNIQUE_PRODUCTS' in select clause is neither an aggregate nor in the group by clause.
  compiled Code at target\run\practice\models\marts\mart_high_cross.sql
[0m16:51:28.934510 [info ] [MainThread]: 
[0m16:51:28.934510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:51:28.936543 [debug] [MainThread]: Command `dbt run` failed at 16:51:28.936543 after 13.04 seconds
[0m16:51:28.936543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002062B908680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002062BA59070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002062BA81AF0>]}
[0m16:51:28.937542 [debug] [MainThread]: Flushing usage events
[0m16:51:43.761515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C8B22630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C8C54110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C8C552E0>]}


============================== 16:51:43.765546 | eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf ==============================
[0m16:51:43.765546 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:51:43.766546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_high_cross', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:51:44.633484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D557DE50>]}
[0m16:51:44.719523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D540EF90>]}
[0m16:51:44.720521 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:51:44.728057 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:51:44.842610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:51:44.843610 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_high_cross.sql
[0m16:51:44.976099 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:51:44.981130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D567D760>]}
[0m16:51:44.994098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D5752E70>]}
[0m16:51:44.994098 [info ] [MainThread]: Found 12 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:51:44.995099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D3DB0440>]}
[0m16:51:44.997098 [info ] [MainThread]: 
[0m16:51:44.998099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:45.000098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:51:45.016111 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:51:45.017108 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:51:45.017108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:45.813597 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:51:45.815587 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:51:45.918098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m16:51:45.944824 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:51:45.945824 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:51:45.946824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:46.379754 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:51:46.387754 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:51:46.480126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m16:51:46.486124 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:51:46.487124 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:51:46.487124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:46.825500 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:51:46.828493 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:51:46.934638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m16:51:46.938210 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:51:46.938210 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:51:46.939214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:47.285317 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0049-0001-429e-0008-435e00023156
[0m16:51:47.285317 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:51:47.286318 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:51:47.286318 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:51:47.286318 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:51:47.404613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m16:51:47.407618 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:51:47.408617 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:51:47.408617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:47.714988 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m16:51:47.716985 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:51:47.819524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D593F830>]}
[0m16:51:47.820491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:47.821458 [info ] [MainThread]: 
[0m16:51:47.824906 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m16:51:47.825905 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_high_cross ............................. [RUN]
[0m16:51:47.826906 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_high_cross'
[0m16:51:47.827906 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m16:51:47.835936 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m16:51:47.836904 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 16:51:47.827906 => 16:51:47.836904
[0m16:51:47.837904 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m16:51:47.869120 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m16:51:47.871088 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m16:51:47.872089 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    UNIQUE_PRODUCTS
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m16:51:47.873102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:51:50.081082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:51:50.107071 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 16:51:47.837904 => 16:51:50.107071
[0m16:51:50.108071 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m16:51:50.202824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaefb27f-a0e4-41d1-bfb3-b239a1c8e7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D59C0560>]}
[0m16:51:50.203820 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_high_cross ........................ [[32mSUCCESS 1[0m in 2.37s]
[0m16:51:50.205775 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m16:51:50.207809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:50.207809 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:51:50.208806 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m16:51:50.208806 [debug] [MainThread]: Connection 'model.practice.mart_high_cross' was properly closed.
[0m16:51:50.208806 [info ] [MainThread]: 
[0m16:51:50.209901 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m16:51:50.210909 [debug] [MainThread]: Command end result
[0m16:51:50.221909 [info ] [MainThread]: 
[0m16:51:50.222916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:50.223907 [info ] [MainThread]: 
[0m16:51:50.224909 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:51:50.225909 [debug] [MainThread]: Command `dbt run` succeeded at 16:51:50.225909 after 6.52 seconds
[0m16:51:50.226938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C88B72F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C8B22630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244C8C54110>]}
[0m16:51:50.226938 [debug] [MainThread]: Flushing usage events
[0m16:52:37.855977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80270AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802955220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802955280>]}


============================== 16:52:37.860976 | a9f892c1-9e3e-4da9-9249-48673ac9a590 ==============================
[0m16:52:37.860976 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:52:37.862006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_high_cross', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:52:38.764169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9f892c1-9e3e-4da9-9249-48673ac9a590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80F24BEC0>]}
[0m16:52:38.850787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9f892c1-9e3e-4da9-9249-48673ac9a590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80CFC05C0>]}
[0m16:52:38.852761 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:52:38.860787 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:52:38.974310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:52:38.975308 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_high_cross.sql
[0m16:52:39.107749 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:52:39.113755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9f892c1-9e3e-4da9-9249-48673ac9a590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80F1BD760>]}
[0m16:52:39.126756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9f892c1-9e3e-4da9-9249-48673ac9a590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80F34F1A0>]}
[0m16:52:39.127757 [info ] [MainThread]: Found 12 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:52:39.128757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f892c1-9e3e-4da9-9249-48673ac9a590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80F53E330>]}
[0m16:52:39.130787 [info ] [MainThread]: 
[0m16:52:39.131763 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:39.133168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:52:39.149175 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:52:39.149175 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:52:39.149175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:40.263955 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:52:40.265956 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:52:40.375569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m16:52:40.385570 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:52:40.385570 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:52:40.386569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:40.870105 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m16:52:40.874089 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:52:40.982650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m16:52:40.991608 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:52:40.991608 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:52:40.991608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:41.364976 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:52:41.367974 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:52:41.474092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m16:52:41.487085 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:52:41.489132 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:52:41.490131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:41.958179 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb004a-0001-429b-0008-435e00022436
[0m16:52:41.958179 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:52:41.959179 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:52:41.959179 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:52:41.960187 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:52:42.066227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m16:52:42.076287 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:52:42.077288 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:52:42.077288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:42.425169 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:52:42.428167 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:52:42.533122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f892c1-9e3e-4da9-9249-48673ac9a590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8029544A0>]}
[0m16:52:42.534091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:42.535122 [info ] [MainThread]: 
[0m16:52:42.539117 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m16:52:42.540115 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_high_cross ............................. [RUN]
[0m16:52:42.541116 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_high_cross'
[0m16:52:42.541116 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m16:52:42.549122 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m16:52:42.551091 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 16:52:42.542091 => 16:52:42.550121
[0m16:52:42.551091 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m16:52:42.582092 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m16:52:42.583122 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m16:52:42.584123 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    UNIQUE_PRODUCTS,
    TOTAL_REVENUE
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m16:52:42.584123 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:52:43.368965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:52:43.389963 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 16:52:42.551091 => 16:52:43.389963
[0m16:52:43.390962 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m16:52:43.475029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9f892c1-9e3e-4da9-9249-48673ac9a590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80F88A2D0>]}
[0m16:52:43.476030 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_high_cross ........................ [[32mSUCCESS 1[0m in 0.93s]
[0m16:52:43.479029 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m16:52:43.482029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:43.483029 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:52:43.484029 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m16:52:43.484029 [debug] [MainThread]: Connection 'model.practice.mart_high_cross' was properly closed.
[0m16:52:43.485034 [info ] [MainThread]: 
[0m16:52:43.486028 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m16:52:43.488991 [debug] [MainThread]: Command end result
[0m16:52:43.500986 [info ] [MainThread]: 
[0m16:52:43.501987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:43.502985 [info ] [MainThread]: 
[0m16:52:43.502985 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:52:43.504984 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:43.504984 after 5.71 seconds
[0m16:52:43.504984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C802619910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8027091F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C80270AC00>]}
[0m16:52:43.506021 [debug] [MainThread]: Flushing usage events
[0m16:55:52.852113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F1255730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F12553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F1257590>]}


============================== 16:55:52.856150 | 066c27fa-2e49-4add-9f41-13e1b8f96447 ==============================
[0m16:55:52.856150 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:55:52.857145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_prod_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:53.784275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '066c27fa-2e49-4add-9f41-13e1b8f96447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F1257AD0>]}
[0m16:55:53.873252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '066c27fa-2e49-4add-9f41-13e1b8f96447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173FD4EA3F0>]}
[0m16:55:53.874285 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:55:53.882789 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:55:54.000330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:55:54.001299 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_prod_churn.sql
[0m16:55:54.134914 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:55:54.139945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '066c27fa-2e49-4add-9f41-13e1b8f96447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173FDC144D0>]}
[0m16:55:54.152913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '066c27fa-2e49-4add-9f41-13e1b8f96447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173FDD52990>]}
[0m16:55:54.153949 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:55:54.154916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '066c27fa-2e49-4add-9f41-13e1b8f96447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173EFEF79E0>]}
[0m16:55:54.155914 [info ] [MainThread]: 
[0m16:55:54.157914 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:54.158945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:55:54.174951 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:55:54.175952 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:55:54.175952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:55.154986 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:55:55.156983 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:55:55.272319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m16:55:55.282318 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:55:55.282318 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:55:55.283319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:55.589839 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb004d-0001-429b-0008-435e00022482
[0m16:55:55.589839 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:55:55.589839 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:55:55.590841 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:55:55.590841 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:55:55.690039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m16:55:55.696040 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:55:55.697040 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:55:55.699039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:56.166586 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:55:56.168593 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:55:56.256487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m16:55:56.261456 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:55:56.261456 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:55:56.262458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:56.586470 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m16:55:56.588467 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:55:56.735522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m16:55:56.739522 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:55:56.739522 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:55:56.739522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:57.203527 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:55:57.205570 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:55:57.308731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '066c27fa-2e49-4add-9f41-13e1b8f96447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173FDF3F170>]}
[0m16:55:57.311791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:57.315199 [info ] [MainThread]: 
[0m16:55:57.329190 [debug] [Thread-1 (]: Began running node model.practice.mart_prod_churn
[0m16:55:57.331189 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_prod_churn ............................. [RUN]
[0m16:55:57.336188 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_prod_churn'
[0m16:55:57.338185 [debug] [Thread-1 (]: Began compiling node model.practice.mart_prod_churn
[0m16:55:57.361215 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_prod_churn"
[0m16:55:57.364177 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (compile): 16:55:57.340239 => 16:55:57.363176
[0m16:55:57.365212 [debug] [Thread-1 (]: Began executing node model.practice.mart_prod_churn
[0m16:55:57.398792 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_prod_churn"
[0m16:55:57.400760 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_prod_churn"
[0m16:55:57.401792 [debug] [Thread-1 (]: On model.practice.mart_prod_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_prod_churn"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_prod_churn
         as
        (



WITH transactions AS (
    SELECT
        PRODUCT_ID,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.PRODUCT_ID,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS LM_churn_status,
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS Ltm_churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.PRODUCT_ID,m.latest_month
)
SELECT * FROM churn_status
        );
[0m16:55:57.401792 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:57.754179 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb004d-0001-429e-0008-435e000231fe
[0m16:55:57.755182 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 17 unexpected 'MAX'.
syntax error line 30 at position 21 unexpected 't'.
syntax error line 30 at position 35 unexpected '<='.
[0m16:55:57.756217 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (execute): 16:55:57.365212 => 16:55:57.755182
[0m16:55:57.756217 [debug] [Thread-1 (]: On model.practice.mart_prod_churn: Close
[0m16:55:57.870022 [debug] [Thread-1 (]: Database Error in model mart_prod_churn (models\marts\mart_prod_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 17 unexpected 'MAX'.
  syntax error line 30 at position 21 unexpected 't'.
  syntax error line 30 at position 35 unexpected '<='.
  compiled Code at target\run\practice\models\marts\mart_prod_churn.sql
[0m16:55:57.871020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066c27fa-2e49-4add-9f41-13e1b8f96447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173FE2853A0>]}
[0m16:55:57.871020 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_prod_churn .................... [[31mERROR[0m in 0.54s]
[0m16:55:57.872992 [debug] [Thread-1 (]: Finished running node model.practice.mart_prod_churn
[0m16:55:57.875075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:57.875075 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:55:57.876114 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m16:55:57.876114 [debug] [MainThread]: Connection 'model.practice.mart_prod_churn' was properly closed.
[0m16:55:57.876114 [info ] [MainThread]: 
[0m16:55:57.877155 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m16:55:57.878119 [debug] [MainThread]: Command end result
[0m16:55:57.891629 [info ] [MainThread]: 
[0m16:55:57.892222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:57.893230 [info ] [MainThread]: 
[0m16:55:57.893230 [error] [MainThread]:   Database Error in model mart_prod_churn (models\marts\mart_prod_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 17 unexpected 'MAX'.
  syntax error line 30 at position 21 unexpected 't'.
  syntax error line 30 at position 35 unexpected '<='.
  compiled Code at target\run\practice\models\marts\mart_prod_churn.sql
[0m16:55:57.894259 [info ] [MainThread]: 
[0m16:55:57.895227 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:57.896227 [debug] [MainThread]: Command `dbt run` failed at 16:55:57.896227 after 5.11 seconds
[0m16:55:57.897260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F128B8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F12553A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173F1255730>]}
[0m16:55:57.897260 [debug] [MainThread]: Flushing usage events
[0m16:56:22.223081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B03555B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B0108620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B0355370>]}


============================== 16:56:22.229078 | 21ca2c37-9816-4f9d-bd3b-08c24ed697aa ==============================
[0m16:56:22.229078 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:56:22.239079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_prod_churn', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:23.200221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21ca2c37-9816-4f9d-bd3b-08c24ed697aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260BCB207A0>]}
[0m16:56:23.287831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21ca2c37-9816-4f9d-bd3b-08c24ed697aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260BC6D3D70>]}
[0m16:56:23.288832 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:56:23.297801 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:56:23.421351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:56:23.422350 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_prod_churn.sql
[0m16:56:23.554947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m16:56:23.560951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21ca2c37-9816-4f9d-bd3b-08c24ed697aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260BCF5D760>]}
[0m16:56:23.573276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21ca2c37-9816-4f9d-bd3b-08c24ed697aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260BCD52BA0>]}
[0m16:56:23.573276 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m16:56:23.574316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ca2c37-9816-4f9d-bd3b-08c24ed697aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260BCF2EF30>]}
[0m16:56:23.576288 [info ] [MainThread]: 
[0m16:56:23.577285 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:23.579314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m16:56:23.594318 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m16:56:23.594318 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m16:56:23.595314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:24.421250 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:56:24.422250 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m16:56:24.522704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m16:56:24.530710 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m16:56:24.531711 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m16:56:24.531711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:24.865166 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:56:24.867158 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m16:56:24.976884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m16:56:24.986526 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m16:56:24.987523 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m16:56:24.987523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:25.408773 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:56:25.411772 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m16:56:25.508107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m16:56:25.515106 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m16:56:25.516104 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m16:56:25.517104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:25.894730 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m16:56:25.896730 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m16:56:25.995795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m16:56:26.002795 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m16:56:26.003798 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m16:56:26.004798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:26.452573 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb004e-0001-429b-0008-435e0002248a
[0m16:56:26.452573 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:56:26.453608 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:56:26.453608 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:56:26.454572 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m16:56:26.557233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ca2c37-9816-4f9d-bd3b-08c24ed697aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260BCD8EDB0>]}
[0m16:56:26.559278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:26.560236 [info ] [MainThread]: 
[0m16:56:26.568001 [debug] [Thread-1 (]: Began running node model.practice.mart_prod_churn
[0m16:56:26.569039 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_prod_churn ............................. [RUN]
[0m16:56:26.572005 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_prod_churn'
[0m16:56:26.572999 [debug] [Thread-1 (]: Began compiling node model.practice.mart_prod_churn
[0m16:56:26.592050 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_prod_churn"
[0m16:56:26.594050 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (compile): 16:56:26.574000 => 16:56:26.593047
[0m16:56:26.595556 [debug] [Thread-1 (]: Began executing node model.practice.mart_prod_churn
[0m16:56:26.630564 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_prod_churn"
[0m16:56:26.632567 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_prod_churn"
[0m16:56:26.633565 [debug] [Thread-1 (]: On model.practice.mart_prod_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_prod_churn"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_prod_churn
         as
        (



WITH transactions AS (
    SELECT
        PRODUCT_ID,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.PRODUCT_ID,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS LM_churn_status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS Ltm_churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.PRODUCT_ID,m.latest_month
)
SELECT * FROM churn_status
        );
[0m16:56:26.633565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:27.417408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:56:27.443435 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (execute): 16:56:26.595556 => 16:56:27.443435
[0m16:56:27.444432 [debug] [Thread-1 (]: On model.practice.mart_prod_churn: Close
[0m16:56:27.574080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21ca2c37-9816-4f9d-bd3b-08c24ed697aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260BD1DC740>]}
[0m16:56:27.574080 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_prod_churn ........................ [[32mSUCCESS 1[0m in 1.00s]
[0m16:56:27.575077 [debug] [Thread-1 (]: Finished running node model.practice.mart_prod_churn
[0m16:56:27.577080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:27.578080 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m16:56:27.578080 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m16:56:27.578080 [debug] [MainThread]: Connection 'model.practice.mart_prod_churn' was properly closed.
[0m16:56:27.579080 [info ] [MainThread]: 
[0m16:56:27.580078 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m16:56:27.581083 [debug] [MainThread]: Command end result
[0m16:56:27.595089 [info ] [MainThread]: 
[0m16:56:27.596088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:27.597088 [info ] [MainThread]: 
[0m16:56:27.598088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:56:27.599428 [debug] [MainThread]: Command `dbt run` succeeded at 16:56:27.599428 after 5.44 seconds
[0m16:56:27.599428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B0383B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AEFF5AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260AEFB7FB0>]}
[0m16:56:27.600429 [debug] [MainThread]: Flushing usage events
[0m17:12:35.810342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013140058140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001313EE33E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013140059280>]}


============================== 17:12:35.827405 | 55633fde-d5c1-47ff-8a8a-e77a3b62e155 ==============================
[0m17:12:35.827405 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:12:35.829374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_high_cross', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:12:43.745485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55633fde-d5c1-47ff-8a8a-e77a3b62e155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C8BC260>]}
[0m17:12:43.832811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55633fde-d5c1-47ff-8a8a-e77a3b62e155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314C256DB0>]}
[0m17:12:43.840985 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:12:43.858353 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:12:45.134816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:12:45.135819 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_high_cross.sql
[0m17:12:45.135819 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_prod_churn.sql
[0m17:12:45.282061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:12:45.287092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55633fde-d5c1-47ff-8a8a-e77a3b62e155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314CC89550>]}
[0m17:12:45.313638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55633fde-d5c1-47ff-8a8a-e77a3b62e155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314CA52ED0>]}
[0m17:12:45.313638 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:12:45.314670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55633fde-d5c1-47ff-8a8a-e77a3b62e155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314AC201A0>]}
[0m17:12:45.316636 [info ] [MainThread]: 
[0m17:12:45.317612 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:12:45.319666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:12:45.333649 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:12:45.334650 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:12:45.334650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:46.576449 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:12:46.579449 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:12:46.681149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m17:12:46.690157 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:12:46.690157 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:12:46.690157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:47.183754 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb005e-0001-429e-0008-435e000232a2
[0m17:12:47.183754 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:12:47.183754 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:12:47.184754 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:12:47.184754 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:12:47.288184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m17:12:47.294177 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:12:47.295183 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:12:47.295183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:47.606209 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m17:12:47.608203 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:12:47.711430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:12:47.715430 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:12:47.716431 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:12:47.716431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:48.033383 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:12:48.035383 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:12:48.130928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:12:48.133928 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:12:48.133928 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:12:48.134928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:48.454031 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:12:48.456030 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:12:48.557775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55633fde-d5c1-47ff-8a8a-e77a3b62e155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314CBF0BF0>]}
[0m17:12:48.558784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:48.559754 [info ] [MainThread]: 
[0m17:12:48.591004 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m17:12:48.591004 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_high_cross ............................. [RUN]
[0m17:12:48.593004 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_high_cross'
[0m17:12:48.593004 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m17:12:48.602006 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m17:12:48.604523 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 17:12:48.593004 => 17:12:48.604523
[0m17:12:48.605522 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m17:12:48.642554 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m17:12:48.644521 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m17:12:48.644521 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    UNIQUE_PRODUCTS,
    RANK() OVER (ORDER BY UNIQUE_PRODUCTS DESC) AS RANK,
    TOTAL_REVENUE
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m17:12:48.645521 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:51.774413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:12:51.799658 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 17:12:48.605522 => 17:12:51.799658
[0m17:12:51.800698 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m17:12:51.899384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55633fde-d5c1-47ff-8a8a-e77a3b62e155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314CF820F0>]}
[0m17:12:51.900394 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_high_cross ........................ [[32mSUCCESS 1[0m in 3.31s]
[0m17:12:51.901394 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m17:12:51.908401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:51.909401 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:12:51.909908 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:12:51.909908 [debug] [MainThread]: Connection 'model.practice.mart_high_cross' was properly closed.
[0m17:12:51.909908 [info ] [MainThread]: 
[0m17:12:51.910916 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m17:12:51.912924 [debug] [MainThread]: Command end result
[0m17:12:51.926454 [info ] [MainThread]: 
[0m17:12:51.927456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:51.930960 [info ] [MainThread]: 
[0m17:12:51.930960 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:12:51.932968 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:51.932968 after 16.21 seconds
[0m17:12:51.932968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131400592E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314008BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001314008BEF0>]}
[0m17:12:51.933973 [debug] [MainThread]: Flushing usage events
[0m17:13:31.341911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD28575C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD2854920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD2856C00>]}


============================== 17:13:31.346946 | 1cecbbe4-af71-429b-82a6-66e3d95560b6 ==============================
[0m17:13:31.346946 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:13:31.347911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_high_cross', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:32.293925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cecbbe4-af71-429b-82a6-66e3d95560b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDF0884A0>]}
[0m17:13:32.385514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cecbbe4-af71-429b-82a6-66e3d95560b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD22CB0B0>]}
[0m17:13:32.387483 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:13:32.397478 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:13:32.526998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:32.528000 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_high_cross.sql
[0m17:13:32.665527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:13:32.671039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cecbbe4-af71-429b-82a6-66e3d95560b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDF440920>]}
[0m17:13:32.684067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cecbbe4-af71-429b-82a6-66e3d95560b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDF247260>]}
[0m17:13:32.684067 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:13:32.685042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cecbbe4-af71-429b-82a6-66e3d95560b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDF42D250>]}
[0m17:13:32.687043 [info ] [MainThread]: 
[0m17:13:32.688045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:13:32.690074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:13:32.704083 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:13:32.705085 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:13:32.705085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:33.548898 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:13:33.550930 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:13:33.654727 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:13:33.663762 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:13:33.663762 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:13:33.663762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:34.029007 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m17:13:34.030976 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:13:34.126525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:13:34.130529 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:13:34.131525 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:13:34.131525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:34.599430 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:13:34.601430 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:13:34.697907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m17:13:34.700939 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:13:34.701939 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:13:34.701939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:35.035044 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb005f-0001-429a-0008-435e00020e76
[0m17:13:35.035044 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:13:35.036061 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:13:35.036061 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:13:35.037067 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:13:35.135569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m17:13:35.138571 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:13:35.138571 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:13:35.139571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:35.463320 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:13:35.470321 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:13:35.591775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cecbbe4-af71-429b-82a6-66e3d95560b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDF505430>]}
[0m17:13:35.593737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:35.595735 [info ] [MainThread]: 
[0m17:13:35.601768 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m17:13:35.602767 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_high_cross ............................. [RUN]
[0m17:13:35.605784 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_high_cross'
[0m17:13:35.605784 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m17:13:35.615731 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m17:13:35.616731 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 17:13:35.606732 => 17:13:35.616731
[0m17:13:35.617731 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m17:13:35.651729 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m17:13:35.653749 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m17:13:35.654730 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    UNIQUE_PRODUCTS,
    DENSE_RANK() OVER (ORDER BY UNIQUE_PRODUCTS DESC) AS RANK,
    TOTAL_REVENUE
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m17:13:35.654730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:13:37.033692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:13:37.055692 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 17:13:35.617731 => 17:13:37.055692
[0m17:13:37.056691 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m17:13:37.158592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cecbbe4-af71-429b-82a6-66e3d95560b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDF6B66F0>]}
[0m17:13:37.159590 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_high_cross ........................ [[32mSUCCESS 1[0m in 1.55s]
[0m17:13:37.160558 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m17:13:37.162531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:37.163531 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:13:37.163531 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:13:37.164530 [debug] [MainThread]: Connection 'model.practice.mart_high_cross' was properly closed.
[0m17:13:37.164530 [info ] [MainThread]: 
[0m17:13:37.165640 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m17:13:37.166648 [debug] [MainThread]: Command end result
[0m17:13:37.179652 [info ] [MainThread]: 
[0m17:13:37.180681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:37.181647 [info ] [MainThread]: 
[0m17:13:37.182647 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:13:37.183681 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:37.183681 after 5.90 seconds
[0m17:13:37.184678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD2519910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CDF4FAEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD2AF86E0>]}
[0m17:13:37.184678 [debug] [MainThread]: Flushing usage events
[0m17:24:59.070990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002692B454260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002692B456300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002692B4552E0>]}


============================== 17:24:59.087586 | 7be0eadb-7896-45f1-b625-eedeb9e761eb ==============================
[0m17:24:59.087586 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:24:59.089566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:07.238103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7be0eadb-7896-45f1-b625-eedeb9e761eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026937C22300>]}
[0m17:25:07.329619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7be0eadb-7896-45f1-b625-eedeb9e761eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002692B4B8530>]}
[0m17:25:07.337620 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:25:07.356619 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:25:08.683267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:08.684269 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:25:08.831170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:25:08.837170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7be0eadb-7896-45f1-b625-eedeb9e761eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026937E11FD0>]}
[0m17:25:08.863928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7be0eadb-7896-45f1-b625-eedeb9e761eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026937E52CF0>]}
[0m17:25:08.863928 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:25:08.864958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be0eadb-7896-45f1-b625-eedeb9e761eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026937D78EC0>]}
[0m17:25:08.866991 [info ] [MainThread]: 
[0m17:25:08.866991 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:25:08.868966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:25:08.882477 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:25:08.883477 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:25:08.883477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:10.408569 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m17:25:10.410567 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:25:10.516509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m17:25:10.524507 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:25:10.525509 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:25:10.525509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:11.109271 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m17:25:11.111227 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:25:11.281978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m17:25:11.290989 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:25:11.290989 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:25:11.292018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:11.637031 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m17:25:11.641035 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:25:11.748526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m17:25:11.758447 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:25:11.758447 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:25:11.758447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:12.335933 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb006b-0001-429b-0008-435e00024006
[0m17:25:12.335933 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:25:12.336963 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:25:12.336963 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:25:12.337964 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:25:12.442736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m17:25:12.445535 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:25:12.445535 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:25:12.445535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:12.805936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:25:12.807957 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:25:12.908528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be0eadb-7896-45f1-b625-eedeb9e761eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269381059A0>]}
[0m17:25:12.909525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:12.909525 [info ] [MainThread]: 
[0m17:25:12.916525 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:25:12.917552 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:25:12.918526 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:25:12.918526 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:25:12.926527 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:25:12.927527 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:25:12.918526 => 17:25:12.927527
[0m17:25:12.928526 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:25:12.962527 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:25:12.964553 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:25:12.964553 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH nrr_grr AS(
SELECT 
    SUM(RAVENUE) AS TOTAL_REVENUE,
    LAG(SUM(RAVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS PREV_REVENUE,
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY PAYMENT_MONTH
)
SELECT 
    PAYMENT_MONTH,
    TOTAL_REVENUE,
    PREV_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE) AS NET_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE)/PREV_REVENUE AS GROWTH_RATE
FROM nrr_grr
ORDER BY PAYMENT_MONTH
        );
[0m17:25:12.965571 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:13.420142 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb006b-0001-429a-0008-435e00020e86
[0m17:25:13.420142 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'RAVENUE'
[0m17:25:13.421146 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:25:12.928526 => 17:25:13.420142
[0m17:25:13.421146 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:25:13.524771 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'RAVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:25:13.525771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be0eadb-7896-45f1-b625-eedeb9e761eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269382F8C20>]}
[0m17:25:13.525771 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.61s]
[0m17:25:13.526774 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:25:13.529746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:13.529746 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:25:13.529746 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m17:25:13.530771 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:25:13.530771 [info ] [MainThread]: 
[0m17:25:13.531746 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m17:25:13.532748 [debug] [MainThread]: Command end result
[0m17:25:13.545746 [info ] [MainThread]: 
[0m17:25:13.546897 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:25:13.547903 [info ] [MainThread]: 
[0m17:25:13.551493 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'RAVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:25:13.551493 [info ] [MainThread]: 
[0m17:25:13.553500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:25:13.554494 [debug] [MainThread]: Command `dbt run` failed at 17:25:13.554494 after 14.58 seconds
[0m17:25:13.555492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002692B321220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002692B301100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002692B03FFB0>]}
[0m17:25:13.555492 [debug] [MainThread]: Flushing usage events
[0m17:25:38.811642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001224EB55370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001224EB541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001224EB56510>]}


============================== 17:25:38.816611 | 522061e5-a980-48ee-87bf-5938214933db ==============================
[0m17:25:38.816611 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:25:38.816611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:39.716240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '522061e5-a980-48ee-87bf-5938214933db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001225B043BF0>]}
[0m17:25:39.803853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '522061e5-a980-48ee-87bf-5938214933db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001225911B2C0>]}
[0m17:25:39.804853 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:25:39.813183 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:25:39.936774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:39.936774 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:25:40.073930 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:25:40.079964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '522061e5-a980-48ee-87bf-5938214933db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001225B7FAF00>]}
[0m17:25:40.091962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '522061e5-a980-48ee-87bf-5938214933db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001225B53B1D0>]}
[0m17:25:40.092931 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:25:40.093930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '522061e5-a980-48ee-87bf-5938214933db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001225B24B0B0>]}
[0m17:25:40.094962 [info ] [MainThread]: 
[0m17:25:40.095962 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:25:40.097961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:25:40.111962 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:25:40.112930 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:25:40.112930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:41.360889 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:25:41.362889 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:25:41.466159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:25:41.485949 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:25:41.486979 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:25:41.486979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:41.943961 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m17:25:41.945959 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:25:42.049100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m17:25:42.053599 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:25:42.053599 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:25:42.054641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:42.538414 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb006b-0001-429a-0008-435e00020e8a
[0m17:25:42.538414 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:25:42.539418 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:25:42.539418 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:25:42.540418 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:25:42.643126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m17:25:42.649127 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:25:42.650129 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:25:42.652083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:43.015880 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:25:43.018891 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:25:43.123774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m17:25:43.128832 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:25:43.128832 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:25:43.128832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:43.430862 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:25:43.433861 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:25:43.539124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '522061e5-a980-48ee-87bf-5938214933db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001225B6717F0>]}
[0m17:25:43.540121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:43.541545 [info ] [MainThread]: 
[0m17:25:43.547507 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:25:43.547507 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:25:43.549472 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:25:43.550473 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:25:43.562516 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:25:43.563515 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:25:43.550473 => 17:25:43.563515
[0m17:25:43.564479 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:25:43.598066 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:25:43.600033 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:25:43.600033 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH nrr_grr AS(
SELECT 
    SUM(RAVENUE) AS TOTAL_REVENUE,
    LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS PREV_REVENUE,
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY PAYMENT_MONTH
)
SELECT 
    PAYMENT_MONTH,
    TOTAL_REVENUE,
    PREV_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE) AS NET_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE)/PREV_REVENUE AS GRR
FROM nrr_grr
ORDER BY PAYMENT_MONTH
        );
[0m17:25:43.601067 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:43.954133 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb006b-0001-429a-0008-435e00020e92
[0m17:25:43.954133 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'RAVENUE'
[0m17:25:43.955164 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:25:43.564479 => 17:25:43.955164
[0m17:25:43.955164 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:25:44.067609 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'RAVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:25:44.068620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '522061e5-a980-48ee-87bf-5938214933db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001225BAC5FA0>]}
[0m17:25:44.069655 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.52s]
[0m17:25:44.071620 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:25:44.075857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:44.075857 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:25:44.076857 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m17:25:44.076857 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:25:44.077857 [info ] [MainThread]: 
[0m17:25:44.078823 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m17:25:44.080818 [debug] [MainThread]: Command end result
[0m17:25:44.094375 [info ] [MainThread]: 
[0m17:25:44.095375 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:25:44.096377 [info ] [MainThread]: 
[0m17:25:44.097375 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'RAVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:25:44.097375 [info ] [MainThread]: 
[0m17:25:44.098375 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:25:44.099376 [debug] [MainThread]: Command `dbt run` failed at 17:25:44.099376 after 5.35 seconds
[0m17:25:44.100375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001224EB8B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001224EB556A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001224EB56510>]}
[0m17:25:44.100375 [debug] [MainThread]: Flushing usage events
[0m17:25:55.329872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077B654140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077B654320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077B655490>]}


============================== 17:25:55.334910 | 7b146c57-4c94-4090-a5e7-fa1fba53236c ==============================
[0m17:25:55.334910 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:25:55.335921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:56.225504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b146c57-4c94-4090-a5e7-fa1fba53236c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070691DD00>]}
[0m17:25:56.312575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b146c57-4c94-4090-a5e7-fa1fba53236c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207064FF0B0>]}
[0m17:25:56.313575 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:25:56.323150 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:25:56.436764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:56.437765 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:25:56.567317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:25:56.574347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b146c57-4c94-4090-a5e7-fa1fba53236c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020706A66B40>]}
[0m17:25:56.587126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b146c57-4c94-4090-a5e7-fa1fba53236c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020708152BD0>]}
[0m17:25:56.587126 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:25:56.588127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b146c57-4c94-4090-a5e7-fa1fba53236c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020708343EF0>]}
[0m17:25:56.590126 [info ] [MainThread]: 
[0m17:25:56.591126 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:25:56.592128 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:25:56.608131 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:25:56.608131 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:25:56.609134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:57.602462 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:25:57.606457 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:25:57.716317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m17:25:57.726326 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:25:57.727325 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:25:57.727325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:58.273111 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m17:25:58.280118 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:25:58.393126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:25:58.399153 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:25:58.399153 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:25:58.399153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:58.734806 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb006b-0001-429e-0008-435e000232de
[0m17:25:58.736319 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:25:58.737334 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:25:58.738333 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:25:58.739333 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:25:58.840700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m17:25:58.842700 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:25:58.843701 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:25:58.843701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:59.137195 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m17:25:59.138327 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:25:59.226330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:25:59.230331 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:25:59.231331 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:25:59.231331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:59.746876 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:25:59.747876 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:25:59.848741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b146c57-4c94-4090-a5e7-fa1fba53236c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070832EC30>]}
[0m17:25:59.849780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:59.850228 [info ] [MainThread]: 
[0m17:25:59.854236 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:25:59.855266 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:25:59.856279 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:25:59.856279 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:25:59.864266 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:25:59.865270 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:25:59.857267 => 17:25:59.865270
[0m17:25:59.866235 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:25:59.898266 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:25:59.900266 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:25:59.900266 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH nrr_grr AS(
SELECT 
    SUM(REVENUE) AS TOTAL_REVENUE,
    LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS PREV_REVENUE,
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY PAYMENT_MONTH
)
SELECT 
    PAYMENT_MONTH,
    TOTAL_REVENUE,
    PREV_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE) AS NET_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE)/PREV_REVENUE AS GRR
FROM nrr_grr
ORDER BY PAYMENT_MONTH
        );
[0m17:25:59.900266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:00.242466 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb006b-0001-429a-0008-435e00020e9a
[0m17:26:00.244547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'PAYMENT_MONTH'
[0m17:26:00.246542 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:25:59.866235 => 17:26:00.245535
[0m17:26:00.248529 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:26:00.360295 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:26:00.362282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b146c57-4c94-4090-a5e7-fa1fba53236c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020708465EE0>]}
[0m17:26:00.363290 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.51s]
[0m17:26:00.365243 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:26:00.369714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:00.370712 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:26:00.370712 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m17:26:00.371714 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:26:00.372710 [info ] [MainThread]: 
[0m17:26:00.373291 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m17:26:00.374301 [debug] [MainThread]: Command end result
[0m17:26:00.389334 [info ] [MainThread]: 
[0m17:26:00.390301 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:00.391298 [info ] [MainThread]: 
[0m17:26:00.391298 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:26:00.392330 [info ] [MainThread]: 
[0m17:26:00.393327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:26:00.394299 [debug] [MainThread]: Command `dbt run` failed at 17:26:00.394299 after 5.13 seconds
[0m17:26:00.395329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077B687920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020708222450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002070804F920>]}
[0m17:26:00.395329 [debug] [MainThread]: Flushing usage events
[0m17:27:11.379004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022252755490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022252754080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022252757C20>]}


============================== 17:27:11.383010 | bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4 ==============================
[0m17:27:11.383010 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:27:11.384009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:27:12.326247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F14BF80>]}
[0m17:27:12.417734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225CD5F650>]}
[0m17:27:12.419736 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:27:12.427402 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:27:12.544346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:12.545347 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:27:12.679865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:27:12.684863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F4FB3B0>]}
[0m17:27:12.696868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F2473E0>]}
[0m17:27:12.697868 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:27:12.698868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225CE179B0>]}
[0m17:27:12.700868 [info ] [MainThread]: 
[0m17:27:12.702641 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:27:12.703641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:27:12.718248 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:27:12.719215 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:27:12.719215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:13.645743 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:27:13.646741 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:27:13.745454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:27:13.754454 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:27:13.754454 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:27:13.754454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:14.233074 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m17:27:14.237040 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:27:14.339220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:27:14.347219 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:27:14.347219 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:27:14.348219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:14.696888 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:27:14.698935 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:27:14.795530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m17:27:14.799533 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:27:14.799533 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:27:14.799533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:15.102601 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb006d-0001-429a-0008-435e00020ec2
[0m17:27:15.103600 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:27:15.103600 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:27:15.104600 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:27:15.104600 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:27:15.203158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m17:27:15.206157 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:27:15.207160 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:27:15.207160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:15.531934 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:27:15.533937 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:27:15.634558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F509550>]}
[0m17:27:15.635561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:15.635561 [info ] [MainThread]: 
[0m17:27:15.639558 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:27:15.640556 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:27:15.641559 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:27:15.642560 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:27:15.650560 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:27:15.652559 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:27:15.642560 => 17:27:15.652559
[0m17:27:15.653618 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:27:15.684592 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:27:15.686560 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:27:15.686560 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH nrr_grr AS(
SELECT 
    SUM(REVENUE) AS TOTAL_REVENUE,
    LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS PREV_REVENUE,
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY PAYMENT_MONTH
)
SELECT 
    PAYMENT_MONTH,
    TOTAL_REVENUE,
    PREV_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE) AS NET_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE)/PREV_REVENUE AS GRR
FROM nrr_grr
        );
[0m17:27:15.687589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:16.086105 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb006d-0001-429b-0008-435e00024022
[0m17:27:16.087105 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'PAYMENT_MONTH'
[0m17:27:16.088104 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:27:15.654595 => 17:27:16.087105
[0m17:27:16.088104 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:27:16.178256 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:27:16.178256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb0007bc-bf74-4881-9cf3-6fc5cce3b4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F443500>]}
[0m17:27:16.179256 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.54s]
[0m17:27:16.180225 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:27:16.183029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:16.183029 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:27:16.183029 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:27:16.184028 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:27:16.184028 [info ] [MainThread]: 
[0m17:27:16.184915 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m17:27:16.185923 [debug] [MainThread]: Command end result
[0m17:27:16.196923 [info ] [MainThread]: 
[0m17:27:16.197922 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:27:16.198924 [info ] [MainThread]: 
[0m17:27:16.199920 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:27:16.200923 [info ] [MainThread]: 
[0m17:27:16.201399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:27:16.202408 [debug] [MainThread]: Command `dbt run` failed at 17:27:16.202408 after 4.88 seconds
[0m17:27:16.203406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022252621910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F14BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F0C1520>]}
[0m17:27:16.203406 [debug] [MainThread]: Flushing usage events
[0m17:28:03.202400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B459355430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B459355190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4593556D0>]}


============================== 17:28:03.206431 | c810b3b8-f109-4491-948d-be285a44cc0b ==============================
[0m17:28:03.206431 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:28:03.207402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:28:04.133711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c810b3b8-f109-4491-948d-be285a44cc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B463DBFAD0>]}
[0m17:28:04.228295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c810b3b8-f109-4491-948d-be285a44cc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B463F7B140>]}
[0m17:28:04.229296 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:28:04.239612 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:28:04.360710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:04.361709 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:28:04.507196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:28:04.513229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c810b3b8-f109-4491-948d-be285a44cc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B465FFEB40>]}
[0m17:28:04.527197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c810b3b8-f109-4491-948d-be285a44cc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B465D52E70>]}
[0m17:28:04.527197 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:28:04.528226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c810b3b8-f109-4491-948d-be285a44cc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B465F60D10>]}
[0m17:28:04.530225 [info ] [MainThread]: 
[0m17:28:04.531226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:04.532228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:28:04.547234 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:28:04.547234 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:28:04.548234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:05.658434 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:28:05.660428 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:28:05.769285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m17:28:05.780285 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:28:05.780285 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:28:05.781286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:06.251573 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:28:06.252567 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:28:06.366991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m17:28:06.379969 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:28:06.381970 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:28:06.382970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:06.720681 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m17:28:06.723649 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:28:06.822110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m17:28:06.826108 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:28:06.827110 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:28:06.827110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:07.160255 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb006e-0001-429e-0008-435e00023302
[0m17:28:07.161287 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:28:07.161287 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:28:07.161287 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:28:07.162294 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:28:07.267055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m17:28:07.270578 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:28:07.270578 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:28:07.270578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:07.628012 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:28:07.630011 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:28:07.737813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c810b3b8-f109-4491-948d-be285a44cc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B466147860>]}
[0m17:28:07.738813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:07.739822 [info ] [MainThread]: 
[0m17:28:07.746395 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:28:07.746395 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:28:07.748359 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:28:07.749392 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:28:07.760369 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:28:07.762366 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:28:07.749392 => 17:28:07.761367
[0m17:28:07.762366 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:28:07.792986 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:28:07.794954 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:28:07.794954 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH nrr_grr AS(
SELECT 
    SUM(REVENUE) AS TOTAL_REVENUE,
    LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS PREV_REVENUE,
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY PAYMENT_MONTH
)
SELECT 
    (TOTAL_REVENUE-PREV_REVENUE) AS NET_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE)/PREV_REVENUE AS GRR
FROM nrr_grr
        );
[0m17:28:07.795987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:10.780858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:28:10.802414 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:28:07.762366 => 17:28:10.801423
[0m17:28:10.802414 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:28:10.902546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c810b3b8-f109-4491-948d-be285a44cc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B46629E870>]}
[0m17:28:10.903543 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 3.16s]
[0m17:28:10.904543 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:28:10.907544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:10.907544 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:28:10.908545 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:28:10.908545 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:28:10.909542 [info ] [MainThread]: 
[0m17:28:10.910543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.38 seconds (6.38s).
[0m17:28:10.911543 [debug] [MainThread]: Command end result
[0m17:28:10.926544 [info ] [MainThread]: 
[0m17:28:10.927545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:10.928543 [info ] [MainThread]: 
[0m17:28:10.930552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:28:10.932544 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:10.932544 after 7.79 seconds
[0m17:28:10.932544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4575B3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B457E26B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4590B86E0>]}
[0m17:28:10.933547 [debug] [MainThread]: Flushing usage events
[0m17:31:15.627846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99AD626F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99CE55730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99CE54230>]}


============================== 17:31:15.640153 | d9486409-f7be-40fc-a61e-8c0532f50538 ==============================
[0m17:31:15.640153 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:31:15.641919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:18.819339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9486409-f7be-40fc-a61e-8c0532f50538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A981B0E0>]}
[0m17:31:18.905766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9486409-f7be-40fc-a61e-8c0532f50538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A7BB7530>]}
[0m17:31:18.906767 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:31:18.987425 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:31:19.164210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:19.165211 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:31:19.306485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:31:19.312485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9486409-f7be-40fc-a61e-8c0532f50538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9BFEC00>]}
[0m17:31:19.335070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9486409-f7be-40fc-a61e-8c0532f50538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A99531A0>]}
[0m17:31:19.335070 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:31:19.336071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9486409-f7be-40fc-a61e-8c0532f50538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A96B7BF0>]}
[0m17:31:19.339070 [info ] [MainThread]: 
[0m17:31:19.341067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:31:19.343068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:31:19.357112 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:31:19.358114 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:31:19.358114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:20.532250 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:31:20.535251 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:31:20.634772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:31:20.662773 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:31:20.663773 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:31:20.663773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:21.093905 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:31:21.096903 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:31:21.191577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:31:21.200542 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:31:21.200542 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:31:21.201512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:21.689895 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:31:21.692902 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:31:21.796028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m17:31:21.809968 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:31:21.811000 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:31:21.811975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:22.154234 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0071-0001-429e-0008-435e00023372
[0m17:31:22.155237 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:31:22.156232 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:31:22.157262 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:31:22.158231 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:31:22.261884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m17:31:22.264884 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:31:22.265885 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:31:22.265885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:22.594935 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:31:22.595903 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:31:22.699118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9486409-f7be-40fc-a61e-8c0532f50538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99CE8BDD0>]}
[0m17:31:22.699118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:22.700118 [info ] [MainThread]: 
[0m17:31:22.729002 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:31:22.730965 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:31:22.734048 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:31:22.736001 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:31:22.747027 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:31:22.748026 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:31:22.737001 => 17:31:22.748026
[0m17:31:22.748995 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:31:22.780000 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:31:22.781000 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:31:22.782000 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH nrr_grr AS(
SELECT 
    SUM(REVENUE) AS TOTAL_REVENUE,
    LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS PREV_REVENUE,
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY PAYMENT_MONTH
)
SELECT 
    PAYMENT_MONTH,
    TOTAL_REVENUE,
    PREV_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE) AS NET_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE)/PREV_REVENUE AS GRR
FROM nrr_grr
ORDER BY PAYMENT_MONTH
        );
[0m17:31:22.782000 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:23.195358 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0071-0001-429e-0008-435e00023376
[0m17:31:23.197360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'PAYMENT_MONTH'
[0m17:31:23.200355 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:31:22.748995 => 17:31:23.199359
[0m17:31:23.201354 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:31:23.307433 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:31:23.307433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9486409-f7be-40fc-a61e-8c0532f50538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9A9EC49E0>]}
[0m17:31:23.308433 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.58s]
[0m17:31:23.309431 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:31:23.312446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:23.312446 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:31:23.313433 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:31:23.313433 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:31:23.313433 [info ] [MainThread]: 
[0m17:31:23.314433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m17:31:23.315432 [debug] [MainThread]: Command end result
[0m17:31:23.328433 [info ] [MainThread]: 
[0m17:31:23.329434 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:23.330433 [info ] [MainThread]: 
[0m17:31:23.331434 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:31:23.331434 [info ] [MainThread]: 
[0m17:31:23.332431 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:31:23.334433 [debug] [MainThread]: Command `dbt run` failed at 17:31:23.334433 after 7.86 seconds
[0m17:31:23.335433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99C8F0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99CD21400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99CD21880>]}
[0m17:31:23.336433 [debug] [MainThread]: Flushing usage events
[0m17:35:38.435906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B0922630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B0A54110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B0A54080>]}


============================== 17:35:38.440907 | 0dbd3805-4fa3-4f16-9b92-e5b42663012e ==============================
[0m17:35:38.440907 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:35:38.441906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:39.330768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dbd3805-4fa3-4f16-9b92-e5b42663012e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BD31A420>]}
[0m17:35:39.415384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dbd3805-4fa3-4f16-9b92-e5b42663012e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BBC1F0B0>]}
[0m17:35:39.416384 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:35:39.425383 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:35:39.540956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:39.540956 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:35:39.676541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:35:39.682566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dbd3805-4fa3-4f16-9b92-e5b42663012e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BD3DAED0>]}
[0m17:35:39.698548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dbd3805-4fa3-4f16-9b92-e5b42663012e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BD43B170>]}
[0m17:35:39.698548 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:35:39.699549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dbd3805-4fa3-4f16-9b92-e5b42663012e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BD2C04A0>]}
[0m17:35:39.701549 [info ] [MainThread]: 
[0m17:35:39.703553 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:39.706558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:35:39.722077 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:35:39.723073 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:35:39.723073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:40.770689 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:35:40.772689 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:35:40.864032 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:35:40.872063 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:35:40.873067 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:35:40.873067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:41.315846 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:35:41.317844 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:35:41.417420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m17:35:41.421804 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:35:41.421804 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:35:41.421804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:41.774409 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:35:41.776413 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:35:41.863930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m17:35:41.868929 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:35:41.869929 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:35:41.869929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:42.180512 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:35:42.182511 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:35:42.268338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m17:35:42.272338 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:35:42.272338 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:35:42.273338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:42.596111 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0075-0001-429b-0008-435e00024066
[0m17:35:42.596111 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:35:42.597111 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:35:42.597111 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:35:42.598111 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:35:42.693957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dbd3805-4fa3-4f16-9b92-e5b42663012e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BD31B320>]}
[0m17:35:42.695995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:42.697958 [info ] [MainThread]: 
[0m17:35:42.704953 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:35:42.705989 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:35:42.707955 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:35:42.707955 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:35:42.718959 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:35:42.720960 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:35:42.708953 => 17:35:42.719960
[0m17:35:42.721957 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:35:42.753570 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:35:42.755534 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:35:42.756566 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH nrr_grr AS(
SELECT 
    SUM(REVENUE) AS TOTAL_REVENUE,
    LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS PREV_REVENUE,
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY PAYMENT_MONTH
)
SELECT 
    PAYMENT_MONTH,
    TOTAL_REVENUE,
    PREV_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE) AS NET_REVENUE,
    (TOTAL_REVENUE-PREV_REVENUE)/PREV_REVENUE AS GRR
FROM nrr_grr
GROUP BY PAYMENT_MONTH
ORDER BY PAYMENT_MONTH
        );
[0m17:35:42.756566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:43.088630 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0075-0001-429a-0008-435e00020f26
[0m17:35:43.088630 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'PAYMENT_MONTH'
[0m17:35:43.089629 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:35:42.721957 => 17:35:43.089629
[0m17:35:43.090633 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:35:43.185871 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:35:43.185871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dbd3805-4fa3-4f16-9b92-e5b42663012e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BD8D6480>]}
[0m17:35:43.186871 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.48s]
[0m17:35:43.187870 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:35:43.189869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:43.190887 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:35:43.190887 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m17:35:43.190887 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:35:43.191902 [info ] [MainThread]: 
[0m17:35:43.192870 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m17:35:43.193871 [debug] [MainThread]: Command end result
[0m17:35:43.205874 [info ] [MainThread]: 
[0m17:35:43.206886 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:35:43.207870 [info ] [MainThread]: 
[0m17:35:43.208870 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:35:43.209871 [info ] [MainThread]: 
[0m17:35:43.210871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:35:43.211871 [debug] [MainThread]: Command `dbt run` failed at 17:35:43.211871 after 4.84 seconds
[0m17:35:43.211871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B0901D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B05C1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B0809AF0>]}
[0m17:35:43.212870 [debug] [MainThread]: Flushing usage events
[0m17:37:40.352180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC6887AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC68C55520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC68C55760>]}


============================== 17:37:40.364213 | 9c93e09c-81d9-4507-ba11-5ea18a03eb69 ==============================
[0m17:37:40.364213 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:37:40.365539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:47.791066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c93e09c-81d9-4507-ba11-5ea18a03eb69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC75517140>]}
[0m17:37:47.879585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c93e09c-81d9-4507-ba11-5ea18a03eb69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC752E8DD0>]}
[0m17:37:47.888585 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:37:47.910586 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:37:49.165200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:49.166200 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:37:49.294745 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.practice.mart_nrr_grr' (models\marts\mart_nrr_grr.sql) depends on a node named 'stg_transactions' which was not found
[0m17:37:49.297557 [debug] [MainThread]: Command `dbt run` failed at 17:37:49.297557 after 9.03 seconds
[0m17:37:49.297557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC66C78BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC75775190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC757E8D10>]}
[0m17:37:49.298551 [debug] [MainThread]: Flushing usage events
[0m17:38:02.030985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016314156D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016314023E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163141556A0>]}


============================== 17:38:02.035987 | db701ae4-eebf-4b73-a922-c014e349ba6e ==============================
[0m17:38:02.035987 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:38:02.036985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:38:02.971316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db701ae4-eebf-4b73-a922-c014e349ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631E9C7C20>]}
[0m17:38:03.062869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db701ae4-eebf-4b73-a922-c014e349ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631E76F650>]}
[0m17:38:03.063869 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:38:03.071935 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:38:03.177560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:03.177560 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:38:03.317650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:38:03.323681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db701ae4-eebf-4b73-a922-c014e349ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016320DF0740>]}
[0m17:38:03.355595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db701ae4-eebf-4b73-a922-c014e349ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016320C52A50>]}
[0m17:38:03.355595 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:38:03.356645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db701ae4-eebf-4b73-a922-c014e349ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016320E2EFF0>]}
[0m17:38:03.358597 [info ] [MainThread]: 
[0m17:38:03.359552 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:03.361584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:38:03.374590 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:38:03.374590 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:38:03.375589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:04.538149 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:38:04.540148 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:38:04.654669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m17:38:04.671668 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:38:04.672668 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:38:04.672668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:05.130985 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0078-0001-429a-0008-435e00020f2e
[0m17:38:05.130985 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:38:05.131986 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:38:05.131986 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:38:05.132986 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:38:05.232722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m17:38:05.235691 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:38:05.235691 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:38:05.236722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:05.720552 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:38:05.722552 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:38:05.816482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:38:05.819482 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:38:05.819482 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:38:05.820482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:06.278930 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:38:06.280932 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:38:06.396809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m17:38:06.406766 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:38:06.406766 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:38:06.407766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:06.737074 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:38:06.744137 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:38:06.863935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db701ae4-eebf-4b73-a922-c014e349ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016320AC0CE0>]}
[0m17:38:06.864898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:06.866896 [info ] [MainThread]: 
[0m17:38:06.872894 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:38:06.873930 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:38:06.874895 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:38:06.875929 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:38:06.884895 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:38:06.885894 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:38:06.875929 => 17:38:06.885894
[0m17:38:06.886898 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:38:06.921933 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:38:06.923934 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:38:06.924932 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (
WITH transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY 1,2
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:38:06.925932 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:07.354930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0078-0001-429e-0008-435e0002339e
[0m17:38:07.355961 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 32
invalid identifier 'PREVIOUS_REVENUE'
[0m17:38:07.355961 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:38:06.887949 => 17:38:07.355961
[0m17:38:07.356930 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:38:07.458449 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 8 at position 32
  invalid identifier 'PREVIOUS_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:38:07.459450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db701ae4-eebf-4b73-a922-c014e349ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163211C5E80>]}
[0m17:38:07.459450 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.58s]
[0m17:38:07.461449 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:38:07.463448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:07.464450 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:38:07.464450 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m17:38:07.464450 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:38:07.465448 [info ] [MainThread]: 
[0m17:38:07.465448 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m17:38:07.467454 [debug] [MainThread]: Command end result
[0m17:38:07.480450 [info ] [MainThread]: 
[0m17:38:07.481465 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:07.482450 [info ] [MainThread]: 
[0m17:38:07.483448 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 8 at position 32
  invalid identifier 'PREVIOUS_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:38:07.485449 [info ] [MainThread]: 
[0m17:38:07.486450 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:38:07.487453 [debug] [MainThread]: Command `dbt run` failed at 17:38:07.487453 after 5.53 seconds
[0m17:38:07.488483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016312E19910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163123F91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016312DC8BC0>]}
[0m17:38:07.488483 [debug] [MainThread]: Flushing usage events
[0m17:39:18.874063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028114554230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028114555760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281145540B0>]}


============================== 17:39:18.880065 | f187f5be-ede7-463d-a32b-1b1326e868c8 ==============================
[0m17:39:18.880065 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:39:18.881065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:19.858722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f187f5be-ede7-463d-a32b-1b1326e868c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028120EEFE60>]}
[0m17:39:19.962245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f187f5be-ede7-463d-a32b-1b1326e868c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281203F7C80>]}
[0m17:39:19.964246 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:39:19.974245 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:39:20.109339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:20.109339 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:39:20.260417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:39:20.266416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f187f5be-ede7-463d-a32b-1b1326e868c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281212FED50>]}
[0m17:39:20.281416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f187f5be-ede7-463d-a32b-1b1326e868c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028121052F60>]}
[0m17:39:20.282419 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:39:20.282419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f187f5be-ede7-463d-a32b-1b1326e868c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281212426C0>]}
[0m17:39:20.285415 [info ] [MainThread]: 
[0m17:39:20.286416 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:20.288416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:39:20.305800 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:39:20.305800 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:39:20.306798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:21.284374 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:39:21.286373 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:39:21.374889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:39:21.383920 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:39:21.383920 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:39:21.384921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:21.815727 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:39:21.818726 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:39:21.902736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:39:21.907249 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:39:21.908249 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:39:21.908249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:22.210981 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:39:22.211983 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:39:22.302017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:39:22.305582 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:39:22.306556 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:39:22.306556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:22.651281 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:39:22.653279 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:39:22.746836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:39:22.751832 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:39:22.752843 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:39:22.752843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:23.070511 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0079-0001-429e-0008-435e000233ae
[0m17:39:23.071512 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:39:23.071512 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:39:23.072512 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:39:23.072512 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:39:23.161095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f187f5be-ede7-463d-a32b-1b1326e868c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002812143B410>]}
[0m17:39:23.162060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:23.163060 [info ] [MainThread]: 
[0m17:39:23.167059 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:39:23.168061 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:39:23.170062 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:39:23.170062 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:39:23.178091 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:39:23.180060 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:39:23.170062 => 17:39:23.179091
[0m17:39:23.180060 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:39:23.213614 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:39:23.215616 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:39:23.216584 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

WITH transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS previous_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY 1,2
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:39:23.216584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:23.669830 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0079-0001-429b-0008-435e0002406e
[0m17:39:23.670830 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[STG_TRANSACTION.PAYMENT_MONTH] is not a valid group by expression
[0m17:39:23.670830 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:39:23.180060 => 17:39:23.670830
[0m17:39:23.671830 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:39:23.762345 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTION.PAYMENT_MONTH] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:39:23.762345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f187f5be-ede7-463d-a32b-1b1326e868c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281215B3BF0>]}
[0m17:39:23.763346 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.59s]
[0m17:39:23.764345 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:39:23.767351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:23.768371 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:39:23.768371 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m17:39:23.768371 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:39:23.769347 [info ] [MainThread]: 
[0m17:39:23.770347 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m17:39:23.771348 [debug] [MainThread]: Command end result
[0m17:39:23.783347 [info ] [MainThread]: 
[0m17:39:23.784349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:39:23.785347 [info ] [MainThread]: 
[0m17:39:23.786347 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTION.PAYMENT_MONTH] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:39:23.787352 [info ] [MainThread]: 
[0m17:39:23.788358 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:39:23.789380 [debug] [MainThread]: Command `dbt run` failed at 17:39:23.789380 after 4.98 seconds
[0m17:39:23.790348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811458B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811458BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811458BF80>]}
[0m17:39:23.790348 [debug] [MainThread]: Flushing usage events
[0m17:39:51.980797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BBFDFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BD2541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BD2552B0>]}


============================== 17:39:51.985797 | f43da242-970f-4073-a6cb-041aef93c2fc ==============================
[0m17:39:51.985797 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:39:51.986796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m17:39:52.935929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f43da242-970f-4073-a6cb-041aef93c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188C9B04B30>]}
[0m17:39:53.025507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f43da242-970f-4073-a6cb-041aef93c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188C9355EE0>]}
[0m17:39:53.026505 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:39:53.035489 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:39:53.153687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:39:53.154682 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:39:53.297205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:39:53.303204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f43da242-970f-4073-a6cb-041aef93c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188C9D125D0>]}
[0m17:39:53.316205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f43da242-970f-4073-a6cb-041aef93c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188C9D47350>]}
[0m17:39:53.316205 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:39:53.318207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f43da242-970f-4073-a6cb-041aef93c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188C75B7470>]}
[0m17:39:53.320206 [info ] [MainThread]: 
[0m17:39:53.321205 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:53.323205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:39:53.339212 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:39:53.339212 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:39:53.340213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:54.229209 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:39:54.231209 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:39:54.333919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m17:39:54.344953 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:39:54.344953 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:39:54.345922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:54.786691 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:39:54.788723 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:39:54.889308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:39:54.893329 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:39:54.893329 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:39:54.894329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:55.252528 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:39:55.255106 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:39:55.355425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:39:55.360393 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:39:55.360393 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:39:55.360393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:55.685016 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0079-0001-429a-0008-435e00020f3a
[0m17:39:55.685016 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:39:55.686047 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:39:55.686047 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:39:55.686047 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:39:55.782785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m17:39:55.785783 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:39:55.785783 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:39:55.786781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:56.133545 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:39:56.135544 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:39:56.238535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f43da242-970f-4073-a6cb-041aef93c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188CA13B860>]}
[0m17:39:56.239535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:56.240534 [info ] [MainThread]: 
[0m17:39:56.243570 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:39:56.244565 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:39:56.245534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:39:56.245534 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:39:56.254567 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:39:56.256568 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:39:56.246567 => 17:39:56.255567
[0m17:39:56.257572 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:39:56.288079 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:39:56.291079 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:39:56.291079 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

WITH transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        LAG(SUM(REVENUE)) OVER (ORDER BY PAYMENT_MONTH) AS previous_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:39:56.292079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:56.683755 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0079-0001-429a-0008-435e00020f3e
[0m17:39:56.683755 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[STG_TRANSACTION.PAYMENT_MONTH] is not a valid group by expression
[0m17:39:56.684758 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:39:56.257572 => 17:39:56.684758
[0m17:39:56.684758 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:39:56.774395 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTION.PAYMENT_MONTH] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:39:56.774395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f43da242-970f-4073-a6cb-041aef93c2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188CA039130>]}
[0m17:39:56.775395 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.53s]
[0m17:39:56.776395 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:39:56.778395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:56.779433 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:39:56.779433 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m17:39:56.779433 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:39:56.780426 [info ] [MainThread]: 
[0m17:39:56.780426 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m17:39:56.782427 [debug] [MainThread]: Command end result
[0m17:39:56.793395 [info ] [MainThread]: 
[0m17:39:56.794396 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:39:56.795421 [info ] [MainThread]: 
[0m17:39:56.796396 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTION.PAYMENT_MONTH] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:39:56.796396 [info ] [MainThread]: 
[0m17:39:56.797439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:39:56.798395 [debug] [MainThread]: Command `dbt run` failed at 17:39:56.798395 after 4.88 seconds
[0m17:39:56.799426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BBFDFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BBF79880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188BD23FD70>]}
[0m17:39:56.799426 [debug] [MainThread]: Flushing usage events
[0m17:42:13.887745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAB77AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAB4DCF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBABB542F0>]}


============================== 17:42:13.891776 | f8027f3c-ddd8-425a-be1c-93dd732fe44b ==============================
[0m17:42:13.891776 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:42:13.892777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m17:42:14.782490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8027f3c-ddd8-425a-be1c-93dd732fe44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB826FC20>]}
[0m17:42:14.870102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8027f3c-ddd8-425a-be1c-93dd732fe44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB6837F80>]}
[0m17:42:14.871106 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:42:14.879568 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:42:14.993149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:14.994150 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:42:15.128253 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:42:15.134285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8027f3c-ddd8-425a-be1c-93dd732fe44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB87FEB70>]}
[0m17:42:15.146279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8027f3c-ddd8-425a-be1c-93dd732fe44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB854F020>]}
[0m17:42:15.147255 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:42:15.148256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8027f3c-ddd8-425a-be1c-93dd732fe44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB8743C80>]}
[0m17:42:15.149254 [info ] [MainThread]: 
[0m17:42:15.151255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:15.152255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:42:15.166286 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:42:15.167285 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:42:15.167285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:16.282616 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:42:16.285655 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:42:16.391305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m17:42:16.404304 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:42:16.404304 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:42:16.405304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:16.879391 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:42:16.886385 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:42:17.005678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m17:42:17.025437 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:42:17.026438 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:42:17.028440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:17.387301 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:42:17.392317 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:42:17.503360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:42:17.507098 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:42:17.508097 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:42:17.508097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:17.845758 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:42:17.849366 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:42:17.962032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m17:42:17.973995 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:42:17.973995 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:42:17.974994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:18.310799 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb007c-0001-429a-0008-435e00020f5a
[0m17:42:18.310799 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:42:18.310799 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:42:18.311798 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:42:18.311798 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:42:18.417154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8027f3c-ddd8-425a-be1c-93dd732fe44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB88C8230>]}
[0m17:42:18.422172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:18.424111 [info ] [MainThread]: 
[0m17:42:18.438166 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:42:18.440195 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:42:18.445184 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:42:18.447185 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:42:18.469724 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:42:18.471691 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:42:18.448134 => 17:42:18.470726
[0m17:42:18.471691 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:42:18.505718 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:42:18.507718 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:42:18.507718 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

WITH transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        LAG(SUM(REVENUE)) OVER (ORDER BY revenue) AS previous_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:42:18.508721 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:19.015292 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007c-0001-429e-0008-435e000233de
[0m17:42:19.016294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[STG_TRANSACTION.REVENUE] is not a valid group by expression
[0m17:42:19.016294 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:42:18.472690 => 17:42:19.016294
[0m17:42:19.017292 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:42:19.138499 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTION.REVENUE] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:42:19.139546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8027f3c-ddd8-425a-be1c-93dd732fe44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB89B38C0>]}
[0m17:42:19.141537 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.70s]
[0m17:42:19.143497 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:42:19.147494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:19.148496 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:42:19.149491 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m17:42:19.149491 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:42:19.150488 [info ] [MainThread]: 
[0m17:42:19.152046 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m17:42:19.154081 [debug] [MainThread]: Command end result
[0m17:42:19.168049 [info ] [MainThread]: 
[0m17:42:19.171048 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:42:19.185042 [info ] [MainThread]: 
[0m17:42:19.192052 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTION.REVENUE] is not a valid group by expression
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:42:19.199041 [info ] [MainThread]: 
[0m17:42:19.200043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:42:19.202045 [debug] [MainThread]: Command `dbt run` failed at 17:42:19.202045 after 5.37 seconds
[0m17:42:19.202045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBABB3FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAB77AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAB7291F0>]}
[0m17:42:19.203042 [debug] [MainThread]: Flushing usage events
[0m17:43:44.536318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E01257410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E01254D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E01256E10>]}


============================== 17:43:44.540318 | fbae3ea0-f1c6-4be8-b28a-999d193b235a ==============================
[0m17:43:44.540318 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:43:44.541289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m17:43:45.429465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbae3ea0-f1c6-4be8-b28a-999d193b235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0128A540>]}
[0m17:43:45.519786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbae3ea0-f1c6-4be8-b28a-999d193b235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E012B48C0>]}
[0m17:43:45.520776 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:43:45.528807 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:43:45.645402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:45.645402 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:43:45.781139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:43:45.787138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbae3ea0-f1c6-4be8-b28a-999d193b235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0DEFEDB0>]}
[0m17:43:45.801143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbae3ea0-f1c6-4be8-b28a-999d193b235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0DC4EFC0>]}
[0m17:43:45.802144 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:43:45.803141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbae3ea0-f1c6-4be8-b28a-999d193b235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0DE40EC0>]}
[0m17:43:45.805172 [info ] [MainThread]: 
[0m17:43:45.806655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:45.808282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:43:45.822319 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:43:45.822319 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:43:45.823328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:46.820098 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:43:46.822097 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:43:46.915821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m17:43:46.929824 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:43:46.930821 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:43:46.930821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:47.349954 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:43:47.352956 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:43:47.444813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:43:47.448814 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:43:47.449813 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:43:47.449813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:47.747024 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:43:47.749023 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:43:47.841603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:43:47.846596 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:43:47.846596 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:43:47.846596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:48.278107 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb007d-0001-429b-0008-435e00024092
[0m17:43:48.279137 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:43:48.279137 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:43:48.280139 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:43:48.280139 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:43:48.373668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m17:43:48.376668 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:43:48.376668 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:43:48.377668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:48.711121 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:43:48.713121 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:43:48.813775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbae3ea0-f1c6-4be8-b28a-999d193b235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0DEF74A0>]}
[0m17:43:48.814796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:48.814796 [info ] [MainThread]: 
[0m17:43:48.819001 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:43:48.820032 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:43:48.821010 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:43:48.821010 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:43:48.830010 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:43:48.831011 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:43:48.822034 => 17:43:48.831011
[0m17:43:48.832010 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:43:48.862007 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:43:48.864008 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:43:48.865038 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by transaction_date) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
)
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:43:48.865038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:49.358984 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007d-0001-429b-0008-435e00024096
[0m17:43:49.359983 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 0 unexpected 'transactions'.
syntax error line 15 at position 21 unexpected 'AS'.
[0m17:43:49.360983 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:43:48.832010 => 17:43:49.360983
[0m17:43:49.361983 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:43:49.463180 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'transactions'.
  syntax error line 15 at position 21 unexpected 'AS'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:43:49.463180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbae3ea0-f1c6-4be8-b28a-999d193b235a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0DE2C680>]}
[0m17:43:49.464181 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.64s]
[0m17:43:49.465070 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:43:49.468108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:49.468108 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:43:49.468108 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m17:43:49.469108 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:43:49.469108 [info ] [MainThread]: 
[0m17:43:49.470021 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m17:43:49.471026 [debug] [MainThread]: Command end result
[0m17:43:49.483064 [info ] [MainThread]: 
[0m17:43:49.484067 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:43:49.486067 [info ] [MainThread]: 
[0m17:43:49.486067 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'transactions'.
  syntax error line 15 at position 21 unexpected 'AS'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:43:49.487573 [info ] [MainThread]: 
[0m17:43:49.488583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:43:49.489580 [debug] [MainThread]: Command `dbt run` failed at 17:43:49.489580 after 5.01 seconds
[0m17:43:49.489580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0115B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DFFD4FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0128BE60>]}
[0m17:43:49.490584 [debug] [MainThread]: Flushing usage events
[0m17:43:55.483926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECE67AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECE958140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECE95B7A0>]}


============================== 17:43:55.487964 | c9db1608-07bb-4840-bc9b-9f3a73c71086 ==============================
[0m17:43:55.487964 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:43:55.488937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:43:56.366063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9db1608-07bb-4840-bc9b-9f3a73c71086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDB1539B0>]}
[0m17:43:56.454641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9db1608-07bb-4840-bc9b-9f3a73c71086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ED9C3A810>]}
[0m17:43:56.455641 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:43:56.463668 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:43:56.581254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:56.581254 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:43:56.714450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:43:56.719479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9db1608-07bb-4840-bc9b-9f3a73c71086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDB37D760>]}
[0m17:43:56.732490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9db1608-07bb-4840-bc9b-9f3a73c71086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDB487830>]}
[0m17:43:56.733449 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:43:56.734449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9db1608-07bb-4840-bc9b-9f3a73c71086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ED9EA02C0>]}
[0m17:43:56.736482 [info ] [MainThread]: 
[0m17:43:56.737451 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:56.739480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:43:56.754448 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:43:56.754448 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:43:56.754448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:57.146207 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m17:43:57.148196 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:43:57.239338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m17:43:57.247338 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:43:57.248335 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:43:57.248335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:57.684769 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:43:57.690864 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:43:57.782734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m17:43:57.786732 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:43:57.786732 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:43:57.786732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:58.187639 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:43:58.189638 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:43:58.273793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m17:43:58.277792 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:43:58.277792 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:43:58.278793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:58.690803 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:43:58.694799 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:43:58.784327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:43:58.789357 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:43:58.789357 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:43:58.790356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:59.140965 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb007d-0001-429e-0008-435e000233ea
[0m17:43:59.141996 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:43:59.141996 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:43:59.141996 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:43:59.142996 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:43:59.242400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9db1608-07bb-4840-bc9b-9f3a73c71086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDB82B650>]}
[0m17:43:59.243400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:59.244400 [info ] [MainThread]: 
[0m17:43:59.248400 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:43:59.248400 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:43:59.250401 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:43:59.250401 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:43:59.260401 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:43:59.262401 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:43:59.251401 => 17:43:59.261408
[0m17:43:59.262401 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:43:59.296399 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:43:59.298407 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:43:59.299407 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by transaction_date) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:43:59.299407 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:59.660505 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007d-0001-429b-0008-435e0002409e
[0m17:43:59.661502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 61
invalid identifier 'TRANSACTION_DATE'
[0m17:43:59.661502 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:43:59.263401 => 17:43:59.661502
[0m17:43:59.662504 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:43:59.782761 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 9 at position 61
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:43:59.784725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9db1608-07bb-4840-bc9b-9f3a73c71086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDB643500>]}
[0m17:43:59.785710 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.53s]
[0m17:43:59.786721 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:43:59.788709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:59.789708 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:43:59.789708 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m17:43:59.790708 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:43:59.790708 [info ] [MainThread]: 
[0m17:43:59.791707 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m17:43:59.794721 [debug] [MainThread]: Command end result
[0m17:43:59.807720 [info ] [MainThread]: 
[0m17:43:59.808721 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:43:59.809720 [info ] [MainThread]: 
[0m17:43:59.810719 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 9 at position 61
  invalid identifier 'TRANSACTION_DATE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:43:59.811719 [info ] [MainThread]: 
[0m17:43:59.812735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:43:59.813719 [debug] [MainThread]: Command `dbt run` failed at 17:43:59.813719 after 4.39 seconds
[0m17:43:59.814718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ED9E791C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDB34CA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECE93FD70>]}
[0m17:43:59.814718 [debug] [MainThread]: Flushing usage events
[0m17:44:14.905388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C784857860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C784857590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7848567B0>]}


============================== 17:44:14.910424 | 2c8cea85-d9f5-4d33-9104-c65a3aef166c ==============================
[0m17:44:14.910424 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:44:14.911388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:44:15.785679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c8cea85-d9f5-4d33-9104-c65a3aef166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78F94E510>]}
[0m17:44:15.875003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c8cea85-d9f5-4d33-9104-c65a3aef166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C78EF586E0>]}
[0m17:44:15.875978 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:44:15.885004 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:44:15.999676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:44:16.000662 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:44:16.135496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:44:16.141497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c8cea85-d9f5-4d33-9104-c65a3aef166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C79114D760>]}
[0m17:44:16.154496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c8cea85-d9f5-4d33-9104-c65a3aef166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791252D80>]}
[0m17:44:16.155522 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:44:16.155522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8cea85-d9f5-4d33-9104-c65a3aef166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C791252C90>]}
[0m17:44:16.157498 [info ] [MainThread]: 
[0m17:44:16.158494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:44:16.160512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:44:16.174528 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:44:16.175496 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:44:16.175496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:17.167749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:44:17.169764 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:44:17.271097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m17:44:17.298026 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:44:17.299026 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:44:17.300026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:17.624075 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:44:17.626078 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:44:17.717105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m17:44:17.721681 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:44:17.721681 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:44:17.722681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:18.163635 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:44:18.165634 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:44:18.251183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m17:44:18.255181 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:44:18.255181 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:44:18.256149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:18.563398 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb007e-0001-429e-0008-435e000233fa
[0m17:44:18.563398 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:44:18.563398 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:44:18.564399 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:44:18.564399 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:44:18.655005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m17:44:18.658005 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:44:18.659006 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:44:18.659006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:19.143765 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:44:19.145757 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:44:19.246006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8cea85-d9f5-4d33-9104-c65a3aef166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7915CA9C0>]}
[0m17:44:19.250067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:19.253007 [info ] [MainThread]: 
[0m17:44:19.266046 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:44:19.267037 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:44:19.269998 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:44:19.270997 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:44:19.283029 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:44:19.285995 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:44:19.270997 => 17:44:19.285000
[0m17:44:19.285995 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:44:19.318007 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:44:19.321032 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:44:19.321032 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:44:19.322032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:44:20.253319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:44:20.277270 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:44:19.286994 => 17:44:20.276270
[0m17:44:20.277270 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:44:20.369759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8cea85-d9f5-4d33-9104-c65a3aef166c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7917809B0>]}
[0m17:44:20.369759 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 1.10s]
[0m17:44:20.370760 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:44:20.372757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:20.373759 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:44:20.373759 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m17:44:20.373759 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:44:20.374759 [info ] [MainThread]: 
[0m17:44:20.374759 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m17:44:20.376759 [debug] [MainThread]: Command end result
[0m17:44:20.387759 [info ] [MainThread]: 
[0m17:44:20.388760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:20.388760 [info ] [MainThread]: 
[0m17:44:20.389757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:44:20.390760 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:20.390760 after 5.55 seconds
[0m17:44:20.391757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C784703620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7848567B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C784857860>]}
[0m17:44:20.391757 [debug] [MainThread]: Flushing usage events
[0m17:45:29.756538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFAD55580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFAD55310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFAD57CE0>]}


============================== 17:45:29.761568 | c363a1e8-710e-4773-8512-81b845e5f456 ==============================
[0m17:45:29.761568 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:45:29.762555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:45:30.677562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c363a1e8-710e-4773-8512-81b845e5f456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E01549970>]}
[0m17:45:30.765725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c363a1e8-710e-4773-8512-81b845e5f456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFFC77D70>]}
[0m17:45:30.766720 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:45:30.775757 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:45:30.892609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:30.892609 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:45:31.028158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:45:31.034158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c363a1e8-710e-4773-8512-81b845e5f456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E01941970>]}
[0m17:45:31.049161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c363a1e8-710e-4773-8512-81b845e5f456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E01752ED0>]}
[0m17:45:31.049161 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:45:31.051160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c363a1e8-710e-4773-8512-81b845e5f456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E01518440>]}
[0m17:45:31.053190 [info ] [MainThread]: 
[0m17:45:31.054155 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:31.056158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:45:31.072174 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:45:31.073219 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:45:31.073219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:32.028716 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:45:32.030713 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:45:32.123061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m17:45:32.131062 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:45:32.132083 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:45:32.132083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:32.444915 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:45:32.451883 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:45:32.561455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:45:32.575877 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:45:32.576876 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:45:32.578875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:33.207591 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.0 seconds
[0m17:45:33.211579 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:45:33.326164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m17:45:33.336087 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:45:33.336087 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:45:33.336087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:33.702176 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:45:33.704175 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:45:33.805156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m17:45:33.816157 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:45:33.817152 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:45:33.817152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:34.184082 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb007f-0001-429a-0008-435e00020f7a
[0m17:45:34.185082 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:45:34.185082 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:45:34.186086 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:45:34.186086 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:45:34.293297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c363a1e8-710e-4773-8512-81b845e5f456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E019BCD10>]}
[0m17:45:34.294336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:34.294799 [info ] [MainThread]: 
[0m17:45:34.298808 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:45:34.298808 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:45:34.300807 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:45:34.300807 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:45:34.309001 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:45:34.310979 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:45:34.300807 => 17:45:34.310010
[0m17:45:34.310979 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:45:34.341011 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:45:34.344010 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:45:34.344010 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as total_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:45:34.344010 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:34.762561 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007f-0001-429e-0008-435e00023412
[0m17:45:34.764561 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'TOTAL_REVENUE'
[0m17:45:34.768509 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:45:34.310979 => 17:45:34.766556
[0m17:45:34.770511 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:45:34.896581 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'TOTAL_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:45:34.898575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c363a1e8-710e-4773-8512-81b845e5f456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E01CF7200>]}
[0m17:45:34.899571 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.60s]
[0m17:45:34.902524 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:45:34.907132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:34.908133 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:45:34.908133 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m17:45:34.909132 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:45:34.910127 [info ] [MainThread]: 
[0m17:45:34.911092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m17:45:34.912136 [debug] [MainThread]: Command end result
[0m17:45:34.928092 [info ] [MainThread]: 
[0m17:45:34.929091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:45:34.929091 [info ] [MainThread]: 
[0m17:45:34.930091 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'TOTAL_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:45:34.931090 [info ] [MainThread]: 
[0m17:45:34.932092 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:45:34.934092 [debug] [MainThread]: Command `dbt run` failed at 17:45:34.934092 after 5.24 seconds
[0m17:45:34.934092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFAD877D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFAD55310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFAD55580>]}
[0m17:45:34.935092 [debug] [MainThread]: Flushing usage events
[0m17:45:50.083712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A77554260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A77554170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A77555580>]}


============================== 17:45:50.088745 | eaa0b63a-3747-4040-8a37-5fdc776d1796 ==============================
[0m17:45:50.088745 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:45:50.089715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:50.968974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaa0b63a-3747-4040-8a37-5fdc776d1796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A81891970>]}
[0m17:45:51.058492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaa0b63a-3747-4040-8a37-5fdc776d1796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A81550CB0>]}
[0m17:45:51.059492 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:45:51.066908 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:45:51.180246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:51.181244 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:45:51.315706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:45:51.321737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaa0b63a-3747-4040-8a37-5fdc776d1796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A81E768D0>]}
[0m17:45:51.335709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaa0b63a-3747-4040-8a37-5fdc776d1796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A81F4F1D0>]}
[0m17:45:51.335709 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:45:51.336706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa0b63a-3747-4040-8a37-5fdc776d1796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7FC08EC0>]}
[0m17:45:51.338737 [info ] [MainThread]: 
[0m17:45:51.339452 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:51.341489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:45:51.354494 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:45:51.355461 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:45:51.355461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:52.492618 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:45:52.494619 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:45:52.597140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m17:45:52.608141 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:45:52.608141 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:45:52.609142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:53.051997 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:45:53.054028 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:45:53.146018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:45:53.157978 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:45:53.158976 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:45:53.158976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:53.753533 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb007f-0001-429a-0008-435e00020f7e
[0m17:45:53.754533 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:45:53.754533 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:45:53.755533 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:45:53.756533 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:45:53.856356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m17:45:53.858357 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:45:53.859356 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:45:53.859356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:54.192916 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:45:54.194918 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:45:54.295105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:45:54.314100 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:45:54.316101 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:45:54.317034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:54.695006 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:45:54.696958 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:45:54.799504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa0b63a-3747-4040-8a37-5fdc776d1796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A8233BE30>]}
[0m17:45:54.802442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:54.805440 [info ] [MainThread]: 
[0m17:45:54.819441 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:45:54.821491 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:45:54.826494 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:45:54.828492 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:45:54.847432 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:45:54.849428 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:45:54.829491 => 17:45:54.848459
[0m17:45:54.850433 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:45:54.884466 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:45:54.886457 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:45:54.887487 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:45:54.887487 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:57.380928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:45:57.405494 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:45:54.850433 => 17:45:57.404495
[0m17:45:57.405494 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:45:57.500705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa0b63a-3747-4040-8a37-5fdc776d1796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A82481C10>]}
[0m17:45:57.503369 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 2.68s]
[0m17:45:57.507370 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:45:57.514370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:57.515368 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:45:57.517362 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m17:45:57.518373 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:45:57.520368 [info ] [MainThread]: 
[0m17:45:57.522318 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m17:45:57.526369 [debug] [MainThread]: Command end result
[0m17:45:57.540304 [info ] [MainThread]: 
[0m17:45:57.541304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:57.542304 [info ] [MainThread]: 
[0m17:45:57.543305 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:57.544304 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:57.544304 after 7.52 seconds
[0m17:45:57.544304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A77587AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A77556E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A77554260>]}
[0m17:45:57.545305 [debug] [MainThread]: Flushing usage events
[0m17:46:30.653331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001976585BD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001976585AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019765858F50>]}


============================== 17:46:30.657305 | 74996c31-bba3-4051-88d5-86fbe61a6a90 ==============================
[0m17:46:30.657305 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:46:30.658306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:31.558060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74996c31-bba3-4051-88d5-86fbe61a6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977211ACC0>]}
[0m17:46:31.647273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74996c31-bba3-4051-88d5-86fbe61a6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197652F20C0>]}
[0m17:46:31.649287 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:46:31.657329 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:46:31.777433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:31.778434 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:46:31.911895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:46:31.917874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74996c31-bba3-4051-88d5-86fbe61a6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197724FEE10>]}
[0m17:46:31.929875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74996c31-bba3-4051-88d5-86fbe61a6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977224F230>]}
[0m17:46:31.930878 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:46:31.931845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74996c31-bba3-4051-88d5-86fbe61a6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197702D8EC0>]}
[0m17:46:31.933843 [info ] [MainThread]: 
[0m17:46:31.934842 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:46:31.936875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:46:31.951848 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:46:31.951848 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:46:31.952856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:32.920163 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:46:32.922165 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:46:33.017962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:46:33.030962 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:46:33.030962 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:46:33.031962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:33.475480 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:46:33.479479 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:46:33.574914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:46:33.586839 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:46:33.587870 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:46:33.587870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:34.012260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:46:34.013254 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:46:34.108665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:46:34.121666 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:46:34.123664 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:46:34.124664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:34.464593 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:46:34.466547 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:46:34.563161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:46:34.567162 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:46:34.568195 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:46:34.568195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:34.891134 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0080-0001-429e-0008-435e0002342a
[0m17:46:34.892143 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:46:34.892143 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:46:34.893143 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:46:34.893143 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:46:34.987369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74996c31-bba3-4051-88d5-86fbe61a6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001977224FFB0>]}
[0m17:46:34.990380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:34.993341 [info ] [MainThread]: 
[0m17:46:35.007369 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:46:35.011316 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:46:35.014356 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:46:35.016356 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:46:35.031307 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:46:35.034322 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:46:35.017311 => 17:46:35.033306
[0m17:46:35.035308 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:46:35.066337 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:46:35.069315 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:46:35.069315 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN revenue - previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN previous_revenue - revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:46:35.070340 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:46:35.856580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:46:35.878632 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:46:35.035308 => 17:46:35.878632
[0m17:46:35.879629 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:46:35.982118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74996c31-bba3-4051-88d5-86fbe61a6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197727CE840>]}
[0m17:46:35.986118 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 0.97s]
[0m17:46:35.990578 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:46:35.998674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:36.000602 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:46:36.001660 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m17:46:36.003664 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:46:36.004655 [info ] [MainThread]: 
[0m17:46:36.005593 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m17:46:36.006592 [debug] [MainThread]: Command end result
[0m17:46:36.016592 [info ] [MainThread]: 
[0m17:46:36.017593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:36.019595 [info ] [MainThread]: 
[0m17:46:36.020599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:46:36.021593 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:36.021593 after 5.43 seconds
[0m17:46:36.022593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197658580E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019770363C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019770FD03E0>]}
[0m17:46:36.022593 [debug] [MainThread]: Flushing usage events
[0m17:49:27.168545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7325557C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B732555640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B732555100>]}


============================== 17:49:27.173523 | 271c695c-fc52-4a13-aceb-2df3835b19ee ==============================
[0m17:49:27.173523 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:49:27.174518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:28.074369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '271c695c-fc52-4a13-aceb-2df3835b19ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73E278170>]}
[0m17:49:28.161987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '271c695c-fc52-4a13-aceb-2df3835b19ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73E278170>]}
[0m17:49:28.162987 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:49:28.171989 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:49:28.290504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:28.290504 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:49:28.422015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:49:28.429016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '271c695c-fc52-4a13-aceb-2df3835b19ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73F00CC20>]}
[0m17:49:28.442023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '271c695c-fc52-4a13-aceb-2df3835b19ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73F052960>]}
[0m17:49:28.443024 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:49:28.444024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '271c695c-fc52-4a13-aceb-2df3835b19ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73F22FB00>]}
[0m17:49:28.445024 [info ] [MainThread]: 
[0m17:49:28.446024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:28.447529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:49:28.463539 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:49:28.463539 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:49:28.463539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:29.474571 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:49:29.476570 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:49:29.577186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m17:49:29.585185 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:49:29.586186 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:49:29.586186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:30.130901 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0083-0001-429b-0008-435e000240ba
[0m17:49:30.130901 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:49:30.131899 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:49:30.131899 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:49:30.132900 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:49:30.230586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m17:49:30.233589 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:49:30.234619 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:49:30.234619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:30.557805 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:49:30.558801 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:49:30.655798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:49:30.672849 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:49:30.674849 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:49:30.676860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:31.145573 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:49:31.149570 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:49:31.245968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:49:31.248970 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:49:31.249966 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:49:31.249966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:31.573586 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:49:31.575618 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:49:31.664096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '271c695c-fc52-4a13-aceb-2df3835b19ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73F33B020>]}
[0m17:49:31.664096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:31.665096 [info ] [MainThread]: 
[0m17:49:31.669096 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:49:31.670131 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:49:31.671098 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:49:31.671098 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:49:31.680129 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:49:31.681096 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:49:31.672098 => 17:49:31.681096
[0m17:49:31.681096 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:49:31.713097 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:49:31.715098 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:49:31.716129 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN total_revenue-total_previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN total_previous_revenue-total_revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:49:31.716129 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:32.082098 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0083-0001-429e-0008-435e00023436
[0m17:49:32.082098 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 68
invalid identifier 'TOTAL_PREVIOUS_REVENUE'
[0m17:49:32.083098 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:49:31.682099 => 17:49:32.082098
[0m17:49:32.083098 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:49:32.181344 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 17 at position 68
  invalid identifier 'TOTAL_PREVIOUS_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:49:32.182347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '271c695c-fc52-4a13-aceb-2df3835b19ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73F39FCB0>]}
[0m17:49:32.182347 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.51s]
[0m17:49:32.184314 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:49:32.186344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:32.186344 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:49:32.187344 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:49:32.187344 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:49:32.188347 [info ] [MainThread]: 
[0m17:49:32.188347 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m17:49:32.189313 [debug] [MainThread]: Command end result
[0m17:49:32.201312 [info ] [MainThread]: 
[0m17:49:32.202314 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:49:32.203314 [info ] [MainThread]: 
[0m17:49:32.204346 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 17 at position 68
  invalid identifier 'TOTAL_PREVIOUS_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:49:32.205315 [info ] [MainThread]: 
[0m17:49:32.207323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:49:32.208314 [debug] [MainThread]: Command `dbt run` failed at 17:49:32.208314 after 5.10 seconds
[0m17:49:32.209314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B732555100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B732555640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B732555D90>]}
[0m17:49:32.209314 [debug] [MainThread]: Flushing usage events
[0m17:49:57.675352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD757AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD92575F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD9257230>]}


============================== 17:49:57.679383 | bfdd5dd7-7ab5-4851-bb2d-64d837bf821c ==============================
[0m17:49:57.679383 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:49:57.680385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:58.594235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfdd5dd7-7ab5-4851-bb2d-64d837bf821c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE5B1A630>]}
[0m17:49:58.681465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfdd5dd7-7ab5-4851-bb2d-64d837bf821c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE58C4380>]}
[0m17:49:58.682465 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:49:58.690502 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:49:58.807379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:58.807379 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:49:58.942936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:49:58.948935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfdd5dd7-7ab5-4851-bb2d-64d837bf821c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE5D32180>]}
[0m17:49:58.960971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfdd5dd7-7ab5-4851-bb2d-64d837bf821c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE5C52BD0>]}
[0m17:49:58.961967 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:49:58.962939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfdd5dd7-7ab5-4851-bb2d-64d837bf821c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE5E630B0>]}
[0m17:49:58.964935 [info ] [MainThread]: 
[0m17:49:58.965935 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:58.966935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:49:58.980971 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:49:58.981967 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:49:58.981967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:00.385599 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:50:00.386599 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:50:00.469541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m17:50:00.477547 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:50:00.477547 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:50:00.478547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:00.909197 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0084-0001-429a-0008-435e00020fa6
[0m17:50:00.909197 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:50:00.910197 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:50:00.910197 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:50:00.911198 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:50:00.998810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m17:50:01.003842 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:50:01.004841 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:50:01.004841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:01.281479 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:50:01.283482 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:50:01.557354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m17:50:01.561354 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:50:01.562360 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:50:01.562360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:01.845515 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:50:01.847515 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:50:01.933835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m17:50:01.941870 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:50:01.942869 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:50:01.942869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:02.240090 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:50:02.241090 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:50:02.322784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfdd5dd7-7ab5-4851-bb2d-64d837bf821c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE5E419A0>]}
[0m17:50:02.323784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:02.324784 [info ] [MainThread]: 
[0m17:50:02.328752 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:50:02.328752 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:50:02.330757 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:50:02.330757 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:50:02.339752 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:50:02.343754 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:50:02.331756 => 17:50:02.342771
[0m17:50:02.343754 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:50:02.376753 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:50:02.378753 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:50:02.379753 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        SUM(CASE WHEN revenue > previous_revenue THEN total_revenue-prev_total_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN revenue < previous_revenue THEN prev_total_revenue-total_revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:50:02.379753 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:02.682313 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0084-0001-429a-0008-435e00020fb2
[0m17:50:02.682313 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002082 (42601): SQL compilation error: 
Aggregate functions cannot be nested: [SUM(PREV.REVENUE)] nested in [SUM(IFF(PREV.REVENUE > PREV.PREVIOUS_REVENUE, TOTAL_REVENUE - PREV_TOTAL_REVENUE, CAST(0 AS NUMBER(38,2))))]
[0m17:50:02.683313 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:50:02.343754 => 17:50:02.683313
[0m17:50:02.683313 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:50:02.765489 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002082 (42601): SQL compilation error: 
  Aggregate functions cannot be nested: [SUM(PREV.REVENUE)] nested in [SUM(IFF(PREV.REVENUE > PREV.PREVIOUS_REVENUE, TOTAL_REVENUE - PREV_TOTAL_REVENUE, CAST(0 AS NUMBER(38,2))))]
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:50:02.765489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfdd5dd7-7ab5-4851-bb2d-64d837bf821c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE61F5C70>]}
[0m17:50:02.766463 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.44s]
[0m17:50:02.767465 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:50:02.769465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:02.770491 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:50:02.770491 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:50:02.770491 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:50:02.771464 [info ] [MainThread]: 
[0m17:50:02.771464 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m17:50:02.772463 [debug] [MainThread]: Command end result
[0m17:50:02.784465 [info ] [MainThread]: 
[0m17:50:02.785470 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:02.786466 [info ] [MainThread]: 
[0m17:50:02.787504 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002082 (42601): SQL compilation error: 
  Aggregate functions cannot be nested: [SUM(PREV.REVENUE)] nested in [SUM(IFF(PREV.REVENUE > PREV.PREVIOUS_REVENUE, TOTAL_REVENUE - PREV_TOTAL_REVENUE, CAST(0 AS NUMBER(38,2))))]
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:50:02.788466 [info ] [MainThread]: 
[0m17:50:02.788466 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:50:02.790490 [debug] [MainThread]: Command `dbt run` failed at 17:50:02.790490 after 5.18 seconds
[0m17:50:02.791466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD9150680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD9181880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FD9181CA0>]}
[0m17:50:02.791466 [debug] [MainThread]: Flushing usage events
[0m17:54:50.112327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EF8592B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EF6CBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EF859220>]}


============================== 17:54:50.124669 | c85292f8-592e-4397-ae07-b0fb60013a1e ==============================
[0m17:54:50.124669 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:54:50.125669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m17:54:57.623501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c85292f8-592e-4397-ae07-b0fb60013a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FC0D1970>]}
[0m17:54:57.713115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c85292f8-592e-4397-ae07-b0fb60013a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FA543140>]}
[0m17:54:57.721121 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:54:57.738488 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:54:59.015122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:59.015122 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:54:59.148753 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:54:59.154752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c85292f8-592e-4397-ae07-b0fb60013a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FC121790>]}
[0m17:54:59.184828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c85292f8-592e-4397-ae07-b0fb60013a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FC352E70>]}
[0m17:54:59.185819 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:54:59.186817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85292f8-592e-4397-ae07-b0fb60013a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FC55E420>]}
[0m17:54:59.188816 [info ] [MainThread]: 
[0m17:54:59.190816 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:59.191815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:54:59.208400 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:54:59.208400 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:54:59.209402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:00.226566 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:55:00.233508 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:55:00.320396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:55:00.329366 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:55:00.329366 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:55:00.330397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:00.744633 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:55:00.746632 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:55:00.825875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:55:00.831871 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:55:00.831871 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:55:00.832837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:01.150717 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:55:01.152711 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:55:01.233371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m17:55:01.236406 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:55:01.236406 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:55:01.237410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:01.659931 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0089-0001-429b-0008-435e000240c6
[0m17:55:01.659931 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:55:01.660932 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:55:01.660932 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:55:01.661932 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:55:01.920948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m17:55:01.923938 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:55:01.923938 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:55:01.923938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:02.214192 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:55:02.215162 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:55:02.325623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85292f8-592e-4397-ae07-b0fb60013a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FAD40E00>]}
[0m17:55:02.328620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:02.331546 [info ] [MainThread]: 
[0m17:55:02.346698 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:55:02.348688 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:55:02.353630 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:55:02.354633 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:55:02.372628 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:55:02.374635 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:55:02.355635 => 17:55:02.374635
[0m17:55:02.375660 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:55:02.408627 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:55:02.410667 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:55:02.411664 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(lag(revenue) over (partition by customer_id order by PAYMENT_MONTH))as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        AS total_revenue,  
         total_revenue,previous_revenue,
        SUM(CASE WHEN total_revenue > previous_revenue THEN total_revenue-previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN total_revenue < previous_revenue THEN previous_revenue-total_revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:55:02.411664 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:02.724447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0089-0001-429a-0008-435e00020fbe
[0m17:55:02.725447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 8 unexpected 'AS'.
syntax error line 16 at position 22 unexpected ','.
syntax error line 16 at position 39 unexpected ','.
syntax error line 17 at position 17 unexpected 'WHEN'.
syntax error line 18 at position 17 unexpected 'WHEN'.
syntax error line 19 at position 4 unexpected 'FROM'.
syntax error line 22 at position 0 unexpected 'SELECT'.
[0m17:55:02.725447 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:55:02.375660 => 17:55:02.725447
[0m17:55:02.726446 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:55:02.812472 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 8 unexpected 'AS'.
  syntax error line 16 at position 22 unexpected ','.
  syntax error line 16 at position 39 unexpected ','.
  syntax error line 17 at position 17 unexpected 'WHEN'.
  syntax error line 18 at position 17 unexpected 'WHEN'.
  syntax error line 19 at position 4 unexpected 'FROM'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:55:02.813471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85292f8-592e-4397-ae07-b0fb60013a1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FC8C5BB0>]}
[0m17:55:02.813471 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.46s]
[0m17:55:02.814472 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:55:02.817981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:02.817981 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:55:02.818989 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:55:02.818989 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:55:02.818989 [info ] [MainThread]: 
[0m17:55:02.819989 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m17:55:02.820994 [debug] [MainThread]: Command end result
[0m17:55:02.832990 [info ] [MainThread]: 
[0m17:55:02.833992 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:02.834991 [info ] [MainThread]: 
[0m17:55:02.835988 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 8 unexpected 'AS'.
  syntax error line 16 at position 22 unexpected ','.
  syntax error line 16 at position 39 unexpected ','.
  syntax error line 17 at position 17 unexpected 'WHEN'.
  syntax error line 18 at position 17 unexpected 'WHEN'.
  syntax error line 19 at position 4 unexpected 'FROM'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:55:02.836989 [info ] [MainThread]: 
[0m17:55:02.837993 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:02.838996 [debug] [MainThread]: Command `dbt run` failed at 17:55:02.838996 after 12.81 seconds
[0m17:55:02.839990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDBF11F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EF6C97C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EF6CBE90>]}
[0m17:55:02.840991 [debug] [MainThread]: Flushing usage events
[0m17:56:05.105439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC5B54110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC5B54290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC5B552B0>]}


============================== 17:56:05.111456 | 7599c252-544e-451c-ad4d-8a0167d1a6c1 ==============================
[0m17:56:05.111456 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:56:05.112435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:06.043299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7599c252-544e-451c-ad4d-8a0167d1a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD248B4D0>]}
[0m17:56:06.131918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7599c252-544e-451c-ad4d-8a0167d1a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD23D3DD0>]}
[0m17:56:06.132916 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:56:06.141885 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:56:06.327952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:06.328951 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:56:06.462579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:56:06.469177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7599c252-544e-451c-ad4d-8a0167d1a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD257D760>]}
[0m17:56:06.481179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7599c252-544e-451c-ad4d-8a0167d1a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD2647050>]}
[0m17:56:06.482147 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:56:06.483146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7599c252-544e-451c-ad4d-8a0167d1a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD282F200>]}
[0m17:56:06.485148 [info ] [MainThread]: 
[0m17:56:06.486146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:56:06.488146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:56:06.504178 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:56:06.505162 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:56:06.505162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:07.786517 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:56:07.788515 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:56:07.879311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m17:56:07.895266 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:56:07.895266 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:56:07.896266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:08.189166 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb008a-0001-429b-0008-435e000240d2
[0m17:56:08.190166 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:56:08.190166 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:56:08.191165 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:56:08.191165 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:56:08.272688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m17:56:08.276687 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:56:08.276687 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:56:08.276687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:08.598978 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:56:08.600981 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:56:09.179447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m17:56:09.183447 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:56:09.184448 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:56:09.184448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:09.476204 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:56:09.477193 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:56:09.561746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:56:09.564744 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:56:09.565744 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:56:09.565744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:09.998013 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:56:09.999052 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:56:10.088797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7599c252-544e-451c-ad4d-8a0167d1a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD24E64E0>]}
[0m17:56:10.089830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:10.089830 [info ] [MainThread]: 
[0m17:56:10.093997 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:56:10.095038 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:56:10.096003 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:56:10.096003 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:56:10.105005 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:56:10.106007 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:56:10.096003 => 17:56:10.106007
[0m17:56:10.107004 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:56:10.139004 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:56:10.141004 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:56:10.142035 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(lag(revenue) over (partition by customer_id order by PAYMENT_MONTH))as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        total_revenue,  
         total_revenue,previous_revenue,
        SUM(CASE WHEN total_revenue > previous_revenue THEN total_revenue-previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN total_revenue < previous_revenue THEN previous_revenue-total_revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:56:10.142035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:56:10.494094 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb008a-0001-429e-0008-435e00023446
[0m17:56:10.494094 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'TOTAL_REVENUE'
[0m17:56:10.495062 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:56:10.107004 => 17:56:10.494094
[0m17:56:10.495062 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:56:10.580536 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'TOTAL_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:56:10.580536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7599c252-544e-451c-ad4d-8a0167d1a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD2B8E990>]}
[0m17:56:10.581536 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.49s]
[0m17:56:10.582470 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:56:10.585023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:10.586055 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:56:10.586055 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m17:56:10.587056 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:56:10.587056 [info ] [MainThread]: 
[0m17:56:10.588023 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m17:56:10.589055 [debug] [MainThread]: Command end result
[0m17:56:10.600025 [info ] [MainThread]: 
[0m17:56:10.601026 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:10.602024 [info ] [MainThread]: 
[0m17:56:10.603024 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'TOTAL_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:56:10.604024 [info ] [MainThread]: 
[0m17:56:10.604024 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:56:10.606025 [debug] [MainThread]: Command `dbt run` failed at 17:56:10.606025 after 5.57 seconds
[0m17:56:10.606025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC5B838F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC3F191F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC5A80590>]}
[0m17:56:10.607056 [debug] [MainThread]: Flushing usage events
[0m17:56:22.734401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9064890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9254F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9255580>]}


============================== 17:56:22.738440 | bf54c778-2df3-4e8a-96ed-ef3e00f2b568 ==============================
[0m17:56:22.738440 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:56:22.739415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:23.619879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf54c778-2df3-4e8a-96ed-ef3e00f2b568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB5B4FF20>]}
[0m17:56:23.708493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf54c778-2df3-4e8a-96ed-ef3e00f2b568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB5BD6F30>]}
[0m17:56:23.709493 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:56:23.717128 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:56:23.832479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:23.833474 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:56:23.962672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m17:56:23.968706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf54c778-2df3-4e8a-96ed-ef3e00f2b568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB5E2D490>]}
[0m17:56:23.981706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf54c778-2df3-4e8a-96ed-ef3e00f2b568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB5C3AC00>]}
[0m17:56:23.981706 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:56:23.983677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf54c778-2df3-4e8a-96ed-ef3e00f2b568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB5A49EE0>]}
[0m17:56:23.985706 [info ] [MainThread]: 
[0m17:56:23.987705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:56:23.988672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:56:24.002674 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:56:24.002674 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:56:24.003673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:24.964942 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:56:24.966942 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:56:25.053449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m17:56:25.063452 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:56:25.063452 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:56:25.063452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:25.512611 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:56:25.514603 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:56:25.596955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m17:56:25.599954 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:56:25.600958 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:56:25.600958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:25.894681 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:56:25.897676 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:56:25.984546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m17:56:25.989546 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:56:25.989546 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:56:25.989546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:26.293454 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:56:26.297443 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:56:26.386262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m17:56:26.395218 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:56:26.396220 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:56:26.396220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:26.692650 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb008a-0001-429e-0008-435e00023452
[0m17:56:26.692650 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:56:26.693650 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:56:26.693650 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:56:26.694650 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:56:26.782870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf54c778-2df3-4e8a-96ed-ef3e00f2b568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB5EBC200>]}
[0m17:56:26.785930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:26.787649 [info ] [MainThread]: 
[0m17:56:26.791684 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:56:26.791684 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:56:26.793683 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:56:26.793683 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:56:26.802683 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:56:26.804684 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:56:26.793683 => 17:56:26.803693
[0m17:56:26.804684 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:56:26.834683 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:56:26.837717 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:56:26.837717 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(lag(revenue) over (partition by customer_id order by PAYMENT_MONTH))as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        total_revenue,  
        previous_revenue,
        SUM(CASE WHEN total_revenue > previous_revenue THEN total_revenue-previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN total_revenue < previous_revenue THEN previous_revenue-total_revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:56:26.838685 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:56:27.345238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb008a-0001-429b-0008-435e000240de
[0m17:56:27.347250 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 4
invalid identifier 'PREV_TOTAL_REVENUE'
[0m17:56:27.349242 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:56:26.804684 => 17:56:27.349242
[0m17:56:27.351190 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:56:27.479855 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 25 at position 4
  invalid identifier 'PREV_TOTAL_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:56:27.481367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf54c778-2df3-4e8a-96ed-ef3e00f2b568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FB5C0C9B0>]}
[0m17:56:27.482379 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.69s]
[0m17:56:27.484389 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:56:27.487377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:27.488375 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:56:27.489377 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m17:56:27.489377 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:56:27.489377 [info ] [MainThread]: 
[0m17:56:27.490375 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m17:56:27.492378 [debug] [MainThread]: Command end result
[0m17:56:27.505379 [info ] [MainThread]: 
[0m17:56:27.506380 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:27.507381 [info ] [MainThread]: 
[0m17:56:27.508377 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 25 at position 4
  invalid identifier 'PREV_TOTAL_REVENUE'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:56:27.509376 [info ] [MainThread]: 
[0m17:56:27.510376 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:56:27.512378 [debug] [MainThread]: Command `dbt run` failed at 17:56:27.511377 after 4.84 seconds
[0m17:56:27.512378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9257650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9255580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024FA9254F80>]}
[0m17:56:27.513376 [debug] [MainThread]: Flushing usage events
[0m17:56:56.476857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666A15AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666A254200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666A2552E0>]}


============================== 17:56:56.481858 | 151115f2-8a06-416a-9466-c7e09600f51c ==============================
[0m17:56:56.481858 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:56:56.482859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m17:56:57.397954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151115f2-8a06-416a-9466-c7e09600f51c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002667644EAB0>]}
[0m17:56:57.486987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '151115f2-8a06-416a-9466-c7e09600f51c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026676AD56D0>]}
[0m17:56:57.486987 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:56:57.495710 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:56:57.609290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:57.609290 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:56:57.742811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:56:57.748808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '151115f2-8a06-416a-9466-c7e09600f51c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026676F2D220>]}
[0m17:56:57.761810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '151115f2-8a06-416a-9466-c7e09600f51c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026676D52BA0>]}
[0m17:56:57.761810 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:56:57.762812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151115f2-8a06-416a-9466-c7e09600f51c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026676F5FB00>]}
[0m17:56:57.764811 [info ] [MainThread]: 
[0m17:56:57.765812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:56:57.767813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:56:57.781820 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:56:57.782822 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:56:57.782822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:58.663291 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:56:58.666292 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:56:58.757643 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m17:56:58.766644 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:56:58.767644 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:56:58.767644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:59.185106 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:56:59.187108 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:56:59.274358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m17:56:59.283323 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:56:59.284363 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:56:59.285359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:59.747331 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb008a-0001-429a-0008-435e00020fce
[0m17:56:59.748330 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:56:59.748330 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:56:59.749334 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:56:59.750330 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:56:59.835970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m17:56:59.845957 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:56:59.846957 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:56:59.847956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:00.136795 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:57:00.137794 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:57:00.227967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m17:57:00.231970 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:57:00.232970 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:57:00.232970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:00.580579 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:57:00.582553 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:57:00.667148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151115f2-8a06-416a-9466-c7e09600f51c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026676815520>]}
[0m17:57:00.668149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:00.669147 [info ] [MainThread]: 
[0m17:57:00.673115 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:57:00.674148 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:57:00.675115 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:57:00.675115 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:57:00.683115 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:57:00.685115 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:57:00.676149 => 17:57:00.685115
[0m17:57:00.685115 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:57:00.716661 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:57:00.718700 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:57:00.719701 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(lag(revenue) over (partition by customer_id order by PAYMENT_MONTH))as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        total_revenue,  
        previous_revenue,
        SUM(CASE WHEN total_revenue > previous_revenue THEN total_revenue-previous_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN total_revenue < previous_revenue THEN previous_revenue-total_revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    previous_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:57:00.719701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:01.075586 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb008b-0001-429a-0008-435e00020fd2
[0m17:57:01.075586 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002065 (42601): SQL compilation error:
Window function [LAG(STG_TRANSACTION.REVENUE) OVER (PARTITION BY STG_TRANSACTION.CUSTOMER_ID ORDER BY STG_TRANSACTION.PAYMENT_MONTH ASC NULLS LAST)] may not appear inside an aggregate function.
[0m17:57:01.076586 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:57:00.686115 => 17:57:01.076586
[0m17:57:01.076586 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:57:01.169342 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002065 (42601): SQL compilation error:
  Window function [LAG(STG_TRANSACTION.REVENUE) OVER (PARTITION BY STG_TRANSACTION.CUSTOMER_ID ORDER BY STG_TRANSACTION.PAYMENT_MONTH ASC NULLS LAST)] may not appear inside an aggregate function.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:57:01.169342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151115f2-8a06-416a-9466-c7e09600f51c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026676FF65A0>]}
[0m17:57:01.170343 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.50s]
[0m17:57:01.171343 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:57:01.174309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:01.174309 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:57:01.175309 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m17:57:01.175309 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:57:01.176309 [info ] [MainThread]: 
[0m17:57:01.176309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m17:57:01.178348 [debug] [MainThread]: Command end result
[0m17:57:01.190314 [info ] [MainThread]: 
[0m17:57:01.191318 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:57:01.192311 [info ] [MainThread]: 
[0m17:57:01.193250 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002065 (42601): SQL compilation error:
  Window function [LAG(STG_TRANSACTION.REVENUE) OVER (PARTITION BY STG_TRANSACTION.CUSTOMER_ID ORDER BY STG_TRANSACTION.PAYMENT_MONTH ASC NULLS LAST)] may not appear inside an aggregate function.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:57:01.194258 [info ] [MainThread]: 
[0m17:57:01.194258 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:57:01.196288 [debug] [MainThread]: Command `dbt run` failed at 17:57:01.195258 after 4.78 seconds
[0m17:57:01.196288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666A15AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666A255790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002666A254200>]}
[0m17:57:01.197289 [debug] [MainThread]: Flushing usage events
[0m17:59:22.570520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03BE850D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03BE84230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03BE853A0>]}


============================== 17:59:22.575552 | 5cc552c2-108c-431c-8270-869d02a795fa ==============================
[0m17:59:22.575552 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:59:22.576518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:23.468029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cc552c2-108c-431c-8270-869d02a795fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0493C9970>]}
[0m17:59:23.557161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cc552c2-108c-431c-8270-869d02a795fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0494C1190>]}
[0m17:59:23.558161 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:59:23.567078 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:59:23.686269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:23.686269 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m17:59:23.822827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m17:59:23.828857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cc552c2-108c-431c-8270-869d02a795fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E049B0A330>]}
[0m17:59:23.840886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cc552c2-108c-431c-8270-869d02a795fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E04993B2C0>]}
[0m17:59:23.841846 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m17:59:23.842850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc552c2-108c-431c-8270-869d02a795fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E049582B70>]}
[0m17:59:23.843849 [info ] [MainThread]: 
[0m17:59:23.845358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:59:23.847416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m17:59:23.861396 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m17:59:23.861396 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m17:59:23.861396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:24.825640 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m17:59:24.827640 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m17:59:24.924254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m17:59:24.934252 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m17:59:24.935253 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m17:59:24.935253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:25.418783 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m17:59:25.423786 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m17:59:25.513737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m17:59:25.518768 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m17:59:25.518768 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m17:59:25.519775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:25.813136 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb008d-0001-429e-0008-435e0002345e
[0m17:59:25.813136 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:59:25.814169 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m17:59:25.814169 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:59:25.815165 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m17:59:25.899803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m17:59:25.902802 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m17:59:25.903803 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m17:59:25.904803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:26.336585 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m17:59:26.338585 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m17:59:26.427811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m17:59:26.437851 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m17:59:26.438848 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m17:59:26.438848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:26.732075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:59:26.735034 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m17:59:26.840183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc552c2-108c-431c-8270-869d02a795fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E049D3BD40>]}
[0m17:59:26.843234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:26.846180 [info ] [MainThread]: 
[0m17:59:26.856383 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m17:59:26.856383 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m17:59:26.858382 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m17:59:26.858382 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m17:59:26.866385 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m17:59:26.867888 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 17:59:26.858382 => 17:59:26.867888
[0m17:59:26.868899 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m17:59:26.901895 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m17:59:26.903898 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m17:59:26.904933 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        SUM(CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END) AS expansion_revenue,  
        SUM(CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END) AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m17:59:26.904933 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:27.239062 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb008d-0001-429a-0008-435e00020fda
[0m17:59:27.240086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002082 (42601): SQL compilation error: 
Aggregate functions cannot be nested: [SUM(PREV.REVENUE)] nested in [SUM(IFF(TOTAL_REVENUE > PREV_TOTAL_REVENUE, TOTAL_REVENUE - PREV_TOTAL_REVENUE, CAST(0 AS NUMBER(38,2))))]
[0m17:59:27.240086 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 17:59:26.868899 => 17:59:27.240086
[0m17:59:27.241086 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m17:59:27.328676 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002082 (42601): SQL compilation error: 
  Aggregate functions cannot be nested: [SUM(PREV.REVENUE)] nested in [SUM(IFF(TOTAL_REVENUE > PREV_TOTAL_REVENUE, TOTAL_REVENUE - PREV_TOTAL_REVENUE, CAST(0 AS NUMBER(38,2))))]
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:59:27.329676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc552c2-108c-431c-8270-869d02a795fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E049C9D820>]}
[0m17:59:27.330676 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.47s]
[0m17:59:27.331676 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m17:59:27.334646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:27.334646 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m17:59:27.334646 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m17:59:27.335676 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m17:59:27.335676 [info ] [MainThread]: 
[0m17:59:27.336677 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m17:59:27.337646 [debug] [MainThread]: Command end result
[0m17:59:27.348646 [info ] [MainThread]: 
[0m17:59:27.349646 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:27.350649 [info ] [MainThread]: 
[0m17:59:27.351678 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  002082 (42601): SQL compilation error: 
  Aggregate functions cannot be nested: [SUM(PREV.REVENUE)] nested in [SUM(IFF(TOTAL_REVENUE > PREV_TOTAL_REVENUE, TOTAL_REVENUE - PREV_TOTAL_REVENUE, CAST(0 AS NUMBER(38,2))))]
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m17:59:27.352644 [info ] [MainThread]: 
[0m17:59:27.353646 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:59:27.354647 [debug] [MainThread]: Command `dbt run` failed at 17:59:27.354647 after 4.85 seconds
[0m17:59:27.355648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03BE871A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03BE84230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E03BE850D0>]}
[0m17:59:27.355648 [debug] [MainThread]: Flushing usage events
[0m18:00:09.281933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F1055550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EFF23E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F1055310>]}


============================== 18:00:09.286938 | 8a24c128-ab08-45bd-9ad7-fe037651685a ==============================
[0m18:00:09.286938 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:00:09.286938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:10.167645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a24c128-ab08-45bd-9ad7-fe037651685a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FD926B10>]}
[0m18:00:10.253259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a24c128-ab08-45bd-9ad7-fe037651685a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FD6C01D0>]}
[0m18:00:10.255259 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:00:10.262698 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:00:10.376033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:10.377034 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:00:10.512556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:00:10.518553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a24c128-ab08-45bd-9ad7-fe037651685a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FDDFEC30>]}
[0m18:00:10.531591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a24c128-ab08-45bd-9ad7-fe037651685a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FDB3AFC0>]}
[0m18:00:10.532559 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:00:10.532559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a24c128-ab08-45bd-9ad7-fe037651685a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FD640980>]}
[0m18:00:10.534559 [info ] [MainThread]: 
[0m18:00:10.535560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:10.537068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:00:10.552108 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:00:10.553107 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:00:10.553107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:11.623354 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:00:11.626348 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:00:11.719391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:00:11.727423 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:00:11.727423 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:00:11.728424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:12.128888 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:00:12.129887 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:00:12.211078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m18:00:12.219084 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:00:12.220081 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:00:12.221081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:12.501231 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:00:12.504234 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:00:12.584400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m18:00:12.587401 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:00:12.588431 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:00:12.588431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:12.892262 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:00:12.895240 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:00:13.289226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m18:00:13.294228 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:00:13.295195 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:00:13.295195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:13.728508 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb008e-0001-429b-0008-435e000240f2
[0m18:00:13.728508 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:00:13.729509 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:00:13.730509 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:00:13.730509 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:00:13.820434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a24c128-ab08-45bd-9ad7-fe037651685a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FDA1B620>]}
[0m18:00:13.824429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:13.826378 [info ] [MainThread]: 
[0m18:00:13.840650 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:00:13.842639 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:00:13.847640 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:00:13.849585 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:00:13.872980 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:00:13.874978 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:00:13.850594 => 18:00:13.874978
[0m18:00:13.876978 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:00:13.922982 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:00:13.926976 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:00:13.927975 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END)AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m18:00:13.927975 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:14.210221 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb008e-0001-429b-0008-435e000240f6
[0m18:00:14.211222 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 102 unexpected 'AS'.
syntax error line 22 at position 0 unexpected 'SELECT'.
[0m18:00:14.211222 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:00:13.876978 => 18:00:14.211222
[0m18:00:14.212222 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:00:14.319831 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 102 unexpected 'AS'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:00:14.321820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a24c128-ab08-45bd-9ad7-fe037651685a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267FDF9C740>]}
[0m18:00:14.324831 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.48s]
[0m18:00:14.327811 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:00:14.334766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:14.335762 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:00:14.336762 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m18:00:14.337812 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:00:14.339760 [info ] [MainThread]: 
[0m18:00:14.340763 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.80 seconds (3.80s).
[0m18:00:14.342763 [debug] [MainThread]: Command end result
[0m18:00:14.360768 [info ] [MainThread]: 
[0m18:00:14.361769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:14.362772 [info ] [MainThread]: 
[0m18:00:14.363769 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 102 unexpected 'AS'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:00:14.364802 [info ] [MainThread]: 
[0m18:00:14.364802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:00:14.366770 [debug] [MainThread]: Command `dbt run` failed at 18:00:14.366770 after 5.15 seconds
[0m18:00:14.367802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F1087800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EFF23E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267EFE091F0>]}
[0m18:00:14.368345 [debug] [MainThread]: Flushing usage events
[0m18:00:28.031145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E160ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252DFDC4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E1855580>]}


============================== 18:00:28.036179 | 39290551-a8ca-4f8e-a0a6-e1fea331b7a2 ==============================
[0m18:00:28.036179 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:00:28.037147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:28.918622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39290551-a8ca-4f8e-a0a6-e1fea331b7a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252EE21B920>]}
[0m18:00:29.006632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39290551-a8ca-4f8e-a0a6-e1fea331b7a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E1884EF0>]}
[0m18:00:29.008632 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:00:29.017146 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:00:29.132725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:29.132725 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:00:29.262307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:00:29.268335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39290551-a8ca-4f8e-a0a6-e1fea331b7a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252EE55D0D0>]}
[0m18:00:29.280304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39290551-a8ca-4f8e-a0a6-e1fea331b7a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252EE347380>]}
[0m18:00:29.281305 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:00:29.282308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39290551-a8ca-4f8e-a0a6-e1fea331b7a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252EC9C0EC0>]}
[0m18:00:29.284335 [info ] [MainThread]: 
[0m18:00:29.285337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:29.286306 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:00:29.302321 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:00:29.302321 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:00:29.303318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:30.328070 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:00:30.331107 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:00:30.417785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:00:30.428302 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:00:30.429302 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:00:30.429302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:30.730162 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:00:30.732197 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:00:30.818236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m18:00:30.822233 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:00:30.823232 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:00:30.823232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:31.153608 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:00:31.155598 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:00:31.376191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m18:00:31.382195 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:00:31.383162 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:00:31.383162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:31.685048 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb008e-0001-429e-0008-435e00023472
[0m18:00:31.686046 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:00:31.686046 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:00:31.687046 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:00:31.687046 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:00:31.777933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m18:00:31.780968 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:00:31.780968 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:00:31.780968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:32.200284 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:00:32.203319 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:00:32.288033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39290551-a8ca-4f8e-a0a6-e1fea331b7a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252EE6CAA50>]}
[0m18:00:32.289036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:32.290044 [info ] [MainThread]: 
[0m18:00:32.294004 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:00:32.294004 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:00:32.296002 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:00:32.296002 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:00:32.305002 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:00:32.307006 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:00:32.296002 => 18:00:32.307006
[0m18:00:32.308002 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:00:32.339568 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:00:32.341538 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:00:32.342566 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 ENDAS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m18:00:32.342566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:32.636664 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb008e-0001-429e-0008-435e00023476
[0m18:00:32.636664 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 98 unexpected 'ENDAS'.
syntax error line 17 at position 104 unexpected 'expansion_revenue'.
syntax error line 18 at position 13 unexpected 'WHEN'.
syntax error line 22 at position 0 unexpected 'SELECT'.
[0m18:00:32.637664 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:00:32.308002 => 18:00:32.637664
[0m18:00:32.637664 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:00:32.727031 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 98 unexpected 'ENDAS'.
  syntax error line 17 at position 104 unexpected 'expansion_revenue'.
  syntax error line 18 at position 13 unexpected 'WHEN'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:00:32.727031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39290551-a8ca-4f8e-a0a6-e1fea331b7a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252EE8C58B0>]}
[0m18:00:32.728031 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.43s]
[0m18:00:32.729232 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:00:32.733834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:32.733834 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:00:32.734866 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m18:00:32.735834 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:00:32.735834 [info ] [MainThread]: 
[0m18:00:32.736832 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m18:00:32.738868 [debug] [MainThread]: Command end result
[0m18:00:32.753832 [info ] [MainThread]: 
[0m18:00:32.754834 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:32.754834 [info ] [MainThread]: 
[0m18:00:32.755831 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 98 unexpected 'ENDAS'.
  syntax error line 17 at position 104 unexpected 'expansion_revenue'.
  syntax error line 18 at position 13 unexpected 'WHEN'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:00:32.756835 [info ] [MainThread]: 
[0m18:00:32.757837 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:00:32.759863 [debug] [MainThread]: Command `dbt run` failed at 18:00:32.759863 after 4.79 seconds
[0m18:00:32.759863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E160ACF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E1630200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E183FC80>]}
[0m18:00:32.760862 [debug] [MainThread]: Flushing usage events
[0m18:00:39.001192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90357AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F903854500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F903856D20>]}


============================== 18:00:39.005191 | 7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd ==============================
[0m18:00:39.005191 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:00:39.006191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m18:00:39.894532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F910021970>]}
[0m18:00:39.982144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90EFD4380>]}
[0m18:00:39.983113 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:00:39.992144 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:00:40.111714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:40.112716 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:00:40.246327 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:00:40.252327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9104FAEA0>]}
[0m18:00:40.264328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F910252E70>]}
[0m18:00:40.264328 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:00:40.265375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F91042F3E0>]}
[0m18:00:40.267328 [info ] [MainThread]: 
[0m18:00:40.268328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:40.270328 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:00:40.284358 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:00:40.285359 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:00:40.285359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:40.788864 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:00:40.790894 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:00:40.877324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m18:00:40.886324 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:00:40.887324 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:00:40.887324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:41.217673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:00:41.220678 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:00:41.312591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m18:00:41.325580 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:00:41.326578 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:00:41.327539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:41.748163 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb008e-0001-429b-0008-435e000240fe
[0m18:00:41.750102 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:00:41.751138 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:00:41.752140 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:00:41.754139 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:00:41.847433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m18:00:41.856366 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:00:41.858410 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:00:41.859411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:42.173427 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:00:42.176404 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:00:42.270575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m18:00:42.275574 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:00:42.275574 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:00:42.276574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:42.590739 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:00:42.592740 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:00:42.670740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F910214140>]}
[0m18:00:42.671710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:42.671710 [info ] [MainThread]: 
[0m18:00:42.675706 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:00:42.675706 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:00:42.677709 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:00:42.677709 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:00:42.686708 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:00:42.687711 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:00:42.677709 => 18:00:42.687711
[0m18:00:42.688707 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:00:42.718707 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:00:42.720708 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:00:42.721711 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (expansion_revenue - contraction_revenue) / total_revenue
    END AS net_revenue_retention
FROM transactions
        );
[0m18:00:42.721711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:43.828795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:43.852781 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:00:42.688707 => 18:00:43.852781
[0m18:00:43.852781 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:00:43.931833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c56ddc0-ebb8-4a74-b7bb-1a3c8eb287cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9107B24E0>]}
[0m18:00:43.932834 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 1.26s]
[0m18:00:43.934845 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:00:43.936844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:43.936844 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:00:43.937843 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m18:00:43.937843 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:00:43.938843 [info ] [MainThread]: 
[0m18:00:43.939701 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m18:00:43.940710 [debug] [MainThread]: Command end result
[0m18:00:43.953711 [info ] [MainThread]: 
[0m18:00:43.954709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:43.955715 [info ] [MainThread]: 
[0m18:00:43.956719 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:43.957740 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:43.957740 after 5.02 seconds
[0m18:00:43.958740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90375B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90E9FA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90E9FA1E0>]}
[0m18:00:43.958740 [debug] [MainThread]: Flushing usage events
[0m18:04:47.888262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015525559580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015525559250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015525558DD0>]}


============================== 18:04:47.893262 | 4b83cc5f-d081-4fbe-b9ec-1104835b824d ==============================
[0m18:04:47.893262 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:04:47.894293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:49.233908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b83cc5f-d081-4fbe-b9ec-1104835b824d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015531CD7F50>]}
[0m18:04:49.321424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b83cc5f-d081-4fbe-b9ec-1104835b824d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015531DEC140>]}
[0m18:04:49.322424 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:04:49.331824 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:04:49.502155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:49.502155 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:04:49.648393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:04:49.654427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b83cc5f-d081-4fbe-b9ec-1104835b824d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015531EB2C30>]}
[0m18:04:49.667395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b83cc5f-d081-4fbe-b9ec-1104835b824d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015531F4F230>]}
[0m18:04:49.668404 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:04:49.669405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b83cc5f-d081-4fbe-b9ec-1104835b824d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155310FFBC0>]}
[0m18:04:49.671401 [info ] [MainThread]: 
[0m18:04:49.672406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:04:49.674406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:04:49.689019 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:04:49.689019 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:04:49.690015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:50.689834 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:04:50.691871 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:04:50.787860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m18:04:50.807378 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:04:50.808379 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:04:50.808379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:51.099813 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:04:51.108796 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:04:51.207656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MART)
[0m18:04:51.223644 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:04:51.224637 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:04:51.225637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:51.667426 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0092-0001-429b-0008-435e00024116
[0m18:04:51.667426 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:04:51.668425 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:04:51.668425 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:04:51.668425 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:04:51.749272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m18:04:51.752302 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:04:51.753302 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:04:51.753302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:52.058903 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:04:52.060954 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:04:52.151872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m18:04:52.154890 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:04:52.155874 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:04:52.155874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:52.455344 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:04:52.457343 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:04:52.541527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b83cc5f-d081-4fbe-b9ec-1104835b824d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155322150D0>]}
[0m18:04:52.542495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:52.542495 [info ] [MainThread]: 
[0m18:04:52.728119 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:04:52.729080 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:04:52.732078 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:04:52.733114 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:04:52.747072 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:04:52.748071 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:04:52.734121 => 18:04:52.748071
[0m18:04:52.748071 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:04:52.780072 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:04:52.783098 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:04:52.819682 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention
FROM transactions
        );
[0m18:04:52.820684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:53.398473 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0092-0001-429a-0008-435e00020ff2
[0m18:04:53.400472 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 32 at position 4 unexpected 'CASE'.
[0m18:04:53.401470 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:04:52.749077 => 18:04:53.401470
[0m18:04:53.402978 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:04:53.514652 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 4 unexpected 'CASE'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:04:53.515654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b83cc5f-d081-4fbe-b9ec-1104835b824d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155324BE870>]}
[0m18:04:53.517693 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.78s]
[0m18:04:53.519652 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:04:53.524686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:53.525651 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:04:53.525651 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m18:04:53.526686 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:04:53.526686 [info ] [MainThread]: 
[0m18:04:53.527683 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m18:04:53.529649 [debug] [MainThread]: Command end result
[0m18:04:53.542657 [info ] [MainThread]: 
[0m18:04:53.543648 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:04:53.544647 [info ] [MainThread]: 
[0m18:04:53.684050 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 4 unexpected 'CASE'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:04:53.685053 [info ] [MainThread]: 
[0m18:04:53.686049 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:04:53.687050 [debug] [MainThread]: Command `dbt run` failed at 18:04:53.687050 after 5.86 seconds
[0m18:04:53.687050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155254591F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155322150D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552FBC0F20>]}
[0m18:04:53.688049 [debug] [MainThread]: Flushing usage events
[0m18:05:02.458077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFCEC55100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFCEC55400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFCEC556D0>]}


============================== 18:05:02.462075 | fcb624ca-287f-46c5-a556-7273f745e07a ==============================
[0m18:05:02.462075 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:05:02.463075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:03.362007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcb624ca-287f-46c5-a556-7273f745e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFD9E4A8D0>]}
[0m18:05:03.449625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcb624ca-287f-46c5-a556-7273f745e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFD9728EC0>]}
[0m18:05:03.450625 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:05:03.459594 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:05:03.588113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:03.589115 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:05:03.729672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:05:03.735673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcb624ca-287f-46c5-a556-7273f745e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFDB95D220>]}
[0m18:05:03.748745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcb624ca-287f-46c5-a556-7273f745e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFDB752D50>]}
[0m18:05:03.749746 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:05:03.750746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb624ca-287f-46c5-a556-7273f745e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFDB9FAC60>]}
[0m18:05:03.752743 [info ] [MainThread]: 
[0m18:05:03.753744 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:05:03.754745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:05:03.772746 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:05:03.773773 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:05:03.773773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:04.243091 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:05:04.244091 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:05:04.326255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m18:05:04.334262 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:05:04.335262 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:05:04.335262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:04.728234 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0093-0001-429b-0008-435e0002411e
[0m18:05:04.729247 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:05:04.729247 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:05:04.730234 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:05:04.730234 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:05:04.827292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m18:05:04.830292 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:05:04.830292 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:05:04.831292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:05.101409 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:05:05.104405 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:05:05.189614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m18:05:05.198701 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:05:05.199702 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:05:05.200703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:05.918080 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:05:05.920072 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:05:06.007599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m18:05:06.025072 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:05:06.027070 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:05:06.028066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:06.334086 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:05:06.337087 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:05:06.422604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb624ca-287f-46c5-a556-7273f745e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFDB9C6480>]}
[0m18:05:06.423605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:05:06.425607 [info ] [MainThread]: 
[0m18:05:06.440608 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:05:06.440608 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:05:06.442609 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:05:06.443607 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:05:06.455634 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:05:06.459633 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:05:06.443607 => 18:05:06.459633
[0m18:05:06.460635 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:05:06.500156 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:05:06.504151 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:05:06.504151 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention
FROM transactions
        );
[0m18:05:06.505151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:05:07.753092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:05:07.779612 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:05:06.460635 => 18:05:07.779612
[0m18:05:07.780612 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:05:07.862615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcb624ca-287f-46c5-a556-7273f745e07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFDB6B6B10>]}
[0m18:05:07.863615 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 1.42s]
[0m18:05:07.864615 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:05:07.867125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:07.867125 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:05:07.868135 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m18:05:07.868135 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:05:07.869133 [info ] [MainThread]: 
[0m18:05:07.869133 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m18:05:07.870136 [debug] [MainThread]: Command end result
[0m18:05:07.880133 [info ] [MainThread]: 
[0m18:05:07.881135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:07.882133 [info ] [MainThread]: 
[0m18:05:07.883133 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:07.885134 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:07.885134 after 5.49 seconds
[0m18:05:07.886133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFCEC877D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFCE6111F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFCEB81B80>]}
[0m18:05:07.886133 [debug] [MainThread]: Flushing usage events
[0m18:05:56.452912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48FF541D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48FF55610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48FF552B0>]}


============================== 18:05:56.457935 | 9150cd49-33d1-4c5e-a490-3a3aadaa4794 ==============================
[0m18:05:56.457935 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:05:56.458910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:57.360368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9150cd49-33d1-4c5e-a490-3a3aadaa4794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D7230E0>]}
[0m18:05:57.446887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9150cd49-33d1-4c5e-a490-3a3aadaa4794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48FF80290>]}
[0m18:05:57.447887 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:05:57.455919 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:05:57.574374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:57.575374 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:05:57.709899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:05:57.715412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9150cd49-33d1-4c5e-a490-3a3aadaa4794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49DAEFE30>]}
[0m18:05:57.728412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9150cd49-33d1-4c5e-a490-3a3aadaa4794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D94F050>]}
[0m18:05:57.728412 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:05:57.729413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9150cd49-33d1-4c5e-a490-3a3aadaa4794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49DB40CB0>]}
[0m18:05:57.731444 [info ] [MainThread]: 
[0m18:05:57.732412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:05:57.733413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:05:57.748410 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:05:57.748410 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:05:57.749413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:58.694918 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:05:58.696919 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:05:58.782533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m18:05:58.792529 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:05:58.792529 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:05:58.792529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:59.306182 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0093-0001-429b-0008-435e00024126
[0m18:05:59.307183 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:05:59.307183 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:05:59.308183 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:05:59.308183 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:05:59.402756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m18:05:59.405762 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:05:59.406756 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:05:59.406756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:59.833275 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:05:59.835274 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:05:59.923818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:05:59.928818 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:05:59.929818 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:05:59.929818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:00.249976 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:06:00.256987 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:06:00.339868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m18:06:00.343899 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:06:00.343899 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:06:00.344869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:00.653962 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:06:00.655963 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:06:00.742606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9150cd49-33d1-4c5e-a490-3a3aadaa4794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49DB2DB80>]}
[0m18:06:00.742606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:00.743619 [info ] [MainThread]: 
[0m18:06:00.747573 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:06:00.748574 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:06:00.749575 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:06:00.750577 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:06:00.758575 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:06:00.760575 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:06:00.750577 => 18:06:00.760575
[0m18:06:00.760575 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:06:00.793575 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:06:00.795608 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:06:00.796605 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_%,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_%
FROM transactions
        );
[0m18:06:00.796605 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:01.088822 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0094-0001-429a-0008-435e00025012
[0m18:06:01.089853 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 36 unexpected '%'.
[0m18:06:01.089853 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:06:00.761574 => 18:06:01.089853
[0m18:06:01.090853 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:06:01.173410 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 36 unexpected '%'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:06:01.173410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9150cd49-33d1-4c5e-a490-3a3aadaa4794', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49DEDE900>]}
[0m18:06:01.174411 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.42s]
[0m18:06:01.175380 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:06:01.177378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:01.178379 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:06:01.178379 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m18:06:01.178379 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:06:01.179410 [info ] [MainThread]: 
[0m18:06:01.180379 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m18:06:01.181383 [debug] [MainThread]: Command end result
[0m18:06:01.192378 [info ] [MainThread]: 
[0m18:06:01.193382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:01.194381 [info ] [MainThread]: 
[0m18:06:01.195381 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 36 unexpected '%'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:06:01.195381 [info ] [MainThread]: 
[0m18:06:01.196381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:06:01.198379 [debug] [MainThread]: Command `dbt run` failed at 18:06:01.197379 after 4.81 seconds
[0m18:06:01.199380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48FF839B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48FBF5AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48FE81CA0>]}
[0m18:06:01.199380 [debug] [MainThread]: Flushing usage events
[0m18:06:25.768312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A3A0AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A3B58AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A3C55280>]}


============================== 18:06:25.772318 | 3fb72412-8fce-425b-a7b4-25239d5b8ca6 ==============================
[0m18:06:25.772318 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:06:25.773355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:26.663665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fb72412-8fce-425b-a7b4-25239d5b8ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AEBEFC20>]}
[0m18:06:26.753974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fb72412-8fce-425b-a7b4-25239d5b8ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B006A3F0>]}
[0m18:06:26.754975 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:06:26.763976 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:06:26.883159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:26.884159 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:06:27.016776 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:06:27.021807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fb72412-8fce-425b-a7b4-25239d5b8ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B070C7D0>]}
[0m18:06:27.035782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fb72412-8fce-425b-a7b4-25239d5b8ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B0752750>]}
[0m18:06:27.036824 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:06:27.037785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb72412-8fce-425b-a7b4-25239d5b8ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A3CB8440>]}
[0m18:06:27.039815 [info ] [MainThread]: 
[0m18:06:27.040812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:27.041880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:06:27.055506 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:06:27.056510 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:06:27.056510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:28.411836 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:06:28.419834 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:06:28.520078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:06:28.552111 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:06:28.553109 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:06:28.554106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:29.028015 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:06:29.031009 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:06:29.129144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m18:06:29.139098 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:06:29.139098 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:06:29.140099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:29.532659 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:06:29.535696 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:06:29.622356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:06:29.628331 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:06:29.628331 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:06:29.629364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:29.944988 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:06:29.945979 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:06:30.033904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m18:06:30.036903 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:06:30.037906 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:06:30.037906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:30.560014 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0094-0001-429e-0008-435e000234a6
[0m18:06:30.560014 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:06:30.561015 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:06:30.561015 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:06:30.561015 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:06:30.642784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb72412-8fce-425b-a7b4-25239d5b8ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B09CE330>]}
[0m18:06:30.643750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:30.644752 [info ] [MainThread]: 
[0m18:06:30.648752 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:06:30.649753 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:06:30.650751 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:06:30.651753 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:06:30.659750 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:06:30.661752 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:06:30.651753 => 18:06:30.660753
[0m18:06:30.661752 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:06:30.694955 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:06:30.696954 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:06:30.697952 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
        );
[0m18:06:30.697952 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:31.704945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:06:31.728897 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:06:30.662784 => 18:06:31.728897
[0m18:06:31.729901 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:06:31.812301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb72412-8fce-425b-a7b4-25239d5b8ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253B0BD4530>]}
[0m18:06:31.813301 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 1.16s]
[0m18:06:31.816304 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:06:31.819340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:31.820340 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:06:31.820340 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m18:06:31.821341 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:06:31.822340 [info ] [MainThread]: 
[0m18:06:31.822340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.78 seconds (4.78s).
[0m18:06:31.824300 [debug] [MainThread]: Command end result
[0m18:06:31.855753 [info ] [MainThread]: 
[0m18:06:31.856753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:31.857752 [info ] [MainThread]: 
[0m18:06:31.858313 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:31.859352 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:31.859352 after 6.28 seconds
[0m18:06:31.860351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A3A0AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A3B50200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253A3B21880>]}
[0m18:06:31.860351 [debug] [MainThread]: Flushing usage events
[0m18:13:15.611116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B1057AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B10555B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B1057500>]}


============================== 18:13:15.627636 | fabd706c-d858-4864-aabc-bf0544f45089 ==============================
[0m18:13:15.627636 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:13:15.628637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m customers_rank', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:23.652572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fabd706c-d858-4864-aabc-bf0544f45089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BDA14B30>]}
[0m18:13:23.741220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fabd706c-d858-4864-aabc-bf0544f45089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BBBD3DD0>]}
[0m18:13:23.749223 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:13:23.767922 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:13:25.077840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:25.078840 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m18:13:25.209998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:13:25.215996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fabd706c-d858-4864-aabc-bf0544f45089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BDDFEF30>]}
[0m18:13:25.229999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fabd706c-d858-4864-aabc-bf0544f45089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BDB4F080>]}
[0m18:13:25.231003 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:13:25.232006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fabd706c-d858-4864-aabc-bf0544f45089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BDA7D250>]}
[0m18:13:25.235003 [info ] [MainThread]: 
[0m18:13:25.236036 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:25.236997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:13:25.250999 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:13:25.251996 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:13:25.251996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:26.475310 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:13:26.476312 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:13:26.564455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_SNOWFLAKE_PRAC_public'
[0m18:13:26.595168 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:13:26.596168 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:13:26.597168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:27.051375 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:13:27.058319 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:13:27.144638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:13:27.153637 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:13:27.154638 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:13:27.155638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:27.453901 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:13:27.457881 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:13:27.545141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m18:13:27.559115 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:13:27.560113 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:13:27.561114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:28.010530 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:13:28.013039 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:13:28.096843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m18:13:28.105852 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:13:28.105852 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:13:28.105852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:28.399595 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb009b-0001-429e-0008-435e000234de
[0m18:13:28.400592 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:13:28.400592 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:13:28.401560 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:13:28.401560 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:13:28.488037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fabd706c-d858-4864-aabc-bf0544f45089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BDDBCC20>]}
[0m18:13:28.489039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:28.490043 [info ] [MainThread]: 
[0m18:13:28.501089 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m18:13:28.502087 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m18:13:28.503929 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m18:13:28.504928 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m18:13:28.515431 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m18:13:28.516438 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 18:13:28.504928 => 18:13:28.516438
[0m18:13:28.517440 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m18:13:28.549439 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m18:13:28.551438 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m18:13:28.552469 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
WITH stg_customers AS (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.CUSTOMER_ID
GROUP BY c.CUSTOMER_ID,CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
)
SELECT 
    s.CUSTOMER_ID,
    s.CUSTOMERNAME,
    s.TOTAL_REVENUE,
    s.RANK,
    con.COUNTRY
FROM stg_customers s
JOIN RIDE_SHARING_DB.STAGING.stg_country con
on s.CUSTOMER_ID = con.CUSTOMER_ID
        );
[0m18:13:28.552469 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:30.359044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:13:30.380995 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 18:13:28.517440 => 18:13:30.380995
[0m18:13:30.381995 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m18:13:30.457990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabd706c-d858-4864-aabc-bf0544f45089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BE0A1AF0>]}
[0m18:13:30.459031 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.customers_rank ......................... [[32mSUCCESS 1[0m in 1.96s]
[0m18:13:30.460991 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m18:13:30.463017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:30.464019 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:13:30.464019 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m18:13:30.464019 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m18:13:30.464988 [info ] [MainThread]: 
[0m18:13:30.464988 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m18:13:30.466987 [debug] [MainThread]: Command end result
[0m18:13:30.479986 [info ] [MainThread]: 
[0m18:13:30.480987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:30.482023 [info ] [MainThread]: 
[0m18:13:30.483987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:13:30.485020 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:30.485020 after 14.96 seconds
[0m18:13:30.485020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239AE268AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B10555B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239B1057AD0>]}
[0m18:13:30.486018 [debug] [MainThread]: Flushing usage events
[0m18:17:46.141977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164CCE64890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164CCA12C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164CE057C20>]}


============================== 18:17:46.146010 | a46186d4-093b-40a9-8eea-c9181fd14318 ==============================
[0m18:17:46.146010 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:17:46.146847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m customers_rank', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:47.064764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a46186d4-093b-40a9-8eea-c9181fd14318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DA80E600>]}
[0m18:17:47.153341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a46186d4-093b-40a9-8eea-c9181fd14318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DA2FAE70>]}
[0m18:17:47.154341 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:17:47.162378 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:17:47.281445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:17:47.281445 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\customers_rank.sql
[0m18:17:47.413963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:17:47.420995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a46186d4-093b-40a9-8eea-c9181fd14318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DA9BC110>]}
[0m18:17:47.432845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a46186d4-093b-40a9-8eea-c9181fd14318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DAB4EF90>]}
[0m18:17:47.433844 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:17:47.434844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46186d4-093b-40a9-8eea-c9181fd14318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164D8648EC0>]}
[0m18:17:47.436842 [info ] [MainThread]: 
[0m18:17:47.437841 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:47.438875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:17:47.452872 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:17:47.453844 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:17:47.453844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:48.415589 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:17:48.417588 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:17:48.883901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m18:17:48.893903 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:17:48.894901 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:17:48.894901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:49.336711 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb009f-0001-429a-0008-435e0002506a
[0m18:17:49.336711 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:17:49.337710 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:17:49.337710 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:17:49.338710 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:17:49.421223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m18:17:49.424225 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:17:49.424225 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:17:49.425225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:49.753203 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:17:49.756189 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:17:49.841327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m18:17:49.845342 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:17:49.846341 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:17:49.846341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:50.139527 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:17:50.141528 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:17:50.229821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m18:17:50.240821 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:17:50.242783 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:17:50.243822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:50.567726 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:17:50.568713 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:17:50.659727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46186d4-093b-40a9-8eea-c9181fd14318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DA921D60>]}
[0m18:17:50.661750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:50.662663 [info ] [MainThread]: 
[0m18:17:50.671440 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m18:17:50.672479 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m18:17:50.675451 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m18:17:50.676451 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m18:17:50.693965 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m18:17:50.694964 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 18:17:50.676451 => 18:17:50.694964
[0m18:17:50.695966 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m18:17:50.728964 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m18:17:50.730964 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m18:17:50.731978 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
WITH stg_customers AS (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.CUSTOMER_ID
GROUP BY c.CUSTOMER_ID,CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
)
SELECT 
    s.CUSTOMER_ID,
    s.CUSTOMERNAME,
    con.COUNTRY,
    con.REGION,
    s.TOTAL_REVENUE,
    s.RANK
    
FROM stg_customers s
JOIN RIDE_SHARING_DB.STAGING.stg_country con
on s.CUSTOMER_ID = con.CUSTOMER_ID
        );
[0m18:17:50.731978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:51.651065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:17:51.673019 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 18:17:50.695966 => 18:17:51.673019
[0m18:17:51.674018 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m18:17:51.788994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46186d4-093b-40a9-8eea-c9181fd14318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164DB08A6C0>]}
[0m18:17:51.791985 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.customers_rank ......................... [[32mSUCCESS 1[0m in 1.11s]
[0m18:17:51.796581 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m18:17:51.806635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:51.807567 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:17:51.807567 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m18:17:51.808588 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m18:17:51.808588 [info ] [MainThread]: 
[0m18:17:51.809567 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m18:17:51.810569 [debug] [MainThread]: Command end result
[0m18:17:51.825569 [info ] [MainThread]: 
[0m18:17:51.826603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:51.827568 [info ] [MainThread]: 
[0m18:17:51.828568 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:17:51.829567 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:51.829567 after 5.75 seconds
[0m18:17:51.830567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164CCF21910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164CCCF7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164CCD79AF0>]}
[0m18:17:51.831571 [debug] [MainThread]: Flushing usage events
[0m18:22:44.352541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B6C44F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B8055340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B8055700>]}


============================== 18:22:44.365175 | a7e498ff-1390-4498-ab52-b18d974f4b28 ==============================
[0m18:22:44.365175 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:22:44.366189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m customers_rank', 'send_anonymous_usage_stats': 'True'}
[0m18:22:52.765788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7e498ff-1390-4498-ab52-b18d974f4b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B6B8D7F0>]}
[0m18:22:52.856842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7e498ff-1390-4498-ab52-b18d974f4b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C4148260>]}
[0m18:22:52.866310 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:22:52.885340 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:22:54.169884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:22:54.170897 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:22:54.305028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:22:54.311028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7e498ff-1390-4498-ab52-b18d974f4b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C4C5E720>]}
[0m18:22:54.335514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7e498ff-1390-4498-ab52-b18d974f4b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C4A4F020>]}
[0m18:22:54.336515 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:22:54.337513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7e498ff-1390-4498-ab52-b18d974f4b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C41F0980>]}
[0m18:22:54.339515 [info ] [MainThread]: 
[0m18:22:54.340514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:22:54.341514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:22:54.355552 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:22:54.356550 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:22:54.356550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:55.481666 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:22:55.482666 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:22:55.574214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m18:22:55.583215 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:22:55.584215 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:22:55.584215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:55.996959 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:22:55.998957 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:22:56.079540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m18:22:56.083540 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:22:56.083540 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:22:56.083540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:56.375649 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:22:56.376639 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:22:56.464838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m18:22:56.474471 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:22:56.474471 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:22:56.475471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:56.761733 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:22:56.764734 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:22:56.855012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m18:22:56.863970 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:22:56.864969 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:22:56.864969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:57.275640 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00a4-0001-429b-0008-435e0002418e
[0m18:22:57.276641 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:22:57.276641 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:22:57.276641 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:22:57.277640 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:22:57.353992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7e498ff-1390-4498-ab52-b18d974f4b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C4CC67E0>]}
[0m18:22:57.356027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:57.357988 [info ] [MainThread]: 
[0m18:22:57.367023 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m18:22:57.368641 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.customers_rank .............................. [RUN]
[0m18:22:57.370591 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.customers_rank'
[0m18:22:57.372591 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m18:22:57.392546 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m18:22:57.394547 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 18:22:57.373546 => 18:22:57.393544
[0m18:22:57.394547 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m18:22:57.426573 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.customers_rank"
[0m18:22:57.428573 [debug] [Thread-1 (]: Using snowflake connection "model.practice.customers_rank"
[0m18:22:57.428573 [debug] [Thread-1 (]: On model.practice.customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.customers_rank
         as
        (
WITH stg_customers AS (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.CUSTOMER_ID
GROUP BY c.CUSTOMER_ID,CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
)
SELECT 
    s.CUSTOMER_ID,
    s.CUSTOMERNAME,
    con.COUNTRY,
    con.REGION,
    s.TOTAL_REVENUE,
    s.RANK
    
FROM stg_customers s
JOIN RIDE_SHARING_DB.STAGING.stg_country con
on s.CUSTOMER_ID = con.CUSTOMER_ID
        );
[0m18:22:57.429573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:22:59.637928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:22:59.663884 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 18:22:57.394547 => 18:22:59.663884
[0m18:22:59.664916 [debug] [Thread-1 (]: On model.practice.customers_rank: Close
[0m18:22:59.752438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7e498ff-1390-4498-ab52-b18d974f4b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C4EFCEC0>]}
[0m18:22:59.753440 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.customers_rank ......................... [[32mSUCCESS 1[0m in 2.38s]
[0m18:22:59.755440 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m18:22:59.758440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:59.759441 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:22:59.759441 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m18:22:59.760440 [debug] [MainThread]: Connection 'model.practice.customers_rank' was properly closed.
[0m18:22:59.760440 [info ] [MainThread]: 
[0m18:22:59.762402 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m18:22:59.764407 [debug] [MainThread]: Command end result
[0m18:22:59.777398 [info ] [MainThread]: 
[0m18:22:59.778399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:22:59.779400 [info ] [MainThread]: 
[0m18:22:59.780400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:22:59.782402 [debug] [MainThread]: Command `dbt run` succeeded at 18:22:59.782402 after 15.52 seconds
[0m18:22:59.782402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C494E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B6C8CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B6EA91F0>]}
[0m18:22:59.783411 [debug] [MainThread]: Flushing usage events
[0m18:24:14.459530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275634226F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027563364890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756330AC00>]}


============================== 18:24:14.468577 | 0afc5e3a-ff0c-45e4-8b76-ec4528caf103 ==============================
[0m18:24:14.468577 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:24:14.469593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m customers_rank', 'send_anonymous_usage_stats': 'True'}
[0m18:24:14.892060 [error] [MainThread]: Encountered an error:

[0m18:24:15.093097 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 165, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\config\runtime.py", line 70, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\config\profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\config\profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\config\profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\config\profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\adapters\factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\adapters\factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 999, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\adapters\snowflake\__init__.py", line 2, in <module>
    from dbt.adapters.snowflake.connections import SnowflakeConnectionManager  # noqa
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\adapters\snowflake\connections.py", line 19, in <module>
    import snowflake.connector
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\__init__.py", line 19, in <module>
    from .connection import SnowflakeConnection
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\connection.py", line 34, in <module>
    from . import errors, proxy
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\errors.py", line 16, in <module>
    from .telemetry import TelemetryData, TelemetryField
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\telemetry.py", line 15, in <module>
    from .test_util import ENABLE_TELEMETRY_LOG, rt_plain_logger
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\test_util.py", line 12, in <module>
    from .compat import IS_LINUX
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\compat.py", line 19, in <module>
    from . import constants
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\constants.py", line 12, in <module>
    from .options import pyarrow as pa
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\options.py", line 134, in <module>
    pandas, pyarrow, installed_pandas = _import_or_missing_pandas_option()
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\snowflake\connector\options.py", line 77, in _import_or_missing_pandas_option
    pandas = importlib.import_module("pandas")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\__init__.py", line 39, in <module>
    from pandas.compat import (
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\compat\__init__.py", line 27, in <module>
    from pandas.compat.pyarrow import (
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\compat\pyarrow.py", line 8, in <module>
    import pyarrow as pa
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pyarrow\__init__.py", line 65, in <module>
    import pyarrow.lib as _lib
  File "<frozen importlib._bootstrap>", line 645, in parent
KeyboardInterrupt

[0m18:24:15.099097 [debug] [MainThread]: Command `dbt run` failed at 18:24:15.099097 after 0.71 seconds
[0m18:24:15.099097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027563219880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002756D9F0C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002755D588290>]}
[0m18:24:15.100097 [debug] [MainThread]: Flushing usage events
[0m18:24:22.142278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEFC12AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEFC65BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEFC65BEF0>]}


============================== 18:24:22.146279 | 53606f46-8384-463a-b73d-6c3f40b0a73f ==============================
[0m18:24:22.146279 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:24:22.147280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:23.977793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53606f46-8384-463a-b73d-6c3f40b0a73f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE880B7C80>]}
[0m18:24:24.065335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53606f46-8384-463a-b73d-6c3f40b0a73f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE88FD8470>]}
[0m18:24:24.066338 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:24:24.075427 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:24:24.241079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:24.242082 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:24:24.383661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:24:24.389666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53606f46-8384-463a-b73d-6c3f40b0a73f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE892044D0>]}
[0m18:24:24.403115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53606f46-8384-463a-b73d-6c3f40b0a73f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8903B2C0>]}
[0m18:24:24.404115 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:24:24.405118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53606f46-8384-463a-b73d-6c3f40b0a73f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE89240440>]}
[0m18:24:24.408113 [info ] [MainThread]: 
[0m18:24:24.409113 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:24.411116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:24:24.426143 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:24:24.427116 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:24:24.427116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:25.563337 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:24:25.566339 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:24:25.656856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m18:24:25.667857 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:24:25.668858 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:24:25.668858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:26.084165 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00a6-0001-429b-0008-435e0002419e
[0m18:24:26.085165 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:24:26.085165 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:24:26.086165 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:24:26.086165 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:24:26.179948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m18:24:26.182893 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:24:26.182893 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:24:26.183908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:26.605755 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:24:26.609321 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:24:26.701288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m18:24:26.714982 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:24:26.716982 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:24:26.717983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:27.055432 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:24:27.058427 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:24:27.148836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m18:24:27.166824 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:24:27.168811 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:24:27.169770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:27.496930 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:24:27.498965 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:24:27.585004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53606f46-8384-463a-b73d-6c3f40b0a73f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE890103B0>]}
[0m18:24:27.586005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:27.586005 [info ] [MainThread]: 
[0m18:24:27.593011 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:24:27.594036 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:24:27.595004 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:24:27.595004 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:24:27.605014 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:24:27.606011 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:24:27.596036 => 18:24:27.606011
[0m18:24:27.607016 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:24:27.639098 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:24:27.642097 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:24:27.642097 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
trans as(
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
)
SELECT 
    t.CUSTOMER_ID,
    c.COUNTRY_NAME,
    c.REGION,
    t,total_revenue,
    t.prev_total_revenue,
    t.expansion_revenue,
    t.contraction_revenue,
    t.net_revenue_retention_in_percentage,
    t.gross_revenue_retention_in_percentage
    from trans t
    JOIN RIDE_SHARING_DB.STAGING.stg_country c
    ON t.CUSTOMER_ID = c.CUSTOMER_ID
        );
[0m18:24:27.643096 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:28.007848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00a6-0001-429a-0008-435e000250b2
[0m18:24:28.007848 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 0 unexpected 'trans'.
syntax error line 31 at position 30 unexpected '+'.
[0m18:24:28.008847 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:24:27.607016 => 18:24:28.007848
[0m18:24:28.008847 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:24:28.109875 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 0 unexpected 'trans'.
  syntax error line 31 at position 30 unexpected '+'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:24:28.110916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53606f46-8384-463a-b73d-6c3f40b0a73f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE895F6840>]}
[0m18:24:28.112902 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.52s]
[0m18:24:28.114959 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:24:28.118989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:28.119991 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:24:28.120991 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m18:24:28.120991 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:24:28.121989 [info ] [MainThread]: 
[0m18:24:28.123032 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m18:24:28.125041 [debug] [MainThread]: Command end result
[0m18:24:28.138039 [info ] [MainThread]: 
[0m18:24:28.139040 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:24:28.140039 [info ] [MainThread]: 
[0m18:24:28.141040 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 0 unexpected 'trans'.
  syntax error line 31 at position 30 unexpected '+'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:24:28.141040 [info ] [MainThread]: 
[0m18:24:28.142071 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:24:28.143090 [debug] [MainThread]: Command `dbt run` failed at 18:24:28.143090 after 6.07 seconds
[0m18:24:28.144129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEFC63FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEFC559070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEFC12AC00>]}
[0m18:24:28.144129 [debug] [MainThread]: Flushing usage events
[0m18:24:39.823214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA30155400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA30157FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA30154380>]}


============================== 18:24:39.827246 | 06da9b76-05a5-4b80-bd7f-245de42f29bc ==============================
[0m18:24:39.827246 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:24:39.828246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:40.711943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06da9b76-05a5-4b80-bd7f-245de42f29bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA301557F0>]}
[0m18:24:40.800414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06da9b76-05a5-4b80-bd7f-245de42f29bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3C6C01D0>]}
[0m18:24:40.801414 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:24:40.810415 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:24:40.930552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:40.930552 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:24:41.061765 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:24:41.067783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06da9b76-05a5-4b80-bd7f-245de42f29bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3C9BCE00>]}
[0m18:24:41.080751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06da9b76-05a5-4b80-bd7f-245de42f29bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3CB4EF60>]}
[0m18:24:41.081751 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:24:41.082751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06da9b76-05a5-4b80-bd7f-245de42f29bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA2DEDDDC0>]}
[0m18:24:41.084750 [info ] [MainThread]: 
[0m18:24:41.085751 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:41.086750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:24:41.102785 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:24:41.102785 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:24:41.103751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:42.017946 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:24:42.019910 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:24:42.114333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:24:42.122332 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:24:42.123332 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:24:42.123332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:42.550394 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:24:42.556977 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:24:42.664225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m18:24:42.682222 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:24:42.683220 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:24:42.684219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:42.980735 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:24:42.982733 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:24:43.067264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:24:43.072299 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:24:43.072299 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:24:43.072299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:43.518648 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:24:43.521616 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:24:43.617718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m18:24:43.621739 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:24:43.621739 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:24:43.621739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:43.911564 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00a6-0001-429b-0008-435e000241b2
[0m18:24:43.911564 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:24:43.912564 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:24:43.912564 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:24:43.913567 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:24:44.004566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06da9b76-05a5-4b80-bd7f-245de42f29bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3CE07080>]}
[0m18:24:44.007565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:44.010567 [info ] [MainThread]: 
[0m18:24:44.018601 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:24:44.019598 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:24:44.021597 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:24:44.022594 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:24:44.033561 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:24:44.035557 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:24:44.022594 => 18:24:44.034590
[0m18:24:44.035557 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:24:44.068674 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:24:44.071674 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:24:44.072645 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
)
trans as(
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
)
SELECT 
    t.CUSTOMER_ID,
    c.COUNTRY_NAME,
    c.REGION,
    t.total_revenue,
    t.prev_total_revenue,
    t.expansion_revenue,
    t.contraction_revenue,
    t.net_revenue_retention_in_percentage,
    t.gross_revenue_retention_in_percentage
    from trans t
    JOIN RIDE_SHARING_DB.STAGING.stg_country c
    ON t.CUSTOMER_ID = c.CUSTOMER_ID
        );
[0m18:24:44.072645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:44.344401 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00a6-0001-429e-0008-435e0002353e
[0m18:24:44.345401 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 0 unexpected 'trans'.
syntax error line 31 at position 30 unexpected '+'.
[0m18:24:44.346401 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:24:44.036560 => 18:24:44.346401
[0m18:24:44.347368 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:24:44.443928 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 0 unexpected 'trans'.
  syntax error line 31 at position 30 unexpected '+'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:24:44.445918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06da9b76-05a5-4b80-bd7f-245de42f29bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA3D0D00B0>]}
[0m18:24:44.446899 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.42s]
[0m18:24:44.448870 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:24:44.453962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:44.454960 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:24:44.454960 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m18:24:44.455960 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:24:44.455960 [info ] [MainThread]: 
[0m18:24:44.457959 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m18:24:44.459959 [debug] [MainThread]: Command end result
[0m18:24:44.478149 [info ] [MainThread]: 
[0m18:24:44.479137 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:24:44.480173 [info ] [MainThread]: 
[0m18:24:44.482142 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 0 unexpected 'trans'.
  syntax error line 31 at position 30 unexpected '+'.
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:24:44.483136 [info ] [MainThread]: 
[0m18:24:44.484139 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:24:44.486171 [debug] [MainThread]: Command `dbt run` failed at 18:24:44.485136 after 4.72 seconds
[0m18:24:44.486171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA30081D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA30001E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA30155400>]}
[0m18:24:44.487135 [debug] [MainThread]: Flushing usage events
[0m18:24:57.478167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C46DAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6059490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6059580>]}


============================== 18:24:57.482167 | 537e53bd-cfd2-4327-af3f-08729e283811 ==============================
[0m18:24:57.482167 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:24:57.483169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:58.378057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537e53bd-cfd2-4327-af3f-08729e283811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D2820A40>]}
[0m18:24:58.468178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '537e53bd-cfd2-4327-af3f-08729e283811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C60844A0>]}
[0m18:24:58.469182 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:24:58.477178 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:24:58.590140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:58.591140 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:24:58.726224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:24:58.731193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537e53bd-cfd2-4327-af3f-08729e283811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D2A11460>]}
[0m18:24:58.745458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537e53bd-cfd2-4327-af3f-08729e283811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D2A4EF60>]}
[0m18:24:58.745458 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:24:58.746458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537e53bd-cfd2-4327-af3f-08729e283811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D26C29C0>]}
[0m18:24:58.748492 [info ] [MainThread]: 
[0m18:24:58.749459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:58.751253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:24:58.764261 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:24:58.765263 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:24:58.765263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:59.660573 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:24:59.663575 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:24:59.744884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:24:59.753396 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:24:59.754394 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:24:59.754394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:00.173227 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:25:00.175227 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:25:00.254805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m18:25:00.259805 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:25:00.259805 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:25:00.259805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:00.549246 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00a7-0001-429a-0008-435e000250ba
[0m18:25:00.549246 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:25:00.550247 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:25:00.550247 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:25:00.551246 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:25:00.633246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m18:25:00.636253 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:25:00.636253 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:25:00.637253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:01.048605 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:25:01.050650 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:25:01.129783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:25:01.134789 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:25:01.134789 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:25:01.134789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:01.435855 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:25:01.439854 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:25:01.538723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537e53bd-cfd2-4327-af3f-08729e283811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D2C2C0E0>]}
[0m18:25:01.539726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:01.540686 [info ] [MainThread]: 
[0m18:25:01.544748 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:25:01.545747 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:25:01.546748 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:25:01.546748 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:25:01.556791 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:25:01.557748 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:25:01.547749 => 18:25:01.557748
[0m18:25:01.558747 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:25:01.589323 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:25:01.592323 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:25:01.592323 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
),
trans as(
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
)
SELECT 
    t.CUSTOMER_ID,
    c.COUNTRY_NAME,
    c.REGION,
    t.total_revenue,
    t.prev_total_revenue,
    t.expansion_revenue,
    t.contraction_revenue,
    t.net_revenue_retention_in_percentage,
    t.gross_revenue_retention_in_percentage
    from trans t
    JOIN RIDE_SHARING_DB.STAGING.stg_country c
    ON t.CUSTOMER_ID = c.CUSTOMER_ID
        );
[0m18:25:01.593325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:01.953161 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00a7-0001-429a-0008-435e000250c2
[0m18:25:01.955164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 41 at position 4
invalid identifier 'C.COUNTRY_NAME'
[0m18:25:01.956164 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:25:01.559286 => 18:25:01.955164
[0m18:25:01.957164 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:25:02.044797 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 41 at position 4
  invalid identifier 'C.COUNTRY_NAME'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:25:02.044797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537e53bd-cfd2-4327-af3f-08729e283811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D2CD5820>]}
[0m18:25:02.045799 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model MARTS.mart_nrr_grr ....................... [[31mERROR[0m in 0.50s]
[0m18:25:02.046776 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:25:02.049945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:02.049945 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:25:02.049945 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m18:25:02.050945 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:25:02.050945 [info ] [MainThread]: 
[0m18:25:02.051976 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m18:25:02.052984 [debug] [MainThread]: Command end result
[0m18:25:02.063558 [info ] [MainThread]: 
[0m18:25:02.064561 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:02.065560 [info ] [MainThread]: 
[0m18:25:02.066559 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\marts\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 41 at position 4
  invalid identifier 'C.COUNTRY_NAME'
  compiled Code at target\run\practice\models\marts\mart_nrr_grr.sql
[0m18:25:02.066559 [info ] [MainThread]: 
[0m18:25:02.067555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:25:02.069561 [debug] [MainThread]: Command `dbt run` failed at 18:25:02.069561 after 4.65 seconds
[0m18:25:02.069561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D26C29C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D29DB740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C60B85F0>]}
[0m18:25:02.070559 [debug] [MainThread]: Flushing usage events
[0m18:25:12.394014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52BFF4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52D3555B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52D354530>]}


============================== 18:25:12.398556 | 349e5d99-2a6d-469f-ab4f-b8bfd44b62cc ==============================
[0m18:25:12.398556 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:25:12.399525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m18:25:13.280766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '349e5d99-2a6d-469f-ab4f-b8bfd44b62cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53916CB00>]}
[0m18:25:13.368353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '349e5d99-2a6d-469f-ab4f-b8bfd44b62cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F539A83DD0>]}
[0m18:25:13.370350 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:25:13.379352 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:25:13.498527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:25:13.498527 [debug] [MainThread]: Partial parsing: updated file: practice://models\marts\mart_nrr_grr.sql
[0m18:25:13.633045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:25:13.639080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '349e5d99-2a6d-469f-ab4f-b8bfd44b62cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F539D4F710>]}
[0m18:25:13.653047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '349e5d99-2a6d-469f-ab4f-b8bfd44b62cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F539E37170>]}
[0m18:25:13.654080 [info ] [MainThread]: Found 13 models, 1 seed, 8 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:25:13.654080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '349e5d99-2a6d-469f-ab4f-b8bfd44b62cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52D388EC0>]}
[0m18:25:13.656047 [info ] [MainThread]: 
[0m18:25:13.657050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:25:13.658047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:25:13.672078 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:25:13.673047 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:25:13.673047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:14.500727 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:25:14.502726 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:25:14.587110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m18:25:14.600636 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:25:14.601636 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:25:14.601636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:15.354309 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00a7-0001-429e-0008-435e0002354a
[0m18:25:15.355311 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:25:15.356311 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:25:15.357310 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:25:15.358310 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:25:15.446110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_STAGING)
[0m18:25:15.449142 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:25:15.450112 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:25:15.450112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:16.059206 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:25:16.064164 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:25:16.150878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m18:25:16.155882 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:25:16.155882 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:25:16.156877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:16.473915 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:25:16.476911 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:25:16.566152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_MARTS)
[0m18:25:16.573152 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:25:16.573152 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:25:16.574153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:17.034019 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:25:17.035020 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:25:17.124634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '349e5d99-2a6d-469f-ab4f-b8bfd44b62cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53A23B5C0>]}
[0m18:25:17.125622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:17.126589 [info ] [MainThread]: 
[0m18:25:17.130589 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:25:17.130589 [info ] [Thread-1 (]: 1 of 1 START sql table model MARTS.mart_nrr_grr ................................ [RUN]
[0m18:25:17.132622 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.mart_nrr_grr'
[0m18:25:17.132622 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:25:17.140588 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:25:17.142590 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:25:17.132622 => 18:25:17.141589
[0m18:25:17.142590 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:25:17.174590 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:25:17.177620 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:25:17.177620 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
),
trans as(
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
)
SELECT 
    t.CUSTOMER_ID,
    c.COUNTRY,
    c.REGION,
    t.total_revenue,
    t.prev_total_revenue,
    t.expansion_revenue,
    t.contraction_revenue,
    t.net_revenue_retention_in_percentage,
    t.gross_revenue_retention_in_percentage
    from trans t
    JOIN RIDE_SHARING_DB.STAGING.stg_country c
    ON t.CUSTOMER_ID = c.CUSTOMER_ID
        );
[0m18:25:17.178589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:19.211643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:25:19.258290 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:25:17.143590 => 18:25:19.258290
[0m18:25:19.258290 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:25:19.342120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349e5d99-2a6d-469f-ab4f-b8bfd44b62cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53A37B2F0>]}
[0m18:25:19.343120 [info ] [Thread-1 (]: 1 of 1 OK created sql table model MARTS.mart_nrr_grr ........................... [[32mSUCCESS 1[0m in 2.21s]
[0m18:25:19.345077 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:25:19.349080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:19.349080 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB' was properly closed.
[0m18:25:19.350081 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MARTS' was properly closed.
[0m18:25:19.351081 [debug] [MainThread]: Connection 'model.practice.mart_nrr_grr' was properly closed.
[0m18:25:19.352081 [info ] [MainThread]: 
[0m18:25:19.353074 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m18:25:19.355108 [debug] [MainThread]: Command end result
[0m18:25:19.367096 [info ] [MainThread]: 
[0m18:25:19.368100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:19.369076 [info ] [MainThread]: 
[0m18:25:19.370076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:25:19.371104 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:19.371104 after 7.04 seconds
[0m18:25:19.371104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52D203620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52D10AEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F539C236B0>]}
[0m18:25:19.372100 [debug] [MainThread]: Flushing usage events
[0m18:35:16.498261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AF355220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AF354FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AF3555B0>]}


============================== 18:35:16.508249 | 773bb81a-3a80-4756-9655-19e4e3e04789 ==============================
[0m18:35:16.508249 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:35:16.509249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test -m revenue_test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:19.128318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '773bb81a-3a80-4756-9655-19e4e3e04789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BB454B00>]}
[0m18:35:19.220803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '773bb81a-3a80-4756-9655-19e4e3e04789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BB625C10>]}
[0m18:35:19.221803 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:35:19.596909 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:35:19.829961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:35:19.831467 [debug] [MainThread]: Partial parsing: added file: practice://tests\revenue_test.sql
[0m18:35:19.939067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:35:19.945096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '773bb81a-3a80-4756-9655-19e4e3e04789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BC0EC770>]}
[0m18:35:19.961066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '773bb81a-3a80-4756-9655-19e4e3e04789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BC060350>]}
[0m18:35:19.961066 [info ] [MainThread]: Found 13 models, 1 seed, 9 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:35:19.963066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773bb81a-3a80-4756-9655-19e4e3e04789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BC02DF10>]}
[0m18:35:19.965065 [info ] [MainThread]: 
[0m18:35:19.967064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:35:19.969097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:35:19.986096 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:35:19.987096 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:35:19.987096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:21.207475 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:35:21.210472 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:35:21.298997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m18:35:21.306001 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:35:21.306001 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:35:21.306998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:21.774224 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:35:21.778222 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:35:21.863435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:35:21.868435 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:35:21.868435 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:35:21.869465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:22.165343 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:35:22.167343 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:35:22.268659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m18:35:22.283588 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:35:22.285595 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:35:22.286595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:22.632887 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b1-0001-429e-0008-435e00023562
[0m18:35:22.633888 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:35:22.634886 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:35:22.635886 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:35:22.636397 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:35:22.722629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '773bb81a-3a80-4756-9655-19e4e3e04789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206AF388E00>]}
[0m18:35:22.724631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:22.725631 [info ] [MainThread]: 
[0m18:35:22.760448 [debug] [Thread-1 (]: Began running node test.practice.revenue_test
[0m18:35:22.760448 [info ] [Thread-1 (]: 1 of 1 START test revenue_test ................................................. [RUN]
[0m18:35:22.762486 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.revenue_test'
[0m18:35:22.762486 [debug] [Thread-1 (]: Began compiling node test.practice.revenue_test
[0m18:35:22.773481 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.revenue_test"
[0m18:35:22.775454 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (compile): 18:35:22.762486 => 18:35:22.774493
[0m18:35:22.775454 [debug] [Thread-1 (]: Began executing node test.practice.revenue_test
[0m18:35:22.801485 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.revenue_test"
[0m18:35:22.803463 [debug] [Thread-1 (]: Using snowflake connection "test.practice.revenue_test"
[0m18:35:22.803463 [debug] [Thread-1 (]: On test.practice.revenue_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.revenue_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    sum(revenue) as total_amount
from RIDE_SHARING_DB.STAGING.stg_transaction
group by 1
having total_amount < 0
      
    ) dbt_internal_test
[0m18:35:22.804486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:23.280004 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b1-0001-429a-0008-435e000250ce
[0m18:35:23.280999 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TOTAL_AMOUNT] is not a valid group by expression
[0m18:35:23.280999 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (execute): 18:35:22.775454 => 18:35:23.280999
[0m18:35:23.282031 [debug] [Thread-1 (]: On test.practice.revenue_test: Close
[0m18:35:23.380771 [debug] [Thread-1 (]: Database Error in test revenue_test (tests\revenue_test.sql)
  000979 (42601): SQL compilation error:
  [TOTAL_AMOUNT] is not a valid group by expression
  compiled Code at target\run\practice\tests\revenue_test.sql
[0m18:35:23.382759 [error] [Thread-1 (]: 1 of 1 ERROR revenue_test ...................................................... [[31mERROR[0m in 0.62s]
[0m18:35:23.384800 [debug] [Thread-1 (]: Finished running node test.practice.revenue_test
[0m18:35:23.389796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:23.390797 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m18:35:23.391797 [debug] [MainThread]: Connection 'test.practice.revenue_test' was properly closed.
[0m18:35:23.391797 [info ] [MainThread]: 
[0m18:35:23.392797 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m18:35:23.393796 [debug] [MainThread]: Command end result
[0m18:35:23.405786 [info ] [MainThread]: 
[0m18:35:23.406755 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:23.406755 [info ] [MainThread]: 
[0m18:35:23.407642 [error] [MainThread]:   Database Error in test revenue_test (tests\revenue_test.sql)
  000979 (42601): SQL compilation error:
  [TOTAL_AMOUNT] is not a valid group by expression
  compiled Code at target\run\practice\tests\revenue_test.sql
[0m18:35:23.408258 [info ] [MainThread]: 
[0m18:35:23.409266 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:35:23.410264 [debug] [MainThread]: Command `dbt test` failed at 18:35:23.410264 after 6.99 seconds
[0m18:35:23.411264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206A6E15AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BBC83DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206BBC83B00>]}
[0m18:35:23.411264 [debug] [MainThread]: Flushing usage events
[0m18:36:59.138285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ED6D5AC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ED6E551C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ED6E55310>]}


============================== 18:36:59.150322 | 8e4f2317-7ad2-4911-9f60-4766bcdc7073 ==============================
[0m18:36:59.150322 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:36:59.151323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test -m revenue_test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:37:06.369695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e4f2317-7ad2-4911-9f60-4766bcdc7073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010EE484FE90>]}
[0m18:37:06.460816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e4f2317-7ad2-4911-9f60-4766bcdc7073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010EE4443920>]}
[0m18:37:06.468816 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:37:06.485823 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:37:07.784474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:37:07.785476 [debug] [MainThread]: Partial parsing: updated file: practice://tests\revenue_test.sql
[0m18:37:07.886028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:37:07.892056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e4f2317-7ad2-4911-9f60-4766bcdc7073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010EE481AED0>]}
[0m18:37:07.921651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e4f2317-7ad2-4911-9f60-4766bcdc7073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010EE4B5C530>]}
[0m18:37:07.921651 [info ] [MainThread]: Found 13 models, 1 seed, 9 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:37:07.922653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4f2317-7ad2-4911-9f60-4766bcdc7073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ED6E8A690>]}
[0m18:37:07.924650 [info ] [MainThread]: 
[0m18:37:07.925650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:07.927649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:37:07.942650 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:37:07.943650 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:37:07.943650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:09.329540 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:37:09.331539 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:37:09.414928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m18:37:09.420928 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:37:09.420928 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:37:09.420928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:09.988483 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b3-0001-429b-0008-435e000241c6
[0m18:37:09.988483 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:37:09.989482 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:37:09.989482 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:37:09.989482 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:37:10.075144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m18:37:10.078146 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:37:10.079147 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:37:10.079147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:10.374902 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:37:10.375901 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:37:10.462792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:37:10.465766 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:37:10.465766 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:37:10.465766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:10.766740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:37:10.770732 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:37:10.857301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4f2317-7ad2-4911-9f60-4766bcdc7073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010EE47BCEC0>]}
[0m18:37:10.858299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:10.859298 [info ] [MainThread]: 
[0m18:37:10.863303 [debug] [Thread-1 (]: Began running node test.practice.revenue_test
[0m18:37:10.864315 [info ] [Thread-1 (]: 1 of 1 START test revenue_test ................................................. [RUN]
[0m18:37:10.865301 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.revenue_test'
[0m18:37:10.866303 [debug] [Thread-1 (]: Began compiling node test.practice.revenue_test
[0m18:37:10.873301 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.revenue_test"
[0m18:37:10.875302 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (compile): 18:37:10.866303 => 18:37:10.874301
[0m18:37:10.875302 [debug] [Thread-1 (]: Began executing node test.practice.revenue_test
[0m18:37:10.899311 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.revenue_test"
[0m18:37:10.901825 [debug] [Thread-1 (]: Using snowflake connection "test.practice.revenue_test"
[0m18:37:10.902826 [debug] [Thread-1 (]: On test.practice.revenue_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.revenue_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    sum(revenue) as total_amount
from RIDE_SHARING_DB.STAGING.stg_transaction
      
    ) dbt_internal_test
[0m18:37:10.902826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:12.089889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:12.112518 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (execute): 18:37:10.875302 => 18:37:12.112518
[0m18:37:12.113563 [debug] [Thread-1 (]: On test.practice.revenue_test: Close
[0m18:37:12.203918 [error] [Thread-1 (]: 1 of 1 FAIL 1 revenue_test ..................................................... [[31mFAIL 1[0m in 1.34s]
[0m18:37:12.206918 [debug] [Thread-1 (]: Finished running node test.practice.revenue_test
[0m18:37:12.209918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:12.211468 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m18:37:12.211468 [debug] [MainThread]: Connection 'test.practice.revenue_test' was properly closed.
[0m18:37:12.212484 [info ] [MainThread]: 
[0m18:37:12.213518 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m18:37:12.215477 [debug] [MainThread]: Command end result
[0m18:37:12.225477 [info ] [MainThread]: 
[0m18:37:12.226477 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:37:12.227493 [info ] [MainThread]: 
[0m18:37:12.228526 [error] [MainThread]: [31mFailure in test revenue_test (tests\revenue_test.sql)[0m
[0m18:37:12.229478 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:37:12.230478 [info ] [MainThread]: 
[0m18:37:12.230478 [info ] [MainThread]:   compiled Code at target\compiled\practice\tests\revenue_test.sql
[0m18:37:12.232483 [info ] [MainThread]: 
[0m18:37:12.233481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:37:12.235478 [debug] [MainThread]: Command `dbt test` failed at 18:37:12.234491 after 13.18 seconds
[0m18:37:12.235478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ED6D50680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ED6ACB5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010EE26E76E0>]}
[0m18:37:12.235478 [debug] [MainThread]: Flushing usage events
[0m18:37:48.777327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002712F254230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002712F2543B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002712F255370>]}


============================== 18:37:48.781358 | 524b20d6-6241-4a0c-8af2-a3a9302dde3f ==============================
[0m18:37:48.781358 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:37:48.782367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test -m revenue_test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:37:49.709741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '524b20d6-6241-4a0c-8af2-a3a9302dde3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713BC4BA10>]}
[0m18:37:49.804397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '524b20d6-6241-4a0c-8af2-a3a9302dde3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002712F3C5EE0>]}
[0m18:37:49.805396 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:37:49.815365 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:37:49.938945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:37:49.938945 [debug] [MainThread]: Partial parsing: updated file: practice://tests\revenue_test.sql
[0m18:37:50.043565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:37:50.049565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '524b20d6-6241-4a0c-8af2-a3a9302dde3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713BEF4A40>]}
[0m18:37:50.061107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '524b20d6-6241-4a0c-8af2-a3a9302dde3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713BF58230>]}
[0m18:37:50.062076 [info ] [MainThread]: Found 13 models, 1 seed, 9 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:37:50.064078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524b20d6-6241-4a0c-8af2-a3a9302dde3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713B480CB0>]}
[0m18:37:50.065108 [info ] [MainThread]: 
[0m18:37:50.067107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:50.069106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MART'
[0m18:37:50.084076 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:37:50.085076 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:37:50.085076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:50.972195 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b3-0001-429a-0008-435e000250da
[0m18:37:50.973220 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:37:50.973220 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:37:50.974222 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:37:50.974222 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:37:51.059885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_RIDE_SHARING_DB_MARTS)
[0m18:37:51.065411 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:37:51.065411 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:37:51.066407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:51.374966 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:37:51.377966 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:37:51.459615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_STAGING)
[0m18:37:51.463614 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:37:51.465121 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:37:51.465121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:51.748970 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:37:51.751054 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:37:51.835605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_SNOWFLAKE_PRAC_public)
[0m18:37:51.842609 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:37:51.842609 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:37:51.843609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:52.280967 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:37:52.287962 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:37:52.388154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524b20d6-6241-4a0c-8af2-a3a9302dde3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713BF58530>]}
[0m18:37:52.389155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:52.389465 [info ] [MainThread]: 
[0m18:37:52.392475 [debug] [Thread-1 (]: Began running node test.practice.revenue_test
[0m18:37:52.393471 [info ] [Thread-1 (]: 1 of 1 START test revenue_test ................................................. [RUN]
[0m18:37:52.394471 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.revenue_test'
[0m18:37:52.394471 [debug] [Thread-1 (]: Began compiling node test.practice.revenue_test
[0m18:37:52.402503 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.revenue_test"
[0m18:37:52.403471 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (compile): 18:37:52.395472 => 18:37:52.403471
[0m18:37:52.403471 [debug] [Thread-1 (]: Began executing node test.practice.revenue_test
[0m18:37:52.427472 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.revenue_test"
[0m18:37:52.428471 [debug] [Thread-1 (]: Using snowflake connection "test.practice.revenue_test"
[0m18:37:52.429475 [debug] [Thread-1 (]: On test.practice.revenue_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.revenue_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    sum(revenue) as total_amount
from RIDE_SHARING_DB.STAGING.stg_transaction
WHERE total_amount<0
      
    ) dbt_internal_test
[0m18:37:52.429475 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:52.779719 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b3-0001-429b-0008-435e000241d6
[0m18:37:52.780741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000990 (42601): SQL compilation error: error line 9 at position 6
aggregate function alias 'TOTAL_AMOUNT' cannot be used in the WHERE clause
[0m18:37:52.780741 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (execute): 18:37:52.404504 => 18:37:52.780741
[0m18:37:52.781742 [debug] [Thread-1 (]: On test.practice.revenue_test: Close
[0m18:37:52.865758 [debug] [Thread-1 (]: Database Error in test revenue_test (tests\revenue_test.sql)
  000990 (42601): SQL compilation error: error line 9 at position 6
  aggregate function alias 'TOTAL_AMOUNT' cannot be used in the WHERE clause
  compiled Code at target\run\practice\tests\revenue_test.sql
[0m18:37:52.867297 [error] [Thread-1 (]: 1 of 1 ERROR revenue_test ...................................................... [[31mERROR[0m in 0.47s]
[0m18:37:52.867297 [debug] [Thread-1 (]: Finished running node test.practice.revenue_test
[0m18:37:52.870303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:52.870303 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m18:37:52.871303 [debug] [MainThread]: Connection 'test.practice.revenue_test' was properly closed.
[0m18:37:52.871303 [info ] [MainThread]: 
[0m18:37:52.872204 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m18:37:52.873211 [debug] [MainThread]: Command end result
[0m18:37:52.883212 [info ] [MainThread]: 
[0m18:37:52.884213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:37:52.884213 [info ] [MainThread]: 
[0m18:37:52.885211 [error] [MainThread]:   Database Error in test revenue_test (tests\revenue_test.sql)
  000990 (42601): SQL compilation error: error line 9 at position 6
  aggregate function alias 'TOTAL_AMOUNT' cannot be used in the WHERE clause
  compiled Code at target\run\practice\tests\revenue_test.sql
[0m18:37:52.886214 [info ] [MainThread]: 
[0m18:37:52.886214 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:37:52.889223 [debug] [MainThread]: Command `dbt test` failed at 18:37:52.888225 after 4.17 seconds
[0m18:37:52.889223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002712DF78680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002712F150590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002712F159A30>]}
[0m18:37:52.890212 [debug] [MainThread]: Flushing usage events
[0m18:38:26.378604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5CB56420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5CB561E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5CB54320>]}


============================== 18:38:26.382611 | 78a3b52f-5ec0-455b-b05a-26a02c56016b ==============================
[0m18:38:26.382611 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:38:26.383643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m revenue_test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:27.259146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78a3b52f-5ec0-455b-b05a-26a02c56016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5CB54E00>]}
[0m18:38:27.346634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78a3b52f-5ec0-455b-b05a-26a02c56016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C67AF4110>]}
[0m18:38:27.347634 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:38:27.355555 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:38:27.472452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:27.472452 [debug] [MainThread]: Partial parsing: updated file: practice://tests\revenue_test.sql
[0m18:38:27.571064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.staging
- models.data_pipeline.marts
[0m18:38:27.577095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78a3b52f-5ec0-455b-b05a-26a02c56016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6975D220>]}
[0m18:38:27.590065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78a3b52f-5ec0-455b-b05a-26a02c56016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6973EF00>]}
[0m18:38:27.590065 [info ] [MainThread]: Found 13 models, 1 seed, 9 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:38:27.591065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78a3b52f-5ec0-455b-b05a-26a02c56016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C6972DF10>]}
[0m18:38:27.593067 [info ] [MainThread]: 
[0m18:38:27.594067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:27.596065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:38:27.612095 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:38:27.613066 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:38:27.614079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:28.637992 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:38:28.640029 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:38:28.736818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_SNOWFLAKE_PRAC_public)
[0m18:38:28.758839 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:38:28.760841 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:38:28.761840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:29.072621 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:38:29.076664 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:38:29.168039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:38:29.173586 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:38:29.173586 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:38:29.174602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:29.480143 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:38:29.481141 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:38:29.574375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MART)
[0m18:38:29.588323 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:38:29.590330 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:38:29.591329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:30.089282 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b4-0001-429e-0008-435e0002356a
[0m18:38:30.089282 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:38:30.090282 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:38:30.090282 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:38:30.090282 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:38:30.185639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78a3b52f-5ec0-455b-b05a-26a02c56016b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C697AD9D0>]}
[0m18:38:30.189696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:30.190885 [info ] [MainThread]: 
[0m18:38:30.194915 [debug] [Thread-1 (]: Began running node test.practice.revenue_test
[0m18:38:30.194915 [info ] [Thread-1 (]: 1 of 1 START test revenue_test ................................................. [RUN]
[0m18:38:30.195914 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.practice.revenue_test'
[0m18:38:30.196949 [debug] [Thread-1 (]: Began compiling node test.practice.revenue_test
[0m18:38:30.203951 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.revenue_test"
[0m18:38:30.205917 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (compile): 18:38:30.196949 => 18:38:30.205917
[0m18:38:30.206917 [debug] [Thread-1 (]: Began executing node test.practice.revenue_test
[0m18:38:30.230948 [debug] [Thread-1 (]: Writing runtime sql for node "test.practice.revenue_test"
[0m18:38:30.231953 [debug] [Thread-1 (]: Using snowflake connection "test.practice.revenue_test"
[0m18:38:30.232917 [debug] [Thread-1 (]: On test.practice.revenue_test: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "test.practice.revenue_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
    *
from RIDE_SHARING_DB.STAGING.stg_transaction
WHERE REVENUE<0
      
    ) dbt_internal_test
[0m18:38:30.232917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:30.617393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:38:30.624389 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (execute): 18:38:30.206917 => 18:38:30.623389
[0m18:38:30.624389 [debug] [Thread-1 (]: On test.practice.revenue_test: Close
[0m18:38:30.709219 [error] [Thread-1 (]: 1 of 1 FAIL 74 revenue_test .................................................... [[31mFAIL 74[0m in 0.51s]
[0m18:38:30.713171 [debug] [Thread-1 (]: Finished running node test.practice.revenue_test
[0m18:38:30.720206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:30.721206 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_MART' was properly closed.
[0m18:38:30.722217 [debug] [MainThread]: Connection 'test.practice.revenue_test' was properly closed.
[0m18:38:30.724220 [info ] [MainThread]: 
[0m18:38:30.726161 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m18:38:30.729154 [debug] [MainThread]: Command end result
[0m18:38:30.749152 [info ] [MainThread]: 
[0m18:38:30.750152 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:38:30.751183 [info ] [MainThread]: 
[0m18:38:30.752182 [error] [MainThread]: [31mFailure in test revenue_test (tests\revenue_test.sql)[0m
[0m18:38:30.753184 [error] [MainThread]:   Got 74 results, configured to fail if != 0
[0m18:38:30.754150 [info ] [MainThread]: 
[0m18:38:30.754150 [info ] [MainThread]:   compiled Code at target\compiled\practice\tests\revenue_test.sql
[0m18:38:30.755150 [info ] [MainThread]: 
[0m18:38:30.756152 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:38:30.758185 [debug] [MainThread]: Command `dbt test` failed at 18:38:30.758185 after 4.44 seconds
[0m18:38:30.759182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C569D5AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5CA81910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5C7F7FB0>]}
[0m18:38:30.759182 [debug] [MainThread]: Flushing usage events
[0m18:38:56.241488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394DEB52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394DEB4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394DEB55B0>]}


============================== 18:38:56.245488 | deece265-5c54-4cbb-8277-e2fff48794de ==============================
[0m18:38:56.245488 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:38:56.246476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:38:57.127653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deece265-5c54-4cbb-8277-e2fff48794de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023959EF07A0>]}
[0m18:38:57.217172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deece265-5c54-4cbb-8277-e2fff48794de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395938AF00>]}
[0m18:38:57.218172 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:38:57.226781 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:38:57.332398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:57.333398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:57.334396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:38:57.340396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deece265-5c54-4cbb-8277-e2fff48794de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395B7212E0>]}
[0m18:38:57.344397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deece265-5c54-4cbb-8277-e2fff48794de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395B953110>]}
[0m18:38:57.344397 [info ] [MainThread]: Found 13 models, 1 seed, 9 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:38:57.345401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deece265-5c54-4cbb-8277-e2fff48794de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395B819EB0>]}
[0m18:38:57.348365 [info ] [MainThread]: 
[0m18:38:57.349366 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:57.351397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_MARTS'
[0m18:38:57.367399 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:38:57.367399 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:38:57.367399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:58.339890 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:38:58.343891 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:38:58.427955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m18:38:58.432957 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:38:58.433959 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:38:58.433959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:58.843537 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b4-0001-429b-0008-435e000241ea
[0m18:38:58.843537 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:38:58.844537 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:38:58.844537 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:38:58.845538 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:38:58.932559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m18:38:58.939060 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:38:58.941062 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:38:58.942062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:59.395130 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:38:59.398656 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:38:59.489984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_SNOWFLAKE_PRAC_public, now list_RIDE_SHARING_DB_STAGING)
[0m18:38:59.499633 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:38:59.500668 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:38:59.500668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:59.819113 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:38:59.826106 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:38:59.925740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deece265-5c54-4cbb-8277-e2fff48794de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395B953530>]}
[0m18:38:59.926750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:59.927651 [info ] [MainThread]: 
[0m18:38:59.931658 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m18:38:59.932656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m18:38:59.933665 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m18:38:59.941688 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m18:38:59.944897 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 18:38:59.933665 => 18:38:59.943880
[0m18:38:59.944897 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m18:38:59.945887 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 18:38:59.944897 => 18:38:59.945887
[0m18:38:59.946890 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m18:38:59.947889 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m18:38:59.948888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m18:38:59.949886 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m18:38:59.952890 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m18:38:59.954887 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 18:38:59.949886 => 18:38:59.953886
[0m18:38:59.954887 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m18:38:59.956392 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 18:38:59.954887 => 18:38:59.954887
[0m18:38:59.956906 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m18:38:59.957917 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m18:38:59.958912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m18:38:59.958912 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m18:38:59.962924 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m18:38:59.964918 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 18:38:59.958912 => 18:38:59.964918
[0m18:38:59.965918 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m18:38:59.965918 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 18:38:59.965918 => 18:38:59.965918
[0m18:38:59.966947 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m18:38:59.967943 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m18:38:59.968945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m18:38:59.968945 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m18:38:59.971943 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m18:38:59.972911 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 18:38:59.968945 => 18:38:59.972911
[0m18:38:59.973912 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m18:38:59.973912 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 18:38:59.973912 => 18:38:59.973912
[0m18:38:59.974912 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m18:38:59.975911 [debug] [Thread-1 (]: Began running node seed.practice.sample
[0m18:38:59.975911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_transaction, now seed.practice.sample)
[0m18:38:59.976911 [debug] [Thread-1 (]: Began compiling node seed.practice.sample
[0m18:38:59.978913 [debug] [Thread-1 (]: Timing info for seed.practice.sample (compile): 18:38:59.976911 => 18:38:59.977912
[0m18:38:59.979914 [debug] [Thread-1 (]: Began executing node seed.practice.sample
[0m18:38:59.979914 [debug] [Thread-1 (]: Timing info for seed.practice.sample (execute): 18:38:59.979914 => 18:38:59.979914
[0m18:38:59.981913 [debug] [Thread-1 (]: Finished running node seed.practice.sample
[0m18:38:59.981913 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m18:38:59.982912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.practice.sample, now test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935)
[0m18:38:59.982912 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m18:38:59.996967 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935"
[0m18:38:59.998919 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935 (compile): 18:38:59.983911 => 18:38:59.998919
[0m18:38:59.998919 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m18:38:59.999951 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935 (execute): 18:38:59.999951 => 18:38:59.999951
[0m18:39:00.000950 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935
[0m18:39:00.000950 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m18:39:00.001950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_COUNTRY_REGION_CUSTOMER_ID.24aff59935, now test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9)
[0m18:39:00.001950 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m18:39:00.006531 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9"
[0m18:39:00.007528 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9 (compile): 18:39:00.002955 => 18:39:00.007528
[0m18:39:00.008492 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m18:39:00.009504 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9 (execute): 18:39:00.008492 => 18:39:00.008492
[0m18:39:00.010501 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9
[0m18:39:00.011496 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m18:39:00.013505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_CUSTOMERS_CUSTOMER_ID.bb4ac17ac9, now test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be)
[0m18:39:00.014497 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m18:39:00.019494 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be"
[0m18:39:00.020493 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be (compile): 18:39:00.015496 => 18:39:00.020493
[0m18:39:00.021494 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m18:39:00.021494 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be (execute): 18:39:00.021494 => 18:39:00.021494
[0m18:39:00.022493 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be
[0m18:39:00.023493 [debug] [Thread-1 (]: Began running node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m18:39:00.024493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_PRODUCTS_PRODUCT_ID.fa34d9d6be, now test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6)
[0m18:39:00.024493 [debug] [Thread-1 (]: Began compiling node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m18:39:00.029493 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6"
[0m18:39:00.030493 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6 (compile): 18:39:00.024493 => 18:39:00.030493
[0m18:39:00.030493 [debug] [Thread-1 (]: Began executing node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m18:39:00.031491 [debug] [Thread-1 (]: Timing info for test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6 (execute): 18:39:00.031491 => 18:39:00.031491
[0m18:39:00.032490 [debug] [Thread-1 (]: Finished running node test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6
[0m18:39:00.032490 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m18:39:00.033491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_not_null_tp_source_TRANSACTION_CUSTOMER_ID.e7fbabf1d6, now test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30)
[0m18:39:00.034492 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m18:39:00.040490 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30"
[0m18:39:00.041493 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30 (compile): 18:39:00.034492 => 18:39:00.041493
[0m18:39:00.042492 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m18:39:00.042492 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30 (execute): 18:39:00.042492 => 18:39:00.042492
[0m18:39:00.043493 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30
[0m18:39:00.044491 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m18:39:00.044491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_COUNTRY_REGION_CUSTOMER_ID.e40968dd30, now test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f)
[0m18:39:00.045491 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m18:39:00.049492 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f"
[0m18:39:00.050492 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f (compile): 18:39:00.045491 => 18:39:00.050492
[0m18:39:00.051493 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m18:39:00.051493 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f (execute): 18:39:00.051493 => 18:39:00.051493
[0m18:39:00.052493 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f
[0m18:39:00.053491 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m18:39:00.054492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_CUSTOMERS_CUSTOMER_ID.453e0ebb7f, now test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678)
[0m18:39:00.054492 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m18:39:00.059491 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678"
[0m18:39:00.060491 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678 (compile): 18:39:00.054492 => 18:39:00.060491
[0m18:39:00.061494 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m18:39:00.061494 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678 (execute): 18:39:00.061494 => 18:39:00.061494
[0m18:39:00.062494 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678
[0m18:39:00.063493 [debug] [Thread-1 (]: Began running node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m18:39:00.064493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_PRODUCTS_PRODUCT_ID.19fbdf1678, now test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3)
[0m18:39:00.064493 [debug] [Thread-1 (]: Began compiling node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m18:39:00.068493 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3"
[0m18:39:00.069492 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3 (compile): 18:39:00.064493 => 18:39:00.069492
[0m18:39:00.070494 [debug] [Thread-1 (]: Began executing node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m18:39:00.070494 [debug] [Thread-1 (]: Timing info for test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3 (execute): 18:39:00.070494 => 18:39:00.070494
[0m18:39:00.071493 [debug] [Thread-1 (]: Finished running node test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3
[0m18:39:00.072493 [debug] [Thread-1 (]: Began running node model.practice.customers_rank
[0m18:39:00.072493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.practice.source_unique_tp_source_TRANSACTION_CUSTOMER_ID.e3856befd3, now model.practice.customers_rank)
[0m18:39:00.073493 [debug] [Thread-1 (]: Began compiling node model.practice.customers_rank
[0m18:39:00.076493 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.customers_rank"
[0m18:39:00.078842 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (compile): 18:39:00.073493 => 18:39:00.077832
[0m18:39:00.078842 [debug] [Thread-1 (]: Began executing node model.practice.customers_rank
[0m18:39:00.079873 [debug] [Thread-1 (]: Timing info for model.practice.customers_rank (execute): 18:39:00.078842 => 18:39:00.078842
[0m18:39:00.080870 [debug] [Thread-1 (]: Finished running node model.practice.customers_rank
[0m18:39:00.080870 [debug] [Thread-1 (]: Began running node model.practice.fiscal_year
[0m18:39:00.081870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.customers_rank, now model.practice.fiscal_year)
[0m18:39:00.081870 [debug] [Thread-1 (]: Began compiling node model.practice.fiscal_year
[0m18:39:00.084871 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.fiscal_year"
[0m18:39:00.085872 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (compile): 18:39:00.081870 => 18:39:00.085872
[0m18:39:00.086839 [debug] [Thread-1 (]: Began executing node model.practice.fiscal_year
[0m18:39:00.086839 [debug] [Thread-1 (]: Timing info for model.practice.fiscal_year (execute): 18:39:00.086839 => 18:39:00.086839
[0m18:39:00.087870 [debug] [Thread-1 (]: Finished running node model.practice.fiscal_year
[0m18:39:00.087870 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m18:39:00.088870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.fiscal_year, now model.practice.mart_churnstatus)
[0m18:39:00.089907 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m18:39:00.092907 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m18:39:00.093875 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 18:39:00.089907 => 18:39:00.092907
[0m18:39:00.093875 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m18:39:00.094907 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 18:39:00.093875 => 18:39:00.093875
[0m18:39:00.095907 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m18:39:00.095907 [debug] [Thread-1 (]: Began running node model.practice.mart_cust_churn_count
[0m18:39:00.096907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_churnstatus, now model.practice.mart_cust_churn_count)
[0m18:39:00.096907 [debug] [Thread-1 (]: Began compiling node model.practice.mart_cust_churn_count
[0m18:39:00.099907 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_cust_churn_count"
[0m18:39:00.100910 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (compile): 18:39:00.096907 => 18:39:00.100910
[0m18:39:00.101877 [debug] [Thread-1 (]: Began executing node model.practice.mart_cust_churn_count
[0m18:39:00.101877 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (execute): 18:39:00.101877 => 18:39:00.101877
[0m18:39:00.102907 [debug] [Thread-1 (]: Finished running node model.practice.mart_cust_churn_count
[0m18:39:00.103907 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m18:39:00.103907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_cust_churn_count, now model.practice.mart_high_cross)
[0m18:39:00.105113 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m18:39:00.108112 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m18:39:00.109113 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 18:39:00.105113 => 18:39:00.109113
[0m18:39:00.109113 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m18:39:00.110112 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 18:39:00.109113 => 18:39:00.109113
[0m18:39:00.111116 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m18:39:00.111116 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:39:00.112113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_high_cross, now model.practice.mart_nrr_grr)
[0m18:39:00.112113 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:39:00.116112 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:39:00.117081 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:39:00.112113 => 18:39:00.116112
[0m18:39:00.117081 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:39:00.118113 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:39:00.117081 => 18:39:00.117081
[0m18:39:00.119113 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:39:00.119113 [debug] [Thread-1 (]: Began running node model.practice.mart_prod_churn
[0m18:39:00.120112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_nrr_grr, now model.practice.mart_prod_churn)
[0m18:39:00.120112 [debug] [Thread-1 (]: Began compiling node model.practice.mart_prod_churn
[0m18:39:00.123112 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_prod_churn"
[0m18:39:00.124112 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (compile): 18:39:00.120112 => 18:39:00.124112
[0m18:39:00.125081 [debug] [Thread-1 (]: Began executing node model.practice.mart_prod_churn
[0m18:39:00.125081 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (execute): 18:39:00.125081 => 18:39:00.125081
[0m18:39:00.126112 [debug] [Thread-1 (]: Finished running node model.practice.mart_prod_churn
[0m18:39:00.127112 [debug] [Thread-1 (]: Began running node model.practice.mart_product_revenue
[0m18:39:00.127112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_prod_churn, now model.practice.mart_product_revenue)
[0m18:39:00.128113 [debug] [Thread-1 (]: Began compiling node model.practice.mart_product_revenue
[0m18:39:00.131115 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_product_revenue"
[0m18:39:00.132113 [debug] [Thread-1 (]: Timing info for model.practice.mart_product_revenue (compile): 18:39:00.128113 => 18:39:00.132113
[0m18:39:00.132113 [debug] [Thread-1 (]: Began executing node model.practice.mart_product_revenue
[0m18:39:00.133113 [debug] [Thread-1 (]: Timing info for model.practice.mart_product_revenue (execute): 18:39:00.133113 => 18:39:00.133113
[0m18:39:00.134116 [debug] [Thread-1 (]: Finished running node model.practice.mart_product_revenue
[0m18:39:00.134116 [debug] [Thread-1 (]: Began running node model.practice.revenue_loss
[0m18:39:00.135112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_product_revenue, now model.practice.revenue_loss)
[0m18:39:00.135112 [debug] [Thread-1 (]: Began compiling node model.practice.revenue_loss
[0m18:39:00.138115 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.revenue_loss"
[0m18:39:00.140081 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (compile): 18:39:00.136112 => 18:39:00.139112
[0m18:39:00.140081 [debug] [Thread-1 (]: Began executing node model.practice.revenue_loss
[0m18:39:00.140081 [debug] [Thread-1 (]: Timing info for model.practice.revenue_loss (execute): 18:39:00.140081 => 18:39:00.140081
[0m18:39:00.141114 [debug] [Thread-1 (]: Finished running node model.practice.revenue_loss
[0m18:39:00.142112 [debug] [Thread-1 (]: Began running node test.practice.revenue_test
[0m18:39:00.143116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.revenue_loss, now test.practice.revenue_test)
[0m18:39:00.143116 [debug] [Thread-1 (]: Began compiling node test.practice.revenue_test
[0m18:39:00.146112 [debug] [Thread-1 (]: Writing injected SQL for node "test.practice.revenue_test"
[0m18:39:00.147081 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (compile): 18:39:00.143116 => 18:39:00.146112
[0m18:39:00.147081 [debug] [Thread-1 (]: Began executing node test.practice.revenue_test
[0m18:39:00.148112 [debug] [Thread-1 (]: Timing info for test.practice.revenue_test (execute): 18:39:00.147081 => 18:39:00.147081
[0m18:39:00.149113 [debug] [Thread-1 (]: Finished running node test.practice.revenue_test
[0m18:39:00.150081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:00.150081 [debug] [MainThread]: Connection 'list_RIDE_SHARING_DB_STAGING' was properly closed.
[0m18:39:00.151083 [debug] [MainThread]: Connection 'test.practice.revenue_test' was properly closed.
[0m18:39:00.154116 [debug] [MainThread]: Command end result
[0m18:39:00.397587 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m18:39:00.398617 [info ] [MainThread]: Building catalog
[0m18:39:00.401585 [debug] [ThreadPool]: Acquiring new snowflake connection 'RIDE_SHARING_DB.information_schema'
[0m18:39:00.418098 [debug] [ThreadPool]: Using snowflake connection "RIDE_SHARING_DB.information_schema"
[0m18:39:00.419101 [debug] [ThreadPool]: On RIDE_SHARING_DB.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "RIDE_SHARING_DB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from RIDE_SHARING_DB.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_cust_churn_count')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_prod_churn')
                )
             or 
                (
                    upper("table_schema") = upper('STAGING')
                    and upper("table_name") = upper('stg_transaction')
                )
             or 
                (
                    upper("table_schema") = upper('MART')
                    and upper("table_name") = upper('stg_product')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_nrr_grr')
                )
             or 
                (
                    upper("table_schema") = upper('STAGING')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_high_cross')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('customers_rank')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('fiscal_year')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('COUNTRY_REGION')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('revenue_loss')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('TRANSACTION')
                )
             or 
                (
                    upper("table_schema") = upper('STAGING')
                    and upper("table_name") = upper('stg_country')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_churnstatus')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('PRODUCTS')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('CUSTOMERS')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_product_revenue')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from RIDE_SHARING_DB.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_cust_churn_count')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_prod_churn')
                )
             or 
                (
                    upper("table_schema") = upper('STAGING')
                    and upper("table_name") = upper('stg_transaction')
                )
             or 
                (
                    upper("table_schema") = upper('MART')
                    and upper("table_name") = upper('stg_product')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_nrr_grr')
                )
             or 
                (
                    upper("table_schema") = upper('STAGING')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_high_cross')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('customers_rank')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('fiscal_year')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('COUNTRY_REGION')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('revenue_loss')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('TRANSACTION')
                )
             or 
                (
                    upper("table_schema") = upper('STAGING')
                    and upper("table_name") = upper('stg_country')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_churnstatus')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('PRODUCTS')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('CUSTOMERS')
                )
             or 
                (
                    upper("table_schema") = upper('MARTS')
                    and upper("table_name") = upper('mart_product_revenue')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:39:00.419101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:05.516804 [debug] [ThreadPool]: SQL status: SUCCESS 89 in 5.0 seconds
[0m18:39:05.531791 [debug] [ThreadPool]: On RIDE_SHARING_DB.information_schema: Close
[0m18:39:05.613841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly RIDE_SHARING_DB.information_schema, now SNOWFLAKE_PRAC.information_schema)
[0m18:39:05.620869 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_PRAC.information_schema"
[0m18:39:05.620869 [debug] [ThreadPool]: On SNOWFLAKE_PRAC.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "SNOWFLAKE_PRAC.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from SNOWFLAKE_PRAC.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('sample_data')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from SNOWFLAKE_PRAC.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('public')
                    and upper("table_name") = upper('sample_data')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:39:05.621868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:07.631461 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m18:39:07.634481 [debug] [ThreadPool]: On SNOWFLAKE_PRAC.information_schema: Close
[0m18:39:07.746137 [info ] [MainThread]: Catalog written to C:\Users\KavinVishnuN\dbt\practice\target\catalog.json
[0m18:39:07.747279 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:39:07.747279 after 11.57 seconds
[0m18:39:07.747279 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:39:07.748308 [debug] [MainThread]: Connection 'SNOWFLAKE_PRAC.information_schema' was properly closed.
[0m18:39:07.748308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394DEB7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394DEB7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394DEB4F80>]}
[0m18:39:07.749278 [debug] [MainThread]: Flushing usage events
[0m18:39:16.761475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B136FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3E56120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3E579B0>]}


============================== 18:39:16.766475 | 5f4fe0ba-c055-42ac-a47d-6af2388bab54 ==============================
[0m18:39:16.766475 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:39:16.767475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m18:39:17.672195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f4fe0ba-c055-42ac-a47d-6af2388bab54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C067CB00>]}
[0m18:39:17.763171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f4fe0ba-c055-42ac-a47d-6af2388bab54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C06D4AD0>]}
[0m18:43:46.395041 [error] [MainThread]: Encountered an error:

[0m18:43:46.453995 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\KavinVishnuN\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:43:46.456381 [debug] [MainThread]: Command `dbt docs serve` failed at 18:43:46.456381 after 269.76 seconds
[0m18:43:46.456381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B31F0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252C074F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252BE4706E0>]}
[0m18:43:46.457380 [debug] [MainThread]: Flushing usage events
[0m18:43:54.159031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C9E87E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C9E87FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C9E86A20>]}


============================== 18:43:54.163034 | 2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5 ==============================
[0m18:43:54.163034 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:43:54.164032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KavinVishnuN\\dbt\\practice\\logs', 'profiles_dir': 'C:\\Users\\KavinVishnuN\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:43:55.073173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D784FEC0>]}
[0m18:43:55.158786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C9EBA5D0>]}
[0m18:43:55.159785 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:43:55.167638 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:43:55.270217 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m18:43:55.271219 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_revenue_loss.sql
[0m18:43:55.271219 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_customers_rank.sql
[0m18:43:55.272218 [debug] [MainThread]: Partial parsing: added file: practice://models\marts\mart_fiscal_year.sql
[0m18:43:55.272218 [debug] [MainThread]: Partial parsing: deleted file: practice://models\marts\fiscal_year.sql
[0m18:43:55.272218 [debug] [MainThread]: Partial parsing: deleted file: practice://models\marts\revenue_loss.sql
[0m18:43:55.273220 [debug] [MainThread]: Partial parsing: deleted file: practice://models\marts\customers_rank.sql
[0m18:43:55.422172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_pipeline.marts
- models.data_pipeline.staging
[0m18:43:55.427764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7B3DBE0>]}
[0m18:43:55.439969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7B858B0>]}
[0m18:43:55.440921 [info ] [MainThread]: Found 13 models, 1 seed, 9 tests, 4 sources, 0 exposures, 0 metrics, 446 macros, 0 groups, 0 semantic models
[0m18:43:55.441918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D745C830>]}
[0m18:43:55.443966 [info ] [MainThread]: 
[0m18:43:55.445919 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:43:55.447951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB'
[0m18:43:55.461918 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:43:55.462920 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:43:55.463961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:56.426862 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:43:56.429862 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:43:56.530704 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:43:56.530704 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:43:56.531715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:56.957017 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:43:56.958042 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:43:57.046822 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB"
[0m18:43:57.047823 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB"} */
show terse schemas in database RIDE_SHARING_DB
    limit 10000
[0m18:43:57.047823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:57.360241 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:43:57.363240 [debug] [ThreadPool]: On list_RIDE_SHARING_DB: Close
[0m18:43:57.454991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB, now create_RIDE_SHARING_DB_MART)
[0m18:43:57.458337 [debug] [ThreadPool]: Creating schema "database: "RIDE_SHARING_DB"
schema: "MART"
"
[0m18:43:57.466361 [debug] [ThreadPool]: Using snowflake connection "create_RIDE_SHARING_DB_MART"
[0m18:43:57.466361 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "create_RIDE_SHARING_DB_MART"} */
create schema if not exists RIDE_SHARING_DB.MART
[0m18:43:57.467360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:57.796016 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:43:57.797014 [debug] [ThreadPool]: On create_RIDE_SHARING_DB_MART: Close
[0m18:43:57.876759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RIDE_SHARING_DB_STAGING'
[0m18:43:57.885762 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_STAGING"
[0m18:43:57.885762 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_STAGING"} */
show terse objects in RIDE_SHARING_DB.STAGING limit 10000
[0m18:43:57.886761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:58.201194 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:43:58.203195 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_STAGING: Close
[0m18:43:58.292760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_STAGING, now list_RIDE_SHARING_DB_MARTS)
[0m18:43:58.298764 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MARTS"
[0m18:43:58.298764 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MARTS"} */
show terse objects in RIDE_SHARING_DB.MARTS limit 10000
[0m18:43:58.299761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:58.757393 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m18:43:58.759938 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MARTS: Close
[0m18:43:58.850200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MARTS, now list_RIDE_SHARING_DB_MART)
[0m18:43:58.853195 [debug] [ThreadPool]: Using snowflake connection "list_RIDE_SHARING_DB_MART"
[0m18:43:58.854197 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_RIDE_SHARING_DB_MART"} */
show terse objects in RIDE_SHARING_DB.MART limit 10000
[0m18:43:58.854197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:59.173265 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m18:43:59.175260 [debug] [ThreadPool]: On list_RIDE_SHARING_DB_MART: Close
[0m18:43:59.262239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RIDE_SHARING_DB_MART, now list_SNOWFLAKE_PRAC_public)
[0m18:43:59.264278 [debug] [ThreadPool]: Using snowflake connection "list_SNOWFLAKE_PRAC_public"
[0m18:43:59.265279 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "connection_name": "list_SNOWFLAKE_PRAC_public"} */
show terse objects in SNOWFLAKE_PRAC.public limit 10000
[0m18:43:59.265279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:59.569463 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.0 seconds
[0m18:43:59.573412 [debug] [ThreadPool]: On list_SNOWFLAKE_PRAC_public: Close
[0m18:43:59.667403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7D8F8F0>]}
[0m18:43:59.671404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:59.674451 [info ] [MainThread]: 
[0m18:43:59.687409 [debug] [Thread-1 (]: Began running node model.practice.stg_country
[0m18:43:59.689441 [info ] [Thread-1 (]: 1 of 13 START sql view model STAGING.stg_country ............................... [RUN]
[0m18:43:59.692397 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.practice.stg_country'
[0m18:43:59.693393 [debug] [Thread-1 (]: Began compiling node model.practice.stg_country
[0m18:43:59.707418 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_country"
[0m18:43:59.708419 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (compile): 18:43:59.694393 => 18:43:59.708419
[0m18:43:59.709423 [debug] [Thread-1 (]: Began executing node model.practice.stg_country
[0m18:43:59.741419 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_country"
[0m18:43:59.742826 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_country"
[0m18:43:59.744242 [debug] [Thread-1 (]: On model.practice.stg_country: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_country"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_country
  
   as (
    

SELECT 
    CUSTOMER_ID,
    COUNTRY,
    REGION
FROM RIDE_SHARING_DB.RAW.COUNTRY_REGION
  );
[0m18:43:59.744242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:00.160312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:44:00.181824 [debug] [Thread-1 (]: Timing info for model.practice.stg_country (execute): 18:43:59.709423 => 18:44:00.181824
[0m18:44:00.182824 [debug] [Thread-1 (]: On model.practice.stg_country: Close
[0m18:44:00.259864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7DE0E00>]}
[0m18:44:00.260864 [info ] [Thread-1 (]: 1 of 13 OK created sql view model STAGING.stg_country .......................... [[32mSUCCESS 1[0m in 0.57s]
[0m18:44:00.261863 [debug] [Thread-1 (]: Finished running node model.practice.stg_country
[0m18:44:00.262896 [debug] [Thread-1 (]: Began running node model.practice.stg_customers
[0m18:44:00.262896 [info ] [Thread-1 (]: 2 of 13 START sql view model STAGING.stg_customers ............................. [RUN]
[0m18:44:00.263887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_country, now model.practice.stg_customers)
[0m18:44:00.265061 [debug] [Thread-1 (]: Began compiling node model.practice.stg_customers
[0m18:44:00.268061 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_customers"
[0m18:44:00.269029 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (compile): 18:44:00.265061 => 18:44:00.269029
[0m18:44:00.269029 [debug] [Thread-1 (]: Began executing node model.practice.stg_customers
[0m18:44:00.273062 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_customers"
[0m18:44:00.274029 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_customers"
[0m18:44:00.275061 [debug] [Thread-1 (]: On model.practice.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_customers"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_customers
  
   as (
    

SELECT 
    CUSTOMER_ID,
    CUSTOMERNAME,
    COMPANY
FROM RIDE_SHARING_DB.RAW.CUSTOMERS
  );
[0m18:44:00.275061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:00.662883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:44:00.665391 [debug] [Thread-1 (]: Timing info for model.practice.stg_customers (execute): 18:44:00.270062 => 18:44:00.665391
[0m18:44:00.666391 [debug] [Thread-1 (]: On model.practice.stg_customers: Close
[0m18:44:00.741403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C5EF6990>]}
[0m18:44:00.742391 [info ] [Thread-1 (]: 2 of 13 OK created sql view model STAGING.stg_customers ........................ [[32mSUCCESS 1[0m in 0.48s]
[0m18:44:00.743392 [debug] [Thread-1 (]: Finished running node model.practice.stg_customers
[0m18:44:00.744394 [debug] [Thread-1 (]: Began running node model.practice.stg_product
[0m18:44:00.744394 [info ] [Thread-1 (]: 3 of 13 START sql table model MART.stg_product ................................. [RUN]
[0m18:44:00.745394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_customers, now model.practice.stg_product)
[0m18:44:00.746428 [debug] [Thread-1 (]: Began compiling node model.practice.stg_product
[0m18:44:00.750467 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_product"
[0m18:44:00.751433 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (compile): 18:44:00.746428 => 18:44:00.751433
[0m18:44:00.752436 [debug] [Thread-1 (]: Began executing node model.practice.stg_product
[0m18:44:00.776744 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_product"
[0m18:44:00.778712 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_product"
[0m18:44:00.778712 [debug] [Thread-1 (]: On model.practice.stg_product: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_product"} */
create or replace transient table RIDE_SHARING_DB.MART.stg_product
         as
        (

SELECT 
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY
FROM RIDE_SHARING_DB.RAW.PRODUCTS



        );
[0m18:44:00.779711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:01.554801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:01.557753 [debug] [Thread-1 (]: Timing info for model.practice.stg_product (execute): 18:44:00.752436 => 18:44:01.557753
[0m18:44:01.557753 [debug] [Thread-1 (]: On model.practice.stg_product: Close
[0m18:44:01.658555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7DBFDD0>]}
[0m18:44:01.660549 [info ] [Thread-1 (]: 3 of 13 OK created sql table model MART.stg_product ............................ [[32mSUCCESS 1[0m in 0.91s]
[0m18:44:01.663550 [debug] [Thread-1 (]: Finished running node model.practice.stg_product
[0m18:44:01.665612 [debug] [Thread-1 (]: Began running node model.practice.stg_transaction
[0m18:44:01.667612 [info ] [Thread-1 (]: 4 of 13 START sql view model STAGING.stg_transaction ........................... [RUN]
[0m18:44:01.668558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_product, now model.practice.stg_transaction)
[0m18:44:01.669590 [debug] [Thread-1 (]: Began compiling node model.practice.stg_transaction
[0m18:44:01.673593 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.stg_transaction"
[0m18:44:01.674589 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (compile): 18:44:01.669590 => 18:44:01.674589
[0m18:44:01.675559 [debug] [Thread-1 (]: Began executing node model.practice.stg_transaction
[0m18:44:01.680096 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.stg_transaction"
[0m18:44:01.682103 [debug] [Thread-1 (]: Using snowflake connection "model.practice.stg_transaction"
[0m18:44:01.682103 [debug] [Thread-1 (]: On model.practice.stg_transaction: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.stg_transaction"} */
create or replace   view RIDE_SHARING_DB.STAGING.stg_transaction
  
   as (
    

SELECT 
    CUSTOMER_ID,
    PRODUCT_ID,
    TO_DATE(PAYMENT_MONTH, 'DD-MM-YYYY') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
FROM RIDE_SHARING_DB.RAW.TRANSACTION
  );
[0m18:44:01.682103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:02.167731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:44:02.171684 [debug] [Thread-1 (]: Timing info for model.practice.stg_transaction (execute): 18:44:01.675559 => 18:44:02.171684
[0m18:44:02.171684 [debug] [Thread-1 (]: On model.practice.stg_transaction: Close
[0m18:44:02.258819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E4E2A0>]}
[0m18:44:02.258819 [info ] [Thread-1 (]: 4 of 13 OK created sql view model STAGING.stg_transaction ...................... [[32mSUCCESS 1[0m in 0.59s]
[0m18:44:02.259788 [debug] [Thread-1 (]: Finished running node model.practice.stg_transaction
[0m18:44:02.260788 [debug] [Thread-1 (]: Began running node model.practice.mart_churnstatus
[0m18:44:02.261787 [info ] [Thread-1 (]: 5 of 13 START sql table model MARTS.mart_churnstatus ........................... [RUN]
[0m18:44:02.262789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.stg_transaction, now model.practice.mart_churnstatus)
[0m18:44:02.262789 [debug] [Thread-1 (]: Began compiling node model.practice.mart_churnstatus
[0m18:44:02.266789 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_churnstatus"
[0m18:44:02.267806 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (compile): 18:44:02.263789 => 18:44:02.267806
[0m18:44:02.268820 [debug] [Thread-1 (]: Began executing node model.practice.mart_churnstatus
[0m18:44:02.271825 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_churnstatus"
[0m18:44:02.273820 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_churnstatus"
[0m18:44:02.274858 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_churnstatus"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_churnstatus
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS LM_Customer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS Ltm_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 'New_Customer' 
            ELSE 'Existing_Customer'
        END AS Ltm_Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT * FROM churn_status
        );
[0m18:44:02.274858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:03.115265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:03.117257 [debug] [Thread-1 (]: Timing info for model.practice.mart_churnstatus (execute): 18:44:02.268820 => 18:44:03.117257
[0m18:44:03.118256 [debug] [Thread-1 (]: On model.practice.mart_churnstatus: Close
[0m18:44:03.205769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E4E480>]}
[0m18:44:03.206747 [info ] [Thread-1 (]: 5 of 13 OK created sql table model MARTS.mart_churnstatus ...................... [[32mSUCCESS 1[0m in 0.94s]
[0m18:44:03.207716 [debug] [Thread-1 (]: Finished running node model.practice.mart_churnstatus
[0m18:44:03.208700 [debug] [Thread-1 (]: Began running node model.practice.mart_cust_churn_count
[0m18:44:03.208700 [info ] [Thread-1 (]: 6 of 13 START sql table model MARTS.mart_cust_churn_count ...................... [RUN]
[0m18:44:03.209731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_churnstatus, now model.practice.mart_cust_churn_count)
[0m18:44:03.210733 [debug] [Thread-1 (]: Began compiling node model.practice.mart_cust_churn_count
[0m18:44:03.213731 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_cust_churn_count"
[0m18:44:03.214731 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (compile): 18:44:03.210733 => 18:44:03.214731
[0m18:44:03.215715 [debug] [Thread-1 (]: Began executing node model.practice.mart_cust_churn_count
[0m18:44:03.218730 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_cust_churn_count"
[0m18:44:03.221700 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_cust_churn_count"
[0m18:44:03.221700 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_cust_churn_count"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_cust_churn_count
         as
        (



WITH transactions AS (
    SELECT
        customer_id,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.customer_id,
        MAX(t.tran_month) AS last_transaction_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3m_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -3, m.latest_month) THEN 1
            ELSE 0
        END AS L3MCustomer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 1
            ELSE 0
        END AS LM_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -1, m.latest_month) THEN 1 
            ELSE 0
        END AS LM_Customer_Status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_churn_status,
        CASE
            WHEN MIN(t.tran_month) >= DATEADD('month', -12, m.latest_month) THEN 1
            ELSE 0
        END AS Ltm_Customer_Status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.customer_id,m.latest_month
)
SELECT sum(LM_churn_status) as churned_last_month,
sum(L3m_churn_status) as churned_last_3_months,
sum(Ltm_churn_status) as churned_last_12_months,
sum(LM_Customer_Status) as new_customers_last_month,
sum(L3MCustomer_Status) as new_customers_last_3_months,
sum(Ltm_Customer_Status) as new_customers_last_12_months
 FROM 
churn_status
        );
[0m18:44:03.222732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:04.005543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:04.009538 [debug] [Thread-1 (]: Timing info for model.practice.mart_cust_churn_count (execute): 18:44:03.215715 => 18:44:04.009538
[0m18:44:04.010528 [debug] [Thread-1 (]: On model.practice.mart_cust_churn_count: Close
[0m18:44:04.092978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7DCFAA0>]}
[0m18:44:04.093980 [info ] [Thread-1 (]: 6 of 13 OK created sql table model MARTS.mart_cust_churn_count ................. [[32mSUCCESS 1[0m in 0.88s]
[0m18:44:04.095488 [debug] [Thread-1 (]: Finished running node model.practice.mart_cust_churn_count
[0m18:44:04.096545 [debug] [Thread-1 (]: Began running node model.practice.mart_customers_rank
[0m18:44:04.097538 [info ] [Thread-1 (]: 7 of 13 START sql table model MARTS.mart_customers_rank ........................ [RUN]
[0m18:44:04.099537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_cust_churn_count, now model.practice.mart_customers_rank)
[0m18:44:04.099537 [debug] [Thread-1 (]: Began compiling node model.practice.mart_customers_rank
[0m18:44:04.106549 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_customers_rank"
[0m18:44:04.108499 [debug] [Thread-1 (]: Timing info for model.practice.mart_customers_rank (compile): 18:44:04.100538 => 18:44:04.107538
[0m18:44:04.109537 [debug] [Thread-1 (]: Began executing node model.practice.mart_customers_rank
[0m18:44:04.114502 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_customers_rank"
[0m18:44:04.117536 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_customers_rank"
[0m18:44:04.118500 [debug] [Thread-1 (]: On model.practice.mart_customers_rank: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_customers_rank"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_customers_rank
         as
        (
WITH stg_customers AS (
SELECT 
    c.CUSTOMER_ID,
    c.CUSTOMERNAME,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.STAGING.stg_customers c
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON c.CUSTOMER_ID = r.CUSTOMER_ID
GROUP BY c.CUSTOMER_ID,CUSTOMERNAME
ORDER BY TOTAL_REVENUE DESC
)
SELECT 
    s.CUSTOMER_ID,
    s.CUSTOMERNAME,
    con.COUNTRY,
    con.REGION,
    s.TOTAL_REVENUE,
    s.RANK
    
FROM stg_customers s
JOIN RIDE_SHARING_DB.STAGING.stg_country con
on s.CUSTOMER_ID = con.CUSTOMER_ID
        );
[0m18:44:04.119535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:05.055039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:05.058048 [debug] [Thread-1 (]: Timing info for model.practice.mart_customers_rank (execute): 18:44:04.109537 => 18:44:05.058048
[0m18:44:05.058048 [debug] [Thread-1 (]: On model.practice.mart_customers_rank: Close
[0m18:44:05.140325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E4E0C0>]}
[0m18:44:05.141327 [info ] [Thread-1 (]: 7 of 13 OK created sql table model MARTS.mart_customers_rank ................... [[32mSUCCESS 1[0m in 1.04s]
[0m18:44:05.143364 [debug] [Thread-1 (]: Finished running node model.practice.mart_customers_rank
[0m18:44:05.144362 [debug] [Thread-1 (]: Began running node model.practice.mart_fiscal_year
[0m18:44:05.145324 [info ] [Thread-1 (]: 8 of 13 START sql table model MARTS.mart_fiscal_year ........................... [RUN]
[0m18:44:05.146334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_customers_rank, now model.practice.mart_fiscal_year)
[0m18:44:05.147326 [debug] [Thread-1 (]: Began compiling node model.practice.mart_fiscal_year
[0m18:44:05.152361 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_fiscal_year"
[0m18:44:05.154322 [debug] [Thread-1 (]: Timing info for model.practice.mart_fiscal_year (compile): 18:44:05.147326 => 18:44:05.154322
[0m18:44:05.155326 [debug] [Thread-1 (]: Began executing node model.practice.mart_fiscal_year
[0m18:44:05.160324 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_fiscal_year"
[0m18:44:05.163330 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_fiscal_year"
[0m18:44:05.164322 [debug] [Thread-1 (]: On model.practice.mart_fiscal_year: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_fiscal_year"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_fiscal_year
         as
        (


WITH first_payment AS (
    SELECT
        customer_id,
        YEAR(MIN(PAYMENT_MONTH)) AS fiscal_Year,
    FROM
        RIDE_SHARING_DB.STAGING.stg_transaction
    GROUP BY customer_id
)
SELECT
    fiscal_Year,
    COUNT(customer_id) AS new_logos_count
FROM
    first_payment
GROUP BY fiscal_Year
        );
[0m18:44:05.164322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:05.836990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:05.838957 [debug] [Thread-1 (]: Timing info for model.practice.mart_fiscal_year (execute): 18:44:05.156328 => 18:44:05.838957
[0m18:44:05.839960 [debug] [Thread-1 (]: On model.practice.mart_fiscal_year: Close
[0m18:44:05.923314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E4E540>]}
[0m18:44:05.923314 [info ] [Thread-1 (]: 8 of 13 OK created sql table model MARTS.mart_fiscal_year ...................... [[32mSUCCESS 1[0m in 0.78s]
[0m18:44:05.924316 [debug] [Thread-1 (]: Finished running node model.practice.mart_fiscal_year
[0m18:44:05.925314 [debug] [Thread-1 (]: Began running node model.practice.mart_high_cross
[0m18:44:05.925314 [info ] [Thread-1 (]: 9 of 13 START sql table model MARTS.mart_high_cross ............................ [RUN]
[0m18:44:05.926437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_fiscal_year, now model.practice.mart_high_cross)
[0m18:44:05.927474 [debug] [Thread-1 (]: Began compiling node model.practice.mart_high_cross
[0m18:44:05.930477 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_high_cross"
[0m18:44:05.931477 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (compile): 18:44:05.927474 => 18:44:05.931477
[0m18:44:05.931477 [debug] [Thread-1 (]: Began executing node model.practice.mart_high_cross
[0m18:44:05.935474 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_high_cross"
[0m18:44:05.937442 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_high_cross"
[0m18:44:05.937442 [debug] [Thread-1 (]: On model.practice.mart_high_cross: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_high_cross"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_high_cross
         as
        (
WITH cross_sell as(
SELECT 
    CUSTOMER_ID,
    Count(DISTINCT PRODUCT_ID) AS UNIQUE_PRODUCTS,
    SUM(REVENUE) AS TOTAL_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
GROUP BY CUSTOMER_ID
)
SELECT 
    CUSTOMER_ID,
    UNIQUE_PRODUCTS,
    DENSE_RANK() OVER (ORDER BY UNIQUE_PRODUCTS DESC) AS RANK,
    TOTAL_REVENUE
FROM cross_sell
    wHERE UNIQUE_PRODUCTS > 1
    ORDER BY UNIQUE_PRODUCTS DESC
        );
[0m18:44:05.938475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:06.667306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:06.670257 [debug] [Thread-1 (]: Timing info for model.practice.mart_high_cross (execute): 18:44:05.932475 => 18:44:06.670257
[0m18:44:06.671258 [debug] [Thread-1 (]: On model.practice.mart_high_cross: Close
[0m18:44:06.766724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E97E90>]}
[0m18:44:06.769660 [info ] [Thread-1 (]: 9 of 13 OK created sql table model MARTS.mart_high_cross ....................... [[32mSUCCESS 1[0m in 0.84s]
[0m18:44:06.771721 [debug] [Thread-1 (]: Finished running node model.practice.mart_high_cross
[0m18:44:06.772677 [debug] [Thread-1 (]: Began running node model.practice.mart_nrr_grr
[0m18:44:06.772677 [info ] [Thread-1 (]: 10 of 13 START sql table model MARTS.mart_nrr_grr .............................. [RUN]
[0m18:44:06.773677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_high_cross, now model.practice.mart_nrr_grr)
[0m18:44:06.774676 [debug] [Thread-1 (]: Began compiling node model.practice.mart_nrr_grr
[0m18:44:06.777676 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_nrr_grr"
[0m18:44:06.779646 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (compile): 18:44:06.774676 => 18:44:06.778645
[0m18:44:06.779646 [debug] [Thread-1 (]: Began executing node model.practice.mart_nrr_grr
[0m18:44:06.783644 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_nrr_grr"
[0m18:44:06.786676 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_nrr_grr"
[0m18:44:06.786676 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_nrr_grr"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_nrr_grr
         as
        (

with prev as (
    select
        customer_id,
        revenue,
        lag(revenue) over (partition by customer_id order by PAYMENT_MONTH) as previous_revenue
    from RIDE_SHARING_DB.STAGING.stg_transaction
),
transactions AS (
 SELECT
        customer_id,
        SUM(revenue) AS total_revenue,  
        sum(previous_revenue) as prev_total_revenue,
        CASE WHEN total_revenue > prev_total_revenue THEN total_revenue-prev_total_revenue ELSE 0 END AS expansion_revenue,  
        CASE WHEN total_revenue < prev_total_revenue THEN prev_total_revenue-total_revenue ELSE 0 END AS contraction_revenue  
    FROM prev
    GROUP BY 1
),
trans as(
SELECT
    customer_id,
    total_revenue,
    prev_total_revenue,
    expansion_revenue,
    contraction_revenue,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)+(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS net_revenue_retention_in_percentage,
    CASE
        WHEN total_revenue = 0 THEN 0
        ELSE (((total_revenue)-(expansion_revenue - contraction_revenue)) / total_revenue)*100
    END AS gross_revenue_retention_in_percentage
FROM transactions
)
SELECT 
    t.CUSTOMER_ID,
    c.COUNTRY,
    c.REGION,
    t.total_revenue,
    t.prev_total_revenue,
    t.expansion_revenue,
    t.contraction_revenue,
    t.net_revenue_retention_in_percentage,
    t.gross_revenue_retention_in_percentage
    from trans t
    JOIN RIDE_SHARING_DB.STAGING.stg_country c
    ON t.CUSTOMER_ID = c.CUSTOMER_ID
        );
[0m18:44:06.787676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:07.710989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:07.714631 [debug] [Thread-1 (]: Timing info for model.practice.mart_nrr_grr (execute): 18:44:06.779646 => 18:44:07.714631
[0m18:44:07.714631 [debug] [Thread-1 (]: On model.practice.mart_nrr_grr: Close
[0m18:44:07.806321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E94F50>]}
[0m18:44:07.809321 [info ] [Thread-1 (]: 10 of 13 OK created sql table model MARTS.mart_nrr_grr ......................... [[32mSUCCESS 1[0m in 1.03s]
[0m18:44:07.813617 [debug] [Thread-1 (]: Finished running node model.practice.mart_nrr_grr
[0m18:44:07.815546 [debug] [Thread-1 (]: Began running node model.practice.mart_prod_churn
[0m18:44:07.816616 [info ] [Thread-1 (]: 11 of 13 START sql table model MARTS.mart_prod_churn ........................... [RUN]
[0m18:44:07.817568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_nrr_grr, now model.practice.mart_prod_churn)
[0m18:44:07.818608 [debug] [Thread-1 (]: Began compiling node model.practice.mart_prod_churn
[0m18:44:07.822606 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_prod_churn"
[0m18:44:07.823603 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (compile): 18:44:07.818608 => 18:44:07.823603
[0m18:44:07.824608 [debug] [Thread-1 (]: Began executing node model.practice.mart_prod_churn
[0m18:44:07.827607 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_prod_churn"
[0m18:44:07.829575 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_prod_churn"
[0m18:44:07.830582 [debug] [Thread-1 (]: On model.practice.mart_prod_churn: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_prod_churn"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_prod_churn
         as
        (



WITH transactions AS (
    SELECT
        PRODUCT_ID,
        DATE_TRUNC('month',PAYMENT_MONTH) AS tran_month
    FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
 
max_month AS (
    SELECT MAX(tran_month) AS latest_month FROM transactions
),
 
churn_status AS (
    SELECT
        t.PRODUCT_ID,
        m.latest_month,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -3, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS L3m_churn_status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -1, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS LM_churn_status,
        CASE
            WHEN MAX(t.tran_month) <= DATEADD('month', -12, m.latest_month) THEN 'Churned'
            ELSE 'Active'
        END AS Ltm_churn_status
    FROM transactions t
    CROSS JOIN max_month m
    GROUP BY t.PRODUCT_ID,m.latest_month
)
SELECT * FROM churn_status
        );
[0m18:44:07.831608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:08.700813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:08.704849 [debug] [Thread-1 (]: Timing info for model.practice.mart_prod_churn (execute): 18:44:07.824608 => 18:44:08.703811
[0m18:44:08.704849 [debug] [Thread-1 (]: On model.practice.mart_prod_churn: Close
[0m18:44:08.785206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E95D30>]}
[0m18:44:08.786206 [info ] [Thread-1 (]: 11 of 13 OK created sql table model MARTS.mart_prod_churn ...................... [[32mSUCCESS 1[0m in 0.97s]
[0m18:44:08.787134 [debug] [Thread-1 (]: Finished running node model.practice.mart_prod_churn
[0m18:44:08.788180 [debug] [Thread-1 (]: Began running node model.practice.mart_product_revenue
[0m18:44:08.788180 [info ] [Thread-1 (]: 12 of 13 START sql table model MARTS.mart_product_revenue ...................... [RUN]
[0m18:44:08.789174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_prod_churn, now model.practice.mart_product_revenue)
[0m18:44:08.790171 [debug] [Thread-1 (]: Began compiling node model.practice.mart_product_revenue
[0m18:44:08.793173 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_product_revenue"
[0m18:44:08.794173 [debug] [Thread-1 (]: Timing info for model.practice.mart_product_revenue (compile): 18:44:08.790171 => 18:44:08.794173
[0m18:44:08.795143 [debug] [Thread-1 (]: Began executing node model.practice.mart_product_revenue
[0m18:44:08.798150 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_product_revenue"
[0m18:44:08.800153 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_product_revenue"
[0m18:44:08.801151 [debug] [Thread-1 (]: On model.practice.mart_product_revenue: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_product_revenue"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_product_revenue
         as
        (
SELECT 
    p.PRODUCT_ID,
    p.PRODUCT_FAMILY,
    SUM(r.REVENUE) AS TOTAL_REVENUE,
    COUNT(DISTINCT r.CUSTOMER_ID) AS UNIQUE_CUSTOMERS,
    RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS RANK
FROM RIDE_SHARING_DB.MART.stg_product p
JOIN RIDE_SHARING_DB.STAGING.stg_transaction r 
ON p.PRODUCT_ID = r.PRODUCT_ID
GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
ORDER BY TOTAL_REVENUE DESC
        );
[0m18:44:08.801151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:09.825428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:09.830389 [debug] [Thread-1 (]: Timing info for model.practice.mart_product_revenue (execute): 18:44:08.795143 => 18:44:09.829390
[0m18:44:09.831426 [debug] [Thread-1 (]: On model.practice.mart_product_revenue: Close
[0m18:44:09.927831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7E953A0>]}
[0m18:44:09.928802 [info ] [Thread-1 (]: 12 of 13 OK created sql table model MARTS.mart_product_revenue ................. [[32mSUCCESS 1[0m in 1.14s]
[0m18:44:09.929808 [debug] [Thread-1 (]: Finished running node model.practice.mart_product_revenue
[0m18:44:09.930801 [debug] [Thread-1 (]: Began running node model.practice.mart_revenue_loss
[0m18:44:09.931800 [info ] [Thread-1 (]: 13 of 13 START sql table model MARTS.mart_revenue_loss ......................... [RUN]
[0m18:44:09.932800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.practice.mart_product_revenue, now model.practice.mart_revenue_loss)
[0m18:44:09.932800 [debug] [Thread-1 (]: Began compiling node model.practice.mart_revenue_loss
[0m18:44:09.936800 [debug] [Thread-1 (]: Writing injected SQL for node "model.practice.mart_revenue_loss"
[0m18:44:09.937798 [debug] [Thread-1 (]: Timing info for model.practice.mart_revenue_loss (compile): 18:44:09.933800 => 18:44:09.937798
[0m18:44:09.938802 [debug] [Thread-1 (]: Began executing node model.practice.mart_revenue_loss
[0m18:44:09.940799 [debug] [Thread-1 (]: Writing runtime sql for node "model.practice.mart_revenue_loss"
[0m18:44:09.942800 [debug] [Thread-1 (]: Using snowflake connection "model.practice.mart_revenue_loss"
[0m18:44:09.943800 [debug] [Thread-1 (]: On model.practice.mart_revenue_loss: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "practice", "target_name": "dev", "node_id": "model.practice.mart_revenue_loss"} */
create or replace transient table RIDE_SHARING_DB.MARTS.mart_revenue_loss
         as
        (

WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM RIDE_SHARING_DB.STAGING.stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT 
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH   
ORDER BY Revenue_Loss DESC


-- SELECT 
--     PRODUCT_ID,
--     SUM(Revenue_Loss) as Total_Revenue_Loss
--     FROM loss_revenue
-- GROUP BY PRODUCT_ID
        );
[0m18:44:09.943800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:10.691688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:10.701688 [debug] [Thread-1 (]: Timing info for model.practice.mart_revenue_loss (execute): 18:44:09.938802 => 18:44:10.699683
[0m18:44:10.702684 [debug] [Thread-1 (]: On model.practice.mart_revenue_loss: Close
[0m18:44:10.801542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b150f75-998c-4bbe-b2d5-bb0a5f5cb7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D7BBE6C0>]}
[0m18:44:10.802544 [info ] [Thread-1 (]: 13 of 13 OK created sql table model MARTS.mart_revenue_loss .................... [[32mSUCCESS 1[0m in 0.87s]
[0m18:44:10.803512 [debug] [Thread-1 (]: Finished running node model.practice.mart_revenue_loss
[0m18:44:10.806558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:10.806558 [debug] [MainThread]: Connection 'create_RIDE_SHARING_DB_MART' was properly closed.
[0m18:44:10.807601 [debug] [MainThread]: Connection 'list_SNOWFLAKE_PRAC_public' was properly closed.
[0m18:44:10.807601 [debug] [MainThread]: Connection 'model.practice.mart_revenue_loss' was properly closed.
[0m18:44:10.808604 [info ] [MainThread]: 
[0m18:44:10.809611 [info ] [MainThread]: Finished running 3 view models, 10 table models in 0 hours 0 minutes and 15.36 seconds (15.36s).
[0m18:44:10.814567 [debug] [MainThread]: Command end result
[0m18:44:10.889154 [info ] [MainThread]: 
[0m18:44:10.890156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:10.891157 [info ] [MainThread]: 
[0m18:44:10.892155 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m18:44:10.893186 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:10.893186 after 16.79 seconds
[0m18:44:10.893186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C9A6F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C4FE9DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7D59D91C0>]}
[0m18:44:10.894186 [debug] [MainThread]: Flushing usage events
